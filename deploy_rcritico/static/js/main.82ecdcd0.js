/*! For license information please see main.82ecdcd0.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,r)=>{e.exports=r(202)},153:(e,t,r)=>{var n=r(43),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,a={},c=null,d=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:o,type:e,key:c,ref:d,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},202:(e,t)=>{var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function x(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||h}function b(){}function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||h}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=x.prototype;var y=v.prototype=new b;y.constructor=v,g(y,x.prototype),y.isPureReactComponent=!0;var j=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var o,a={},i=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)_.call(t,o)&&!w.hasOwnProperty(o)&&(a[o]=t[o]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===a[o]&&(a[o]=l[o]);return{$$typeof:r,type:e,key:i,ref:s,props:a,_owner:S.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,o,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return i=i(l=e),e=""===a?"."+T(l,0):a,j(i)?(o="",null!=e&&(o=e.replace(E,"$&/")+"/"),R(i,t,o,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",j(e))for(var c=0;c<e.length;c++){var d=a+T(s=e[c],c);l+=R(s,t,o,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=R(s=s.value,t,o,d=a+T(s,c++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,r){if(null==e)return e;var n=[],o=0;return R(e,n,"","",function(e){return t.call(r,e,o++)}),n}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var z={current:null},I={transition:null},O={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:I,ReactCurrentOwner:S};t.Children={map:N,forEach:function(e,t,r){N(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=o,t.Profiler=i,t.PureComponent=v,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!w.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];o.children=l}return{$$typeof:r,type:e.type,key:a,ref:i,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return z.current.useCallback(e,t)},t.useContext=function(e){return z.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return z.current.useDeferredValue(e)},t.useEffect=function(e,t){return z.current.useEffect(e,t)},t.useId=function(){return z.current.useId()},t.useImperativeHandle=function(e,t,r){return z.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return z.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return z.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return z.current.useMemo(e,t)},t.useReducer=function(e,t,r){return z.current.useReducer(e,t,r)},t.useRef=function(e){return z.current.useRef(e)},t.useState=function(e){return z.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return z.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return z.current.useTransition()},t.version="18.2.0"},234:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,o=e[n];if(!(0<a(o,t)))break e;e[n]=t,e[r]=o,r=n}}function n(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length,i=o>>>1;n<i;){var s=2*(n+1)-1,l=e[s],c=s+1,d=e[c];if(0>a(l,r))c<o&&0>a(d,l)?(e[n]=d,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else{if(!(c<o&&0>a(d,r)))break e;e[n]=d,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],p=1,u=null,f=3,h=!1,g=!1,m=!1,x="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=n(d);null!==t;){if(null===t.callback)o(d);else{if(!(t.startTime<=e))break;o(d),t.sortIndex=t.expirationTime,r(c,t)}t=n(d)}}function j(e){if(m=!1,y(e),!g)if(null!==n(c))g=!0,I(_);else{var t=n(d);null!==t&&O(j,t.startTime-e)}}function _(e,r){g=!1,m&&(m=!1,b(C),C=-1),h=!0;var a=f;try{for(y(r),u=n(c);null!==u&&(!(u.expirationTime>r)||e&&!R());){var i=u.callback;if("function"===typeof i){u.callback=null,f=u.priorityLevel;var s=i(u.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?u.callback=s:u===n(c)&&o(c),y(r)}else o(c);u=n(c)}if(null!==u)var l=!0;else{var p=n(d);null!==p&&O(j,p.startTime-r),l=!1}return l}finally{u=null,f=a,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,w=!1,k=null,C=-1,E=5,T=-1;function R(){return!(t.unstable_now()-T<E)}function N(){if(null!==k){var e=t.unstable_now();T=e;var r=!0;try{r=k(!0,e)}finally{r?S():(w=!1,k=null)}}else w=!1}if("function"===typeof v)S=function(){v(N)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,z=A.port2;A.port1.onmessage=N,S=function(){z.postMessage(null)}}else S=function(){x(N,0)};function I(e){k=e,w||(w=!0,S())}function O(e,r){C=x(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||h||(g=!0,I(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:p++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>i?(e.sortIndex=a,r(d,e),null===n(c)&&e===n(d)&&(m?(b(C),C=-1):m=!0,O(j,a-i))):(e.sortIndex=s,r(c,e),g||h||(g=!0,I(_))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},579:(e,t,r)=>{e.exports=r(153)},730:(e,t,r)=>{var n=r(43),o=r(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),p=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function g(e,t,r,n,o,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function v(e,t,r,n){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,o,n)&&(r=null),n||null===o?function(e){return!!p.call(h,e)||!p.call(f,e)&&(u.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=null===r?3!==o.type&&"":r:(t=o.attributeName,n=o.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(o=o.type)||4===o&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,b);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var D,L=Object.assign;function B(e){if(void 0===D)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var F=!1;function M(e,t){if(!e||F)return"";F=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),a=n.stack.split("\n"),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(1!==i||1!==s)do{if(i--,0>--s||o[i]!==a[s]){var l="\n"+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?B(e):""}function W(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=M(e.type,!1);case 11:return e=M(e.type.render,!1);case 1:return e=M(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case k:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return U(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var o=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=G(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var r=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function K(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=V(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Q(e,t){J(e,t);var r=V(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&q(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+V(r),t=null,o=0;o<e.length;o++){if(e[o].value===r)return e[o].selected=!0,void(n&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:V(r)}}function ae(e,t){var r=V(t.value),n=V(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,pe=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function ue(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),o=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}Object.keys(fe).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var xe=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,we=null;function ke(e){if(e=yo(e)){if("function"!==typeof _e)throw Error(a(280));var t=e.stateNode;t&&(t=_o(t),_e(e.stateNode,e.type,t))}}function Ce(e){Se?we?we.push(e):we=[e]:Se=e}function Ee(){if(Se){var e=Se,t=we;if(we=Se=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Te(e,t){return e(t)}function Re(){}var Ne=!1;function Ae(e,t,r){if(Ne)return e(t,r);Ne=!0;try{return Te(e,t,r)}finally{Ne=!1,(null!==Se||null!==we)&&(Re(),Ee())}}function ze(e,t){var r=e.stateNode;if(null===r)return null;var n=_o(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(a(231,t,typeof r));return r}var Ie=!1;if(d)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(de){Ie=!1}function Pe(e,t,r,n,o,a,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var De=!1,Le=null,Be=!1,Fe=null,Me={onError:function(e){De=!0,Le=e}};function We(e,t,r,n,o,a,i,s,l){De=!1,Le=null,Pe.apply(Me,arguments)}function Ue(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ue(e)!==e)throw Error(a(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(n=o.return)){r=n;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===r)return Ve(o),e;if(i===n)return Ve(o),t;i=i.sibling}throw Error(a(188))}if(r.return!==n.return)r=o,n=i;else{for(var s=!1,l=o.child;l;){if(l===r){s=!0,r=o,n=i;break}if(l===n){s=!0,n=o,r=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===r){s=!0,r=i,n=o;break}if(l===n){s=!0,n=i,r=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var $e=o.unstable_scheduleCallback,qe=o.unstable_cancelCallback,Xe=o.unstable_shouldYield,Ke=o.unstable_requestPaint,Je=o.unstable_now,Qe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,rt=o.unstable_LowPriority,nt=o.unstable_IdlePriority,ot=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function pt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,o=e.suspendedLanes,a=e.pingedLanes,i=268435455&r;if(0!==i){var s=i&~o;0!==s?n=pt(s):0!==(a&=i)&&(n=pt(a))}else 0!==(i=r&~o)?n=pt(i):0!==a&&(n=pt(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&o)&&((o=n&-n)>=(a=t&-t)||16===o&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(r=31-it(t)),n|=e[r],t&=~o;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-it(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var vt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,_t,St,wt,kt,Ct=!1,Et=[],Tt=null,Rt=null,Nt=null,At=new Map,zt=new Map,It=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zt.delete(t.pointerId)}}function Dt(e,t,r,n,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=yo(t))&&_t(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=vo(e.target);if(null!==t){var r=Ue(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void kt(e.priority,function(){St(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=yo(r))&&_t(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);ye=n,r.target.dispatchEvent(n),ye=null,t.shift()}return!0}function Ft(e,t,r){Bt(e)&&r.delete(t)}function Mt(){Ct=!1,null!==Tt&&Bt(Tt)&&(Tt=null),null!==Rt&&Bt(Rt)&&(Rt=null),null!==Nt&&Bt(Nt)&&(Nt=null),At.forEach(Ft),zt.forEach(Ft)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Mt)))}function Ut(e){function t(t){return Wt(t,e)}if(0<Et.length){Wt(Et[0],e);for(var r=1;r<Et.length;r++){var n=Et[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Tt&&Wt(Tt,e),null!==Rt&&Wt(Rt,e),null!==Nt&&Wt(Nt,e),At.forEach(t),zt.forEach(t),r=0;r<It.length;r++)(n=It[r]).blockedOn===e&&(n.blockedOn=null);for(;0<It.length&&null===(r=It[0]).blockedOn;)Lt(r),null===r.blockedOn&&It.shift()}var Ht=y.ReactCurrentBatchConfig,Vt=!0;function Gt(e,t,r,n){var o=vt,a=Ht.transition;Ht.transition=null;try{vt=1,$t(e,t,r,n)}finally{vt=o,Ht.transition=a}}function Yt(e,t,r,n){var o=vt,a=Ht.transition;Ht.transition=null;try{vt=4,$t(e,t,r,n)}finally{vt=o,Ht.transition=a}}function $t(e,t,r,n){if(Vt){var o=Xt(e,t,r,n);if(null===o)Vn(e,t,n,qt,r),Pt(e,n);else if(function(e,t,r,n,o){switch(t){case"focusin":return Tt=Dt(Tt,e,t,r,n,o),!0;case"dragenter":return Rt=Dt(Rt,e,t,r,n,o),!0;case"mouseover":return Nt=Dt(Nt,e,t,r,n,o),!0;case"pointerover":var a=o.pointerId;return At.set(a,Dt(At.get(a)||null,e,t,r,n,o)),!0;case"gotpointercapture":return a=o.pointerId,zt.set(a,Dt(zt.get(a)||null,e,t,r,n,o)),!0}return!1}(o,e,t,r,n))n.stopPropagation();else if(Pt(e,n),4&t&&-1<Ot.indexOf(e)){for(;null!==o;){var a=yo(o);if(null!==a&&jt(a),null===(a=Xt(e,t,r,n))&&Vn(e,t,n,qt,r),a===o)break;o=a}null!==o&&n.stopPropagation()}else Vn(e,t,n,null,r)}}var qt=null;function Xt(e,t,r,n){if(qt=null,null!==(e=vo(e=je(n))))if(null===(t=Ue(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Qt,n=r.length,o="value"in Jt?Jt.value:Jt.textContent,a=o.length;for(e=0;e<n&&r[e]===o[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===o[a-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function or(e){function t(t,r,n,o,a){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,ir,sr,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=or(lr),dr=L({},lr,{view:0,detail:0}),pr=or(dr),ur=L({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(ar=e.screenX-sr.screenX,ir=e.screenY-sr.screenY):ir=ar=0,sr=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:ir}}),fr=or(ur),hr=or(L({},ur,{dataTransfer:0})),gr=or(L({},dr,{relatedTarget:0})),mr=or(L({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),xr=L({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=or(xr),vr=or(L({},lr,{data:0})),yr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_r[e])&&!!t[e]}function wr(){return Sr}var kr=L({},dr,{key:function(e){if(e.key){var t=yr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cr=or(kr),Er=or(L({},ur,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tr=or(L({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wr})),Rr=or(L({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nr=L({},ur,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ar=or(Nr),zr=[9,13,27,32],Ir=d&&"CompositionEvent"in window,Or=null;d&&"documentMode"in document&&(Or=document.documentMode);var Pr=d&&"TextEvent"in window&&!Or,Dr=d&&(!Ir||Or&&8<Or&&11>=Or),Lr=String.fromCharCode(32),Br=!1;function Fr(e,t){switch(e){case"keyup":return-1!==zr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wr=!1;var Ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ur[e.type]:"textarea"===t}function Vr(e,t,r,n){Ce(n),0<(t=Yn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gr=null,Yr=null;function $r(e){Bn(e,0)}function qr(e){if($(jo(e)))return e}function Xr(e,t){if("change"===e)return t}var Kr=!1;if(d){var Jr;if(d){var Qr="oninput"in document;if(!Qr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Qr="function"===typeof Zr.oninput}Jr=Qr}else Jr=!1;Kr=Jr&&(!document.documentMode||9<document.documentMode)}function en(){Gr&&(Gr.detachEvent("onpropertychange",tn),Yr=Gr=null)}function tn(e){if("value"===e.propertyName&&qr(Yr)){var t=[];Vr(t,Yr,e,je(e)),Ae($r,t)}}function rn(e,t,r){"focusin"===e?(en(),Yr=r,(Gr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qr(Yr)}function on(e,t){if("click"===e)return qr(t)}function an(e,t){if("input"===e||"change"===e)return qr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!p.call(t,o)||!sn(e[o],t[o]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function pn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function un(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=q((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hn(e){var t=un(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&pn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=r.textContent.length,a=Math.min(n.start,o);n=void 0===n.end?a:Math.min(n.end,o),!e.extend&&a>n&&(o=n,n=a,a=o),o=dn(r,a);var i=dn(r,n);o&&i&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=d&&"documentMode"in document&&11>=document.documentMode,mn=null,xn=null,bn=null,vn=!1;function yn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;vn||null==mn||mn!==q(n)||("selectionStart"in(n=mn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=Yn(xn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function jn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _n={animationend:jn("Animation","AnimationEnd"),animationiteration:jn("Animation","AnimationIteration"),animationstart:jn("Animation","AnimationStart"),transitionend:jn("Transition","TransitionEnd")},Sn={},wn={};function kn(e){if(Sn[e])return Sn[e];if(!_n[e])return e;var t,r=_n[e];for(t in r)if(r.hasOwnProperty(t)&&t in wn)return Sn[e]=r[t];return e}d&&(wn=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var Cn=kn("animationend"),En=kn("animationiteration"),Tn=kn("animationstart"),Rn=kn("transitionend"),Nn=new Map,An="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,t){Nn.set(e,t),l(t,[e])}for(var In=0;In<An.length;In++){var On=An[In];zn(On.toLowerCase(),"on"+(On[0].toUpperCase()+On.slice(1)))}zn(Cn,"onAnimationEnd"),zn(En,"onAnimationIteration"),zn(Tn,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(Rn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pn));function Ln(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,o,i,s,l,c){if(We.apply(this,arguments),De){if(!De)throw Error(a(198));var d=Le;De=!1,Le=null,Be||(Be=!0,Fe=d)}}(n,t,void 0,e),e.currentTarget=null}function Bn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var s=n[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;Ln(o,s,c),a=l}else for(i=0;i<n.length;i++){if(l=(s=n[i]).instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;Ln(o,s,c),a=l}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Fn(e,t){var r=t[mo];void 0===r&&(r=t[mo]=new Set);var n=e+"__bubble";r.has(n)||(Hn(t,e,2,!1),r.add(n))}function Mn(e,t,r){var n=0;t&&(n|=4),Hn(r,e,n,t)}var Wn="_reactListening"+Math.random().toString(36).slice(2);function Un(e){if(!e[Wn]){e[Wn]=!0,i.forEach(function(t){"selectionchange"!==t&&(Dn.has(t)||Mn(t,!1,e),Mn(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wn]||(t[Wn]=!0,Mn("selectionchange",!1,t))}}function Hn(e,t,r,n){switch(Kt(t)){case 1:var o=Gt;break;case 4:o=Yt;break;default:o=$t}r=o.bind(null,t,r,e),o=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),n?void 0!==o?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):void 0!==o?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Vn(e,t,r,n,o){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var s=n.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===i)for(i=n.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;i=i.return}for(;null!==s;){if(null===(i=vo(s)))return;if(5===(l=i.tag)||6===l){n=a=i;continue e}s=s.parentNode}}n=n.return}Ae(function(){var n=a,o=je(r),i=[];e:{var s=Nn.get(e);if(void 0!==s){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Cr;break;case"focusin":c="focus",l=gr;break;case"focusout":c="blur",l=gr;break;case"beforeblur":case"afterblur":l=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=hr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tr;break;case Cn:case En:case Tn:l=mr;break;case Rn:l=Rr;break;case"scroll":l=pr;break;case"wheel":l=Ar;break;case"copy":case"cut":case"paste":l=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Er}var d=0!==(4&t),p=!d&&"scroll"===e,u=d?null!==s?s+"Capture":null:s;d=[];for(var f,h=n;null!==h;){var g=(f=h).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==u&&(null!=(g=ze(h,u))&&d.push(Gn(h,g,f)))),p)break;h=h.return}0<d.length&&(s=new l(s,c,null,r,o),i.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===ye||!(c=r.relatedTarget||r.fromElement)||!vo(c)&&!c[go])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?vo(c):null)&&(c!==(p=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=fr,g="onMouseLeave",u="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(d=Er,g="onPointerLeave",u="onPointerEnter",h="pointer"),p=null==l?s:jo(l),f=null==c?s:jo(c),(s=new d(g,h+"leave",l,r,o)).target=p,s.relatedTarget=f,g=null,vo(o)===n&&((d=new d(u,h+"enter",c,r,o)).target=f,d.relatedTarget=p,g=d),p=g,l&&c)e:{for(u=c,h=0,f=d=l;f;f=$n(f))h++;for(f=0,g=u;g;g=$n(g))f++;for(;0<h-f;)d=$n(d),h--;for(;0<f-h;)u=$n(u),f--;for(;h--;){if(d===u||null!==u&&d===u.alternate)break e;d=$n(d),u=$n(u)}d=null}else d=null;null!==l&&qn(i,s,l,d,!1),null!==c&&null!==p&&qn(i,p,c,d,!0)}if("select"===(l=(s=n?jo(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Xr;else if(Hr(s))if(Kr)m=an;else{m=nn;var x=rn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=on);switch(m&&(m=m(e,n))?Vr(i,m,r,o):(x&&x(e,s,n),"focusout"===e&&(x=s._wrapperState)&&x.controlled&&"number"===s.type&&ee(s,"number",s.value)),x=n?jo(n):window,e){case"focusin":(Hr(x)||"true"===x.contentEditable)&&(mn=x,xn=n,bn=null);break;case"focusout":bn=xn=mn=null;break;case"mousedown":vn=!0;break;case"contextmenu":case"mouseup":case"dragend":vn=!1,yn(i,r,o);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":yn(i,r,o)}var b;if(Ir)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Wr?Fr(e,r)&&(v="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(v="onCompositionStart");v&&(Dr&&"ko"!==r.locale&&(Wr||"onCompositionStart"!==v?"onCompositionEnd"===v&&Wr&&(b=er()):(Qt="value"in(Jt=o)?Jt.value:Jt.textContent,Wr=!0)),0<(x=Yn(n,v)).length&&(v=new vr(v,e,null,r,o),i.push({event:v,listeners:x}),b?v.data=b:null!==(b=Mr(r))&&(v.data=b))),(b=Pr?function(e,t){switch(e){case"compositionend":return Mr(t);case"keypress":return 32!==t.which?null:(Br=!0,Lr);case"textInput":return(e=t.data)===Lr&&Br?null:e;default:return null}}(e,r):function(e,t){if(Wr)return"compositionend"===e||!Ir&&Fr(e,t)?(e=er(),Zt=Qt=Jt=null,Wr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Yn(n,"onBeforeInput")).length&&(o=new vr("onBeforeInput","beforeinput",null,r,o),i.push({event:o,listeners:n}),o.data=b))}Bn(i,t)})}function Gn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yn(e,t){for(var r=t+"Capture",n=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=ze(e,r))&&n.unshift(Gn(e,a,o)),null!=(a=ze(e,t))&&n.push(Gn(e,a,o))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qn(e,t,r,n,o){for(var a=t._reactName,i=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=ze(r,a))&&i.unshift(Gn(r,l,s)):o||null!=(l=ze(r,a))&&i.push(Gn(r,l,s))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var Xn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Xn,"\n").replace(Kn,"")}function Qn(e,t,r){if(t=Jn(t),Jn(e)!==t&&r)throw Error(a(425))}function Zn(){}var eo=null,to=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var no="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,ao="function"===typeof Promise?Promise:void 0,io="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ao?function(e){return ao.resolve(null).then(e).catch(so)}:no;function so(e){setTimeout(function(){throw e})}function lo(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&8===o.nodeType)if("/$"===(r=o.data)){if(0===n)return e.removeChild(o),void Ut(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=o}while(r);Ut(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function po(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var uo=Math.random().toString(36).slice(2),fo="__reactFiber$"+uo,ho="__reactProps$"+uo,go="__reactContainer$"+uo,mo="__reactEvents$"+uo,xo="__reactListeners$"+uo,bo="__reactHandles$"+uo;function vo(e){var t=e[fo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[go]||r[fo]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=po(e);null!==e;){if(r=e[fo])return r;e=po(e)}return t}r=(e=r).parentNode}return null}function yo(e){return!(e=e[fo]||e[go])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function jo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _o(e){return e[ho]||null}var So=[],wo=-1;function ko(e){return{current:e}}function Co(e){0>wo||(e.current=So[wo],So[wo]=null,wo--)}function Eo(e,t){wo++,So[wo]=e.current,e.current=t}var To={},Ro=ko(To),No=ko(!1),Ao=To;function zo(e,t){var r=e.type.contextTypes;if(!r)return To;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in r)a[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Io(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oo(){Co(No),Co(Ro)}function Po(e,t,r){if(Ro.current!==To)throw Error(a(168));Eo(Ro,t),Eo(No,r)}function Do(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in t))throw Error(a(108,H(e)||"Unknown",o));return L({},r,n)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||To,Ao=Ro.current,Eo(Ro,e),Eo(No,No.current),!0}function Bo(e,t,r){var n=e.stateNode;if(!n)throw Error(a(169));r?(e=Do(e,t,Ao),n.__reactInternalMemoizedMergedChildContext=e,Co(No),Co(Ro),Eo(Ro,e)):Co(No),Eo(No,r)}var Fo=null,Mo=!1,Wo=!1;function Uo(e){null===Fo?Fo=[e]:Fo.push(e)}function Ho(){if(!Wo&&null!==Fo){Wo=!0;var e=0,t=vt;try{var r=Fo;for(vt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Fo=null,Mo=!1}catch(o){throw null!==Fo&&(Fo=Fo.slice(e+1)),$e(Ze,Ho),o}finally{vt=t,Wo=!1}}return null}var Vo=[],Go=0,Yo=null,$o=0,qo=[],Xo=0,Ko=null,Jo=1,Qo="";function Zo(e,t){Vo[Go++]=$o,Vo[Go++]=Yo,Yo=e,$o=t}function ea(e,t,r){qo[Xo++]=Jo,qo[Xo++]=Qo,qo[Xo++]=Ko,Ko=e;var n=Jo;e=Qo;var o=32-it(n)-1;n&=~(1<<o),r+=1;var a=32-it(t)+o;if(30<a){var i=o-o%5;a=(n&(1<<i)-1).toString(32),n>>=i,o-=i,Jo=1<<32-it(t)+o|r<<o|n,Qo=a+e}else Jo=1<<a|r<<o|n,Qo=e}function ta(e){null!==e.return&&(Zo(e,1),ea(e,1,0))}function ra(e){for(;e===Yo;)Yo=Vo[--Go],Vo[Go]=null,$o=Vo[--Go],Vo[Go]=null;for(;e===Ko;)Ko=qo[--Xo],qo[Xo]=null,Qo=qo[--Xo],qo[Xo]=null,Jo=qo[--Xo],qo[Xo]=null}var na=null,oa=null,aa=!1,ia=null;function sa(e,t){var r=zc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function la(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,oa=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Ko?{id:Jo,overflow:Qo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=zc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,na=e,oa=null,!0);default:return!1}}function ca(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function da(e){if(aa){var t=oa;if(t){var r=t;if(!la(e,t)){if(ca(e))throw Error(a(418));t=co(r.nextSibling);var n=na;t&&la(e,t)?sa(n,r):(e.flags=-4097&e.flags|2,aa=!1,na=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,na=e}}}function pa(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!aa)return pa(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=oa)){if(ca(e))throw fa(),Error(a(418));for(;t;)sa(e,t),t=co(t.nextSibling)}if(pa(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){oa=co(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}oa=null}}else oa=na?co(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=oa;e;)e=co(e.nextSibling)}function ha(){oa=na=null,aa=!1}function ga(e){null===ia?ia=[e]:ia.push(e)}var ma=y.ReactCurrentBatchConfig;function xa(e,t){if(e&&e.defaultProps){for(var r in t=L({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var ba=ko(null),va=null,ya=null,ja=null;function _a(){ja=ya=va=null}function Sa(e){var t=ba.current;Co(ba),e._currentValue=t}function wa(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ka(e,t){va=e,ja=ya=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ys=!0),e.firstContext=null)}function Ca(e){var t=e._currentValue;if(ja!==e)if(e={context:e,memoizedValue:t,next:null},null===ya){if(null===va)throw Error(a(308));ya=e,va.dependencies={lanes:0,firstContext:e}}else ya=ya.next=e;return t}var Ea=null;function Ta(e){null===Ea?Ea=[e]:Ea.push(e)}function Ra(e,t,r,n){var o=t.interleaved;return null===o?(r.next=r,Ta(t)):(r.next=o.next,o.next=r),t.interleaved=r,Na(e,n)}function Na(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Aa=!1;function za(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ia(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pa(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Rl)){var o=n.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Na(e,r)}return null===(o=n.interleaved)?(t.next=t,Ta(n)):(t.next=o.next,o.next=t),n.interleaved=t,Na(e,r)}function Da(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}function La(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var o=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?o=a=i:a=a.next=i,r=r.next}while(null!==r);null===a?o=a=t:a=a.next=t}else o=a=t;return r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ba(e,t,r,n){var o=e.updateQueue;Aa=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==a){var p=o.baseState;for(i=0,d=c=l=null,s=a;;){var u=s.lane,f=s.eventTime;if((n&u)===u){null!==d&&(d=d.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,g=s;switch(u=t,f=r,g.tag){case 1:if("function"===typeof(h=g.payload)){p=h.call(f,p,u);break e}p=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(u="function"===typeof(h=g.payload)?h.call(f,p,u):h)||void 0===u)break e;p=L({},p,u);break e;case 2:Aa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(u=o.effects)?o.effects=[s]:u.push(s))}else f={eventTime:f,lane:u,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,l=p):d=d.next=f,i|=u;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(u=s).next,u.next=null,o.lastBaseUpdate=u,o.shared.pending=null}}if(null===d&&(l=p),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=d,null!==(t=o.shared.interleaved)){o=t;do{i|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Ll|=i,e.lanes=i,e.memoizedState=p}}function Fa(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=r,"function"!==typeof o)throw Error(a(191,o));o.call(n)}}}var Ma=(new n.Component).refs;function Wa(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:L({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var Ua={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tc(),o=rc(e),a=Oa(n,o);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=Pa(e,a,o))&&(nc(t,e,o,n),Da(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tc(),o=rc(e),a=Oa(n,o);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=Pa(e,a,o))&&(nc(t,e,o,n),Da(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tc(),n=rc(e),o=Oa(r,n);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Pa(e,o,n))&&(nc(t,e,n,r),Da(t,e,n))}};function Ha(e,t,r,n,o,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(o,a))}function Va(e,t,r){var n=!1,o=To,a=t.contextType;return"object"===typeof a&&null!==a?a=Ca(a):(o=Io(t)?Ao:Ro.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?zo(e,o):To),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ua,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ga(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ua.enqueueReplaceState(t,t.state,null)}function Ya(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs=Ma,za(e);var a=t.contextType;"object"===typeof a&&null!==a?o.context=Ca(a):(a=Io(t)?Ao:Ro.current,o.context=zo(e,a)),o.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Wa(e,t,a,r),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&Ua.enqueueReplaceState(o,o.state,null),Ba(e,r,o,n),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function $a(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var n=r.stateNode}if(!n)throw Error(a(147,e));var o=n,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;t===Ma&&(t=o.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function qa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xa(e){return(0,e._init)(e._payload)}function Ka(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function i(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Bc(r,e.mode,n)).return=e,t):((t=o(t,r)).return=e,t)}function c(e,t,r,n){var a=r.type;return a===S?p(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===z&&Xa(a)===t.type)?((n=o(t,r.props)).ref=$a(e,t,r),n.return=e,n):((n=Pc(r.type,r.key,r.props,null,e.mode,n)).ref=$a(e,t,r),n.return=e,n)}function d(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fc(r,e.mode,n)).return=e,t):((t=o(t,r.children||[])).return=e,t)}function p(e,t,r,n,a){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,a)).return=e,t):((t=o(t,r)).return=e,t)}function u(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(r=Pc(t.type,t.key,t.props,null,e.mode,r)).ref=$a(e,null,t),r.return=e,r;case _:return(t=Fc(t,e.mode,r)).return=e,t;case z:return u(e,(0,t._init)(t._payload),r)}if(te(t)||P(t))return(t=Dc(t,e.mode,r,null)).return=e,t;qa(e,t)}return null}function f(e,t,r,n){var o=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==o?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case j:return r.key===o?c(e,t,r,n):null;case _:return r.key===o?d(e,t,r,n):null;case z:return f(e,t,(o=r._init)(r._payload),n)}if(te(r)||P(r))return null!==o?null:p(e,t,r,n,null);qa(e,r)}return null}function h(e,t,r,n,o){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case j:return c(t,e=e.get(null===n.key?r:n.key)||null,n,o);case _:return d(t,e=e.get(null===n.key?r:n.key)||null,n,o);case z:return h(e,t,r,(0,n._init)(n._payload),o)}if(te(n)||P(n))return p(t,e=e.get(r)||null,n,o,null);qa(t,n)}return null}function g(o,a,s,l){for(var c=null,d=null,p=a,g=a=0,m=null;null!==p&&g<s.length;g++){p.index>g?(m=p,p=null):m=p.sibling;var x=f(o,p,s[g],l);if(null===x){null===p&&(p=m);break}e&&p&&null===x.alternate&&t(o,p),a=i(x,a,g),null===d?c=x:d.sibling=x,d=x,p=m}if(g===s.length)return r(o,p),aa&&Zo(o,g),c;if(null===p){for(;g<s.length;g++)null!==(p=u(o,s[g],l))&&(a=i(p,a,g),null===d?c=p:d.sibling=p,d=p);return aa&&Zo(o,g),c}for(p=n(o,p);g<s.length;g++)null!==(m=h(p,o,g,s[g],l))&&(e&&null!==m.alternate&&p.delete(null===m.key?g:m.key),a=i(m,a,g),null===d?c=m:d.sibling=m,d=m);return e&&p.forEach(function(e){return t(o,e)}),aa&&Zo(o,g),c}function m(o,s,l,c){var d=P(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var p=d=null,g=s,m=s=0,x=null,b=l.next();null!==g&&!b.done;m++,b=l.next()){g.index>m?(x=g,g=null):x=g.sibling;var v=f(o,g,b.value,c);if(null===v){null===g&&(g=x);break}e&&g&&null===v.alternate&&t(o,g),s=i(v,s,m),null===p?d=v:p.sibling=v,p=v,g=x}if(b.done)return r(o,g),aa&&Zo(o,m),d;if(null===g){for(;!b.done;m++,b=l.next())null!==(b=u(o,b.value,c))&&(s=i(b,s,m),null===p?d=b:p.sibling=b,p=b);return aa&&Zo(o,m),d}for(g=n(o,g);!b.done;m++,b=l.next())null!==(b=h(g,o,m,b.value,c))&&(e&&null!==b.alternate&&g.delete(null===b.key?m:b.key),s=i(b,s,m),null===p?d=b:p.sibling=b,p=b);return e&&g.forEach(function(e){return t(o,e)}),aa&&Zo(o,m),d}return function e(n,a,i,l){if("object"===typeof i&&null!==i&&i.type===S&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case j:e:{for(var c=i.key,d=a;null!==d;){if(d.key===c){if((c=i.type)===S){if(7===d.tag){r(n,d.sibling),(a=o(d,i.props.children)).return=n,n=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===z&&Xa(c)===d.type){r(n,d.sibling),(a=o(d,i.props)).ref=$a(n,d,i),a.return=n,n=a;break e}r(n,d);break}t(n,d),d=d.sibling}i.type===S?((a=Dc(i.props.children,n.mode,l,i.key)).return=n,n=a):((l=Pc(i.type,i.key,i.props,null,n.mode,l)).ref=$a(n,a,i),l.return=n,n=l)}return s(n);case _:e:{for(d=i.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){r(n,a.sibling),(a=o(a,i.children||[])).return=n,n=a;break e}r(n,a);break}t(n,a),a=a.sibling}(a=Fc(i,n.mode,l)).return=n,n=a}return s(n);case z:return e(n,a,(d=i._init)(i._payload),l)}if(te(i))return g(n,a,i,l);if(P(i))return m(n,a,i,l);qa(n,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(r(n,a.sibling),(a=o(a,i)).return=n,n=a):(r(n,a),(a=Bc(i,n.mode,l)).return=n,n=a),s(n)):r(n,a)}}var Ja=Ka(!0),Qa=Ka(!1),Za={},ei=ko(Za),ti=ko(Za),ri=ko(Za);function ni(e){if(e===Za)throw Error(a(174));return e}function oi(e,t){switch(Eo(ri,t),Eo(ti,e),Eo(ei,Za),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Co(ei),Eo(ei,t)}function ai(){Co(ei),Co(ti),Co(ri)}function ii(e){ni(ri.current);var t=ni(ei.current),r=le(t,e.type);t!==r&&(Eo(ti,e),Eo(ei,r))}function si(e){ti.current===e&&(Co(ei),Co(ti))}var li=ko(0);function ci(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var di=[];function pi(){for(var e=0;e<di.length;e++)di[e]._workInProgressVersionPrimary=null;di.length=0}var ui=y.ReactCurrentDispatcher,fi=y.ReactCurrentBatchConfig,hi=0,gi=null,mi=null,xi=null,bi=!1,vi=!1,yi=0,ji=0;function _i(){throw Error(a(321))}function Si(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function wi(e,t,r,n,o,i){if(hi=i,gi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ui.current=null===e||null===e.memoizedState?ss:ls,e=r(n,o),vi){i=0;do{if(vi=!1,yi=0,25<=i)throw Error(a(301));i+=1,xi=mi=null,t.updateQueue=null,ui.current=cs,e=r(n,o)}while(vi)}if(ui.current=is,t=null!==mi&&null!==mi.next,hi=0,xi=mi=gi=null,bi=!1,t)throw Error(a(300));return e}function ki(){var e=0!==yi;return yi=0,e}function Ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xi?gi.memoizedState=xi=e:xi=xi.next=e,xi}function Ei(){if(null===mi){var e=gi.alternate;e=null!==e?e.memoizedState:null}else e=mi.next;var t=null===xi?gi.memoizedState:xi.next;if(null!==t)xi=t,mi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(mi=e).memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},null===xi?gi.memoizedState=xi=e:xi=xi.next=e}return xi}function Ti(e,t){return"function"===typeof t?t(e):t}function Ri(e){var t=Ei(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=mi,o=n.baseQueue,i=r.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}n.baseQueue=o=i,r.pending=null}if(null!==o){i=o.next,n=n.baseState;var l=s=null,c=null,d=i;do{var p=d.lane;if((hi&p)===p)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var u={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=u,s=n):c=c.next=u,gi.lanes|=p,Ll|=p}d=d.next}while(null!==d&&d!==i);null===c?s=n:c.next=l,sn(n,t.memoizedState)||(ys=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){o=e;do{i=o.lane,gi.lanes|=i,Ll|=i,o=o.next}while(o!==e)}else null===o&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ni(e){var t=Ei(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,i=t.memoizedState;if(null!==o){r.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);sn(i,t.memoizedState)||(ys=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Ai(){}function zi(e,t){var r=gi,n=Ei(),o=t(),i=!sn(n.memoizedState,o);if(i&&(n.memoizedState=o,ys=!0),n=n.queue,Vi(Pi.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||null!==xi&&1&xi.memoizedState.tag){if(r.flags|=2048,Fi(9,Oi.bind(null,r,n,o,t),void 0,null),null===Nl)throw Error(a(349));0!==(30&hi)||Ii(r,t,o)}return o}function Ii(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=gi.updateQueue)?(t={lastEffect:null,stores:null},gi.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Oi(e,t,r,n){t.value=r,t.getSnapshot=n,Di(t)&&Li(e)}function Pi(e,t,r){return r(function(){Di(t)&&Li(e)})}function Di(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Li(e){var t=Na(e,1);null!==t&&nc(t,e,1,-1)}function Bi(e){var t=Ci();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:e},t.queue=e,e=e.dispatch=rs.bind(null,gi,e),[t.memoizedState,e]}function Fi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=gi.updateQueue)?(t={lastEffect:null,stores:null},gi.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Mi(){return Ei().memoizedState}function Wi(e,t,r,n){var o=Ci();gi.flags|=e,o.memoizedState=Fi(1|t,r,void 0,void 0===n?null:n)}function Ui(e,t,r,n){var o=Ei();n=void 0===n?null:n;var a=void 0;if(null!==mi){var i=mi.memoizedState;if(a=i.destroy,null!==n&&Si(n,i.deps))return void(o.memoizedState=Fi(t,r,a,n))}gi.flags|=e,o.memoizedState=Fi(1|t,r,a,n)}function Hi(e,t){return Wi(8390656,8,e,t)}function Vi(e,t){return Ui(2048,8,e,t)}function Gi(e,t){return Ui(4,2,e,t)}function Yi(e,t){return Ui(4,4,e,t)}function $i(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qi(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ui(4,4,$i.bind(null,t,e),r)}function Xi(){}function Ki(e,t){var r=Ei();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Si(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ji(e,t){var r=Ei();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Si(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Qi(e,t,r){return 0===(21&hi)?(e.baseState&&(e.baseState=!1,ys=!0),e.memoizedState=r):(sn(r,t)||(r=gt(),gi.lanes|=r,Ll|=r,e.baseState=!0),t)}function Zi(e,t){var r=vt;vt=0!==r&&4>r?r:4,e(!0);var n=fi.transition;fi.transition={};try{e(!1),t()}finally{vt=r,fi.transition=n}}function es(){return Ei().memoizedState}function ts(e,t,r){var n=rc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ns(e))os(t,r);else if(null!==(r=Ra(e,t,r,n))){nc(r,e,n,tc()),as(r,t,n)}}function rs(e,t,r){var n=rc(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ns(e))os(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=a(i,r);if(o.hasEagerState=!0,o.eagerState=s,sn(s,i)){var l=t.interleaved;return null===l?(o.next=o,Ta(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(c){}null!==(r=Ra(e,t,o,n))&&(nc(r,e,n,o=tc()),as(r,t,n))}}function ns(e){var t=e.alternate;return e===gi||null!==t&&t===gi}function os(e,t){vi=bi=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function as(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}var is={readContext:Ca,useCallback:_i,useContext:_i,useEffect:_i,useImperativeHandle:_i,useInsertionEffect:_i,useLayoutEffect:_i,useMemo:_i,useReducer:_i,useRef:_i,useState:_i,useDebugValue:_i,useDeferredValue:_i,useTransition:_i,useMutableSource:_i,useSyncExternalStore:_i,useId:_i,unstable_isNewReconciler:!1},ss={readContext:Ca,useCallback:function(e,t){return Ci().memoizedState=[e,void 0===t?null:t],e},useContext:Ca,useEffect:Hi,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Wi(4194308,4,$i.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wi(4,2,e,t)},useMemo:function(e,t){var r=Ci();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ci();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ts.bind(null,gi,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Ci().memoizedState=e},useState:Bi,useDebugValue:Xi,useDeferredValue:function(e){return Ci().memoizedState=e},useTransition:function(){var e=Bi(!1),t=e[0];return e=Zi.bind(null,e[1]),Ci().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gi,o=Ci();if(aa){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Nl)throw Error(a(349));0!==(30&hi)||Ii(n,t,r)}o.memoizedState=r;var i={value:r,getSnapshot:t};return o.queue=i,Hi(Pi.bind(null,n,i,e),[e]),n.flags|=2048,Fi(9,Oi.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ci(),t=Nl.identifierPrefix;if(aa){var r=Qo;t=":"+t+"R"+(r=(Jo&~(1<<32-it(Jo)-1)).toString(32)+r),0<(r=yi++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ji++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:Ca,useCallback:Ki,useContext:Ca,useEffect:Vi,useImperativeHandle:qi,useInsertionEffect:Gi,useLayoutEffect:Yi,useMemo:Ji,useReducer:Ri,useRef:Mi,useState:function(){return Ri(Ti)},useDebugValue:Xi,useDeferredValue:function(e){return Qi(Ei(),mi.memoizedState,e)},useTransition:function(){return[Ri(Ti)[0],Ei().memoizedState]},useMutableSource:Ai,useSyncExternalStore:zi,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ca,useCallback:Ki,useContext:Ca,useEffect:Vi,useImperativeHandle:qi,useInsertionEffect:Gi,useLayoutEffect:Yi,useMemo:Ji,useReducer:Ni,useRef:Mi,useState:function(){return Ni(Ti)},useDebugValue:Xi,useDeferredValue:function(e){var t=Ei();return null===mi?t.memoizedState=e:Qi(t,mi.memoizedState,e)},useTransition:function(){return[Ni(Ti)[0],Ei().memoizedState]},useMutableSource:Ai,useSyncExternalStore:zi,useId:es,unstable_isNewReconciler:!1};function ds(e,t){try{var r="",n=t;do{r+=W(n),n=n.return}while(n);var o=r}catch(a){o="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:o,digest:null}}function ps(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,r){(r=Oa(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gl||(Gl=!0,Yl=n),us(0,t)},r}function gs(e,t,r){(r=Oa(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){us(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(r.callback=function(){us(0,t),"function"!==typeof n&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ms(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fs;var o=new Set;n.set(t,o)}else void 0===(o=n.get(t))&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=Cc.bind(null,e,t,r),t.then(e,e))}function xs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bs(e,t,r,n,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Oa(-1,1)).tag=2,Pa(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var vs=y.ReactCurrentOwner,ys=!1;function js(e,t,r,n){t.child=null===e?Qa(t,null,r,n):Ja(t,e.child,r,n)}function _s(e,t,r,n,o){r=r.render;var a=t.ref;return ka(t,o),n=wi(e,t,r,n,a,o),r=ki(),null===e||ys?(aa&&r&&ta(t),t.flags|=1,js(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Ss(e,t,r,n,o){if(null===e){var a=r.type;return"function"!==typeof a||Ic(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Pc(r.type,null,n,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ws(e,t,a,n,o))}if(a=e.child,0===(e.lanes&o)){var i=a.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(i,n)&&e.ref===t.ref)return Gs(e,t,o)}return t.flags|=1,(e=Oc(a,n)).ref=t.ref,e.return=t,t.child=e}function ws(e,t,r,n,o){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(ys=!1,t.pendingProps=n=a,0===(e.lanes&o))return t.lanes=e.lanes,Gs(e,t,o);0!==(131072&e.flags)&&(ys=!0)}}return Es(e,t,r,n,o)}function ks(e,t,r){var n=t.pendingProps,o=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Eo(Ol,Il),Il|=r;else{if(0===(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Eo(Ol,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:r,Eo(Ol,Il),Il|=n}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,Eo(Ol,Il),Il|=n;return js(e,t,o,r),t.child}function Cs(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Es(e,t,r,n,o){var a=Io(r)?Ao:Ro.current;return a=zo(t,a),ka(t,o),r=wi(e,t,r,n,a,o),n=ki(),null===e||ys?(aa&&n&&ta(t),t.flags|=1,js(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Ts(e,t,r,n,o){if(Io(r)){var a=!0;Lo(t)}else a=!1;if(ka(t,o),null===t.stateNode)Vs(e,t),Va(t,r,n),Ya(t,r,n,o),n=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=r.contextType;"object"===typeof c&&null!==c?c=Ca(c):c=zo(t,c=Io(r)?Ao:Ro.current);var d=r.getDerivedStateFromProps,p="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;p||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==n||l!==c)&&Ga(t,i,n,c),Aa=!1;var u=t.memoizedState;i.state=u,Ba(t,n,i,o),l=t.memoizedState,s!==n||u!==l||No.current||Aa?("function"===typeof d&&(Wa(t,r,d,n),l=t.memoizedState),(s=Aa||Ha(t,r,s,n,u,l,c))?(p||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=s):("function"===typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Ia(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:xa(t.type,s),i.props=c,p=t.pendingProps,u=i.context,"object"===typeof(l=r.contextType)&&null!==l?l=Ca(l):l=zo(t,l=Io(r)?Ao:Ro.current);var f=r.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==p||u!==l)&&Ga(t,i,n,l),Aa=!1,u=t.memoizedState,i.state=u,Ba(t,n,i,o);var h=t.memoizedState;s!==p||u!==h||No.current||Aa?("function"===typeof f&&(Wa(t,r,f,n),h=t.memoizedState),(c=Aa||Ha(t,r,c,n,u,h,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(n,h,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,h,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=h),i.props=n,i.state=h,i.context=l,n=c):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),n=!1)}return Rs(e,t,r,n,a,o)}function Rs(e,t,r,n,o,a){Cs(e,t);var i=0!==(128&t.flags);if(!n&&!i)return o&&Bo(t,r,!1),Gs(e,t,a);n=t.stateNode,vs.current=t;var s=i&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=Ja(t,e.child,null,a),t.child=Ja(t,null,s,a)):js(e,t,s,a),t.memoizedState=n.state,o&&Bo(t,r,!0),t.child}function Ns(e){var t=e.stateNode;t.pendingContext?Po(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Po(0,t.context,!1),oi(e,t.containerInfo)}function As(e,t,r,n,o){return ha(),ga(o),t.flags|=256,js(e,t,r,n),t.child}var zs,Is,Os,Ps,Ds={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bs(e,t,r){var n,o=t.pendingProps,i=li.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&i)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Eo(li,1&i),null===e)return da(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Lc(l,o,0,null),e=Dc(e,o,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(r),t.memoizedState=Ds,e):Fs(t,l));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,r,n,o,i,s){if(r)return 256&t.flags?(t.flags&=-257,Ms(e,t,s,n=ps(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,o=t.mode,n=Lc({mode:"visible",children:n.children},o,0,null),(i=Dc(i,o,s,null)).flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!==(1&t.mode)&&Ja(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ds,i);if(0===(1&t.mode))return Ms(e,t,s,null);if("$!"===o.data){if(n=o.nextSibling&&o.nextSibling.dataset)var l=n.dgst;return n=l,Ms(e,t,s,n=ps(i=Error(a(419)),n,void 0))}if(l=0!==(s&e.childLanes),ys||l){if(null!==(n=Nl)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(n.suspendedLanes|s))?0:o)&&o!==i.retryLane&&(i.retryLane=o,Na(e,o),nc(n,e,o,-1))}return mc(),Ms(e,t,s,n=ps(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,oa=co(o.nextSibling),na=t,aa=!0,ia=null,null!==e&&(qo[Xo++]=Jo,qo[Xo++]=Qo,qo[Xo++]=Ko,Jo=e.id,Qo=e.overflow,Ko=t),t=Fs(t,n.children),t.flags|=4096,t)}(e,t,l,o,n,i,r);if(s){s=o.fallback,l=t.mode,n=(i=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&l)&&t.child!==i?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Oc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==n?s=Oc(n,s):(s=Dc(s,l,r,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?Ls(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Ds,o}return e=(s=e.child).sibling,o=Oc(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=r),o.return=t,o.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function Fs(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ms(e,t,r,n){return null!==n&&ga(n),Ja(t,e.child,null,r),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),wa(e.return,t,r)}function Us(e,t,r,n,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=o)}function Hs(e,t,r){var n=t.pendingProps,o=n.revealOrder,a=n.tail;if(js(e,t,n.children,r),0!==(2&(n=li.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,r,t);else if(19===e.tag)Ws(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Eo(li,n),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;null!==r;)null!==(e=r.alternate)&&null===ci(e)&&(o=r),r=r.sibling;null===(r=o)?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Us(t,!1,o,r,a);break;case"backwards":for(r=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ci(e)){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Us(t,!0,r,null,a);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Oc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Oc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Ys(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function $s(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=14680064&o.subtreeFlags,n|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function qs(e,t,r){var n=t.pendingProps;switch(ra(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $s(t),null;case 1:case 17:return Io(t.type)&&Oo(),$s(t),null;case 3:return n=t.stateNode,ai(),Co(No),Co(Ro),pi(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ia&&(sc(ia),ia=null))),Is(e,t),$s(t),null;case 5:si(t);var o=ni(ri.current);if(r=t.type,null!==e&&null!=t.stateNode)Os(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return $s(t),null}if(e=ni(ei.current),ua(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[fo]=t,n[ho]=i,e=0!==(1&t.mode),r){case"dialog":Fn("cancel",n),Fn("close",n);break;case"iframe":case"object":case"embed":Fn("load",n);break;case"video":case"audio":for(o=0;o<Pn.length;o++)Fn(Pn[o],n);break;case"source":Fn("error",n);break;case"img":case"image":case"link":Fn("error",n),Fn("load",n);break;case"details":Fn("toggle",n);break;case"input":K(n,i),Fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Fn("invalid",n);break;case"textarea":oe(n,i),Fn("invalid",n)}for(var l in be(r,i),o=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==i.suppressHydrationWarning&&Qn(n.textContent,c,e),o=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Qn(n.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fn("scroll",n)}switch(r){case"input":Y(n),Z(n,i,!0);break;case"textarea":Y(n),ie(n);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(n.onclick=Zn)}n=o,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[fo]=t,e[ho]=n,zs(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(r,n),r){case"dialog":Fn("cancel",e),Fn("close",e),o=n;break;case"iframe":case"object":case"embed":Fn("load",e),o=n;break;case"video":case"audio":for(o=0;o<Pn.length;o++)Fn(Pn[o],e);o=n;break;case"source":Fn("error",e),o=n;break;case"img":case"image":case"link":Fn("error",e),Fn("load",e),o=n;break;case"details":Fn("toggle",e),o=n;break;case"input":K(e,n),o=X(e,n),Fn("invalid",e);break;case"option":default:o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=L({},n,{value:void 0}),Fn("invalid",e);break;case"textarea":oe(e,n),o=ne(e,n),Fn("invalid",e)}for(i in be(r,o),c=o)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?me(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&pe(e,d):"children"===i?"string"===typeof d?("textarea"!==r||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Fn("scroll",e):null!=d&&v(e,i,d,l))}switch(r){case"input":Y(e),Z(e,n,!1);break;case"textarea":Y(e),ie(e);break;case"option":null!=n.value&&e.setAttribute("value",""+V(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?re(e,!!n.multiple,i,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $s(t),null;case 6:if(e&&null!=t.stateNode)Ps(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(r=ni(ri.current),ni(ei.current),ua(t)){if(n=t.stateNode,r=t.memoizedProps,n[fo]=t,(i=n.nodeValue!==r)&&null!==(e=na))switch(e.tag){case 3:Qn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qn(n.nodeValue,r,0!==(1&e.mode))}i&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[fo]=t,t.stateNode=n}return $s(t),null;case 13:if(Co(li),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&0!==(1&t.mode)&&0===(128&t.flags))fa(),ha(),t.flags|=98560,i=!1;else if(i=ua(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[fo]=t}else ha(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$s(t),i=!1}else null!==ia&&(sc(ia),ia=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&li.current)?0===Pl&&(Pl=3):mc())),null!==t.updateQueue&&(t.flags|=4),$s(t),null);case 4:return ai(),Is(e,t),null===e&&Un(t.stateNode.containerInfo),$s(t),null;case 10:return Sa(t.type._context),$s(t),null;case 19:if(Co(li),null===(i=t.memoizedState))return $s(t),null;if(n=0!==(128&t.flags),null===(l=i.rendering))if(n)Ys(i,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ci(e))){for(t.flags|=128,Ys(i,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(i=r).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Eo(li,1&li.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Hl&&(t.flags|=128,n=!0,Ys(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ci(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Ys(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!aa)return $s(t),null}else 2*Je()-i.renderingStartTime>Hl&&1073741824!==r&&(t.flags|=128,n=!0,Ys(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=i.last)?r.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,r=li.current,Eo(li,n?1&r|2:1&r),t):($s(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Il)&&($s(t),6&t.subtreeFlags&&(t.flags|=8192)):$s(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Xs(e,t){switch(ra(t),t.tag){case 1:return Io(t.type)&&Oo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ai(),Co(No),Co(Ro),pi(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return si(t),null;case 13:if(Co(li),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ha()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Co(li),null;case 4:return ai(),null;case 10:return Sa(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}zs=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Is=function(){},Os=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,ni(ei.current);var a,i=null;switch(r){case"input":o=X(e,o),n=X(e,n),i=[];break;case"select":o=L({},o,{value:void 0}),n=L({},n,{value:void 0}),i=[];break;case"textarea":o=ne(e,o),n=ne(e,n),i=[];break;default:"function"!==typeof o.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in be(r,n),r=null,o)if(!n.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var l=o[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=o?o[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fn("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Ps=function(e,t,r,n){r!==n&&(t.flags|=4)};var Ks=!1,Js=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Zs=null;function el(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){kc(e,t,n)}else r.current=null}function tl(e,t,r){try{r()}catch(n){kc(e,t,n)}}var rl=!1;function nl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var o=n=n.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&tl(t,r,a)}o=o.next}while(o!==n)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function al(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[ho],delete t[mo],delete t[xo],delete t[bo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}function dl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(dl(e,t,r),e=e.sibling;null!==e;)dl(e,t,r),e=e.sibling}var pl=null,ul=!1;function fl(e,t,r){for(r=r.child;null!==r;)hl(e,t,r),r=r.sibling}function hl(e,t,r){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,r)}catch(s){}switch(r.tag){case 5:Js||el(r,t);case 6:var n=pl,o=ul;pl=null,fl(e,t,r),ul=o,null!==(pl=n)&&(ul?(e=pl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):pl.removeChild(r.stateNode));break;case 18:null!==pl&&(ul?(e=pl,r=r.stateNode,8===e.nodeType?lo(e.parentNode,r):1===e.nodeType&&lo(e,r),Ut(e)):lo(pl,r.stateNode));break;case 4:n=pl,o=ul,pl=r.stateNode.containerInfo,ul=!0,fl(e,t,r),pl=n,ul=o;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){o=n=n.next;do{var a=o,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&tl(r,t,i),o=o.next}while(o!==n)}fl(e,t,r);break;case 1:if(!Js&&(el(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){kc(r,t,s)}fl(e,t,r);break;case 21:fl(e,t,r);break;case 22:1&r.mode?(Js=(n=Js)||null!==r.memoizedState,fl(e,t,r),Js=n):fl(e,t,r);break;default:fl(e,t,r)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Qs),t.forEach(function(t){var n=Rc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function ml(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var o=r[n];try{var i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:pl=l.stateNode,ul=!1;break e;case 3:case 4:pl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===pl)throw Error(a(160));hl(i,s,o),pl=null,ul=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(d){kc(o,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)xl(t,e),t=t.sibling}function xl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),bl(e),4&n){try{nl(3,e,e.return),ol(3,e)}catch(m){kc(e,e.return,m)}try{nl(5,e,e.return)}catch(m){kc(e,e.return,m)}}break;case 1:ml(t,e),bl(e),512&n&&null!==r&&el(r,r.return);break;case 5:if(ml(t,e),bl(e),512&n&&null!==r&&el(r,r.return),32&e.flags){var o=e.stateNode;try{ue(o,"")}catch(m){kc(e,e.return,m)}}if(4&n&&null!=(o=e.stateNode)){var i=e.memoizedProps,s=null!==r?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(o,i),ve(l,s);var d=ve(l,i);for(s=0;s<c.length;s+=2){var p=c[s],u=c[s+1];"style"===p?me(o,u):"dangerouslySetInnerHTML"===p?pe(o,u):"children"===p?ue(o,u):v(o,p,u,d)}switch(l){case"input":Q(o,i);break;case"textarea":ae(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;null!=h?re(o,!!i.multiple,h,!1):f!==!!i.multiple&&(null!=i.defaultValue?re(o,!!i.multiple,i.defaultValue,!0):re(o,!!i.multiple,i.multiple?[]:"",!1))}o[ho]=i}catch(m){kc(e,e.return,m)}}break;case 6:if(ml(t,e),bl(e),4&n){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(m){kc(e,e.return,m)}}break;case 3:if(ml(t,e),bl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){kc(e,e.return,m)}break;case 4:default:ml(t,e),bl(e);break;case 13:ml(t,e),bl(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(Ul=Je())),4&n&&gl(e);break;case 22:if(p=null!==r&&null!==r.memoizedState,1&e.mode?(Js=(d=Js)||p,ml(t,e),Js=d):ml(t,e),bl(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!p&&0!==(1&e.mode))for(Zs=e,p=e.child;null!==p;){for(u=Zs=p;null!==Zs;){switch(h=(f=Zs).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:el(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){kc(n,r,m)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){_l(u);continue}}null!==h?(h.return=f,Zs=h):_l(u)}p=p.sibling}e:for(p=null,u=e;;){if(5===u.tag){if(null===p){p=u;try{o=u.stateNode,d?"function"===typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=u.stateNode,s=void 0!==(c=u.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",s))}catch(m){kc(e,e.return,m)}}}else if(6===u.tag){if(null===p)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(m){kc(e,e.return,m)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:ml(t,e),bl(e),4&n&&gl(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sl(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 5:var o=n.stateNode;32&n.flags&&(ue(o,""),n.flags&=-33),dl(e,ll(e),o);break;case 3:case 4:var i=n.stateNode.containerInfo;cl(e,ll(e),i);break;default:throw Error(a(161))}}catch(s){kc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,r){Zs=e,yl(e,t,r)}function yl(e,t,r){for(var n=0!==(1&e.mode);null!==Zs;){var o=Zs,a=o.child;if(22===o.tag&&n){var i=null!==o.memoizedState||Ks;if(!i){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Js;s=Ks;var c=Js;if(Ks=i,(Js=l)&&!c)for(Zs=o;null!==Zs;)l=(i=Zs).child,22===i.tag&&null!==i.memoizedState?Sl(o):null!==l?(l.return=i,Zs=l):Sl(o);for(;null!==a;)Zs=a,yl(a,t,r),a=a.sibling;Zs=o,Ks=s,Js=c}jl(e)}else 0!==(8772&o.subtreeFlags)&&null!==a?(a.return=o,Zs=a):jl(e)}}function jl(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||ol(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Js)if(null===r)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:xa(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Fa(t,i,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Fa(t,s,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var p=d.memoizedState;if(null!==p){var u=p.dehydrated;null!==u&&Ut(u)}}}break;default:throw Error(a(163))}Js||512&t.flags&&al(t)}catch(f){kc(t,t.return,f)}}if(t===e){Zs=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zs=r;break}Zs=t.return}}function _l(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zs=r;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ol(4,t)}catch(l){kc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var o=t.return;try{n.componentDidMount()}catch(l){kc(t,o,l)}}var a=t.return;try{al(t)}catch(l){kc(t,a,l)}break;case 5:var i=t.return;try{al(t)}catch(l){kc(t,i,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var wl,kl=Math.ceil,Cl=y.ReactCurrentDispatcher,El=y.ReactCurrentOwner,Tl=y.ReactCurrentBatchConfig,Rl=0,Nl=null,Al=null,zl=0,Il=0,Ol=ko(0),Pl=0,Dl=null,Ll=0,Bl=0,Fl=0,Ml=null,Wl=null,Ul=0,Hl=1/0,Vl=null,Gl=!1,Yl=null,$l=null,ql=!1,Xl=null,Kl=0,Jl=0,Ql=null,Zl=-1,ec=0;function tc(){return 0!==(6&Rl)?Je():-1!==Zl?Zl:Zl=Je()}function rc(e){return 0===(1&e.mode)?1:0!==(2&Rl)&&0!==zl?zl&-zl:null!==ma.transition?(0===ec&&(ec=gt()),ec):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nc(e,t,r,n){if(50<Jl)throw Jl=0,Ql=null,Error(a(185));xt(e,r,n),0!==(2&Rl)&&e===Nl||(e===Nl&&(0===(2&Rl)&&(Bl|=r),4===Pl&&lc(e,zl)),oc(e,n),1===r&&0===Rl&&0===(1&t.mode)&&(Hl=Je()+500,Mo&&Ho()))}function oc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),s=1<<i,l=o[i];-1===l?0!==(s&r)&&0===(s&n)||(o[i]=ft(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var n=ut(e,e===Nl?zl:0);if(0===n)null!==r&&qe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&qe(r),1===t)0===e.tag?function(e){Mo=!0,Uo(e)}(cc.bind(null,e)):Uo(cc.bind(null,e)),io(function(){0===(6&Rl)&&Ho()}),r=null;else{switch(yt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Nc(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if(Zl=-1,ec=0,0!==(6&Rl))throw Error(a(327));var r=e.callbackNode;if(Sc()&&e.callbackNode!==r)return null;var n=ut(e,e===Nl?zl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=xc(e,n);else{t=n;var o=Rl;Rl|=2;var i=gc();for(Nl===e&&zl===t||(Vl=null,Hl=Je()+500,fc(e,t));;)try{vc();break}catch(l){hc(e,l)}_a(),Cl.current=i,Rl=o,null!==Al?t=0:(Nl=null,zl=0,t=Pl)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(n=o,t=ic(e,o))),1===t)throw r=Dl,fc(e,0),lc(e,n),oc(e,Je()),r;if(6===t)lc(e,n);else{if(o=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var o=r[n],a=o.getSnapshot;o=o.value;try{if(!sn(a(),o))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=xc(e,n))&&(0!==(i=ht(e))&&(n=i,t=ic(e,i))),1===t))throw r=Dl,fc(e,0),lc(e,n),oc(e,Je()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:_c(e,Wl,Vl);break;case 3:if(lc(e,n),(130023424&n)===n&&10<(t=Ul+500-Je())){if(0!==ut(e,0))break;if(((o=e.suspendedLanes)&n)!==n){tc(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=no(_c.bind(null,e,Wl,Vl),t);break}_c(e,Wl,Vl);break;case 4:if(lc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,o=-1;0<n;){var s=31-it(n);i=1<<s,(s=t[s])>o&&(o=s),n&=~i}if(n=o,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kl(n/1960))-n)){e.timeoutHandle=no(_c.bind(null,e,Wl,Vl),n);break}_c(e,Wl,Vl);break;default:throw Error(a(329))}}}return oc(e,Je()),e.callbackNode===r?ac.bind(null,e):null}function ic(e,t){var r=Ml;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=xc(e,t))&&(t=Wl,Wl=r,null!==t&&sc(t)),e}function sc(e){null===Wl?Wl=e:Wl.push.apply(Wl,e)}function lc(e,t){for(t&=~Fl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-it(t),n=1<<r;e[r]=-1,t&=~n}}function cc(e){if(0!==(6&Rl))throw Error(a(327));Sc();var t=ut(e,0);if(0===(1&t))return oc(e,Je()),null;var r=xc(e,t);if(0!==e.tag&&2===r){var n=ht(e);0!==n&&(t=n,r=ic(e,n))}if(1===r)throw r=Dl,fc(e,0),lc(e,t),oc(e,Je()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Wl,Vl),oc(e,Je()),null}function dc(e,t){var r=Rl;Rl|=1;try{return e(t)}finally{0===(Rl=r)&&(Hl=Je()+500,Mo&&Ho())}}function pc(e){null!==Xl&&0===Xl.tag&&0===(6&Rl)&&Sc();var t=Rl;Rl|=1;var r=Tl.transition,n=vt;try{if(Tl.transition=null,vt=1,e)return e()}finally{vt=n,Tl.transition=r,0===(6&(Rl=t))&&Ho()}}function uc(){Il=Ol.current,Co(Ol)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,oo(r)),null!==Al)for(r=Al.return;null!==r;){var n=r;switch(ra(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Oo();break;case 3:ai(),Co(No),Co(Ro),pi();break;case 5:si(n);break;case 4:ai();break;case 13:case 19:Co(li);break;case 10:Sa(n.type._context);break;case 22:case 23:uc()}r=r.return}if(Nl=e,Al=e=Oc(e.current,null),zl=Il=t,Pl=0,Dl=null,Fl=Bl=Ll=0,Wl=Ml=null,null!==Ea){for(t=0;t<Ea.length;t++)if(null!==(n=(r=Ea[t]).interleaved)){r.interleaved=null;var o=n.next,a=r.pending;if(null!==a){var i=a.next;a.next=o,n.next=i}r.pending=n}Ea=null}return e}function hc(e,t){for(;;){var r=Al;try{if(_a(),ui.current=is,bi){for(var n=gi.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}bi=!1}if(hi=0,xi=mi=gi=null,vi=!1,yi=0,El.current=null,null===r||null===r.return){Pl=1,Dl=t,Al=null;break}e:{var i=e,s=r.return,l=r,c=t;if(t=zl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,p=l,u=p.tag;if(0===(1&p.mode)&&(0===u||11===u||15===u)){var f=p.alternate;f?(p.updateQueue=f.updateQueue,p.memoizedState=f.memoizedState,p.lanes=f.lanes):(p.updateQueue=null,p.memoizedState=null)}var h=xs(s);if(null!==h){h.flags&=-257,bs(h,s,l,0,t),1&h.mode&&ms(i,d,t),c=d;var g=(t=h).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){ms(i,d,t),mc();break e}c=Error(a(426))}else if(aa&&1&l.mode){var x=xs(s);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),bs(x,s,l,0,t),ga(ds(c,l));break e}}i=c=ds(c,l),4!==Pl&&(Pl=2),null===Ml?Ml=[i]:Ml.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,La(i,hs(0,c,t));break e;case 1:l=c;var b=i.type,v=i.stateNode;if(0===(128&i.flags)&&("function"===typeof b.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===$l||!$l.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,La(i,gs(i,l,t));break e}}i=i.return}while(null!==i)}jc(r)}catch(y){t=y,Al===r&&null!==r&&(Al=r=r.return);continue}break}}function gc(){var e=Cl.current;return Cl.current=is,null===e?is:e}function mc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Nl||0===(268435455&Ll)&&0===(268435455&Bl)||lc(Nl,zl)}function xc(e,t){var r=Rl;Rl|=2;var n=gc();for(Nl===e&&zl===t||(Vl=null,fc(e,t));;)try{bc();break}catch(o){hc(e,o)}if(_a(),Rl=r,Cl.current=n,null!==Al)throw Error(a(261));return Nl=null,zl=0,Pl}function bc(){for(;null!==Al;)yc(Al)}function vc(){for(;null!==Al&&!Xe();)yc(Al)}function yc(e){var t=wl(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?jc(e):Al=t,El.current=null}function jc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=qs(r,t,Il)))return void(Al=r)}else{if(null!==(r=Xs(r,t)))return r.flags&=32767,void(Al=r);if(null===e)return Pl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Pl&&(Pl=5)}function _c(e,t,r){var n=vt,o=Tl.transition;try{Tl.transition=null,vt=1,function(e,t,r,n){do{Sc()}while(null!==Xl);if(0!==(6&Rl))throw Error(a(327));r=e.finishedWork;var o=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-it(r),a=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~a}}(e,i),e===Nl&&(Al=Nl=null,zl=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||ql||(ql=!0,Nc(tt,function(){return Sc(),null})),i=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||i){i=Tl.transition,Tl.transition=null;var s=vt;vt=1;var l=Rl;Rl|=4,El.current=null,function(e,t){if(eo=Vt,fn(e=un())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var o=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch(j){r=null;break e}var s=0,l=-1,c=-1,d=0,p=0,u=e,f=null;t:for(;;){for(var h;u!==r||0!==o&&3!==u.nodeType||(l=s+o),u!==i||0!==n&&3!==u.nodeType||(c=s+n),3===u.nodeType&&(s+=u.nodeValue.length),null!==(h=u.firstChild);)f=u,u=h;for(;;){if(u===e)break t;if(f===r&&++d===o&&(l=s),f===i&&++p===n&&(c=s),null!==(h=u.nextSibling))break;f=(u=f).parentNode}u=h}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(to={focusedElem:e,selectionRange:r},Vt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,x=g.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:xa(t.type,m),x);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(a(163))}}catch(j){kc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}g=rl,rl=!1}(e,r),xl(r,e),hn(to),Vt=!!eo,to=eo=null,e.current=r,vl(r,e,o),Ke(),Rl=l,vt=s,Tl.transition=i}else e.current=r;if(ql&&(ql=!1,Xl=e,Kl=o),i=e.pendingLanes,0===i&&($l=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),oc(e,Je()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(Gl)throw Gl=!1,e=Yl,Yl=null,e;0!==(1&Kl)&&0!==e.tag&&Sc(),i=e.pendingLanes,0!==(1&i)?e===Ql?Jl++:(Jl=0,Ql=e):Jl=0,Ho()}(e,t,r,n)}finally{Tl.transition=o,vt=n}return null}function Sc(){if(null!==Xl){var e=yt(Kl),t=Tl.transition,r=vt;try{if(Tl.transition=null,vt=16>e?16:e,null===Xl)var n=!1;else{if(e=Xl,Xl=null,Kl=0,0!==(6&Rl))throw Error(a(331));var o=Rl;for(Rl|=4,Zs=e.current;null!==Zs;){var i=Zs,s=i.child;if(0!==(16&Zs.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Zs=d;null!==Zs;){var p=Zs;switch(p.tag){case 0:case 11:case 15:nl(8,p,i)}var u=p.child;if(null!==u)u.return=p,Zs=u;else for(;null!==Zs;){var f=(p=Zs).sibling,h=p.return;if(il(p),p===d){Zs=null;break}if(null!==f){f.return=h,Zs=f;break}Zs=h}}}var g=i.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(null!==m)}}Zs=i}}if(0!==(2064&i.subtreeFlags)&&null!==s)s.return=i,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(i=Zs).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,Zs=b;break e}Zs=i.return}}var v=e.current;for(Zs=v;null!==Zs;){var y=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==y)y.return=s,Zs=y;else e:for(s=v;null!==Zs;){if(0!==(2048&(l=Zs).flags))try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(_){kc(l,l.return,_)}if(l===s){Zs=null;break e}var j=l.sibling;if(null!==j){j.return=l.return,Zs=j;break e}Zs=l.return}}if(Rl=o,Ho(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(_){}n=!0}return n}finally{vt=r,Tl.transition=t}}return!1}function wc(e,t,r){e=Pa(e,t=hs(0,t=ds(r,t),1),1),t=tc(),null!==e&&(xt(e,1,t),oc(e,t))}function kc(e,t,r){if(3===e.tag)wc(e,e,r);else for(;null!==t;){if(3===t.tag){wc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===$l||!$l.has(n))){t=Pa(t,e=gs(t,e=ds(r,e),1),1),e=tc(),null!==t&&(xt(t,1,e),oc(t,e));break}}t=t.return}}function Cc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&r,Nl===e&&(zl&r)===r&&(4===Pl||3===Pl&&(130023424&zl)===zl&&500>Je()-Ul?fc(e,0):Fl|=r),oc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var r=tc();null!==(e=Na(e,t))&&(xt(e,t,r),oc(e,r))}function Tc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ec(e,r)}function Rc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;null!==o&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Ec(e,r)}function Nc(e,t){return $e(e,t)}function Ac(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zc(e,t,r,n){return new Ac(e,t,r,n)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var r=e.alternate;return null===r?((r=zc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Pc(e,t,r,n,o,i){var s=2;if(n=e,"function"===typeof e)Ic(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Dc(r.children,o,i,t);case w:s=8,o|=8;break;case k:return(e=zc(12,r,t,2|o)).elementType=k,e.lanes=i,e;case R:return(e=zc(13,r,t,o)).elementType=R,e.lanes=i,e;case N:return(e=zc(19,r,t,o)).elementType=N,e.lanes=i,e;case I:return Lc(r,o,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case E:s=9;break e;case T:s=11;break e;case A:s=14;break e;case z:s=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=zc(s,r,t,o)).elementType=e,t.type=n,t.lanes=i,t}function Dc(e,t,r,n){return(e=zc(7,e,n,t)).lanes=r,e}function Lc(e,t,r,n){return(e=zc(22,e,n,t)).elementType=I,e.lanes=r,e.stateNode={isHidden:!1},e}function Bc(e,t,r){return(e=zc(6,e,null,t)).lanes=r,e}function Fc(e,t,r){return(t=zc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mc(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Wc(e,t,r,n,o,a,i,s,l){return e=new Mc(e,t,r,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=zc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},za(a),e}function Uc(e){if(!e)return To;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Io(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Io(r))return Do(e,r,t)}return t}function Hc(e,t,r,n,o,a,i,s,l){return(e=Wc(r,n,!0,e,0,a,0,s,l)).context=Uc(null),r=e.current,(a=Oa(n=tc(),o=rc(r))).callback=void 0!==t&&null!==t?t:null,Pa(r,a,o),e.current.lanes=o,xt(e,o,n),oc(e,n),e}function Vc(e,t,r,n){var o=t.current,a=tc(),i=rc(o);return r=Uc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Oa(a,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Pa(o,t,i))&&(nc(e,o,i,a),Da(e,o,i)),i}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Yc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function $c(e,t){Yc(e,t),(e=e.alternate)&&Yc(e,t)}wl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||No.current)ys=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return ys=!1,function(e,t,r){switch(t.tag){case 3:Ns(t),ha();break;case 5:ii(t);break;case 1:Io(t.type)&&Lo(t);break;case 4:oi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;Eo(ba,n._currentValue),n._currentValue=o;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Eo(li,1&li.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Bs(e,t,r):(Eo(li,1&li.current),null!==(e=Gs(e,t,r))?e.sibling:null);Eo(li,1&li.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return Hs(e,t,r);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Eo(li,li.current),n)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,r)}return Gs(e,t,r)}(e,t,r);ys=0!==(131072&e.flags)}else ys=!1,aa&&0!==(1048576&t.flags)&&ea(t,$o,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Vs(e,t),e=t.pendingProps;var o=zo(t,Ro.current);ka(t,r),o=wi(null,t,n,e,o,r);var i=ki();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Io(n)?(i=!0,Lo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,za(t),o.updater=Ua,t.stateNode=o,o._reactInternals=t,Ya(t,n,e,r),t=Rs(null,t,n,!0,i,r)):(t.tag=0,aa&&i&&ta(t),js(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,n=(o=n._init)(n._payload),t.type=n,o=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===A)return 14}return 2}(n),e=xa(n,e),o){case 0:t=Es(null,t,n,e,r);break e;case 1:t=Ts(null,t,n,e,r);break e;case 11:t=_s(null,t,n,e,r);break e;case 14:t=Ss(null,t,n,xa(n.type,e),r);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,Es(e,t,n,o=t.elementType===n?o:xa(n,o),r);case 1:return n=t.type,o=t.pendingProps,Ts(e,t,n,o=t.elementType===n?o:xa(n,o),r);case 3:e:{if(Ns(t),null===e)throw Error(a(387));n=t.pendingProps,o=(i=t.memoizedState).element,Ia(e,t),Ba(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=As(e,t,n,r,o=ds(Error(a(423)),t));break e}if(n!==o){t=As(e,t,n,r,o=ds(Error(a(424)),t));break e}for(oa=co(t.stateNode.containerInfo.firstChild),na=t,aa=!0,ia=null,r=Qa(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ha(),n===o){t=Gs(e,t,r);break e}js(e,t,n,r)}t=t.child}return t;case 5:return ii(t),null===e&&da(t),n=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,ro(n,o)?s=null:null!==i&&ro(n,i)&&(t.flags|=32),Cs(e,t),js(e,t,s,r),t.child;case 6:return null===e&&da(t),null;case 13:return Bs(e,t,r);case 4:return oi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ja(t,null,n,r):js(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,_s(e,t,n,o=t.elementType===n?o:xa(n,o),r);case 7:return js(e,t,t.pendingProps,r),t.child;case 8:case 12:return js(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,i=t.memoizedProps,s=o.value,Eo(ba,n._currentValue),n._currentValue=s,null!==i)if(sn(i.value,s)){if(i.children===o.children&&!No.current){t=Gs(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===i.tag){(c=Oa(-1,r&-r)).tag=2;var d=i.updateQueue;if(null!==d){var p=(d=d.shared).pending;null===p?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}i.lanes|=r,null!==(c=i.alternate)&&(c.lanes|=r),wa(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),wa(s,r,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}js(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,ka(t,r),n=n(o=Ca(o)),t.flags|=1,js(e,t,n,r),t.child;case 14:return o=xa(n=t.type,t.pendingProps),Ss(e,t,n,o=xa(n.type,o),r);case 15:return ws(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:xa(n,o),Vs(e,t),t.tag=1,Io(n)?(e=!0,Lo(t)):e=!1,ka(t,r),Va(t,n,o),Ya(t,n,o,r),Rs(null,t,n,!0,e,r);case 19:return Hs(e,t,r);case 22:return ks(e,t,r)}throw Error(a(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function ed(e,t,r,n,o){var a=r._reactRootContainer;if(a){var i=a;if("function"===typeof o){var s=o;o=function(){var e=Gc(i);s.call(e)}}Vc(t,i,e,o)}else i=function(e,t,r,n,o){if(o){if("function"===typeof n){var a=n;n=function(){var e=Gc(i);a.call(e)}}var i=Hc(t,n,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[go]=i.current,Un(8===e.nodeType?e.parentNode:e),pc(),i}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof n){var s=n;n=function(){var e=Gc(l);s.call(e)}}var l=Wc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[go]=l.current,Un(8===e.nodeType?e.parentNode:e),pc(function(){Vc(t,l,r,n)}),l}(r,t,e,o,n);return Gc(i)}Kc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vc(e,t,null,null)},Kc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pc(function(){Vc(null,e,null,null)}),t[go]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<It.length&&0!==t&&t<It[r].priority;r++);It.splice(r,0,e),0===r&&Lt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=pt(t.pendingLanes);0!==r&&(bt(t,1|r),oc(t,Je()),0===(6&Rl)&&(Hl=Je()+500,Ho()))}break;case 13:pc(function(){var t=Na(e,1);if(null!==t){var r=tc();nc(t,e,1,r)}}),$c(e,1)}},_t=function(e){if(13===e.tag){var t=Na(e,134217728);if(null!==t)nc(t,e,134217728,tc());$c(e,134217728)}},St=function(e){if(13===e.tag){var t=rc(e),r=Na(e,t);if(null!==r)nc(r,e,t,tc());$c(e,t)}},wt=function(){return vt},kt=function(e,t){var r=vt;try{return vt=e,t()}finally{vt=r}},_e=function(e,t,r){switch(t){case"input":if(Q(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=_o(n);if(!o)throw Error(a(90));$(n),Q(n,o)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Te=dc,Re=pc;var td={usingClientEntryPoint:!1,Events:[yo,jo,_o,Ce,Ee,dc]},rd={findFiberByHostInstance:vo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nd={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!od.isDisabled&&od.supportsFiber)try{ot=od.inject(nd),at=od}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(a(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Jc(e))throw Error(a(299));var r=!1,n="",o=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Wc(e,1,!1,null,0,r,0,n,o),e[go]=t.current,Un(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return pc(e)},t.hydrate=function(e,t,r){if(!Qc(t))throw Error(a(200));return ed(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Jc(e))throw Error(a(405));var n=null!=r&&r.hydratedSources||null,o=!1,i="",s=qc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(o=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=Hc(t,null,e,1,null!=r?r:null,o,0,i,s),e[go]=t.current,Un(e),n)for(e=0;e<n.length;e++)o=(o=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Kc(t)},t.render=function(e,t,r){if(!Qc(t))throw Error(a(200));return ed(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(a(40));return!!e._reactRootContainer&&(pc(function(){ed(null,null,e,!1,function(){e._reactRootContainer=null,e[go]=null})}),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qc(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ed(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},853:(e,t,r)=>{e.exports=r(234)},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var a=Object.create(null);r.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,r.d(a,i),a}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,o=r(43),a=r.t(o,2),i=r(950),s=r.t(i,2);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const c="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,r,n){return void 0===r&&(r=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function g(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function m(e,t,r,o){void 0===o&&(o={});let{window:a=document.defaultView,v5Compat:i=!1}=o,s=a.history,p=n.Pop,g=null,m=x();function x(){return(s.state||{idx:null}).idx}function b(){p=n.Pop;let e=x(),t=null==e?null:e-m;m=e,g&&g({action:p,location:y.location,delta:t})}function v(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,r="string"===typeof e?e:h(e);return r=r.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==m&&(m=0,s.replaceState(l({},s.state,{idx:m}),""));let y={get action(){return p},get location(){return e(a,s)},listen(e){if(g)throw new Error("A history only accepts one active listener");return a.addEventListener(c,b),g=e,()=>{a.removeEventListener(c,b),g=null}},createHref:e=>t(a,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p=n.Push;let o=f(y.location,e,t);r&&r(o,e),m=x()+1;let l=u(o,m),c=y.createHref(o);try{s.pushState(l,"",c)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;a.location.assign(c)}i&&g&&g({action:p,location:y.location,delta:1})},replace:function(e,t){p=n.Replace;let o=f(y.location,e,t);r&&r(o,e),m=x();let a=u(o,m),l=y.createHref(o);s.replaceState(a,"",l),i&&g&&g({action:p,location:y.location,delta:0})},go:e=>s.go(e)};return y}var x;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(x||(x={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,r){return void 0===r&&(r="/"),v(e,t,r,!1)}function v(e,t,r,n){let o=I(("string"===typeof t?g(t):t).pathname||"/",r);if(null==o)return null;let a=y(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let i=null;for(let s=0;null==i&&s<a.length;++s){let e=z(o);i=N(a[s],e,n)}return i}function y(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let o=(e,o,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};i.relativePath.startsWith("/")&&(d(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let s=B([n,i.relativePath]),l=r.concat(i);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),y(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:R(s,e.index),routesMeta:l})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of j(e.path))o(e,t,n);else o(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,o=r.endsWith("?"),a=r.replace(/\?$/,"");if(0===n.length)return o?[a,""]:[a];let i=j(n.join("/")),s=[];return s.push(...i.map(e=>""===e?a:[a,e].join("/"))),o&&s.push(...i),s.map(t=>e.startsWith("/")&&""===t?"/":t)}const _=/^:[\w-]+$/,S=3,w=2,k=1,C=10,E=-2,T=e=>"*"===e;function R(e,t){let r=e.split("/"),n=r.length;return r.some(T)&&(n+=E),t&&(n+=w),r.filter(e=>!T(e)).reduce((e,t)=>e+(_.test(t)?S:""===t?k:C),n)}function N(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,o={},a="/",i=[];for(let s=0;s<n.length;++s){let e=n[s],l=s===n.length-1,c="/"===a?t:t.slice(a.length)||"/",d=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),p=e.route;if(!d&&l&&r&&!n[n.length-1].route.index&&(d=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),i.push({params:o,pathname:B([a,d.pathname]),pathnameBase:F(B([a,d.pathnameBase])),route:p}),"/"!==d.pathnameBase&&(a=B([a,d.pathnameBase]))}return i}function A(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");let a=new RegExp(o,t?void 0:"i");return[a,n]}(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let a=o[0],i=a.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:n.reduce((e,t,r)=>{let{paramName:n,isOptional:o}=t;if("*"===n){let e=s[r]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[r];return e[n]=o&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:i,pattern:e}}function z(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return p(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function O(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function P(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function D(e,t){let r=P(e);return t?r.map((e,t)=>t===r.length-1?e.pathname:e.pathnameBase):r.map(e=>e.pathnameBase)}function L(e,t,r,n){let o;void 0===n&&(n=!1),"string"===typeof e?o=g(e):(o=l({},e),d(!o.pathname||!o.pathname.includes("?"),O("?","pathname","search",o)),d(!o.pathname||!o.pathname.includes("#"),O("#","pathname","hash",o)),d(!o.search||!o.search.includes("#"),O("#","search","hash",o)));let a,i=""===e||""===o.pathname,s=i?"/":o.pathname;if(null==s)a=r;else{let e=t.length-1;if(!n&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}a=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:o=""}="string"===typeof e?g(e):e,a=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:a,search:M(n),hash:W(o)}}(o,a),p=s&&"/"!==s&&s.endsWith("/"),u=(i||"."===s)&&r.endsWith("/");return c.pathname.endsWith("/")||!p&&!u||(c.pathname+="/"),c}const B=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function U(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],V=(new Set(H),["get",...H]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G.apply(this,arguments)}const Y=o.createContext(null);const q=o.createContext(null);const X=o.createContext(null);const K=o.createContext(null);const J=o.createContext({outlet:null,matches:[],isDataRoute:!1});const Q=o.createContext(null);function Z(){return null!=o.useContext(K)}function ee(){return Z()||d(!1),o.useContext(K).location}function te(e){o.useContext(X).static||o.useLayoutEffect(e)}function re(){let{isDataRoute:e}=o.useContext(J);return e?function(){let{router:e}=pe(ce.UseNavigateStable),t=fe(de.UseNavigateStable),r=o.useRef(!1);return te(()=>{r.current=!0}),o.useCallback(function(n,o){void 0===o&&(o={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,G({fromRouteId:t},o)))},[e,t])}():function(){Z()||d(!1);let e=o.useContext(Y),{basename:t,future:r,navigator:n}=o.useContext(X),{matches:a}=o.useContext(J),{pathname:i}=ee(),s=JSON.stringify(D(a,r.v7_relativeSplatPath)),l=o.useRef(!1);return te(()=>{l.current=!0}),o.useCallback(function(r,o){if(void 0===o&&(o={}),!l.current)return;if("number"===typeof r)return void n.go(r);let a=L(r,JSON.parse(s),i,"path"===o.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:B([t,a.pathname])),(o.replace?n.replace:n.push)(a,o.state,o)},[t,n,s,i,e])}()}function ne(e,t,r,a){Z()||d(!1);let{navigator:i}=o.useContext(X),{matches:s}=o.useContext(J),l=s[s.length-1],c=l?l.params:{},p=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let u,f=ee();if(t){var h;let e="string"===typeof t?g(t):t;"/"===p||(null==(h=e.pathname)?void 0:h.startsWith(p))||d(!1),u=e}else u=f;let m=u.pathname||"/",x=m;if("/"!==p){let e=p.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=b(e,{pathname:x});let y=le(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:B([p,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:B([p,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),s,r,a);return t&&y?o.createElement(K.Provider,{value:{location:G({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:n.Pop}},y):y}function oe(){let e=function(){var e;let t=o.useContext(Q),r=ue(de.UseRouteError),n=fe(de.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=U(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n};return o.createElement(o.Fragment,null,o.createElement("h2",null,"Unexpected Application Error!"),o.createElement("h3",{style:{fontStyle:"italic"}},t),r?o.createElement("pre",{style:a},r):null,null)}const ae=o.createElement(oe,null);class ie extends o.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?o.createElement(J.Provider,{value:this.props.routeContext},o.createElement(Q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:t,match:r,children:n}=e,a=o.useContext(Y);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),o.createElement(J.Provider,{value:t},n)}function le(e,t,r,n){var a;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var i;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(i=n)&&i.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let s=e,l=null==(a=r)?void 0:a.errors;if(null!=l){let e=s.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||d(!1),s=s.slice(0,Math.min(s.length,e+1))}let c=!1,p=-1;if(r&&n&&n.v7_partialHydration)for(let o=0;o<s.length;o++){let e=s[o];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(p=o),e.route.id){let{loaderData:t,errors:n}=r,o=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||o){c=!0,s=p>=0?s.slice(0,p+1):[s[0]];break}}}return s.reduceRight((e,n,a)=>{let i,d=!1,u=null,f=null;var h;r&&(i=l&&n.route.id?l[n.route.id]:void 0,u=n.route.errorElement||ae,c&&(p<0&&0===a?(h="route-fallback",!1||he[h]||(he[h]=!0),d=!0,f=null):p===a&&(d=!0,f=n.route.hydrateFallbackElement||null)));let g=t.concat(s.slice(0,a+1)),m=()=>{let t;return t=i?u:d?f:n.route.Component?o.createElement(n.route.Component,null):n.route.element?n.route.element:e,o.createElement(se,{match:n,routeContext:{outlet:e,matches:g,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===a)?o.createElement(ie,{location:r.location,revalidation:r.revalidation,component:u,error:i,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function pe(e){let t=o.useContext(Y);return t||d(!1),t}function ue(e){let t=o.useContext(q);return t||d(!1),t}function fe(e){let t=function(){let e=o.useContext(J);return e||d(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||d(!1),r.route.id}const he={};function ge(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function me(e){d(!1)}function xe(e){let{basename:t="/",children:r=null,location:a,navigationType:i=n.Pop,navigator:s,static:l=!1,future:c}=e;Z()&&d(!1);let p=t.replace(/^\/*/,"/"),u=o.useMemo(()=>({basename:p,navigator:s,static:l,future:G({v7_relativeSplatPath:!1},c)}),[p,c,s,l]);"string"===typeof a&&(a=g(a));let{pathname:f="/",search:h="",hash:m="",state:x=null,key:b="default"}=a,v=o.useMemo(()=>{let e=I(f,p);return null==e?null:{location:{pathname:e,search:h,hash:m,state:x,key:b},navigationType:i}},[p,f,h,m,x,b,i]);return null==v?null:o.createElement(X.Provider,{value:u},o.createElement(K.Provider,{children:r,value:v}))}function be(e){let{children:t,location:r}=e;return ne(ve(t),r)}new Promise(()=>{});o.Component;function ve(e,t){void 0===t&&(t=[]);let r=[];return o.Children.forEach(e,(e,n)=>{if(!o.isValidElement(e))return;let a=[...t,n];if(e.type===o.Fragment)return void r.push.apply(r,ve(e.props.children,a));e.type!==me&&d(!1),e.props.index&&e.props.children&&d(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=ve(e.props.children,a)),r.push(i)}),r}function ye(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(e=>[r,e]):[[r,n]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Fh){}new Map;const je=a.startTransition;s.flushSync,a.useId;function _e(e){let{basename:t,children:r,future:n,window:a}=e,i=o.useRef();var s;null==i.current&&(i.current=(void 0===(s={window:a,v5Compat:!0})&&(s={}),m(function(e,t){let{pathname:r,search:n,hash:o}=e.location;return f("",{pathname:r,search:n,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:h(t)},null,s)));let l=i.current,[c,d]=o.useState({action:l.action,location:l.location}),{v7_startTransition:p}=n||{},u=o.useCallback(e=>{p&&je?je(()=>d(e)):d(e)},[d,p]);return o.useLayoutEffect(()=>l.listen(u),[l,u]),o.useEffect(()=>ge(n),[n]),o.createElement(xe,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:l,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Se,we;function ke(e){let t=o.useRef(ye(e)),r=o.useRef(!1),n=ee(),a=o.useMemo(()=>function(e,t){let r=ye(e);return t&&t.forEach((e,n)=>{r.has(n)||t.getAll(n).forEach(e=>{r.append(n,e)})}),r}(n.search,r.current?null:t.current),[n.search]),i=re(),s=o.useCallback((e,t)=>{const n=ye("function"===typeof e?e(a):e);r.current=!0,i("?"+n,t)},[i,a]);return[a,s]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Se||(Se={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(we||(we={}));const Ce=()=>{if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){const e=window.location.port;if(e&&("3001"===e||"3000"===e||"3002"===e))return"http://localhost/rcritico/api";const t=window.location.pathname;let r="";const n=t.split("/").filter(e=>e);return r=t.includes("/rcritico")||t.includes("/rcritico/")?"/rcritico":t.includes("/ssocaren")||t.includes("/ssocaren/")?"/ssocaren":n.length>0&&("rcritico"===n[0]||"ssocaren"===n[0])?"/"+n[0]:"/rcritico","http://localhost".concat(r,"/api")}return window.location.pathname.startsWith("/pmo/")?"/pmo/api":"/api"},Ee=()=>window.location.origin,Te=Ce(),Re=(()=>{if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){const e=window.location.port;if(e&&("3001"===e||"3000"===e||"3002"===e))return"http://localhost/rcritico/api/auth/login.php";const t=window.location.pathname;let r="";return r=t.includes("/rcritico")||t.includes("/rcritico/")?"/rcritico":t.includes("/ssocaren")||t.includes("/ssocaren/")?"/ssocaren":"/rcritico","http://localhost".concat(r,"/api/auth/login.php")}const e=Ce();return"".concat(e,"/auth/login.php")})(),Ne=Ee(),Ae=(()=>{const e=Ee();return window.location.pathname.startsWith("/pmo/")?"".concat(e,"/pmo"):e})();var ze=r(579);const Ie=e=>{let{onBackToLogin:t}=e;const[r,n]=(0,o.useState)(""),[a,i]=(0,o.useState)(""),[s,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[p,u]=(0,o.useState)("");return c?(0,ze.jsx)("div",{className:"forgot-password-container",style:{minHeight:"100vh",width:"100vw",background:"url(".concat("","/img/fondo-codelco.png) center center/cover no-repeat"),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:(0,ze.jsxs)("div",{className:"forgot-password-form",children:[(0,ze.jsx)("img",{src:"/img/JEJ.png",alt:"JEJ Ingenier\xeda",className:"login-logo"}),(0,ze.jsx)("h2",{children:"Email Enviado"}),(0,ze.jsxs)("div",{className:"success-message",children:[(0,ze.jsxs)("p",{children:["Si el email ",(0,ze.jsx)("strong",{children:r})," est\xe1 registrado y activo en nuestro sistema, recibir\xe1s un enlace para restablecer tu contrase\xf1a."]}),(0,ze.jsxs)("p",{children:[(0,ze.jsx)("strong",{children:"Requisitos:"})," Solo usuarios registrados y aprobados pueden recuperar su contrase\xf1a."]}),(0,ze.jsx)("p",{children:"Revisa tu bandeja de entrada y tambi\xe9n la carpeta de spam."})]}),(0,ze.jsx)("button",{type:"button",onClick:t,className:"back-button",children:"Volver al Login"})]})}):(0,ze.jsx)("div",{className:"forgot-password-container",style:{minHeight:"100vh",width:"100vw",background:"url(".concat("","/img/fondo-codelco.png) center center/cover no-repeat"),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:(0,ze.jsxs)("div",{className:"forgot-password-form",children:[(0,ze.jsx)("img",{src:"/img/JEJ.png",alt:"JEJ Ingenier\xeda",className:"login-logo"}),(0,ze.jsx)("h2",{children:"Recuperar Contrase\xf1a"}),(0,ze.jsxs)("p",{className:"forgot-password-description",children:["Ingresa tu email y te enviaremos un enlace para restablecer tu contrase\xf1a.",(0,ze.jsx)("br",{}),(0,ze.jsx)("strong",{children:"Solo usuarios registrados y activos pueden usar esta funci\xf3n."})]}),(0,ze.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(""),l(!0);try{const e=await fetch("/api/forgot_password.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),t=await e.json();"success"===t.status?(d(!0),t.show_link?(i("El email no se pudo enviar, pero puedes usar este enlace para restablecer tu contrase\xf1a"),u(t.reset_link)):i("Si el email est\xe1 registrado y activo, recibir\xe1s un enlace para restablecer tu contrase\xf1a")):t.message&&t.message.includes("aprobada")?i("\u274c Tu cuenta a\xfan no ha sido aprobada por un administrador"):t.message&&t.message.includes("formato")?i("\u274c Formato de email inv\xe1lido"):i(t.message||"\u274c Error al procesar la solicitud")}catch(t){i("Error de conexi\xf3n con el servidor")}l(!1)},children:[(0,ze.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",value:r,onChange:e=>n(e.target.value),required:!0,autoFocus:!0}),(0,ze.jsx)("button",{type:"submit",disabled:s,children:s?"Enviando...":"Enviar Enlace"}),a&&(0,ze.jsx)("div",{className:"login-status",children:a}),p&&(0,ze.jsxs)("div",{className:"reset-link-container",children:[(0,ze.jsx)("h3",{children:"\ud83d\udd17 Enlace de Recuperaci\xf3n:"}),(0,ze.jsxs)("div",{className:"reset-link-box",children:[(0,ze.jsx)("p",{children:(0,ze.jsx)("strong",{children:"Haz clic en el enlace para restablecer tu contrase\xf1a:"})}),(0,ze.jsx)("a",{href:p,target:"_blank",rel:"noopener noreferrer",className:"reset-link-button",children:"Restablecer Contrase\xf1a"}),(0,ze.jsx)("p",{className:"reset-link-url",children:p})]})]})]}),(0,ze.jsx)("div",{className:"login-links",children:(0,ze.jsx)("a",{href:"#",onClick:t,children:"\u2190 Volver al Login"})})]})})},Oe=e=>{let{setUser:t,setCentros:r}=e;const[n,a]=(0,o.useState)(""),[i,s]=(0,o.useState)(""),[l,c]=(0,o.useState)(""),[d,p]=(0,o.useState)(!1),[u,f]=(0,o.useState)(!1);return u?(0,ze.jsx)(Ie,{onBackToLogin:()=>f(!1)}):(0,ze.jsx)("div",{className:"login-bg",style:{minHeight:"100vh",width:"100vw",background:"url(".concat("","/img/fondo-codelco.png) center center/cover no-repeat"),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:(0,ze.jsxs)("form",{className:"login-form",onSubmit:async e=>{e.preventDefault(),c(""),p(!0);try{const o=await fetch(Re,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i})}),a=o.headers.get("content-type");let s;if(a&&a.includes("application/json"))s=await o.json();else{const t=await o.text();try{s=JSON.parse(t)}catch(e){throw new Error("Respuesta no v\xe1lida del servidor: "+t.substring(0,200))}}o.ok?"success"===s.status?(t(s.user),r(s.centros),c("Login exitoso"),localStorage.setItem("user",JSON.stringify(s.user)),localStorage.setItem("centros",JSON.stringify(s.centros))):"pending"===s.status?c("Usuario pendiente de aprobaci\xf3n. Espera autorizaci\xf3n de un administrador."):(c(s.message||"Error de login"),console.error("Error en login:",s)):(s&&s.message?c(s.message):c("Error HTTP ".concat(o.status,": ").concat(s.status||"Error desconocido")),console.error("Error en login:",o.status,s))}catch(o){console.error("Error en login:",o),c("Error de conexi\xf3n con el servidor: "+(o.message||"Error desconocido"))}p(!1)},children:[(0,ze.jsx)("img",{src:"/img/JEJ.png",alt:"JEJ Ingenier\xeda",className:"login-logo"}),(0,ze.jsx)("h2",{children:"Iniciar Sesi\xf3n"}),(0,ze.jsx)("input",{type:"email",placeholder:"Correo electr\xf3nico",value:n,onChange:e=>a(e.target.value),required:!0}),(0,ze.jsx)("input",{type:"password",placeholder:"Contrase\xf1a",value:i,onChange:e=>s(e.target.value),required:!0,autoComplete:"current-password"}),(0,ze.jsx)("button",{type:"submit",disabled:d,children:d?"Ingresando...":"Ingresar"}),l&&(0,ze.jsx)("div",{className:"login-status",children:l}),(0,ze.jsxs)("div",{className:"login-links",children:["\xbfNo tienes cuenta? ",(0,ze.jsx)("a",{href:"#",children:"Reg\xedstrate aqu\xed"}),(0,ze.jsx)("br",{}),(0,ze.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),f(!0)},children:"\xbfOlvidaste tu contrase\xf1a?"})]})]})})},Pe="/api",De=e=>{let{user:t,onLogout:r}=e;const n=re(),[a,i]=(0,o.useState)([]),[s,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),p=(0,o.useRef)(null);(0,o.useEffect)(()=>{u();const e=setInterval(u,6e4);return()=>clearInterval(e)},[t]),(0,o.useEffect)(()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const u=async()=>{if(null!==t&&void 0!==t&&t.id){d(!0);try{const e=await fetch("".concat(Pe,"/notificaciones/obtener.php?usuario_id=").concat(t.id)),r=await e.json();r.success&&i(r.notificaciones||[])}catch(e){console.error("Error cargando notificaciones:",e)}finally{d(!1)}}},f=async e=>{try{const r=await fetch("".concat(Pe,"/notificaciones/marcar_leida.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificacion_id:e.id,usuario_id:t.id,ref_id:e.ref_id})}),n=await r.json();console.log("Respuesta marcar le\xedda:",n),l(!1),e.carpeta_id&&e.proyecto_id?(sessionStorage.setItem("navegarACarpeta",e.carpeta_id),"mensaje"===e.tipo?(e.linea_base_id&&sessionStorage.setItem("lineaBaseId",e.linea_base_id.toString()),sessionStorage.setItem("mostrarForo","true")):"tarea"===e.tipo&&e.ref_id&&sessionStorage.setItem("tareaIdToOpen",e.ref_id.toString()),window.location.href="/proyecto/".concat(e.proyecto_id,"?carpeta=").concat(e.carpeta_id)):u()}catch(r){console.error("Error marcando notificaci\xf3n:",r)}},h=a.filter(e=>!e.leida).length,g=e=>{const t=new Date,r=new Date(e),n=t-r,o=Math.floor(n/6e4),a=Math.floor(n/36e5),i=Math.floor(n/864e5);return o<1?"Ahora":o<60?"Hace ".concat(o," min"):a<24?"Hace ".concat(a,"h"):1===i?"Ayer":i<7?"Hace ".concat(i," d\xedas"):r.toLocaleDateString("es-CL",{day:"2-digit",month:"short"})};return(0,ze.jsxs)("nav",{className:"navbar",style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#17a2b8",padding:"0.56rem 1.6rem",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",position:"fixed",top:0,left:0,width:"100vw",zIndex:1e3,fontSize:"0.84rem"},children:[(0,ze.jsxs)("div",{className:"navbar-left",style:{display:"flex",alignItems:"center"},children:[(0,ze.jsx)("img",{src:"/img/logo-codelco.png",alt:"Logo Codelco",className:"navbar-logo",style:{width:"80px",height:"auto",marginRight:"0.96rem",marginTop:"1.6px"}}),(0,ze.jsx)("span",{className:"navbar-title",style:{fontWeight:"bold",fontSize:"1.04rem",letterSpacing:"0.4px"},children:"GESTI\xd3N CONTROLES CR\xcdTICOS QUE SALVAN VIDAS."})]}),(0,ze.jsxs)("div",{className:"navbar-menu",style:{display:"flex",gap:"1.6rem"},children:[(0,ze.jsxs)("a",{className:"navbar-link",onClick:e=>{e.preventDefault(),n("/")},style:{cursor:"pointer",color:"#fff",textDecoration:"none",fontSize:"0.84rem",display:"flex",alignItems:"center",gap:"0.32rem",transition:"color 0.2s"},children:[(0,ze.jsx)("i",{className:"fa fa-home",style:{fontSize:"0.84rem"}})," Inicio"]}),(0,ze.jsxs)("a",{className:"navbar-link",onClick:e=>{e.preventDefault(),n("/centros-por-region")},style:{cursor:"pointer",color:"#fff",textDecoration:"none",fontSize:"0.84rem",display:"flex",alignItems:"center",gap:"0.32rem",transition:"color 0.2s"},children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{fontSize:"0.84rem"}})," Proyectos"]}),"super_admin"===t.rol&&(0,ze.jsxs)("a",{className:"navbar-link",onClick:e=>{e.preventDefault(),n("/ajuste")},style:{cursor:"pointer",color:"#fff",textDecoration:"none",fontSize:"0.84rem",display:"flex",alignItems:"center",gap:"0.32rem",transition:"color 0.2s"},children:[(0,ze.jsx)("i",{className:"fa fa-cog",style:{fontSize:"0.84rem"}})," Ajuste"]})]}),(0,ze.jsxs)("div",{className:"navbar-user",style:{display:"flex",alignItems:"center",gap:"0.8rem",fontWeight:"500",fontSize:"0.84rem"},children:[(0,ze.jsx)("i",{className:"fa fa-user-circle",style:{fontSize:"0.84rem"}})," ",t.nombre," (",t.rol,")",(0,ze.jsxs)("div",{ref:p,style:{position:"relative"},children:[(0,ze.jsxs)("button",{onClick:()=>{l(!s),s||u()},style:{background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",position:"relative",transition:"all 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.25)",onMouseLeave:e=>e.currentTarget.style.background="rgba(255,255,255,0.15)",title:"Notificaciones",children:[(0,ze.jsx)("i",{className:"fa fa-bell",style:{color:"#fff",fontSize:"14px"}}),h>0&&(0,ze.jsx)("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:"#dc3545",color:"#fff",fontSize:"10px",fontWeight:"bold",borderRadius:"50%",minWidth:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:h>99?"99+":h})]}),s&&(0,ze.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"360px",maxHeight:"450px",background:"#fff",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",overflow:"hidden",zIndex:1001},children:[(0,ze.jsx)("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e9ecef",display:"flex",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)"},children:(0,ze.jsxs)("span",{style:{fontWeight:"600",color:"#fff",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-bell"}),"Notificaciones",h>0&&(0,ze.jsxs)("span",{style:{background:"rgba(255,255,255,0.25)",padding:"2px 8px",borderRadius:"10px",fontSize:"11px"},children:[h," nuevas"]})]})}),(0,ze.jsx)("div",{style:{maxHeight:"380px",overflowY:"auto"},children:c?(0,ze.jsxs)("div",{style:{padding:"30px",textAlign:"center",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{marginRight:"8px"}}),"Cargando..."]}):0===a.length?(0,ze.jsxs)("div",{style:{padding:"40px 20px",textAlign:"center",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-bell-slash",style:{fontSize:"32px",marginBottom:"12px",opacity:.5}}),(0,ze.jsx)("p",{style:{margin:0,fontSize:"14px"},children:"No tienes notificaciones"})]}):a.map((e,t)=>(0,ze.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>f(e),onKeyPress:t=>{"Enter"===t.key&&f(e)},"aria-label":"Notificaci\xf3n: ".concat(e.mensaje),style:{padding:"12px 16px",borderBottom:"1px solid #f0f0f0",cursor:"pointer",background:e.leida?"#fff":"#f0f7ff",transition:"background 0.15s",display:"flex",gap:"12px",alignItems:"flex-start"},onMouseEnter:t=>t.currentTarget.style.background=e.leida?"#f8f9fa":"#e3f2fd",onMouseLeave:t=>t.currentTarget.style.background=e.leida?"#fff":"#f0f7ff",children:[(0,ze.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:"mensaje"===e.tipo?"#17a2b8":"tarea"===e.tipo?"#ffc107":"#6c757d",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa ".concat("mensaje"===e.tipo?"fa-comment":"tarea"===e.tipo?"fa-tasks":"fa-bell"),style:{color:"#fff",fontSize:"14px"}})}),(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#333",fontWeight:e.leida?"400":"600",marginBottom:"4px",lineHeight:"1.4"},children:e.mensaje}),(0,ze.jsxs)("div",{style:{fontSize:"11px",color:"#6c757d",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"4px"}}),e.carpeta_nombre||"General"]}),(0,ze.jsx)("span",{children:"\u2022"}),(0,ze.jsx)("span",{children:g(e.fecha)})]})]}),!e.leida&&(0,ze.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#17a2b8",flexShrink:0,marginTop:"6px"}})]},e.id||t))})]})]}),(0,ze.jsx)("button",{className:"logout-btn",onClick:r,style:{background:"#fff",color:"#17a2b8",border:"none",borderRadius:"4.8px",padding:"0.32rem 0.8rem",fontWeight:"bold",cursor:"pointer",transition:"background 0.2s, color 0.2s",fontSize:"0.84rem"},children:"Cerrar sesi\xf3n"})]})]})},Le=e=>{let{user:t,centros:r,onLogout:n}=e;const[a,i]=(0,o.useState)(1===r.length?r[0].id:""),[s,l]=(0,o.useState)(!1),c=re(),[d,p]=(0,o.useState)(""),[u,f]=(0,o.useState)([]),[h,g]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1);(0,o.useEffect)(()=>{m&&0===u.length&&fetch("".concat(Te,"/regiones.php")).then(e=>e.json()).then(e=>f(e)).catch(e=>{console.error("Error cargando regiones:",e),f([])})},[m,u.length]);const b=()=>{localStorage.removeItem("user"),localStorage.removeItem("centros"),window.location.href="/"},v=e=>{e.preventDefault(),console.log("Bot\xf3n Proyectos clickeado"),console.log("Usuario actual:",t),console.log("Centros disponibles:",r),console.log("Navegando a /centros-por-region");try{c("/centros-por-region")}catch(n){console.error("Error al navegar:",n),window.location.href="/centros-por-region"}},y=e=>{e.preventDefault(),c("/ajuste")};if("visita_sin_permiso"===t.rol||!t.aprobado)return(0,ze.jsxs)("div",{className:"main-bg",style:{background:"linear-gradient(rgba(10, 110, 189, 0.3), rgba(30, 64, 175, 0.3)), url(".concat("/img/muro.jpg",")"),backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat",minHeight:"100vh"},children:[(0,ze.jsx)(De,{user:t,onLogout:b}),(0,ze.jsx)("main",{className:"main-content moderno",style:{paddingTop:"100px"},children:(0,ze.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"20px",padding:"3rem",textAlign:"center",width:"100%",maxWidth:"700px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-lock",style:{fontSize:"4rem",color:"#dc3545",marginBottom:"1rem"}}),(0,ze.jsx)("h2",{style:{fontSize:"2rem",marginBottom:"1rem",color:"#dc3545",fontWeight:"700"},children:"Acceso Restringido"}),(0,ze.jsx)("p",{style:{fontSize:"1.1rem",color:"#666",lineHeight:"1.6",marginBottom:"1rem"},children:"Tu cuenta est\xe1 pendiente de aprobaci\xf3n."}),(0,ze.jsx)("p",{style:{fontSize:"0.95rem",color:"#888",lineHeight:"1.6"},children:"Por favor, espera autorizaci\xf3n de un administrador para acceder al sistema."})]})})]});const j=(()=>{const e={super_admin:{title:"Super Administrador",subtitle:"Control total del sistema",description:"Tienes acceso completo a todas las funcionalidades del sistema. Puedes gestionar usuarios, proyectos, carpetas y configuraciones.",features:[{icon:"fa-users-cog",text:"Gesti\xf3n completa de usuarios y roles"},{icon:"fa-project-diagram",text:"Administraci\xf3n de proyectos y carpetas"},{icon:"fa-cog",text:"Configuraci\xf3n del sistema"},{icon:"fa-shield-alt",text:"Control de permisos y accesos"},{icon:"fa-chart-line",text:"Visi\xf3n global de todos los proyectos"}],actions:[{icon:"fa-building",title:"Proyectos",description:"Gestiona todos los proyectos y carpetas",onClick:v},{icon:"fa-cog",title:"Ajuste",description:"Configuraci\xf3n del sistema",onClick:y}]},admin:{title:"Administrador",subtitle:"Gesti\xf3n de carpetas asignadas",description:"Puedes gestionar las carpetas que te han sido asignadas y administrar usuarios trabajadores dentro de ellas.",features:[{icon:"fa-folder-open",text:"Gesti\xf3n de carpetas asignadas"},{icon:"fa-user-plus",text:"Asignar trabajadores a carpetas"},{icon:"fa-file-upload",text:"Subir y gestionar archivos"},{icon:"fa-tasks",text:"Crear y asignar tareas"},{icon:"fa-comments",text:"Moderar foros de discusi\xf3n"}],actions:[{icon:"fa-building",title:"Proyectos",description:"Accede a tus carpetas asignadas",onClick:v}]},trabajador:{title:"Trabajador",subtitle:"Colaboraci\xf3n en proyectos",description:"Trabaja en las carpetas asignadas, sube archivos, completa tareas y participa en los foros de discusi\xf3n.",features:[{icon:"fa-folder",text:"Acceso a carpetas asignadas"},{icon:"fa-file-upload",text:"Subir archivos y documentos"},{icon:"fa-tasks",text:"Ver y completar tareas asignadas"},{icon:"fa-comments",text:"Participar en foros de discusi\xf3n"},{icon:"fa-chart-bar",text:"Visualizar an\xe1lisis Bowtie y L\xednea Base"}],actions:[{icon:"fa-building",title:"Proyectos",description:"Accede a tus proyectos asignados",onClick:v}]},visita:{title:"Usuario Visitante",subtitle:"Acceso de solo lectura",description:"Tienes permisos limitados de visualizaci\xf3n. Contacta a un administrador si necesitas acceso adicional.",features:[{icon:"fa-eye",text:"Visualizaci\xf3n de contenido asignado"},{icon:"fa-file-download",text:"Descarga de archivos permitidos"},{icon:"fa-info-circle",text:"Consulta de informaci\xf3n general"}],actions:[]}};return e[t.rol]||e.trabajador})(),_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const r=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return"rgba(".concat(r,", ").concat(n,", ").concat(o,", ").concat(t,")")},S=e=>{const t={"fa-building":"#0a6ebd","fa-cog":"#6b7280","fa-folder":"#3b82f6","fa-folder-open":"#3b82f6","fa-file-upload":"#10b981","fa-tasks":"#f59e0b","fa-comments":"#8b5cf6","fa-chart-bar":"#ef4444","fa-user-plus":"#06b6d4","fa-eye":"#6366f1","fa-file-download":"#14b8a6","fa-info-circle":"#64748b","fa-users-cog":"#0ea5e9","fa-project-diagram":"#0a6ebd","fa-shield-alt":"#10b981","fa-chart-line":"#f59e0b","fa-history":"#6366f1","fa-users":"#8b5cf6",default:"#0a6ebd"};return t[e]||t.default};return(0,ze.jsxs)("div",{className:"main-bg",style:{background:"linear-gradient(rgba(10, 110, 189, 0.35), rgba(30, 64, 175, 0.35)), url(".concat("/img/muro.jpg",")"),backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat",minHeight:"100vh",paddingBottom:"2rem"},children:[(0,ze.jsx)(De,{user:t,onLogout:b}),(0,ze.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"90px 1.5rem 2rem 1.5rem"},children:[(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(30px)",borderRadius:"16px",padding:"1.25rem 1.5rem",marginBottom:"1.5rem",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(255, 255, 255, 0.15)"},children:(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,ze.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #0a6ebd 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-user-circle",style:{fontSize:"1.5rem",color:"white"}})}),(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem",flexWrap:"wrap"},children:[(0,ze.jsx)("h1",{style:{fontSize:"1.15rem",margin:0,fontWeight:"700",color:"#ffffff",letterSpacing:"-0.1px",textShadow:"0 2px 8px rgba(0, 0, 0, 0.3), 0 1px 3px rgba(0, 0, 0, 0.2)"},children:t.nombre}),(0,ze.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.3rem",background:"linear-gradient(135deg, #0a6ebd 0%, #FF8C00 100%)",color:"white",padding:"0.3rem 0.75rem",borderRadius:"16px",fontSize:"0.75rem",fontWeight:"500",whiteSpace:"nowrap"},children:[(0,ze.jsx)("i",{className:"fa fa-user-shield",style:{fontSize:"0.65rem"}}),j.title]})]}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",color:"#e2e8f0",margin:0,fontWeight:"500",textShadow:"0 2px 6px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},children:j.subtitle})]})]})}),(0,ze.jsxs)("div",{className:"dashboard-main-grid",style:{display:"grid",gridTemplateColumns:j.actions.length>0?"1fr 1fr":"1fr",gap:"1.25rem",marginBottom:"1.5rem"},children:[j.actions.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.12)",backdropFilter:"blur(20px)",borderRadius:"10px",padding:"0.75rem 1rem",marginBottom:"0.875rem",border:"1px solid rgba(10, 110, 189, 0.25)",display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"linear-gradient(135deg, #0a6ebd 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-bolt",style:{fontSize:"0.75rem",color:"white"}})}),(0,ze.jsx)("h2",{style:{fontSize:"0.9rem",fontWeight:"700",color:"#ffffff",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3)"},children:"Accesos R\xe1pidos"})]}),(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:j.actions.map((e,t)=>(0,ze.jsxs)("div",{onClick:e.onClick,style:{background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(30px)",borderRadius:"12px",padding:"1rem 1.25rem",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(10, 110, 189, 0.25)",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.875rem"},onMouseEnter:t=>{const r=S(e.icon);t.currentTarget.style.borderColor=r,t.currentTarget.style.transform="translateY(-1px)",t.currentTarget.style.boxShadow="0 4px 16px ".concat(_(r,.4)),t.currentTarget.style.background="rgba(255, 255, 255, 0.25)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="rgba(10, 110, 189, 0.25)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.08)",e.currentTarget.style.background="rgba(255, 255, 255, 0.15)"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:S(e.icon),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:"0 3px 10px ".concat(_(S(e.icon),.4))},children:(0,ze.jsx)("i",{className:"fa ".concat(e.icon),style:{fontSize:"1.1rem",color:"white"}})}),(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsx)("h3",{style:{fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",marginBottom:"0.15rem",lineHeight:"1.3",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3)"},children:e.title}),(0,ze.jsx)("p",{style:{fontSize:"0.8rem",color:"#e2e8f0",margin:0,lineHeight:"1.4",textShadow:"0 1px 4px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},children:e.description})]}),(0,ze.jsx)("i",{className:"fa fa-chevron-right",style:{color:"#e2e8f0",fontSize:"0.85rem",flexShrink:0,textShadow:"0 1px 3px rgba(0, 0, 0, 0.3)"}})]},t))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",marginBottom:"0.875rem",border:"1px solid rgba(10, 110, 189, 0.15)",display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"linear-gradient(135deg, #0a6ebd 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-star",style:{fontSize:"0.75rem",color:"white"}})}),(0,ze.jsx)("h2",{style:{fontSize:"0.9rem",fontWeight:"700",color:"#ffffff",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3)"},children:"Caracter\xedsticas de tu Perfil"})]}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(30px)",borderRadius:"12px",padding:"1.25rem",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(10, 110, 189, 0.25)"},children:(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"0.75rem"},children:j.features.map((e,t)=>{const r=S(e.icon);return(0,ze.jsxs)("div",{style:{padding:"0.875rem",background:_(r,.08),borderRadius:"10px",border:"1px solid ".concat(_(r,.2)),transition:"all 0.2s ease",textAlign:"center"},onMouseEnter:e=>{e.currentTarget.style.background=_(r,.15),e.currentTarget.style.borderColor=_(r,.3)},onMouseLeave:e=>{e.currentTarget.style.background=_(r,.08),e.currentTarget.style.borderColor=_(r,.2)},children:[(0,ze.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"9px",background:r,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.625rem auto",boxShadow:"0 3px 10px ".concat(_(r,.4))},children:(0,ze.jsx)("i",{className:"fa ".concat(e.icon),style:{fontSize:"1rem",color:"white"}})}),(0,ze.jsx)("p",{style:{fontSize:"0.8rem",color:"#e2e8f0",lineHeight:"1.4",fontWeight:"500",margin:0,textShadow:"0 1px 4px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},children:e.text})]},t)})})})]})]}),(0,ze.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(30px)",borderRadius:"12px",padding:"1.25rem",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(10, 110, 189, 0.25)"},children:[(0,ze.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.45)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",marginBottom:"1rem",border:"1px solid rgba(10, 110, 189, 0.25)",display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"linear-gradient(135deg, #0a6ebd 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{fontSize:"0.75rem",color:"white"}})}),(0,ze.jsx)("h2",{style:{fontSize:"0.9rem",fontWeight:"700",color:"#ffffff",margin:0,textTransform:"uppercase",letterSpacing:"0.5px",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3)"},children:"Caracter\xedsticas del Sistema"})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"0.75rem"},children:[{icon:"fa-shield-alt",title:"Seguridad",desc:"Control de accesos por rol"},{icon:"fa-project-diagram",title:"Organizaci\xf3n",desc:"Gesti\xf3n por proyectos y carpetas"},{icon:"fa-history",title:"Trazabilidad",desc:"Registro completo de actividades"},{icon:"fa-users",title:"Colaboraci\xf3n",desc:"Trabajo en equipo eficiente"}].map((e,t)=>{const r=S(e.icon);return(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"1rem",background:_(r,.08),borderRadius:"10px",border:"1px solid ".concat(_(r,.2)),transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=_(r,.15),e.currentTarget.style.borderColor=_(r,.3)},onMouseLeave:e=>{e.currentTarget.style.background=_(r,.08),e.currentTarget.style.borderColor=_(r,.2)},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"9px",background:r,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.625rem auto",boxShadow:"0 3px 10px ".concat(_(r,.4))},children:(0,ze.jsx)("i",{className:"fa ".concat(e.icon),style:{fontSize:"1.1rem",color:"white"}})}),(0,ze.jsx)("h3",{style:{fontSize:"0.9rem",color:"#ffffff",margin:"0 0 0.3rem 0",fontWeight:"600",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3)"},children:e.title}),(0,ze.jsx)("p",{style:{fontSize:"0.75rem",color:"#e2e8f0",margin:0,lineHeight:"1.4",textShadow:"0 1px 4px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},children:e.desc})]},t)})})]})]})]})};function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Fe(e){var t=function(e,t){if("object"!=Be(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Be(t)?t:t+""}function Me(e,t,r){return(t=Fe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach(function(t){Me(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const He=(0,o.createContext)(),Ve=()=>(0,o.useContext)(He),Ge=e=>{let{children:t}=e;const[r,n]=(0,o.useState)(null);return(0,ze.jsx)(He.Provider,{value:{selectedProject:r,setSelectedProject:n},children:t})},Ye=e=>{let{user:t,centros:r,onLogout:n}=e;const[a,i]=(0,o.useState)([]),[s,l]=(0,o.useState)([]),[c,d]=(0,o.useState)({}),[p,u]=(0,o.useState)(!0),[f,h]=(0,o.useState)(null),[g,m]=(0,o.useState)([]),x=re(),{setSelectedProject:b}=Ve();(0,o.useEffect)(()=>{(async()=>{console.log("CentrosPorRegion: Cargando datos..."),console.log("API_BASE:",Te),console.log("Centros recibidos:",r);try{const e=await fetch("".concat(Te,"/regiones.php"));if(console.log("Respuesta de regiones:",e),console.log("Status:",e.status),console.log("URL:","".concat(Te,"/regiones.php")),!e.ok){const t=await e.text();throw console.error("Error HTTP al cargar regiones:",e.status,t),new Error("HTTP error! status: ".concat(e.status," - ").concat(t))}const t=await e.json();if(console.log("Datos de regiones recibidos:",t),t.error)throw console.error("Error en respuesta de regiones:",t.error),new Error(t.error);let r=[];if(t.success&&Array.isArray(t.regiones))r=t.regiones;else{if(!Array.isArray(t))return console.error("Error: datos de regiones no v\xe1lidos:",t),void i([]);r=t}console.log("Regiones procesadas (total):",r.length),console.log("Regiones procesadas:",r);const n=await fetch("".concat(Te,"/proyectos.php"));if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));const o=await n.json();console.log("Datos de proyectos:",o);let a=[];if(o.success&&Array.isArray(o.proyectos))a=o.proyectos;else{if(!Array.isArray(o))return console.error("Error: datos de proyectos no v\xe1lidos:",o),void l([]);a=o}const s=a.map(e=>Ue(Ue({},e),{},{proyecto_id:parseInt(e.proyecto_id)||e.proyecto_id,region_id:parseInt(e.region_id)||e.region_id}));console.log("Proyectos procesados (normalizados):",s),l(s);const c=r.map(e=>Ue(Ue({},e),{},{region_id:parseInt(e.region_id)||e.region_id,cantidad_proyectos:parseInt(e.cantidad_proyectos)||0})),p={};c.forEach(e=>{const t=parseInt(e.region_id);p[e.region_id]=s.filter(e=>{const r=parseInt(e.region_id);return!isNaN(r)&&r===t})}),d(p),console.log("Proyectos agrupados por regi\xf3n:",p);const u=c.map(e=>Ue(Ue({},e),{},{cantidad_proyectos:p[e.region_id]?p[e.region_id].length:0}));console.log("Regiones con cantidad final:",u),i(u)}catch(f){console.error("Error cargando datos:",f),console.error("Stack trace:",f.stack),i([]),l([]),h(f.message||"Error al cargar las regiones. Verifica la conexi\xf3n con la base de datos.")}finally{u(!1)}})()},[]);const v=()=>{localStorage.removeItem("user"),localStorage.removeItem("centros"),window.location.href="/"};if(p)return(0,ze.jsx)("div",{className:"main-bg",children:(0,ze.jsx)("div",{className:"content-card",style:{textAlign:"center"},children:(0,ze.jsx)("h2",{children:"Cargando regiones..."})})});if("visita"===t.rol)return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:t,onLogout:v}),(0,ze.jsxs)("div",{className:"content-card",style:{textAlign:"center",marginTop:"4rem"},children:[(0,ze.jsx)("h2",{children:"Acceso restringido"}),(0,ze.jsx)("p",{children:'Los usuarios de tipo "visita" solo pueden visualizar la p\xe1gina de inicio.'}),(0,ze.jsx)("p",{children:"No tienen permisos para acceder a proyectos."})]})]});if("super_admin"!==t.rol&&"admin"!==t.rol&&"trabajador"!==t.rol)return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:t,onLogout:v}),(0,ze.jsxs)("div",{className:"content-card",style:{textAlign:"center",marginTop:"4rem"},children:[(0,ze.jsx)("h2",{children:"Acceso restringido"}),(0,ze.jsx)("p",{children:"No tienes permisos para navegar entre proyectos y regiones."}),(0,ze.jsx)("p",{children:"Contacta a un administrador para m\xe1s informaci\xf3n."})]})]});if(!Array.isArray(a))return console.error("Error: regiones no es un array:",a),(0,ze.jsx)("div",{className:"main-bg",children:(0,ze.jsxs)("div",{className:"content-card",style:{textAlign:"center"},children:[(0,ze.jsx)("h2",{children:"Error cargando datos"}),(0,ze.jsx)("p",{children:"No se pudieron cargar las regiones correctamente."})]})});let y=a,j=c;if(console.log("Usuario actual:",t),console.log("Centros disponibles:",r),console.log("Regiones totales:",a.length),console.log("Regiones cargadas:",a),console.log("Proyectos por regi\xf3n:",c),console.log("Estado loading:",p),"admin"===t.rol||"trabajador"===t.rol){console.log("Usuario:",t.rol,t),console.log("Centros asignados (originales):",r);const e=Array.isArray(r)?r.map(e=>Ue(Ue({},e),{},{proyecto_id:e.proyecto_id?parseInt(e.proyecto_id):null,id:e.id?parseInt(e.id):null})):[];console.log("Centros normalizados:",e);const n=e.map(e=>e.proyecto_id).filter(e=>null!==e&&void 0!==e&&!isNaN(e));console.log("Proyectos asignados (normalizados):",n),console.log("Total proyectos disponibles:",s.length),console.log("Proyectos disponibles (muestra):",s.slice(0,3).map(e=>({proyecto_id:e.proyecto_id,proyecto_id_tipo:typeof e.proyecto_id,region_id:e.region_id,region_id_tipo:typeof e.region_id})));const o=new Set;s.forEach(e=>{const t=parseInt(e.proyecto_id);if(!isNaN(t)&&n.includes(t)){const t=parseInt(e.region_id);isNaN(t)||o.add(t)}}),console.log("Regiones asignadas (IDs):",Array.from(o)),console.log("Total regiones disponibles:",a.length),n.length>0?(y=a.filter(e=>{const t=parseInt(e.region_id),r=!isNaN(t)&&o.has(t);return r&&console.log("Regi\xf3n ".concat(e.nombre," (ID: ").concat(t,") incluida")),r}),j={},y.forEach(e=>{j[e.region_id]=(c[e.region_id]||[]).filter(e=>{const t=parseInt(e.proyecto_id);return!isNaN(t)&&n.includes(t)})}),console.log("Regiones filtradas (final):",y.length,y.map(e=>({id:e.region_id,nombre:e.nombre}))),console.log("Proyectos filtrados por regi\xf3n:",Object.keys(j).length)):(console.warn("Usuario sin proyectos asignados. Centros:",e),console.warn("Si el usuario tiene centro_costo_id, deber\xeda tener proyectos asignados"),y=[],j={})}return console.log("Regiones filtradas:",y.length),console.log("Proyectos por regi\xf3n filtrados:",j),Array.isArray(y)||(console.error("Error: regionesFiltradas no es un array:",y),y=[]),(0,ze.jsxs)("div",{className:"main-bg",style:{background:"linear-gradient(rgba(10, 110, 189, 0.4), rgba(30, 64, 175, 0.4)), url(".concat("/img/imagen_jej.jpg",")"),backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat",height:"100vh",overflow:"hidden"},children:[(0,ze.jsx)("style",{children:"\n          .main-content.moderno {\n            background: transparent !important;\n            box-shadow: none !important;\n          }\n          \n          .content-card {\n            background: transparent !important;\n          }\n          \n          @keyframes shimmer {\n            0% { transform: translateX(-100%); }\n            100% { transform: translateX(100%); }\n          }\n          \n          @keyframes fadeInUp {\n            from {\n              opacity: 0;\n              transform: translateY(20px);\n            }\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n          \n          @keyframes pulse {\n            0%, 100% {\n              transform: scale(1);\n            }\n            50% {\n              transform: scale(1.05);\n            }\n          }\n          \n          /* Enable scrolling so content is visible */\n          .main-content.moderno {\n            overflow-y: auto !important;\n            height: calc(100vh - 80px) !important;\n          }\n          \n          .content-card {\n            max-height: calc(100vh - 140px) !important;\n            overflow-y: auto !important;\n            overflow-x: hidden !important;\n            animation: fadeInUp 0.6s ease-out;\n          }\n          \n          /* Ocultar scrollbar completamente pero mantener funcionalidad */\n          .content-card,\n          .regiones-lista-scroll {\n            scrollbar-width: none !important; /* Firefox */\n            -ms-overflow-style: none !important; /* IE y Edge */\n          }\n          \n          .content-card::-webkit-scrollbar,\n          .regiones-lista-scroll::-webkit-scrollbar {\n            display: none !important; /* Chrome, Safari, Opera */\n            width: 0px !important;\n            height: 0px !important;\n            background: transparent !important;\n          }\n          \n          .content-card::-webkit-scrollbar-track,\n          .regiones-lista-scroll::-webkit-scrollbar-track {\n            display: none !important;\n            background: transparent !important;\n          }\n          \n          .content-card::-webkit-scrollbar-thumb,\n          .regiones-lista-scroll::-webkit-scrollbar-thumb {\n            display: none !important;\n            background: transparent !important;\n          }\n          \n          .content-card::-webkit-scrollbar-button,\n          .regiones-lista-scroll::-webkit-scrollbar-button {\n            display: none !important;\n          }\n          \n          /* Responsive design */\n          @media (max-width: 768px) {\n            .content-card {\n              margin: 10px !important;\n              border-radius: 12px !important;\n            }\n          }\n          \n          @media (max-width: 480px) {\n            .content-card {\n              margin: 5px !important;\n              border-radius: 8px !important;\n            }\n          }\n          \n          /* Efectos de hover mejorados */\n          .region-item:hover {\n            animation: pulse 0.6s ease-in-out;\n          }\n          \n          /* Transiciones suaves */\n          * {\n            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n          }\n          \n          /* Estilos hover para navbar */\n          .navbar-link:hover {\n            color: #ffd700 !important;\n          }\n          \n          .logout-btn:hover {\n            background: #ffd700 !important;\n            color: #0a6ebd !important;\n          }\n        "}),(0,ze.jsx)(De,{user:t,onLogout:v}),(0,ze.jsx)("main",{className:"main-content moderno",style:{paddingTop:"30px",background:"transparent",boxShadow:"none",height:"calc(100vh - 80px)",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,ze.jsxs)("div",{className:"content-card",style:{maxWidth:window.innerWidth>1200?"560px":window.innerWidth>768?"480px":"76%",minWidth:window.innerWidth>768?"320px":"240px",margin:"0 auto",padding:"0",background:"rgba(13, 30, 60, 0.92)",boxShadow:"0 20px 64px rgba(0, 0, 0, 0.32)",border:"1px solid rgba(255, 255, 255, 0.25)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:"13px",position:"relative",fontSize:window.innerWidth>768?"11px":"10px",height:"auto",maxHeight:"calc(100vh - 140px)",overflow:"hidden"},children:[0===y.length&&p&&(0,ze.jsx)("div",{style:{padding:"12px",color:"#ffffff",textAlign:"center",fontSize:"11px"},children:"Cargando regiones desde base de datos..."}),0===y.length&&!p&&(0,ze.jsx)("div",{style:{padding:"12px",color:"#ffffff",textAlign:"center",fontSize:"11px"},children:f?(0,ze.jsxs)("div",{children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{marginRight:"8px",color:"#ffc107"}}),f]}):"super_admin"===t.rol?"No se encontraron regiones en la base de datos.":"No se encontraron regiones o proyectos asignados. Contacta a un administrador para obtener acceso."}),y.length>0&&(0,ze.jsxs)("div",{style:{padding:"16px 20px 12px 20px",borderBottom:"1px solid rgba(255, 255, 255, 0.15)",background:"rgba(255, 255, 255, 0.05)"},children:[(0,ze.jsx)("h2",{style:{color:"#ffffff",fontSize:"14px",fontWeight:600,margin:0,textAlign:"center",letterSpacing:"0.4px"},children:"Regiones y Proyectos"}),(0,ze.jsx)("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"10px",margin:"3px 0 0 0",textAlign:"center"},children:"Selecciona una regi\xf3n para ver sus proyectos"})]}),y.length>0&&(0,ze.jsx)("div",{className:"regiones-lista-scroll",style:{padding:"16px 20px 20px 20px",maxHeight:"calc(100vh - 280px)",overflowY:"auto"},children:(0,ze.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0,width:"100%"},children:y.map((e,t)=>{const r=j[e.region_id]||[],n=g.includes(e.region_id),o=Number(e.cantidad_proyectos)>0;return(0,ze.jsxs)("li",{style:{marginBottom:"10px"},children:[(0,ze.jsxs)("div",{onClick:()=>{return o&&(t=e.region_id,void m(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]));var t},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"13px 16px",cursor:o?"pointer":"default",background:o?"linear-gradient(135deg, rgba(96, 165, 250, 0.15), rgba(59, 130, 246, 0.1))":"rgba(255, 255, 255, 0.08)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:500,borderRadius:"10px",border:o?"1px solid rgba(96, 165, 250, 0.3)":"1px solid rgba(255, 255, 255, 0.15)",boxShadow:o?"0 3px 10px rgba(96, 165, 250, 0.1)":"0 2px 6px rgba(0, 0, 0, 0.1)",position:"relative",overflow:"hidden"},onMouseOver:e=>{o&&(e.currentTarget.style.background="linear-gradient(135deg, rgba(96, 165, 250, 0.25), rgba(59, 130, 246, 0.15))",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 20px rgba(96, 165, 250, 0.2)")},onMouseOut:e=>{o&&(e.currentTarget.style.background="linear-gradient(135deg, rgba(96, 165, 250, 0.15), rgba(59, 130, 246, 0.1))",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(96, 165, 250, 0.1)")},children:[(0,ze.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent)"}}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,ze.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:o?"linear-gradient(135deg, #60a5fa, #3b82f6)":"rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"13px",boxShadow:o?"0 3px 10px rgba(96, 165, 250, 0.3)":"0 2px 6px rgba(0, 0, 0, 0.1)"},children:(0,ze.jsx)("i",{className:"fa fa-map-marker-alt",style:{color:"#ffffff",fontSize:"13px",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"}})}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("span",{style:{color:"#ffffff",fontWeight:600,fontSize:"12px",lineHeight:"1.3",display:"block"},children:e.nombre}),(0,ze.jsxs)("span",{style:{color:"rgba(255, 255, 255, 0.6)",fontSize:"10px",fontWeight:400},children:["Regi\xf3n ",t+1," de ",y.length]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{background:o?"linear-gradient(135deg, #f59e0b, #d97706)":"rgba(255, 255, 255, 0.1)",padding:"5px 10px",borderRadius:"16px",border:o?"1px solid rgba(245, 158, 11, 0.3)":"1px solid rgba(255, 255, 255, 0.2)",boxShadow:o?"0 2px 6px rgba(245, 158, 11, 0.2)":"none"},children:(0,ze.jsxs)("span",{style:{color:"#ffffff",fontWeight:600,fontSize:"11px"},children:[e.cantidad_proyectos," proyecto",1===e.cantidad_proyectos?"":"s"]})}),o&&(0,ze.jsx)("div",{style:{width:"26px",height:"26px",borderRadius:"6px",background:"rgba(245, 158, 11, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},children:(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(n?"up":"down"),style:{fontSize:"10px",color:"#f59e0b",transition:"transform 0.3s ease"}})})]})]}),n&&o&&(0,ze.jsxs)("div",{style:{marginTop:"6px",padding:"13px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",paddingBottom:"6px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{color:"#f59e0b",fontSize:"11px",marginRight:"6px"}}),(0,ze.jsxs)("span",{style:{color:"#ffffff",fontSize:"11px",fontWeight:600},children:["Proyectos en esta regi\xf3n (",r.length,")"]})]}),(0,ze.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:r.map((e,t)=>(0,ze.jsxs)("li",{onClick:()=>(e=>{const t=s.find(t=>t.proyecto_id===e);b(t),x("/proyecto/".concat(e))})(e.proyecto_id),style:{padding:"10px 13px",cursor:"pointer",color:"#ffffff",fontWeight:400,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",borderRadius:"6px",margin:"5px 0",background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",gap:"10px",position:"relative",overflow:"hidden"},onMouseOver:e=>{e.currentTarget.style.background="linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(217, 119, 6, 0.1))",e.currentTarget.style.borderColor="rgba(245, 158, 11, 0.3)",e.currentTarget.style.transform="translateX(4px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(245, 158, 11, 0.2)"},onMouseOut:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.08)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"linear-gradient(135deg, #f59e0b, #d97706)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"9px",fontWeight:600,color:"#ffffff",flexShrink:0},children:t+1}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontWeight:600,color:"#ffffff",fontSize:"11px",lineHeight:"1.3",marginBottom:"2px"},children:e.nombre}),e.descripcion&&(0,ze.jsx)("div",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"10px",lineHeight:"1.3"},children:e.descripcion})]}),(0,ze.jsx)("i",{className:"fa fa-arrow-right",style:{color:"rgba(245, 158, 11, 0.6)",fontSize:"10px",transition:"all 0.3s ease"}})]},e.proyecto_id))})]})]},e.region_id)})})})]})})]})};var $e=function(){return $e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},$e.apply(this,arguments)};function qe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function Xe(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Ke(){return Ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ke.apply(this,arguments)}function Je(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var Qe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ze=Je(function(e){return Qe.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91});var et=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(Fh){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),this.tags=[],this.ctr=0},e}(),tt="-ms-",rt="-moz-",nt="-webkit-",ot="comm",at="rule",it="decl",st="@keyframes",lt=Math.abs,ct=String.fromCharCode,dt=Object.assign;function pt(e){return e.trim()}function ut(e,t,r){return e.replace(t,r)}function ft(e,t){return e.indexOf(t)}function ht(e,t){return 0|e.charCodeAt(t)}function gt(e,t,r){return e.slice(t,r)}function mt(e){return e.length}function xt(e){return e.length}function bt(e,t){return t.push(e),e}var vt=1,yt=1,jt=0,_t=0,St=0,wt="";function kt(e,t,r,n,o,a,i){return{value:e,root:t,parent:r,type:n,props:o,children:a,line:vt,column:yt,length:i,return:""}}function Ct(e,t){return dt(kt("",null,null,"",null,null,0),e,{length:-e.length},t)}function Et(){return St=_t>0?ht(wt,--_t):0,yt--,10===St&&(yt=1,vt--),St}function Tt(){return St=_t<jt?ht(wt,_t++):0,yt++,10===St&&(yt=1,vt++),St}function Rt(){return ht(wt,_t)}function Nt(){return _t}function At(e,t){return gt(wt,e,t)}function zt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function It(e){return vt=yt=1,jt=mt(wt=e),_t=0,[]}function Ot(e){return wt="",e}function Pt(e){return pt(At(_t-1,Bt(91===e?e+2:40===e?e+1:e)))}function Dt(e){for(;(St=Rt())&&St<33;)Tt();return zt(e)>2||zt(St)>3?"":" "}function Lt(e,t){for(;--t&&Tt()&&!(St<48||St>102||St>57&&St<65||St>70&&St<97););return At(e,Nt()+(t<6&&32==Rt()&&32==Tt()))}function Bt(e){for(;Tt();)switch(St){case e:return _t;case 34:case 39:34!==e&&39!==e&&Bt(St);break;case 40:41===e&&Bt(e);break;case 92:Tt()}return _t}function Ft(e,t){for(;Tt()&&e+St!==57&&(e+St!==84||47!==Rt()););return"/*"+At(t,_t-1)+"*"+ct(47===e?e:Tt())}function Mt(e){for(;!zt(Rt());)Tt();return At(e,_t)}function Wt(e){return Ot(Ut("",null,null,null,[""],e=It(e),0,[0],e))}function Ut(e,t,r,n,o,a,i,s,l){for(var c=0,d=0,p=i,u=0,f=0,h=0,g=1,m=1,x=1,b=0,v="",y=o,j=a,_=n,S=v;m;)switch(h=b,b=Tt()){case 40:if(108!=h&&58==ht(S,p-1)){-1!=ft(S+=ut(Pt(b),"&","&\f"),"&\f")&&(x=-1);break}case 34:case 39:case 91:S+=Pt(b);break;case 9:case 10:case 13:case 32:S+=Dt(h);break;case 92:S+=Lt(Nt()-1,7);continue;case 47:switch(Rt()){case 42:case 47:bt(Vt(Ft(Tt(),Nt()),t,r),l);break;default:S+="/"}break;case 123*g:s[c++]=mt(S)*x;case 125*g:case 59:case 0:switch(b){case 0:case 125:m=0;case 59+d:f>0&&mt(S)-p&&bt(f>32?Gt(S+";",n,r,p-1):Gt(ut(S," ","")+";",n,r,p-2),l);break;case 59:S+=";";default:if(bt(_=Ht(S,t,r,c,d,o,s,v,y=[],j=[],p),a),123===b)if(0===d)Ut(S,t,_,_,y,a,p,s,j);else switch(99===u&&110===ht(S,3)?100:u){case 100:case 109:case 115:Ut(e,_,_,n&&bt(Ht(e,_,_,0,0,o,s,v,o,y=[],p),j),o,j,p,s,n?y:j);break;default:Ut(S,_,_,_,[""],j,0,s,j)}}c=d=f=0,g=x=1,v=S="",p=i;break;case 58:p=1+mt(S),f=h;default:if(g<1)if(123==b)--g;else if(125==b&&0==g++&&125==Et())continue;switch(S+=ct(b),b*g){case 38:x=d>0?1:(S+="\f",-1);break;case 44:s[c++]=(mt(S)-1)*x,x=1;break;case 64:45===Rt()&&(S+=Pt(Tt())),u=Rt(),d=p=mt(v=S+=Mt(Nt())),b++;break;case 45:45===h&&2==mt(S)&&(g=0)}}return a}function Ht(e,t,r,n,o,a,i,s,l,c,d){for(var p=o-1,u=0===o?a:[""],f=xt(u),h=0,g=0,m=0;h<n;++h)for(var x=0,b=gt(e,p+1,p=lt(g=i[h])),v=e;x<f;++x)(v=pt(g>0?u[x]+" "+b:ut(b,/&\f/g,u[x])))&&(l[m++]=v);return kt(e,t,r,0===o?at:s,l,c,d)}function Vt(e,t,r){return kt(e,t,r,ot,ct(St),gt(e,2,-2),0)}function Gt(e,t,r,n){return kt(e,t,r,it,gt(e,0,n),gt(e,n+1,-1),n)}function Yt(e,t){for(var r="",n=xt(e),o=0;o<n;o++)r+=t(e[o],o,e,t)||"";return r}function $t(e,t,r,n){switch(e.type){case"@import":case it:return e.return=e.return||e.value;case ot:return"";case st:return e.return=e.value+"{"+Yt(e.children,n)+"}";case at:e.value=e.props.join(",")}return mt(r=Yt(e.children,n))?e.return=e.value+"{"+r+"}":""}function qt(e){var t=xt(e);return function(r,n,o,a){for(var i="",s=0;s<t;s++)i+=e[s](r,n,o,a)||"";return i}}var Xt=function(e,t,r){for(var n=0,o=0;n=o,o=Rt(),38===n&&12===o&&(t[r]=1),!zt(o);)Tt();return At(e,_t)},Kt=function(e,t){return Ot(function(e,t){var r=-1,n=44;do{switch(zt(n)){case 0:38===n&&12===Rt()&&(t[r]=1),e[r]+=Xt(_t-1,t,r);break;case 2:e[r]+=Pt(n);break;case 4:if(44===n){e[++r]=58===Rt()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=ct(n)}}while(n=Tt());return e}(It(e),t))},Jt=new WeakMap,Qt=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Jt.get(r))&&!n){Jt.set(e,!0);for(var o=[],a=Kt(t,o),i=r.props,s=0,l=0;s<a.length;s++)for(var c=0;c<i.length;c++,l++)e.props[l]=o[s]?a[s].replace(/&\f/g,i[c]):i[c]+" "+a[s]}}},Zt=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function er(e,t){switch(function(e,t){return 45^ht(e,0)?(((t<<2^ht(e,0))<<2^ht(e,1))<<2^ht(e,2))<<2^ht(e,3):0}(e,t)){case 5103:return nt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return nt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return nt+e+rt+e+tt+e+e;case 6828:case 4268:return nt+e+tt+e+e;case 6165:return nt+e+tt+"flex-"+e+e;case 5187:return nt+e+ut(e,/(\w+).+(:[^]+)/,nt+"box-$1$2"+tt+"flex-$1$2")+e;case 5443:return nt+e+tt+"flex-item-"+ut(e,/flex-|-self/,"")+e;case 4675:return nt+e+tt+"flex-line-pack"+ut(e,/align-content|flex-|-self/,"")+e;case 5548:return nt+e+tt+ut(e,"shrink","negative")+e;case 5292:return nt+e+tt+ut(e,"basis","preferred-size")+e;case 6060:return nt+"box-"+ut(e,"-grow","")+nt+e+tt+ut(e,"grow","positive")+e;case 4554:return nt+ut(e,/([^-])(transform)/g,"$1"+nt+"$2")+e;case 6187:return ut(ut(ut(e,/(zoom-|grab)/,nt+"$1"),/(image-set)/,nt+"$1"),e,"")+e;case 5495:case 3959:return ut(e,/(image-set\([^]*)/,nt+"$1$`$1");case 4968:return ut(ut(e,/(.+:)(flex-)?(.*)/,nt+"box-pack:$3"+tt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+nt+e+e;case 4095:case 3583:case 4068:case 2532:return ut(e,/(.+)-inline(.+)/,nt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(mt(e)-1-t>6)switch(ht(e,t+1)){case 109:if(45!==ht(e,t+4))break;case 102:return ut(e,/(.+:)(.+)-([^]+)/,"$1"+nt+"$2-$3$1"+rt+(108==ht(e,t+3)?"$3":"$2-$3"))+e;case 115:return~ft(e,"stretch")?er(ut(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==ht(e,t+1))break;case 6444:switch(ht(e,mt(e)-3-(~ft(e,"!important")&&10))){case 107:return ut(e,":",":"+nt)+e;case 101:return ut(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+nt+(45===ht(e,14)?"inline-":"")+"box$3$1"+nt+"$2$3$1"+tt+"$2box$3")+e}break;case 5936:switch(ht(e,t+11)){case 114:return nt+e+tt+ut(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return nt+e+tt+ut(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return nt+e+tt+ut(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return nt+e+tt+e+e}return e}var tr="undefined"!==typeof document,rr=tr?void 0:function(e){var t=new WeakMap;return function(r){if(t.has(r))return t.get(r);var n=e(r);return t.set(r,n),n}}(function(){return Je(function(){var e={};return function(t){return e[t]}})}),nr=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case it:e.return=er(e.value,e.length);break;case st:return Yt([Ct(e,{value:ut(e.value,"@","@"+nt)})],n);case at:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Yt([Ct(e,{props:[ut(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Yt([Ct(e,{props:[ut(t,/:(plac\w+)/,":"+nt+"input-$1")]}),Ct(e,{props:[ut(t,/:(plac\w+)/,":-moz-$1")]}),Ct(e,{props:[ut(t,/:(plac\w+)/,tt+"input-$1")]})],n)}return""})}}],or=function(e){var t=e.key;if(tr&&"css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var n=e.stylisPlugins||nr;var o,a,i={},s=[];tr&&(o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)i[t[r]]=!0;s.push(e)}));var l,c=[Qt,Zt];if(tr){var d,p=[$t,(l=function(e){d.insert(e)},function(e){e.root||(e=e.return)&&l(e)})],u=qt(c.concat(n,p));a=function(e,t,r,n){d=r,Yt(Wt(e?e+"{"+t.styles+"}":t.styles),u),n&&(x.inserted[t.name]=!0)}}else{var f=[$t],h=qt(c.concat(n,f)),g=rr(n)(t),m=function(e,t){var r=t.name;return void 0===g[r]&&(g[r]=Yt(Wt(e?e+"{"+t.styles+"}":t.styles),h)),g[r]};a=function(e,t,r,n){var o=t.name,a=m(e,t);return void 0===x.compat?(n&&(x.inserted[o]=!0),a):n?void(x.inserted[o]=a):a}}var x={key:t,sheet:new et({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:a};return x.sheet.hydrate(s),x};var ar="undefined"!==typeof document,ir=function(e){return e()},sr=!!a.useInsertionEffect&&a.useInsertionEffect,lr=ar&&sr||ir,cr="undefined"!==typeof document,dr=(0,o.createContext)("undefined"!==typeof HTMLElement?or({key:"css"}):null);dr.Provider;var pr=function(e){return(0,o.forwardRef)(function(t,r){var n=(0,o.useContext)(dr);return e(t,n,r)})};cr||(pr=function(e){return function(t){var r=(0,o.useContext)(dr);return null===r?(r=or({key:"css"}),(0,o.createElement)(dr.Provider,{value:r},e(t,r))):e(t,r)}});var ur=(0,o.createContext)({});var fr="undefined"!==typeof document;var hr=function(e,t,r){var n=e.key+"-"+t.name;(!1===r||!1===fr&&void 0!==e.compat)&&void 0===e.registered[n]&&(e.registered[n]=t.styles)};var gr={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},mr=/[A-Z]|^ms/g,xr=/_EMO_([^_]+?)_([^]*?)_EMO_/g,br=function(e){return 45===e.charCodeAt(1)},vr=function(e){return null!=e&&"boolean"!==typeof e},yr=Je(function(e){return br(e)?e:e.replace(mr,"-$&").toLowerCase()}),jr=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(xr,function(e,t,r){return Sr={name:t,styles:r,next:Sr},t})}return 1===gr[e]||br(e)||"number"!==typeof t||0===t?t:t+"px"};function _r(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return Sr={name:r.name,styles:r.styles,next:Sr},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)Sr={name:n.name,styles:n.styles,next:Sr},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var o=0;o<r.length;o++)n+=_r(e,t,r[o])+";";else for(var a in r){var i=r[a];if("object"!==typeof i)null!=t&&void 0!==t[i]?n+=a+"{"+t[i]+"}":vr(i)&&(n+=yr(a)+":"+jr(a,i)+";");else if(!Array.isArray(i)||"string"!==typeof i[0]||null!=t&&void 0!==t[i[0]]){var s=_r(e,t,i);switch(a){case"animation":case"animationName":n+=yr(a)+":"+s+";";break;default:n+=a+"{"+s+"}"}}else for(var l=0;l<i.length;l++)vr(i[l])&&(n+=yr(a)+":"+jr(a,i[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var o=Sr,a=r(e);return Sr=o,_r(e,t,a)}}if(null==t)return r;var i=t[r];return void 0!==i?i:r}var Sr,wr=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var kr=Ze,Cr=function(e){return"theme"!==e},Er=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?kr:Cr},Tr=function(e,t,r){var n;if(t){var o=t.shouldForwardProp;n=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!==typeof n&&r&&(n=e.__emotion_forwardProp),n},Rr="undefined"!==typeof document,Nr=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;hr(t,r,n);var a=lr(function(){return function(e,t,r){hr(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",a=t;do{var i=e.insert(t===a?"."+n:"",a,e.sheet,!0);fr||void 0===i||(o+=i),a=a.next}while(void 0!==a);if(!fr&&0!==o.length)return o}}(t,r,n)});if(!Rr&&void 0!==a){for(var i,s=r.name,l=r.next;void 0!==l;)s+=" "+l.name,l=l.next;return(0,o.createElement)("style",((i={})["data-emotion"]=t.key+" "+s,i.dangerouslySetInnerHTML={__html:a},i.nonce=t.sheet.nonce,i))}return null},Ar=function e(t,r){var n,a,i=t.__emotion_real===t,s=i&&t.__emotion_base||t;void 0!==r&&(n=r.label,a=r.target);var l=Tr(t,r,i),c=l||Er(s),d=!c("as");return function(){var p=arguments,u=i&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==n&&u.push("label:"+n+";"),null==p[0]||void 0===p[0].raw)u.push.apply(u,p);else{0,u.push(p[0][0]);for(var f=p.length,h=1;h<f;h++)u.push(p[h],p[0][h])}var g=pr(function(e,t,r){var n=d&&e.as||s,i="",p=[],f=e;if(null==e.theme){for(var h in f={},e)f[h]=e[h];f.theme=(0,o.useContext)(ur)}"string"===typeof e.className?i=function(e,t,r){var n="";return r.split(" ").forEach(function(r){void 0!==e[r]?t.push(e[r]+";"):n+=r+" "}),n}(t.registered,p,e.className):null!=e.className&&(i=e.className+" ");var g=function(e,t,r){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,o="";Sr=void 0;var a=e[0];null==a||void 0===a.raw?(n=!1,o+=_r(r,t,a)):o+=a[0];for(var i=1;i<e.length;i++)o+=_r(r,t,e[i]),n&&(o+=a[i]);wr.lastIndex=0;for(var s,l="";null!==(s=wr.exec(o));)l+="-"+s[1];var c=function(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(o)+l;return{name:c,styles:o,next:Sr}}(u.concat(p),t.registered,f);i+=t.key+"-"+g.name,void 0!==a&&(i+=" "+a);var m=d&&void 0===l?Er(n):c,x={};for(var b in e)d&&"as"===b||m(b)&&(x[b]=e[b]);return x.className=i,x.ref=r,(0,o.createElement)(o.Fragment,null,(0,o.createElement)(Nr,{cache:t,serialized:g,isStringTag:"string"===typeof n}),(0,o.createElement)(n,x))});return g.displayName=void 0!==n?n:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",g.defaultProps=t.defaultProps,g.__emotion_real=g,g.__emotion_base=s,g.__emotion_styles=u,g.__emotion_forwardProp=l,Object.defineProperty(g,"toString",{value:function(){return"."+a}}),g.withComponent=function(t,n){return e(t,Ke({},r,n,{shouldForwardProp:Tr(g,n,!0)})).apply(void 0,u)},g}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(e){Ar[e]=Ar(e)});var zr,Ir={exports:{}};zr=Ir,function(){var e={}.hasOwnProperty;function t(){for(var r=[],n=0;n<arguments.length;n++){var o=arguments[n];if(o){var a=typeof o;if("string"===a||"number"===a)r.push(o);else if(Array.isArray(o)){if(o.length){var i=t.apply(null,o);i&&r.push(i)}}else if("object"===a){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var s in o)e.call(o,s)&&o[s]&&r.push(s)}}}return r.join(" ")}zr.exports?(t.default=t,zr.exports=t):window.classNames=t}();var Or,Pr,Dr,Lr,Br,Fr,Mr,Wr,Ur,Hr,Vr,Gr,Yr,$r,qr=Ir.exports,Xr=o.createContext(void 0),Kr=function(){return o.useContext(Xr)},Jr="ps-sidebar-root",Qr="ps-sidebar-container",Zr="ps-sidebar-image",en="ps-sidebar-backdrop",tn="ps-collapsed",rn="ps-toggled",nn="ps-rtl",on="ps-broken",an="ps-menu-root",sn="ps-menuitem-root",ln="ps-submenu-root",cn="ps-menu-button",dn="ps-menu-prefix",pn="ps-menu-suffix",un="ps-menu-label",fn="ps-menu-icon",hn="ps-submenu-content",gn="ps-submenu-expand-icon",mn="ps-disabled",xn="ps-active",bn="ps-open",vn=Ar.div(Or||(Or=Xe(["\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  z-index: 1;\n  background-color: rgb(0, 0, 0, 0.3);\n"],["\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  z-index: 1;\n  background-color: rgb(0, 0, 0, 0.3);\n"]))),yn={xs:"480px",sm:"576px",md:"768px",lg:"992px",xl:"1200px",xxl:"1600px",always:"always",all:"all"},jn=Ar.aside(Pr||(Pr=Xe(["\n  position: relative;\n  border-right-width: 1px;\n  border-right-style: solid;\n  border-color: #efefef;\n\n  transition: ",";\n\n  width: ",";\n  min-width: ",";\n\n  &."," {\n    width: ",";\n    min-width: ",";\n  }\n\n  &."," {\n    direction: rtl;\n    border-right-width: none;\n    border-left-width: 1px;\n    border-right-style: none;\n    border-left-style: solid;\n  }\n\n  &."," {\n    position: fixed;\n    height: 100%;\n    top: 0px;\n    z-index: 100;\n\n    ","\n\n    &."," {\n      ","\n    }\n\n    &."," {\n      ","\n    }\n\n    &."," {\n      right: -",";\n\n      &."," {\n        right: -",";\n      }\n\n      &."," {\n        right: 0;\n      }\n    }\n  }\n\n  ","\n"],["\n  position: relative;\n  border-right-width: 1px;\n  border-right-style: solid;\n  border-color: #efefef;\n\n  transition: ",";\n\n  width: ",";\n  min-width: ",";\n\n  &."," {\n    width: ",";\n    min-width: ",";\n  }\n\n  &."," {\n    direction: rtl;\n    border-right-width: none;\n    border-left-width: 1px;\n    border-right-style: none;\n    border-left-style: solid;\n  }\n\n  &."," {\n    position: fixed;\n    height: 100%;\n    top: 0px;\n    z-index: 100;\n\n    ","\n\n    &."," {\n      ","\n    }\n\n    &."," {\n      ","\n    }\n\n    &."," {\n      right: -",";\n\n      &."," {\n        right: -",";\n      }\n\n      &."," {\n        right: 0;\n      }\n    }\n  }\n\n  ","\n"])),function(e){var t=e.transitionDuration;return"width, left, right, ".concat(t,"ms")},function(e){return e.width},function(e){return e.width},tn,function(e){return e.collapsedWidth},function(e){return e.collapsedWidth},nn,on,function(e){var t=e.rtl,r=e.width;return t?"":"left: -".concat(r,";")},tn,function(e){var t=e.rtl,r=e.collapsedWidth;return t?"":"left: -".concat(r,"; ")},rn,function(e){return e.rtl?"":"left: 0;"},nn,function(e){return e.width},tn,function(e){return e.collapsedWidth},rn,function(e){return e.rootStyles}),_n=Ar.div(Dr||(Dr=Xe(["\n  position: relative;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  z-index: 3;\n\n  ","\n"],["\n  position: relative;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  z-index: 3;\n\n  ","\n"])),function(e){var t=e.backgroundColor;return t?"background-color:".concat(t,";"):""}),Sn=Ar.img(Lr||(Lr=Xe(["\n  &."," {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    object-position: center;\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 2;\n  }\n"],["\n  &."," {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    object-position: center;\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 2;\n  }\n"])),Zr),wn=o.createContext({collapsed:!1,toggled:!1,rtl:!1,transitionDuration:300}),kn=o.forwardRef(function(e,t){var r,n=e.collapsed,a=e.toggled,i=e.onBackdropClick,s=e.onBreakPoint,l=e.width,c=void 0===l?"250px":l,d=e.collapsedWidth,p=void 0===d?"80px":d,u=e.defaultCollapsed,f=e.className,h=e.children,g=e.breakPoint,m=e.customBreakPoint,x=e.backgroundColor,b=void 0===x?"rgb(249, 249, 249, 0.7)":x,v=e.transitionDuration,y=void 0===v?300:v,j=e.image,_=e.rtl,S=e.rootStyles,w=qe(e,["collapsed","toggled","onBackdropClick","onBreakPoint","width","collapsedWidth","defaultCollapsed","className","children","breakPoint","customBreakPoint","backgroundColor","transitionDuration","image","rtl","rootStyles"]),k=o.useRef();k.current=function(e){null===s||void 0===s||s(e)};var C=function(e){var t=o.useState(!!e&&"undefined"!==typeof window&&window.matchMedia(e).matches),r=t[0],n=t[1];return o.useEffect(function(){if(e){var t=window.matchMedia(e),o=function(){t.matches!==r&&n(t.matches)};return o(),t.addEventListener("change",o),function(){return t.removeEventListener("change",o)}}},[r,e]),r}(m?"(max-width: ".concat(m,")"):g?["xs","sm","md","lg","xl","xxl"].includes(g)?"(max-width: ".concat(yn[g],")"):"always"===g||"all"===g?("always"===g&&console.warn('The "always" breakPoint is deprecated and will be removed in future release. Please use the "all" breakPoint instead.'),"screen"):"(max-width: ".concat(g,")"):void 0),E=o.useState(!1),T=E[0],R=E[1],N=Kr(),A=null!==n&&void 0!==n?n:!(T||!u)||(null===N||void 0===N?void 0:N.collapsed),z=null!==a&&void 0!==a?a:null===N||void 0===N?void 0:N.toggled,I=function(){null===i||void 0===i||i(),null===N||void 0===N||N.updateSidebarState({toggled:!1})};return o.useEffect(function(){var e;null===(e=k.current)||void 0===e||e.call(k,C)},[C]),o.useEffect(function(){null===N||void 0===N||N.updateSidebarState({broken:C,rtl:_,transitionDuration:y})},[C,null===N||void 0===N?void 0:N.updateSidebarState,_,y]),o.useEffect(function(){T||(null===N||void 0===N||N.updateSidebarState({collapsed:u}),R(!0))},[u,T,null===N||void 0===N?void 0:N.updateSidebarState]),o.createElement(wn.Provider,{value:{collapsed:A,toggled:z,rtl:_,transitionDuration:y}},o.createElement(jn,$e({ref:t,"data-testid":"".concat(Jr,"-test-id"),rtl:_,rootStyles:S,width:c,collapsedWidth:p,transitionDuration:y,className:qr(Jr,(r={},r[tn]=A,r[rn]=z,r[on]=C,r[nn]=_,r),f)},w),o.createElement(_n,{"data-testid":"".concat(Qr,"-test-id"),className:Qr,backgroundColor:b},h),j&&o.createElement(Sn,{"data-testid":"".concat(Zr,"-test-id"),src:j,alt:"sidebar background",className:Zr}),C&&z&&o.createElement(vn,{"data-testid":"".concat(en,"-test-id"),role:"button",tabIndex:0,"aria-label":"backdrop",onClick:I,onKeyPress:I,className:en})))}),Cn=Ar.ul(Br||(Br=Xe(["\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n"],["\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n"]))),En=Ar.nav(Fr||(Fr=Xe(["\n  &."," {\n    ","\n  }\n"],["\n  &."," {\n    ","\n  }\n"])),an,function(e){return e.rootStyles}),Tn=o.createContext(void 0),Rn=o.createContext(0),Nn=o.forwardRef(function(e,t){var r=e.children,n=e.className,a=e.transitionDuration,i=void 0===a?300:a,s=e.closeOnClick,l=void 0!==s&&s,c=e.rootStyles,d=e.menuItemStyles,p=e.renderExpandIcon,u=qe(e,["children","className","transitionDuration","closeOnClick","rootStyles","menuItemStyles","renderExpandIcon"]),f=o.useMemo(function(){return{transitionDuration:i,closeOnClick:l,menuItemStyles:d,renderExpandIcon:p}},[i,l,d,p]);return o.createElement(Tn.Provider,{value:f},o.createElement(Rn.Provider,{value:0},o.createElement(En,$e({ref:t,className:qr(an,n),rootStyles:c},u),o.createElement(Cn,null,r))))}),An=function(){var e=o.useContext(Tn);if(void 0===e)throw new Error("Menu Component is required!");return e},zn=Ar.div(Mr||(Mr=Xe(["\n  height: 0px;\n  overflow: hidden;\n  z-index: 999;\n  transition: height ","ms;\n  box-sizing: border-box;\n  background-color: white;\n\n  ","\n\n  ","\n\n  ",";\n\n  ",";\n"],["\n  height: 0px;\n  overflow: hidden;\n  z-index: 999;\n  transition: height ","ms;\n  box-sizing: border-box;\n  background-color: white;\n\n  ","\n\n  ","\n\n  ",";\n\n  ",";\n"])),function(e){return e.transitionDuration},function(e){var t=e.firstLevel,r=e.collapsed;return t&&r&&"\n     background-color: white;\n     box-shadow: 0 3px 6px -4px #0000001f, 0 6px 16px #00000014, 0 9px 28px 8px #0000000d;\n     "},function(e){return e.defaultOpen&&"height: auto;display: block;"},function(e){var t=e.collapsed,r=e.firstLevel,n=e.openWhenCollapsed;return t&&r?"\n      position: fixed;\n      padding-left: 0px;\n      width: 200px;\n      border-radius: 4px;\n      height: auto!important;\n      display: block!important;     \n      transition: none!important;     \n      visibility: ".concat(n?"visible":"hidden",";\n     "):"\n      position: static!important;\n      transform: none!important;\n      "},function(e){return e.rootStyles}),In=o.forwardRef(function(e,t){var r=e.children,n=e.open,a=e.openWhenCollapsed,i=e.firstLevel,s=e.collapsed,l=e.defaultOpen,c=qe(e,["children","open","openWhenCollapsed","firstLevel","collapsed","defaultOpen"]),d=An().transitionDuration,p=o.useState(l)[0];return o.createElement(zn,$e({"data-testid":"".concat(hn,"-test-id"),ref:t,firstLevel:i,collapsed:s,open:n,openWhenCollapsed:a,transitionDuration:d,defaultOpen:p},c),o.createElement(Cn,null,r))}),On=Ar.span(Wr||(Wr=Xe(["\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  ",";\n"],["\n  flex-grow: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  ",";\n"])),function(e){return e.rootStyles}),Pn=Ar.span(Ur||(Ur=Xe(["\n  width: 35px;\n  min-width: 35px;\n  height: 35px;\n  line-height: 35px;\n  text-align: center;\n  display: inline-block;\n  border-radius: 2px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  ","\n\n  ",";\n"],["\n  width: 35px;\n  min-width: 35px;\n  height: 35px;\n  line-height: 35px;\n  text-align: center;\n  display: inline-block;\n  border-radius: 2px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  ","\n\n  ",";\n"])),function(e){return e.rtl?"margin-left: 10px;":"margin-right: 10px;"},function(e){return e.rootStyles}),Dn=Ar.span(Hr||(Hr=Xe(["\n  ","\n  opacity: ",";\n  transition: opacity ","ms;\n\n  ",";\n"],["\n  ","\n  opacity: ",";\n  transition: opacity ","ms;\n\n  ",";\n"])),function(e){return e.rtl?"margin-left: 5px;":"margin-right: 5px;"},function(e){var t=e.firstLevel,r=e.collapsed;return t&&r?"0":"1"},function(e){return e.transitionDuration},function(e){return e.rootStyles}),Ln=Ar.span(Vr||(Vr=Xe(["\n  margin-right: 5px;\n  margin-left: 5px;\n  opacity: ",";\n  transition: opacity ","ms;\n\n  ",";\n"],["\n  margin-right: 5px;\n  margin-left: 5px;\n  opacity: ",";\n  transition: opacity ","ms;\n\n  ",";\n"])),function(e){var t=e.firstLevel,r=e.collapsed;return t&&r?"0":"1"},function(e){return e.transitionDuration},function(e){return e.rootStyles}),Bn=Ar.span(Gr||(Gr=Xe(["\n  ","\n\n  ",";\n"],["\n  ","\n\n  ",";\n"])),function(e){var t=e.collapsed,r=e.level,n=e.rtl;return t&&0===r&&"\n    position: absolute;\n    ".concat(n?"left: 10px;":"right: 10px;","\n    top: 50%;\n    transform: translateY(-50%);\n    \n    ")},function(e){return e.rootStyles}),Fn=Ar.span(Yr||(Yr=Xe(["\n  display: inline-block;\n  transition: transform 0.3s;\n  ","\n\n  width: 5px;\n  height: 5px;\n  transform: rotate(",");\n"],["\n  display: inline-block;\n  transition: transform 0.3s;\n  ","\n\n  width: 5px;\n  height: 5px;\n  transform: rotate(",");\n"])),function(e){return e.rtl?"\n          border-left: 2px solid currentcolor;\n          border-top: 2px solid currentcolor;\n        ":" border-right: 2px solid currentcolor;\n          border-bottom: 2px solid currentcolor;\n        "},function(e){var t=e.open,r=e.rtl;return t?r?"-135deg":"45deg":"-45deg"}),Mn=Ar.span($r||($r=Xe(["\n  width: 5px;\n  height: 5px;\n  background-color: currentcolor;\n  border-radius: 50%;\n  display: inline-block;\n"],["\n  width: 5px;\n  height: 5px;\n  background-color: currentcolor;\n  border-radius: 50%;\n  display: inline-block;\n"]))),Wn="top",Un="bottom",Hn="right",Vn="left",Gn="auto",Yn=[Wn,Un,Hn,Vn],$n="start",qn="end",Xn="viewport",Kn="popper",Jn=Yn.reduce(function(e,t){return e.concat([t+"-"+$n,t+"-"+qn])},[]),Qn=[].concat(Yn,[Gn]).reduce(function(e,t){return e.concat([t,t+"-"+$n,t+"-"+qn])},[]),Zn=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function eo(e){return e?(e.nodeName||"").toLowerCase():null}function to(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ro(e){return e instanceof to(e).Element||e instanceof Element}function no(e){return e instanceof to(e).HTMLElement||e instanceof HTMLElement}function oo(e){return"undefined"!==typeof ShadowRoot&&(e instanceof to(e).ShadowRoot||e instanceof ShadowRoot)}var ao={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},o=t.elements[e];no(o)&&eo(o)&&(Object.assign(o.style,r),Object.keys(n).forEach(function(e){var t=n[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(e){var n=t.elements[e],o=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce(function(e,t){return e[t]="",e},{});no(n)&&eo(n)&&(Object.assign(n.style,a),Object.keys(o).forEach(function(e){n.removeAttribute(e)}))})}},requires:["computeStyles"]};function io(e){return e.split("-")[0]}var so=Math.max,lo=Math.min,co=Math.round;function po(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function uo(){return!/^((?!chrome|android).)*safari/i.test(po())}function fo(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),o=1,a=1;t&&no(e)&&(o=e.offsetWidth>0&&co(n.width)/e.offsetWidth||1,a=e.offsetHeight>0&&co(n.height)/e.offsetHeight||1);var i=(ro(e)?to(e):window).visualViewport,s=!uo()&&r,l=(n.left+(s&&i?i.offsetLeft:0))/o,c=(n.top+(s&&i?i.offsetTop:0))/a,d=n.width/o,p=n.height/a;return{width:d,height:p,top:c,right:l+d,bottom:c+p,left:l,x:l,y:c}}function ho(e){var t=fo(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function go(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&oo(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function mo(e){return to(e).getComputedStyle(e)}function xo(e){return["table","td","th"].indexOf(eo(e))>=0}function bo(e){return((ro(e)?e.ownerDocument:e.document)||window.document).documentElement}function vo(e){return"html"===eo(e)?e:e.assignedSlot||e.parentNode||(oo(e)?e.host:null)||bo(e)}function yo(e){return no(e)&&"fixed"!==mo(e).position?e.offsetParent:null}function jo(e){for(var t=to(e),r=yo(e);r&&xo(r)&&"static"===mo(r).position;)r=yo(r);return r&&("html"===eo(r)||"body"===eo(r)&&"static"===mo(r).position)?t:r||function(e){var t=/firefox/i.test(po());if(/Trident/i.test(po())&&no(e)&&"fixed"===mo(e).position)return null;var r=vo(e);for(oo(r)&&(r=r.host);no(r)&&["html","body"].indexOf(eo(r))<0;){var n=mo(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}function _o(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function So(e,t,r){return so(e,lo(t,r))}function wo(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ko(e,t){return t.reduce(function(t,r){return t[r]=e,t},{})}var Co={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,o=e.options,a=r.elements.arrow,i=r.modifiersData.popperOffsets,s=io(r.placement),l=_o(s),c=[Vn,Hn].indexOf(s)>=0?"height":"width";if(a&&i){var d=function(e,t){return wo("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ko(e,Yn))}(o.padding,r),p=ho(a),u="y"===l?Wn:Vn,f="y"===l?Un:Hn,h=r.rects.reference[c]+r.rects.reference[l]-i[l]-r.rects.popper[c],g=i[l]-r.rects.reference[l],m=jo(a),x=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,b=h/2-g/2,v=d[u],y=x-p[c]-d[f],j=x/2-p[c]/2+b,_=So(v,j,y),S=l;r.modifiersData[n]=((t={})[S]=_,t.centerOffset=_-j,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!==typeof n||(n=t.elements.popper.querySelector(n)))&&go(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Eo(e){return e.split("-")[1]}var To={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ro(e){var t,r=e.popper,n=e.popperRect,o=e.placement,a=e.variation,i=e.offsets,s=e.position,l=e.gpuAcceleration,c=e.adaptive,d=e.roundOffsets,p=e.isFixed,u=i.x,f=void 0===u?0:u,h=i.y,g=void 0===h?0:h,m="function"===typeof d?d({x:f,y:g}):{x:f,y:g};f=m.x,g=m.y;var x=i.hasOwnProperty("x"),b=i.hasOwnProperty("y"),v=Vn,y=Wn,j=window;if(c){var _=jo(r),S="clientHeight",w="clientWidth";if(_===to(r)&&"static"!==mo(_=bo(r)).position&&"absolute"===s&&(S="scrollHeight",w="scrollWidth"),o===Wn||(o===Vn||o===Hn)&&a===qn)y=Un,g-=(p&&_===j&&j.visualViewport?j.visualViewport.height:_[S])-n.height,g*=l?1:-1;if(o===Vn||(o===Wn||o===Un)&&a===qn)v=Hn,f-=(p&&_===j&&j.visualViewport?j.visualViewport.width:_[w])-n.width,f*=l?1:-1}var k,C=Object.assign({position:s},c&&To),E=!0===d?function(e){var t=e.x,r=e.y,n=window.devicePixelRatio||1;return{x:co(t*n)/n||0,y:co(r*n)/n||0}}({x:f,y:g}):{x:f,y:g};return f=E.x,g=E.y,l?Object.assign({},C,((k={})[y]=b?"0":"",k[v]=x?"0":"",k.transform=(j.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",k)):Object.assign({},C,((t={})[y]=b?g+"px":"",t[v]=x?f+"px":"",t.transform="",t))}var No={passive:!0};var Ao={left:"right",right:"left",bottom:"top",top:"bottom"};function zo(e){return e.replace(/left|right|bottom|top/g,function(e){return Ao[e]})}var Io={start:"end",end:"start"};function Oo(e){return e.replace(/start|end/g,function(e){return Io[e]})}function Po(e){var t=to(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Do(e){return fo(bo(e)).left+Po(e).scrollLeft}function Lo(e){var t=mo(e),r=t.overflow,n=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+n)}function Bo(e){return["html","body","#document"].indexOf(eo(e))>=0?e.ownerDocument.body:no(e)&&Lo(e)?e:Bo(vo(e))}function Fo(e,t){var r;void 0===t&&(t=[]);var n=Bo(e),o=n===(null==(r=e.ownerDocument)?void 0:r.body),a=to(n),i=o?[a].concat(a.visualViewport||[],Lo(n)?n:[]):n,s=t.concat(i);return o?s:s.concat(Fo(vo(i)))}function Mo(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Wo(e,t,r){return t===Xn?Mo(function(e,t){var r=to(e),n=bo(e),o=r.visualViewport,a=n.clientWidth,i=n.clientHeight,s=0,l=0;if(o){a=o.width,i=o.height;var c=uo();(c||!c&&"fixed"===t)&&(s=o.offsetLeft,l=o.offsetTop)}return{width:a,height:i,x:s+Do(e),y:l}}(e,r)):ro(t)?function(e,t){var r=fo(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):Mo(function(e){var t,r=bo(e),n=Po(e),o=null==(t=e.ownerDocument)?void 0:t.body,a=so(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=so(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-n.scrollLeft+Do(e),l=-n.scrollTop;return"rtl"===mo(o||r).direction&&(s+=so(r.clientWidth,o?o.clientWidth:0)-a),{width:a,height:i,x:s,y:l}}(bo(e)))}function Uo(e,t,r,n){var o="clippingParents"===t?function(e){var t=Fo(vo(e)),r=["absolute","fixed"].indexOf(mo(e).position)>=0&&no(e)?jo(e):e;return ro(r)?t.filter(function(e){return ro(e)&&go(e,r)&&"body"!==eo(e)}):[]}(e):[].concat(t),a=[].concat(o,[r]),i=a[0],s=a.reduce(function(t,r){var o=Wo(e,r,n);return t.top=so(o.top,t.top),t.right=lo(o.right,t.right),t.bottom=lo(o.bottom,t.bottom),t.left=so(o.left,t.left),t},Wo(e,i,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Ho(e){var t,r=e.reference,n=e.element,o=e.placement,a=o?io(o):null,i=o?Eo(o):null,s=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(a){case Wn:t={x:s,y:r.y-n.height};break;case Un:t={x:s,y:r.y+r.height};break;case Hn:t={x:r.x+r.width,y:l};break;case Vn:t={x:r.x-n.width,y:l};break;default:t={x:r.x,y:r.y}}var c=a?_o(a):null;if(null!=c){var d="y"===c?"height":"width";switch(i){case $n:t[c]=t[c]-(r[d]/2-n[d]/2);break;case qn:t[c]=t[c]+(r[d]/2-n[d]/2)}}return t}function Vo(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=void 0===n?e.placement:n,a=r.strategy,i=void 0===a?e.strategy:a,s=r.boundary,l=void 0===s?"clippingParents":s,c=r.rootBoundary,d=void 0===c?Xn:c,p=r.elementContext,u=void 0===p?Kn:p,f=r.altBoundary,h=void 0!==f&&f,g=r.padding,m=void 0===g?0:g,x=wo("number"!==typeof m?m:ko(m,Yn)),b=u===Kn?"reference":Kn,v=e.rects.popper,y=e.elements[h?b:u],j=Uo(ro(y)?y:y.contextElement||bo(e.elements.popper),l,d,i),_=fo(e.elements.reference),S=Ho({reference:_,element:v,strategy:"absolute",placement:o}),w=Mo(Object.assign({},v,S)),k=u===Kn?w:_,C={top:j.top-k.top+x.top,bottom:k.bottom-j.bottom+x.bottom,left:j.left-k.left+x.left,right:k.right-j.right+x.right},E=e.modifiersData.offset;if(u===Kn&&E){var T=E[o];Object.keys(C).forEach(function(e){var t=[Hn,Un].indexOf(e)>=0?1:-1,r=[Wn,Un].indexOf(e)>=0?"y":"x";C[e]+=T[r]*t})}return C}function Go(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=r.boundary,a=r.rootBoundary,i=r.padding,s=r.flipVariations,l=r.allowedAutoPlacements,c=void 0===l?Qn:l,d=Eo(n),p=d?s?Jn:Jn.filter(function(e){return Eo(e)===d}):Yn,u=p.filter(function(e){return c.indexOf(e)>=0});0===u.length&&(u=p);var f=u.reduce(function(t,r){return t[r]=Vo(e,{placement:r,boundary:o,rootBoundary:a,padding:i})[io(r)],t},{});return Object.keys(f).sort(function(e,t){return f[e]-f[t]})}var Yo={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var o=r.mainAxis,a=void 0===o||o,i=r.altAxis,s=void 0===i||i,l=r.fallbackPlacements,c=r.padding,d=r.boundary,p=r.rootBoundary,u=r.altBoundary,f=r.flipVariations,h=void 0===f||f,g=r.allowedAutoPlacements,m=t.options.placement,x=io(m),b=l||(x===m||!h?[zo(m)]:function(e){if(io(e)===Gn)return[];var t=zo(e);return[Oo(e),t,Oo(t)]}(m)),v=[m].concat(b).reduce(function(e,r){return e.concat(io(r)===Gn?Go(t,{placement:r,boundary:d,rootBoundary:p,padding:c,flipVariations:h,allowedAutoPlacements:g}):r)},[]),y=t.rects.reference,j=t.rects.popper,_=new Map,S=!0,w=v[0],k=0;k<v.length;k++){var C=v[k],E=io(C),T=Eo(C)===$n,R=[Wn,Un].indexOf(E)>=0,N=R?"width":"height",A=Vo(t,{placement:C,boundary:d,rootBoundary:p,altBoundary:u,padding:c}),z=R?T?Hn:Vn:T?Un:Wn;y[N]>j[N]&&(z=zo(z));var I=zo(z),O=[];if(a&&O.push(A[E]<=0),s&&O.push(A[z]<=0,A[I]<=0),O.every(function(e){return e})){w=C,S=!1;break}_.set(C,O)}if(S)for(var P=function(e){var t=v.find(function(t){var r=_.get(t);if(r)return r.slice(0,e).every(function(e){return e})});if(t)return w=t,"break"},D=h?3:1;D>0;D--){if("break"===P(D))break}t.placement!==w&&(t.modifiersData[n]._skip=!0,t.placement=w,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function $o(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function qo(e){return[Wn,Hn,Un,Vn].some(function(t){return e[t]>=0})}var Xo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.offset,a=void 0===o?[0,0]:o,i=Qn.reduce(function(e,r){return e[r]=function(e,t,r){var n=io(e),o=[Vn,Wn].indexOf(n)>=0?-1:1,a="function"===typeof r?r(Object.assign({},t,{placement:e})):r,i=a[0],s=a[1];return i=i||0,s=(s||0)*o,[Vn,Hn].indexOf(n)>=0?{x:s,y:i}:{x:i,y:s}}(r,t.rects,a),e},{}),s=i[t.placement],l=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=i}};var Ko={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.mainAxis,a=void 0===o||o,i=r.altAxis,s=void 0!==i&&i,l=r.boundary,c=r.rootBoundary,d=r.altBoundary,p=r.padding,u=r.tether,f=void 0===u||u,h=r.tetherOffset,g=void 0===h?0:h,m=Vo(t,{boundary:l,rootBoundary:c,padding:p,altBoundary:d}),x=io(t.placement),b=Eo(t.placement),v=!b,y=_o(x),j="x"===y?"y":"x",_=t.modifiersData.popperOffsets,S=t.rects.reference,w=t.rects.popper,k="function"===typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,C="number"===typeof k?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),E=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(_){if(a){var R,N="y"===y?Wn:Vn,A="y"===y?Un:Hn,z="y"===y?"height":"width",I=_[y],O=I+m[N],P=I-m[A],D=f?-w[z]/2:0,L=b===$n?S[z]:w[z],B=b===$n?-w[z]:-S[z],F=t.elements.arrow,M=f&&F?ho(F):{width:0,height:0},W=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=W[N],H=W[A],V=So(0,S[z],M[z]),G=v?S[z]/2-D-V-U-C.mainAxis:L-V-U-C.mainAxis,Y=v?-S[z]/2+D+V+H+C.mainAxis:B+V+H+C.mainAxis,$=t.elements.arrow&&jo(t.elements.arrow),q=$?"y"===y?$.clientTop||0:$.clientLeft||0:0,X=null!=(R=null==E?void 0:E[y])?R:0,K=I+Y-X,J=So(f?lo(O,I+G-X-q):O,I,f?so(P,K):P);_[y]=J,T[y]=J-I}if(s){var Q,Z="x"===y?Wn:Vn,ee="x"===y?Un:Hn,te=_[j],re="y"===j?"height":"width",ne=te+m[Z],oe=te-m[ee],ae=-1!==[Wn,Vn].indexOf(x),ie=null!=(Q=null==E?void 0:E[j])?Q:0,se=ae?ne:te-S[re]-w[re]-ie+C.altAxis,le=ae?te+S[re]+w[re]-ie-C.altAxis:oe,ce=f&&ae?function(e,t,r){var n=So(e,t,r);return n>r?r:n}(se,te,le):So(f?se:ne,te,f?le:oe);_[j]=ce,T[j]=ce-te}t.modifiersData[n]=T}},requiresIfExists:["offset"]};function Jo(e,t,r){void 0===r&&(r=!1);var n=no(t),o=no(t)&&function(e){var t=e.getBoundingClientRect(),r=co(t.width)/e.offsetWidth||1,n=co(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),a=bo(t),i=fo(e,o,r),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&(("body"!==eo(t)||Lo(a))&&(s=function(e){return e!==to(e)&&no(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:Po(e);var t}(t)),no(t)?((l=fo(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):a&&(l.x=Do(a))),{x:i.left+s.scrollLeft-l.x,y:i.top+s.scrollTop-l.y,width:i.width,height:i.height}}function Qo(e){var t=new Map,r=new Set,n=[];function o(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!r.has(e)){var n=t.get(e);n&&o(n)}}),n.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){r.has(e.name)||o(e)}),n}function Zo(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}var ea={placement:"bottom",modifiers:[],strategy:"absolute"};function ta(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(e){return!(e&&"function"===typeof e.getBoundingClientRect)})}function ra(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,o=t.defaultOptions,a=void 0===o?ea:o;return function(e,t,r){void 0===r&&(r=a);var o={placement:"bottom",orderedModifiers:[],options:Object.assign({},ea,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},i=[],s=!1,l={state:o,setOptions:function(r){var s="function"===typeof r?r(o.options):r;c(),o.options=Object.assign({},a,o.options,s),o.scrollParents={reference:ro(e)?Fo(e):e.contextElement?Fo(e.contextElement):[],popper:Fo(t)};var d=function(e){var t=Qo(e);return Zn.reduce(function(e,r){return e.concat(t.filter(function(e){return e.phase===r}))},[])}(function(e){var t=e.reduce(function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(n,o.options.modifiers)));return o.orderedModifiers=d.filter(function(e){return e.enabled}),o.orderedModifiers.forEach(function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,a=e.effect;if("function"===typeof a){var s=a({state:o,name:t,instance:l,options:n}),c=function(){};i.push(s||c)}}),l.update()},forceUpdate:function(){if(!s){var e=o.elements,t=e.reference,r=e.popper;if(ta(t,r)){o.rects={reference:Jo(t,jo(r),"fixed"===o.options.strategy),popper:ho(r)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach(function(e){return o.modifiersData[e.name]=Object.assign({},e.data)});for(var n=0;n<o.orderedModifiers.length;n++)if(!0!==o.reset){var a=o.orderedModifiers[n],i=a.fn,c=a.options,d=void 0===c?{}:c,p=a.name;"function"===typeof i&&(o=i({state:o,options:d,name:p,instance:l})||o)}else o.reset=!1,n=-1}}},update:Zo(function(){return new Promise(function(e){l.forceUpdate(),e(o)})}),destroy:function(){c(),s=!0}};if(!ta(e,t))return l;function c(){i.forEach(function(e){return e()}),i=[]}return l.setOptions(r).then(function(e){!s&&r.onFirstUpdate&&r.onFirstUpdate(e)}),l}}var na,oa,aa=ra({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,o=n.scroll,a=void 0===o||o,i=n.resize,s=void 0===i||i,l=to(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&c.forEach(function(e){e.addEventListener("scroll",r.update,No)}),s&&l.addEventListener("resize",r.update,No),function(){a&&c.forEach(function(e){e.removeEventListener("scroll",r.update,No)}),s&&l.removeEventListener("resize",r.update,No)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=Ho({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,o=void 0===n||n,a=r.adaptive,i=void 0===a||a,s=r.roundOffsets,l=void 0===s||s,c={placement:io(t.placement),variation:Eo(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Ro(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Ro(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},ao,Xo,Yo,Ko,Co,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,i=Vo(t,{elementContext:"reference"}),s=Vo(t,{altBoundary:!0}),l=$o(i,n),c=$o(s,o,a),d=qo(l),p=qo(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}}]}),ia=function(e){var t=e.rtl,r=e.level,n=e.collapsed,o=e.disabled,a=e.active;return"\n    display: flex;\n    align-items: center;\n    height: 50px;\n    text-decoration: none;\n    color: inherit;\n    box-sizing: border-box;\n    cursor: pointer;\n\n    ".concat(t?"padding-left: 20px;\n           padding-right: ".concat(0===r?20:20*(n?r:r+1),"px;\n            "):"padding-right: 20px;\n           padding-left: ".concat(0===r?20:20*(n?r:r+1),"px;\n           "),"\n\n    &:hover {\n      background-color: #f3f3f3;\n    }\n\n    ").concat(o&&" \n      pointer-events: none;\n      cursor: default;\n      color:#adadad;\n        ","\n\n    ").concat(a&&"background-color: #e2eef9;","\n  \n  ")},sa=o.forwardRef(function(e,t){var r=e.className,n=e.component,a=e.children,i=qe(e,["className","component","children"]);if(n){if("string"===typeof n)return o.createElement(n,$e($e({className:qr(r)},i),{ref:t}),a);var s=n.props,l=s.className,c=qe(s,["className"]);return o.cloneElement(n,$e($e($e({className:qr(r,l)},i),c),{ref:t}),a)}return o.createElement("a",$e({ref:t,className:qr(r)},i),a)}),la=Ar.li(na||(na=Xe(["\n  position: relative;\n  width: 100%;\n\n  ",";\n\n  ",";\n\n  > ."," {\n    ",";\n\n    ",";\n  }\n"],["\n  position: relative;\n  width: 100%;\n\n  ",";\n\n  ",";\n\n  > ."," {\n    ",";\n\n    ",";\n  }\n"])),function(e){return e.menuItemStyles},function(e){return e.rootStyles},cn,function(e){var t=e.level,r=e.disabled,n=e.active,o=e.collapsed,a=e.rtl;return ia({level:t,disabled:r,active:n,collapsed:o,rtl:a})},function(e){return e.buttonStyles}),ca=(o.forwardRef(function(e,t){var r,n=e.children,a=e.className,i=e.label,s=e.icon,l=e.title,c=e.prefix,d=e.suffix,p=e.open,u=e.defaultOpen,f=e.active,h=void 0!==f&&f,g=e.disabled,m=void 0!==g&&g,x=e.rootStyles,b=e.component,v=e.onOpenChange,y=e.onClick,j=e.onKeyUp,_=qe(e,["children","className","label","icon","title","prefix","suffix","open","defaultOpen","active","disabled","rootStyles","component","onOpenChange","onClick","onKeyUp"]),S=o.useContext(Rn),w=o.useContext(wn),k=w.collapsed,C=w.rtl,E=w.transitionDuration,T=An(),R=T.renderExpandIcon,N=T.closeOnClick,A=T.menuItemStyles,z=T.transitionDuration,I=o.useState(!!u),O=I[0],P=I[1],D=o.useState(!1),L=D[0],B=D[1],F=o.useState(!1),M=F[0],W=F[1],U=o.useRef(null),H=o.useRef(null),V=o.useRef(),G=function(e){var t=e.level,r=e.buttonRef,n=e.contentRef,a=o.useContext(wn),i=a.collapsed,s=a.toggled,l=a.transitionDuration,c=o.useRef();return o.useEffect(function(){return 0===t&&i&&n.current&&r.current&&(c.current=aa(r.current,n.current,{placement:"right",strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,5]}}]})),function(){var e;return null===(e=c.current)||void 0===e?void 0:e.destroy()}},[t,i,n,r]),o.useEffect(function(){if(n.current&&r.current){var e=new ResizeObserver(function(){var e;null===(e=c.current)||void 0===e||e.update()});e.observe(n.current),e.observe(r.current)}setTimeout(function(){var e;null===(e=c.current)||void 0===e||e.update()},l)},[l,s,n,r]),{popperInstance:c.current}}({level:S,buttonRef:U,contentRef:H}).popperInstance,Y=o.useCallback(function(){var e,t=H.current;if(t){var r=null===(e=null===t||void 0===t?void 0:t.querySelector(".".concat(hn," > ul")))||void 0===e?void 0:e.clientHeight;t.style.overflow="hidden",t.style.height="".concat(r,"px"),V.current=setTimeout(function(){t.style.overflow="auto",t.style.height="auto"},z)}},[z]),$=function(){var e,t=H.current;if(t){var r=null===(e=null===t||void 0===t?void 0:t.querySelector(".".concat(hn," > ul")))||void 0===e?void 0:e.clientHeight;t.style.overflow="hidden",t.style.height="".concat(r,"px"),t.offsetHeight,t.style.height="0px"}},q=function(){0===S&&k||("undefined"===typeof p?(clearTimeout(Number(V.current)),O?$():Y(),null===v||void 0===v||v(!O),P(!O)):null===v||void 0===v||v(!p))};o.useEffect(function(){0===S&&k||"undefined"===typeof p||!M||(clearTimeout(Number(V.current)),p?Y():$())},[k,Y,i,S,v,p]);var X=function(e){if(A){var t={level:S,disabled:m,active:h,isSubmenu:!0,open:null!==p&&void 0!==p?p:O},r=A.root,n=A.button,o=A.label,a=A.icon,i=A.prefix,s=A.suffix,l=A.subMenuContent,c=A.SubMenuExpandIcon;switch(e){case"root":return"function"===typeof r?r(t):r;case"button":return"function"===typeof n?n(t):n;case"label":return"function"===typeof o?o(t):o;case"icon":return"function"===typeof a?a(t):a;case"prefix":return"function"===typeof i?i(t):i;case"suffix":return"function"===typeof s?s(t):s;case"SubMenuExpandIcon":return"function"===typeof c?c(t):c;case"subMenuContent":return"function"===typeof l?l(t):l;default:return}}};o.useEffect(function(){setTimeout(function(){return null===G||void 0===G?void 0:G.update()},E),k&&0===S&&B(!1)},[k,S,C,E,G]),o.useEffect(function(){var e=function(e){var t,r,n;!L&&(null===(t=U.current)||void 0===t?void 0:t.contains(e))?B(!0):(N&&!(null===(r=e.closest(".".concat(sn)))||void 0===r?void 0:r.classList.contains(ln))||!(null===(n=H.current)||void 0===n?void 0:n.contains(e))&&L)&&B(!1)},t=function(t){e(t.target)},r=function(t){"Enter"===t.key?e(t.target):"Escape"===t.key&&B(!1)},n=function(){document.removeEventListener("click",t),document.removeEventListener("keyup",r)};return n(),k&&0===S&&(document.addEventListener("click",t,!1),document.addEventListener("keyup",r,!1)),function(){n()}},[k,S,N,L]),o.useEffect(function(){W(!0)},[]);var K=((r={})[xn]=h,r[mn]=m,r[bn]=null!==p&&void 0!==p?p:O,r);return o.createElement(la,{ref:t,className:qr(sn,ln,K,a),menuItemStyles:X("root"),level:S,collapsed:k,rtl:C,disabled:m,active:h,buttonStyles:X("button"),rootStyles:x},o.createElement(sa,$e({"data-testid":"".concat(cn,"-test-id"),ref:U,title:l,className:qr(cn,K),onClick:function(e){null===y||void 0===y||y(e),q()},onKeyUp:function(e){null===j||void 0===j||j(e),"Enter"===e.key&&q()},component:b,tabIndex:0},_),s&&o.createElement(Pn,{rtl:C,className:qr(fn,K),rootStyles:X("icon")},s),c&&o.createElement(Dn,{collapsed:k,transitionDuration:E,firstLevel:0===S,className:qr(dn,K),rtl:C,rootStyles:X("prefix")},c),o.createElement(On,{className:qr(un,K),rootStyles:X("label")},i),d&&o.createElement(Ln,{collapsed:k,transitionDuration:E,firstLevel:0===S,className:qr(pn,K),rootStyles:X("suffix")},d),o.createElement(Bn,{rtl:C,className:qr(gn,K),collapsed:k,level:S,rootStyles:X("SubMenuExpandIcon")},R?R({level:S,disabled:m,active:h,open:null!==p&&void 0!==p?p:O}):k&&0===S?o.createElement(Mn,null):o.createElement(Fn,{rtl:C,open:null!==p&&void 0!==p?p:O}))),o.createElement(In,{ref:H,openWhenCollapsed:L,open:null!==p&&void 0!==p?p:O,firstLevel:0===S,collapsed:k,defaultOpen:p&&!M||u,className:qr(hn,K),rootStyles:X("subMenuContent")},o.createElement(Rn.Provider,{value:S+1},n)))}),Ar.li(oa||(oa=Xe(["\n  width: 100%;\n  position: relative;\n\n  ",";\n\n  ",";\n\n  > ."," {\n    ",";\n\n    ",";\n  }\n"],["\n  width: 100%;\n  position: relative;\n\n  ",";\n\n  ",";\n\n  > ."," {\n    ",";\n\n    ",";\n  }\n"])),function(e){return e.menuItemStyles},function(e){return e.rootStyles},cn,function(e){var t=e.level,r=e.disabled,n=e.active,o=e.collapsed,a=e.rtl;return ia({level:t,disabled:r,active:n,collapsed:o,rtl:a})},function(e){return e.buttonStyles})),da=o.forwardRef(function(e,t){var r,n=e.children,a=e.icon,i=e.className,s=e.prefix,l=e.suffix,c=e.active,d=void 0!==c&&c,p=e.disabled,u=void 0!==p&&p,f=e.component,h=e.rootStyles,g=qe(e,["children","icon","className","prefix","suffix","active","disabled","component","rootStyles"]),m=o.useContext(Rn),x=o.useContext(wn),b=x.collapsed,v=x.rtl,y=x.transitionDuration,j=An().menuItemStyles,_=function(e){if(j){var t={level:m,disabled:u,active:d,isSubmenu:!1},r=j.root,n=j.button,o=j.label,a=j.icon,i=j.prefix,s=j.suffix;switch(e){case"root":return"function"===typeof r?r(t):r;case"button":return"function"===typeof n?n(t):n;case"label":return"function"===typeof o?o(t):o;case"icon":return"function"===typeof a?a(t):a;case"prefix":return"function"===typeof i?i(t):i;case"suffix":return"function"===typeof s?s(t):s;default:return}}},S=((r={})[xn]=d,r[mn]=u,r);return o.createElement(ca,{ref:t,className:qr(sn,S,i),menuItemStyles:_("root"),level:m,collapsed:b,rtl:v,disabled:u,active:d,buttonStyles:_("button"),rootStyles:h},o.createElement(sa,$e({className:qr(cn,S),"data-testid":"".concat(cn,"-test-id"),component:f,tabIndex:0},g),a&&o.createElement(Pn,{rtl:v,className:qr(fn,S),rootStyles:_("icon")},a),s&&o.createElement(Dn,{collapsed:b,transitionDuration:y,firstLevel:0===m,className:qr(dn,S),rtl:v,rootStyles:_("prefix")},s),o.createElement(On,{className:qr(un,S),rootStyles:_("label")},n),l&&o.createElement(Ln,{collapsed:b,transitionDuration:y,firstLevel:0===m,className:qr(pn,S),rootStyles:_("suffix")},l)))});const pa=e=>{let{seleccionado:t,onSelect:r,onCollapsedChange:n,proyecto:a,user:i}=e;const[s,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)({carpetas:!0,control_proyecto:!1}),[p,u]=(0,o.useState)([]),[f,h]=(0,o.useState)(new Set),[g,m]=(0,o.useState)(!1),{selectedProject:x}=Ve(),b=i||JSON.parse(localStorage.getItem("user"))||null,v=a||x;(0,o.useEffect)(()=>{v&&v.proyecto_id&&y()},[v,b]);const y=async()=>{m(!0);try{const e=new URLSearchParams({proyecto_id:v.proyecto_id,todas:"1"});b&&b.id&&e.append("usuario_id",b.id);const t=await fetch("".concat(Te,"/archivos/carpetas.php?").concat(e)),r=await t.json();u(Array.isArray(r)?r:[])}catch(e){console.error("Error cargando carpetas:",e),u([])}m(!1)},j=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map(e=>{const o=e.hijos&&e.hijos.length>0,a=f.has(e.id),i=16*n,l=t==="carpeta_".concat(e.id);return(0,ze.jsxs)("div",{style:{position:"relative"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 8px",margin:"1px 6px",borderRadius:"4px",cursor:"pointer",backgroundColor:l?"#F2A900":"transparent",color:l?"#1a2235":"#fff",fontSize:"13px",paddingLeft:"".concat(8+i,"px"),transition:"all 0.15s ease",minHeight:"28px"},onMouseEnter:e=>{l||(e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)")},onMouseLeave:e=>{l||(e.currentTarget.style.backgroundColor="transparent")},onClick:()=>r("carpeta_".concat(e.id)),children:[(0,ze.jsx)("div",{onClick:t=>{var r;t.stopPropagation(),o&&(r=e.id,h(e=>{const t=new Set(e);return t.has(r)?t.delete(r):t.add(r),t}))},style:{width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"4px",cursor:o?"pointer":"default",flexShrink:0},children:o?(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(a?"down":"right"),style:{fontSize:"9px",color:l?"#1a2235":"#F2A900"}}):(0,ze.jsx)("span",{style:{width:"9px",display:"inline-block"}})}),(0,ze.jsx)("i",{className:"fa ".concat(a&&o?"fa-folder-open":"fa-folder"),style:{marginRight:"6px",fontSize:"14px",color:l?"#1a2235":"#F2A900",flexShrink:0}}),(0,ze.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,fontWeight:l?"600":"400"},title:e.descripcion||e.nombre,children:e.nombre}),e.cantidad_archivos>0&&(0,ze.jsxs)("span",{style:{marginLeft:"6px",fontSize:"10px",color:l?"rgba(26, 34, 53, 0.7)":"rgba(255,255,255,0.6)",flexShrink:0},children:["(",e.cantidad_archivos,")"]})]}),o&&a&&!s&&(0,ze.jsxs)("div",{style:{position:"relative"},children:[0===n&&(0,ze.jsx)("div",{style:{position:"absolute",left:"".concat(8+i+8,"px"),top:0,bottom:0,width:"1px",backgroundColor:"rgba(255, 255, 255, 0.1)",pointerEvents:"none"}}),j(e.hijos,n+1)]})]},e.id)})},_=e=>{d(t=>Ue(Ue({},t),{},{[e]:!t[e]}))};return o.useEffect(()=>{n&&n(s)},[s,n]),(0,ze.jsxs)(kn,{breakPoint:"md",backgroundColor:"rgba(0, 43, 127, 0.92)",collapsed:s,rootStyles:{height:"calc(100vh - 51px)",top:"51px",left:"0",right:"unset",position:"fixed",zIndex:100,width:s?"52px":"260px",minWidth:s?"52px":"260px",maxWidth:s?"52px":"260px",borderRight:"6px solid #F2A900"},children:[(0,ze.jsx)("button",{onClick:()=>l(!s),className:"sidebar-toggle-btn",style:{position:"absolute",top:10,right:8,background:"none",border:"none",color:"#FFD000",fontSize:20,cursor:"pointer",zIndex:1100,padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",fontWeight:"bold"},title:s?"Expandir men\xfa":"Minimizar men\xfa",children:s?"\u25b6":"\u25c0"}),(0,ze.jsxs)(Nn,{menuItemStyles:{button:e=>{let{active:t,disabled:r}=e;return{backgroundColor:t?"#F2A900":r?"#d1d5db":"transparent",color:t?"#1a2235":r?"#222":"#fff",fontWeight:t?"600":"500",borderRadius:"5px",margin:"2px 8px",padding:"11px 12px",transition:"all 0.18s ease",fontSize:"14px",marginTop:"32px",whiteSpace:"nowrap",overflow:"visible",textOverflow:"clip"}},hover:e=>{let{disabled:t}=e;return{backgroundColor:t?"#b0b0b0":"rgba(255, 255, 255, 0.1)",color:t?"#222":"#F2A900",fontWeight:"600"}},icon:e=>{let{active:t,disabled:r,hovered:n}=e;return{color:t?"#1a2235":r?n?"#222":"#b0b0b0":"#F2A900",fontSize:"16px",marginRight:"10px",flexShrink:0}}},children:[(0,ze.jsx)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-chart-line"}),active:"dashboard"===t,onClick:()=>r("dashboard"),style:{margin:"2px 6px",padding:"11px 16px",cursor:"pointer"},children:"Dashboard"})}),(0,ze.jsxs)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-folder-open"}),onClick:()=>_("carpetas"),style:{margin:"2px 6px",padding:"11px 16px",cursor:"pointer"},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,ze.jsx)("span",{children:"Gesti\xf3n de Archivos"}),(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(c.carpetas?"up":"down"),style:{fontSize:"12px",marginLeft:"8px"}})]})}),c.carpetas&&!s&&(0,ze.jsxs)("div",{style:{paddingLeft:"0px"},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-folder-open"}),active:"gestor_archivos"===t,onClick:()=>r("gestor_archivos"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Todas las Carpetas"}),g?(0,ze.jsx)("div",{style:{padding:"8px 16px",fontSize:"11px",color:"rgba(255,255,255,0.7)"},children:"Cargando..."}):(0,ze.jsx)("div",{style:{maxHeight:"calc(100vh - 400px)",overflowY:"auto",overflowX:"hidden"},children:j((()=>{const e=new Map,t=[];p.forEach(t=>{e.set(t.id,Ue(Ue({},t),{},{hijos:[]}))}),p.forEach(r=>{if(null===r.carpeta_padre_id||0===r.carpeta_padre_id)t.push(e.get(r.id));else{const t=e.get(r.carpeta_padre_id);t&&t.hijos.push(e.get(r.id))}});const r=e=>{e.hijos&&e.hijos.length>0&&(e.hijos.sort((e,t)=>e.nombre.localeCompare(t.nombre)),e.hijos.forEach(r))};return t.forEach(r),t.sort((e,t)=>e.nombre.localeCompare(t.nombre)),t})())})]})]}),(0,ze.jsxs)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-folder"}),onClick:()=>_("control_proyecto"),style:{margin:"2px 6px",padding:"11px 16px",cursor:"pointer"},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,ze.jsx)("span",{children:"Control Proyecto"}),(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(c.control_proyecto?"up":"down"),style:{fontSize:"12px",marginLeft:"8px"}})]})}),c.control_proyecto&&!s&&(0,ze.jsxs)("div",{style:{paddingLeft:"20px"},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-tasks"}),active:"control_tareas"===t,onClick:()=>r("control_tareas"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Control de Tareas (Gantt)"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-comments"}),active:"resumen_comentarios"===t,onClick:()=>r("resumen_comentarios"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Resumen de Comentarios"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-sitemap"}),active:"arbol_carpetas"===t,onClick:()=>r("arbol_carpetas"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"\xc1rbol de Carpetas"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-chalkboard-teacher"}),active:"presentaciones_staff"===t,onClick:()=>r("presentaciones_staff"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Presentaciones Staff"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-chart-line"}),active:"informes_stockholders"===t,onClick:()=>r("informes_stockholders"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Informes Stockholders"})]})]})]})]})},ua=e=>{let{proyectoId:t,user:r,sidebarCollapsed:n}=e;const[a,i]=(0,o.useState)([]),[s,l]=(0,o.useState)({}),[c,d]=(0,o.useState)(new Set),[p,u]=(0,o.useState)(!0),[f,h]=(0,o.useState)(3);(0,o.useEffect)(()=>{t&&g()},[t,r]);const g=async()=>{u(!0);try{const e=new URLSearchParams({proyecto_id:t,todas:"1"});r&&r.id&&e.append("usuario_id",r.id);const n=await fetch("".concat(Te,"/archivos/carpetas.php?").concat(e)),o=await n.json(),a=Array.isArray(o)?o:[];i(a),await m(a)}catch(e){console.error("Error cargando carpetas:",e),i([])}u(!1)},m=async e=>{const t={};for(const n of e)try{const e=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php?carpeta_id=").concat(n.id));if(e.ok){const r=await e.json();t[n.id]=Array.isArray(r)?r:[]}}catch(r){console.error("Error cargando usuarios para carpeta ".concat(n.id,":"),r),t[n.id]=[]}l(t)},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=f)return null;const r=e.hijos&&e.hijos.length>0,n=c.has(e.id),o=s[e.id]||[],a=e.color_primario||"#0a6ebd";return(0,ze.jsxs)("div",{style:{marginBottom:"0.375rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.375rem",marginLeft:"".concat(1.5*t,"rem"),position:"relative"},children:[t>0&&(0,ze.jsx)("div",{style:{position:"absolute",left:"-1.125rem",top:"0",width:"1px",height:"100%",background:"linear-gradient(180deg, ".concat(a,"40 0%, ").concat(a,"20 100%)"),zIndex:0}}),t>0&&(0,ze.jsx)("div",{style:{position:"absolute",left:"-1.125rem",top:"0.875rem",width:"1.125rem",height:"1px",background:"".concat(a,"60"),zIndex:1}}),r&&(0,ze.jsx)("button",{onClick:()=>(e=>{const t=new Set(c);t.has(e)?t.delete(e):t.add(e),d(t)})(e.id),style:{width:"16px",height:"16px",borderRadius:"3px",border:"1px solid ".concat(a,"40"),background:n?"".concat(a,"15"):"transparent",color:a,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"8px",flexShrink:0,marginTop:"1px",transition:"all 0.2s ease",padding:0},onMouseEnter:e=>{e.target.style.background="".concat(a,"25"),e.target.style.borderColor=a},onMouseLeave:e=>{e.target.style.background=n?"".concat(a,"15"):"transparent",e.target.style.borderColor="".concat(a,"40")},children:(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(n?"down":"right")})}),!r&&(0,ze.jsx)("div",{style:{width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,ze.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:"".concat(a,"60")}})}),(0,ze.jsxs)("div",{style:{flex:1,background:"#ffffff",border:"1px solid ".concat(a,"30"),borderLeft:"3px solid ".concat(a),borderRadius:"6px",padding:"0.5rem 0.625rem",boxShadow:"0 1px 3px rgba(0,0,0,0.06)",transition:"all 0.2s ease",position:"relative",zIndex:2},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 2px 6px ".concat(a,"20"),e.currentTarget.style.borderColor="".concat(a,"50"),e.currentTarget.style.transform="translateX(2px)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.06)",e.currentTarget.style.borderColor="".concat(a,"30"),e.currentTarget.style.transform="translateX(0)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:o.length>0?"0.375rem":"0"},children:[(0,ze.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"4px",background:"".concat(a,"15"),display:"flex",alignItems:"center",justifyContent:"center",color:a,fontSize:"11px",flexShrink:0,border:"1px solid ".concat(a,"25")},children:(0,ze.jsx)("i",{className:"fa fa-folder"})}),(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#0a3265",marginBottom:e.descripcion?"1px":"0",lineHeight:"1.3"},children:e.nombre}),e.descripcion&&(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#6c757d",lineHeight:"1.2",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.descripcion})]})]}),o.length>0&&(0,ze.jsxs)("div",{style:{marginTop:"0.375rem",paddingTop:"0.375rem",borderTop:"1px solid ".concat(a,"15")},children:[(0,ze.jsxs)("div",{style:{fontSize:"9px",fontWeight:"600",color:"#6c757d",textTransform:"uppercase",letterSpacing:"0.3px",marginBottom:"0.375rem",display:"flex",alignItems:"center",gap:"3px"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{fontSize:"8px"}}),o.length," ",1===o.length?"participante":"participantes"]}),(0,ze.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:[o.slice(0,5).map(e=>(0,ze.jsxs)("div",{style:{padding:"0.125rem 0.375rem",background:"".concat(a,"10"),borderRadius:"8px",fontSize:"9px",color:a,fontWeight:"500",border:"1px solid ".concat(a,"20"),display:"flex",alignItems:"center",gap:"3px",lineHeight:"1.4"},title:"".concat(e.usuario_nombre," (").concat(e.usuario_email,")"),children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{fontSize:"7px"}}),(0,ze.jsx)("span",{style:{maxWidth:"80px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.usuario_nombre})]},e.id)),o.length>5&&(0,ze.jsxs)("div",{style:{padding:"0.125rem 0.375rem",background:"#f8f9fa",borderRadius:"8px",fontSize:"9px",color:"#6c757d",fontWeight:"500",border:"1px solid #e9ecef",display:"flex",alignItems:"center",gap:"3px"},children:["+",o.length-5]})]})]}),0===o.length&&(0,ze.jsx)("div",{style:{fontSize:"9px",color:"#adb5bd",fontStyle:"italic",marginTop:"0.25rem"},children:"Sin participantes"})]})]}),r&&n&&(0,ze.jsx)("div",{style:{marginTop:"0.375rem"},children:e.hijos.map(e=>x(e,t+1))})]},e.id)};if(p)return(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",marginBottom:"1rem"}}),(0,ze.jsx)("p",{children:"Cargando estructura de carpetas..."})]});const b=(()=>{const e=new Map,t=[];a.forEach(t=>{e.set(t.id,Ue(Ue({},t),{},{hijos:[]}))}),a.forEach(r=>{if(null===r.carpeta_padre_id||0===r.carpeta_padre_id)t.push(e.get(r.id));else{const t=e.get(r.carpeta_padre_id);t&&t.hijos.push(e.get(r.id))}});const r=e=>{e.hijos&&e.hijos.length>0&&(e.hijos.sort((e,t)=>e.nombre.localeCompare(t.nombre)),e.hijos.forEach(r))};return t.forEach(r),t.sort((e,t)=>e.nombre.localeCompare(t.nombre)),t})();return(0,ze.jsxs)("div",{style:{padding:"1.25rem",background:"#ffffff",minHeight:"100vh"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.25rem",paddingBottom:"0.875rem",borderBottom:"2px solid #e9ecef",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",bottom:"-2px",left:0,width:"50px",height:"2px",background:"linear-gradient(90deg, #0a6ebd 0%, #005288 100%)",borderRadius:"2px 2px 0 0"}}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[(0,ze.jsxs)("h1",{style:{margin:0,fontSize:"18px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px",letterSpacing:"-0.3px"},children:[(0,ze.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"6px",background:"linear-gradient(135deg, #0a6ebd15 0%, #0a6ebd08 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #0a6ebd20"},children:(0,ze.jsx)("i",{className:"fa fa-sitemap",style:{color:"#0a6ebd",fontSize:"14px"}})}),"Distribuci\xf3n de Carpetas"]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("label",{style:{fontSize:"11px",color:"#6c757d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Niveles:"}),(0,ze.jsxs)("select",{value:f,onChange:e=>h(parseInt(e.target.value)),style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #e9ecef",fontSize:"11px",color:"#495057",background:"white",cursor:"pointer",fontWeight:"500"},children:[(0,ze.jsx)("option",{value:1,children:"1"}),(0,ze.jsx)("option",{value:2,children:"2"}),(0,ze.jsx)("option",{value:3,children:"3"})]})]})]})]}),0===b.length?(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{fontSize:"2rem",marginBottom:"0.75rem",color:"#adb5bd"}}),(0,ze.jsx)("p",{style:{fontSize:"13px",margin:0},children:"No hay carpetas disponibles en este proyecto."})]}):(0,ze.jsx)("div",{style:{position:"relative",padding:"0.5rem 0"},children:b.map(e=>x(e,0))})]})},fa=e=>{let{proyectoId:t,sidebarCollapsed:r}=e;const[n,a]=(0,o.useState)([]),[i,s]=(0,o.useState)(!0),[l,c]=(0,o.useState)(!1),[d,p]=(0,o.useState)(null),[u,f]=(0,o.useState)({titulo:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],audiencia:"",presentador:"",tipo:"PowerPoint"});(0,o.useEffect)(()=>{h()},[t]);const h=()=>{s(!0),setTimeout(()=>{a([{id:1,titulo:"Avance Mensual - Octubre 2024",descripcion:"Presentaci\xf3n de avance f\xedsico y financiero del proyecto",fecha:"2024-10-25",audiencia:"Directorio",presentador:"Gerente de Proyecto",tipo:"PowerPoint",diapositivas:32,estado:"Presentado",portada:"/img/imagen_jej.jpg"},{id:2,titulo:"An\xe1lisis de Riesgos Q4",descripcion:"Identificaci\xf3n y mitigaci\xf3n de riesgos del cuarto trimestre",fecha:"2024-11-05",audiencia:"Staff T\xe9cnico",presentador:"Jefe de Control",tipo:"PDF",diapositivas:24,estado:"Programado",portada:"/img/muro.jpg"},{id:3,titulo:"Kick-off Meeting 2025",descripcion:"Presentaci\xf3n de planificaci\xf3n estrat\xe9gica para el a\xf1o 2025",fecha:"2024-12-15",audiencia:"Equipo Completo",presentador:"PMO",tipo:"PowerPoint",diapositivas:45,estado:"En Preparaci\xf3n",portada:"/img/fondo-codelco.png"}]),s(!1)},500)},g=e=>{switch(e){case"Presentado":return"#10b981";case"Programado":return"#3b82f6";case"En Preparaci\xf3n":return"#f59e0b";default:return"#6b7280"}},m=e=>{switch(e){case"PowerPoint":return"\ud83d\udcca";case"PDF":return"\ud83d\udcc4";case"Keynote":return"\ud83c\udfaf";default:return"\ud83d\udccb"}};return i?(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh",fontSize:"18px",color:"#0a3265"},children:"Cargando presentaciones..."}):(0,ze.jsxs)("div",{style:{padding:"2rem",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"10px",padding:"20px 24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",borderLeft:"4px solid #0a6ebd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:"0 0 6px 0",fontSize:"22px",fontWeight:"600",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-chalkboard-teacher",style:{color:"#0a6ebd"}}),"Presentaciones Staff"]}),(0,ze.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#718096"},children:"Gesti\xf3n de presentaciones ejecutivas y t\xe9cnicas del proyecto"})]}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(10, 110, 189, 0.3)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(10, 110, 189, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"}),"Nueva Presentaci\xf3n"]})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px",marginBottom:"24px"},children:n.map(e=>(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-6px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.15)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 12px rgba(0, 0, 0, 0.08)"},onClick:()=>p(e),children:[(0,ze.jsxs)("div",{style:{height:"160px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(e.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,ze.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:m(e.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"6px 14px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",color:g(e.estado)},children:e.estado})]}),(0,ze.jsxs)("div",{style:{padding:"16px"},children:[(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:"#2d3748",lineHeight:"1.3"},children:e.titulo}),(0,ze.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"13px",color:"#718096",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",fontSize:"12px",color:"#4a5568",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:new Date(e.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.audiencia})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.presentador})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-file-powerpoint",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsxs)("span",{children:[e.diapositivas," diapositivas"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("button",{onClick:e=>{e.stopPropagation(),alert("Funci\xf3n de descargar no implementada")},style:{flex:1,background:"#f0f9ff",color:"#0a6ebd",border:"none",padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsx)("button",{onClick:t=>{var r;t.stopPropagation(),r=e.id,window.confirm("\xbfEst\xe1s seguro de eliminar esta presentaci\xf3n?")&&a(n.filter(e=>e.id!==r))},style:{background:"#fef2f2",color:"#dc2626",border:"none",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#fee2e2",onMouseOut:e=>e.currentTarget.style.background="#fef2f2",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]})]},e.id))}),0===n.length&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"60px 40px",textAlign:"center",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.06)"},children:[(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"\ud83d\udcca"}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"20px",color:"#2d3748"},children:"No hay presentaciones registradas"}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#718096"},children:"Comienza agregando tu primera presentaci\xf3n del proyecto"}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"#0a6ebd",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"})," Crear Primera Presentaci\xf3n"]})]}),l&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>c(!1),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"540px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,ze.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:"Nueva Presentaci\xf3n"}),(0,ze.jsx)("button",{onClick:()=>c(!1),style:{background:"none",border:"none",fontSize:"24px",color:"#9ca3af",cursor:"pointer",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#374151"},onMouseOut:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#9ca3af"},children:"\xd7"})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"T\xedtulo de la Presentaci\xf3n *"}),(0,ze.jsx)("input",{type:"text",value:u.titulo,onChange:e=>f(Ue(Ue({},u),{},{titulo:e.target.value})),placeholder:"Ej: Avance Mensual Octubre 2024",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:u.descripcion,onChange:e=>f(Ue(Ue({},u),{},{descripcion:e.target.value})),placeholder:"Describe el contenido de la presentaci\xf3n...",rows:"3",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",resize:"vertical",fontFamily:"inherit",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Fecha *"}),(0,ze.jsx)("input",{type:"date",value:u.fecha,onChange:e=>f(Ue(Ue({},u),{},{fecha:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Tipo *"}),(0,ze.jsxs)("select",{value:u.tipo,onChange:e=>f(Ue(Ue({},u),{},{tipo:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"PowerPoint",children:"PowerPoint"}),(0,ze.jsx)("option",{value:"PDF",children:"PDF"}),(0,ze.jsx)("option",{value:"Keynote",children:"Keynote"}),(0,ze.jsx)("option",{value:"Google Slides",children:"Google Slides"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Audiencia *"}),(0,ze.jsx)("input",{type:"text",value:u.audiencia,onChange:e=>f(Ue(Ue({},u),{},{audiencia:e.target.value})),placeholder:"Ej: Directorio, Staff T\xe9cnico, Cliente",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Presentador *"}),(0,ze.jsx)("input",{type:"text",value:u.presentador,onChange:e=>f(Ue(Ue({},u),{},{presentador:e.target.value})),placeholder:"Nombre del presentador",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"32px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsx)("button",{onClick:()=>c(!1),style:{flex:1,padding:"12px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#e5e7eb",onMouseOut:e=>e.currentTarget.style.background="#f3f4f6",children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:()=>{const e=Ue(Ue({id:n.length+1},u),{},{diapositivas:0,estado:"En Preparaci\xf3n",portada:"/img/fondo-codelco.png"});a([...n,e]),c(!1),f({titulo:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],audiencia:"",presentador:"",tipo:"PowerPoint"})},disabled:!u.titulo||!u.fecha||!u.audiencia||!u.presentador,style:{flex:1,padding:"12px",background:u.titulo&&u.fecha&&u.audiencia&&u.presentador?"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)":"#d1d5db",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:u.titulo&&u.fecha&&u.audiencia&&u.presentador?"pointer":"not-allowed",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Crear Presentaci\xf3n"]})]})]})}),d&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>p(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"0",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{height:"200px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(d.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",padding:"24px"},children:[(0,ze.jsx)("button",{onClick:()=>p(null),style:{position:"absolute",top:"16px",right:"16px",background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"none",width:"40px",height:"40px",borderRadius:"50%",fontSize:"24px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"}),(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"12px"},children:m(d.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"8px 18px",borderRadius:"24px",fontSize:"13px",fontWeight:"600",color:g(d.estado)},children:d.estado})]}),(0,ze.jsxs)("div",{style:{padding:"32px"},children:[(0,ze.jsx)("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:d.titulo}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"15px",color:"#718096",lineHeight:"1.6"},children:d.descripcion}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"24px"},children:[(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Fecha"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",marginRight:"8px"}}),new Date(d.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Audiencia"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#0a6ebd",marginRight:"8px"}}),d.audiencia]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Presentador"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{color:"#0a6ebd",marginRight:"8px"}}),d.presentador]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Diapositivas"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-file-powerpoint",style:{color:"#0a6ebd",marginRight:"8px"}}),d.diapositivas," slides"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsxs)("button",{onClick:()=>alert("Funci\xf3n de visualizar no implementada"),style:{flex:1,padding:"14px",background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-eye"})," Ver Presentaci\xf3n"]}),(0,ze.jsx)("button",{onClick:()=>alert("Funci\xf3n de descargar no implementada"),style:{padding:"14px 20px",background:"#f0f9ff",color:"#0a6ebd",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]})]})]})})]})},ha=e=>{let{proyectoId:t,sidebarCollapsed:r}=e;const[n,a]=(0,o.useState)([]),[i,s]=(0,o.useState)(!0),[l,c]=(0,o.useState)(!1),[d,p]=(0,o.useState)(null),[u,f]=(0,o.useState)({titulo:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],periodo:"",destinatarios:"",tipo:"Ejecutivo"});(0,o.useEffect)(()=>{h()},[t]);const h=()=>{s(!0),setTimeout(()=>{a([{id:1,titulo:"Informe Trimestral Q3 2024",descripcion:"Resumen ejecutivo del desempe\xf1o financiero y operacional del tercer trimestre",fecha:"2024-09-30",periodo:"Q3 2024",destinatarios:"Accionistas, Board of Directors",tipo:"Ejecutivo",paginas:42,estado:"Publicado",portada:"/img/imagen_jej.jpg"},{id:2,titulo:"An\xe1lisis de Valor Ganado - Septiembre",descripcion:"Reporte t\xe9cnico de EVM con proyecciones y an\xe1lisis de tendencias",fecha:"2024-10-05",periodo:"Septiembre 2024",destinatarios:"Inversionistas, PMO",tipo:"T\xe9cnico",paginas:28,estado:"En Revisi\xf3n",portada:"/img/muro.jpg"},{id:3,titulo:"Estado del Proyecto - Noviembre 2024",descripcion:"Dashboard ejecutivo con KPIs principales y alertas cr\xedticas",fecha:"2024-11-10",periodo:"Noviembre 2024",destinatarios:"Stakeholders, Sponsors",tipo:"Ejecutivo",paginas:18,estado:"Borrador",portada:"/img/fondo-codelco.png"}]),s(!1)},500)},g=e=>{switch(e){case"Publicado":return"#10b981";case"En Revisi\xf3n":return"#f59e0b";default:return"#6b7280"}},m=e=>{switch(e){case"Ejecutivo":return"\ud83d\udcca";case"T\xe9cnico":return"\ud83d\udcc8";case"Financiero":return"\ud83d\udcb0";default:return"\ud83d\udcc4"}};return i?(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh",fontSize:"18px",color:"#0a3265"},children:"Cargando informes..."}):(0,ze.jsxs)("div",{style:{padding:"2rem",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"10px",padding:"20px 24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",borderLeft:"4px solid #0a6ebd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:"0 0 6px 0",fontSize:"22px",fontWeight:"600",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-file-chart-line",style:{color:"#0a6ebd"}}),"Informes Stockholders"]}),(0,ze.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#718096"},children:"Reportes ejecutivos y t\xe9cnicos para accionistas e inversionistas"})]}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(10, 110, 189, 0.3)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(10, 110, 189, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"}),"Nuevo Informe"]})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px",marginBottom:"24px"},children:n.map(e=>(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-6px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.15)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 12px rgba(0, 0, 0, 0.08)"},onClick:()=>p(e),children:[(0,ze.jsxs)("div",{style:{height:"160px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(e.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,ze.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:m(e.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"6px 14px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",color:g(e.estado)},children:e.estado})]}),(0,ze.jsxs)("div",{style:{padding:"16px"},children:[(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:"#2d3748",lineHeight:"1.3"},children:e.titulo}),(0,ze.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"13px",color:"#718096",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",fontSize:"12px",color:"#4a5568",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:new Date(e.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-clock",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.periodo})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.destinatarios})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-file-pdf",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsxs)("span",{children:[e.paginas," p\xe1ginas"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("button",{onClick:e=>{e.stopPropagation(),alert("Funci\xf3n de descargar no implementada")},style:{flex:1,background:"#f0f9ff",color:"#0a6ebd",border:"none",padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsx)("button",{onClick:t=>{var r;t.stopPropagation(),r=e.id,window.confirm("\xbfEst\xe1s seguro de eliminar este informe?")&&a(n.filter(e=>e.id!==r))},style:{background:"#fef2f2",color:"#dc2626",border:"none",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#fee2e2",onMouseOut:e=>e.currentTarget.style.background="#fef2f2",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]})]},e.id))}),0===n.length&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"60px 40px",textAlign:"center",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.06)"},children:[(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"\ud83d\udcca"}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"20px",color:"#2d3748"},children:"No hay informes registrados"}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#718096"},children:"Comienza agregando tu primer informe para stockholders"}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"#0a6ebd",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"})," Crear Primer Informe"]})]}),l&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>c(!1),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"540px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,ze.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:"Nuevo Informe"}),(0,ze.jsx)("button",{onClick:()=>c(!1),style:{background:"none",border:"none",fontSize:"24px",color:"#9ca3af",cursor:"pointer",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#374151"},onMouseOut:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#9ca3af"},children:"\xd7"})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"T\xedtulo del Informe *"}),(0,ze.jsx)("input",{type:"text",value:u.titulo,onChange:e=>f(Ue(Ue({},u),{},{titulo:e.target.value})),placeholder:"Ej: Informe Trimestral Q4 2024",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:u.descripcion,onChange:e=>f(Ue(Ue({},u),{},{descripcion:e.target.value})),placeholder:"Describe el contenido del informe...",rows:"3",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",resize:"vertical",fontFamily:"inherit",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Fecha *"}),(0,ze.jsx)("input",{type:"date",value:u.fecha,onChange:e=>f(Ue(Ue({},u),{},{fecha:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Tipo *"}),(0,ze.jsxs)("select",{value:u.tipo,onChange:e=>f(Ue(Ue({},u),{},{tipo:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"Ejecutivo",children:"Ejecutivo"}),(0,ze.jsx)("option",{value:"T\xe9cnico",children:"T\xe9cnico"}),(0,ze.jsx)("option",{value:"Financiero",children:"Financiero"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Periodo *"}),(0,ze.jsx)("input",{type:"text",value:u.periodo,onChange:e=>f(Ue(Ue({},u),{},{periodo:e.target.value})),placeholder:"Ej: Q4 2024, Noviembre 2024",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Destinatarios *"}),(0,ze.jsx)("input",{type:"text",value:u.destinatarios,onChange:e=>f(Ue(Ue({},u),{},{destinatarios:e.target.value})),placeholder:"Ej: Accionistas, Board of Directors",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"32px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsx)("button",{onClick:()=>c(!1),style:{flex:1,padding:"12px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#e5e7eb",onMouseOut:e=>e.currentTarget.style.background="#f3f4f6",children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:()=>{const e=Ue(Ue({id:n.length+1},u),{},{paginas:0,estado:"Borrador",portada:"/img/fondo-codelco.png"});a([...n,e]),c(!1),f({titulo:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],periodo:"",destinatarios:"",tipo:"Ejecutivo"})},disabled:!u.titulo||!u.fecha||!u.periodo||!u.destinatarios,style:{flex:1,padding:"12px",background:u.titulo&&u.fecha&&u.periodo&&u.destinatarios?"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)":"#d1d5db",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:u.titulo&&u.fecha&&u.periodo&&u.destinatarios?"pointer":"not-allowed",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Crear Informe"]})]})]})}),d&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>p(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"0",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{height:"200px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(d.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",padding:"24px"},children:[(0,ze.jsx)("button",{onClick:()=>p(null),style:{position:"absolute",top:"16px",right:"16px",background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"none",width:"40px",height:"40px",borderRadius:"50%",fontSize:"24px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"}),(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"12px"},children:m(d.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"8px 18px",borderRadius:"24px",fontSize:"13px",fontWeight:"600",color:g(d.estado)},children:d.estado})]}),(0,ze.jsxs)("div",{style:{padding:"32px"},children:[(0,ze.jsx)("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:d.titulo}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"15px",color:"#718096",lineHeight:"1.6"},children:d.descripcion}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"24px"},children:[(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Fecha"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",marginRight:"8px"}}),new Date(d.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Periodo"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-clock",style:{color:"#0a6ebd",marginRight:"8px"}}),d.periodo]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Destinatarios"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#0a6ebd",marginRight:"8px"}}),d.destinatarios]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"P\xe1ginas"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-file-pdf",style:{color:"#0a6ebd",marginRight:"8px"}}),d.paginas," p\xe1ginas"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsxs)("button",{onClick:()=>alert("Funci\xf3n de visualizar no implementada"),style:{flex:1,padding:"14px",background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-eye"})," Ver Informe"]}),(0,ze.jsx)("button",{onClick:()=>alert("Funci\xf3n de descargar no implementada"),style:{padding:"14px 20px",background:"#f0f9ff",color:"#0a6ebd",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]})]})]})})]})},ga=e=>{let{proyectoId:t,sidebarCollapsed:r}=e;const[n,a]=(0,o.useState)([]),[i,s]=(0,o.useState)(!0),[l,c]=(0,o.useState)(!1),[d,p]=(0,o.useState)(null),[u,f]=(0,o.useState)({codigo:"",nombre:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],disciplina:"Arquitectura",escala:"1:100",revision:"A"});(0,o.useEffect)(()=>{h()},[t]);const h=()=>{s(!0),setTimeout(()=>{a([{id:1,codigo:"ARQ-001",nombre:"Planta General - Nivel 1",descripcion:"Planta arquitect\xf3nica general del primer nivel con distribuci\xf3n de espacios",fecha:"2024-10-15",disciplina:"Arquitectura",escala:"1:100",revision:"C",estado:"Aprobado",formato:"DWG",portada:"/img/imagen_jej.jpg"},{id:2,codigo:"EST-012",nombre:"Estructura Fundaciones",descripcion:"Plano estructural de fundaciones y cimentaci\xf3n",fecha:"2024-10-20",disciplina:"Estructuras",escala:"1:50",revision:"B",estado:"En Revisi\xf3n",formato:"PDF",portada:"/img/muro.jpg"},{id:3,codigo:"INS-025",nombre:"Instalaciones El\xe9ctricas",descripcion:"Diagrama unifilar y distribuci\xf3n de tableros el\xe9ctricos",fecha:"2024-11-05",disciplina:"Instalaciones",escala:"1:75",revision:"A",estado:"Borrador",formato:"DWG",portada:"/img/fondo-codelco.png"}]),s(!1)},500)},g=e=>{switch(e){case"Aprobado":return"#10b981";case"En Revisi\xf3n":return"#f59e0b";case"Borrador":default:return"#6b7280";case"Rechazado":return"#ef4444"}},m=e=>{switch(e){case"Arquitectura":return"\ud83c\udfd7\ufe0f";case"Estructuras":return"\ud83d\udd29";case"Instalaciones":return"\u26a1";case"Mec\xe1nica":return"\u2699\ufe0f";default:return"\ud83d\udcd0"}};return i?(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh",fontSize:"18px",color:"#0a3265"},children:"Cargando planos..."}):(0,ze.jsxs)("div",{style:{padding:"2rem",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"10px",padding:"20px 24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",borderLeft:"4px solid #0a6ebd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:"0 0 6px 0",fontSize:"22px",fontWeight:"600",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-drafting-compass",style:{color:"#0a6ebd"}}),"Gesti\xf3n de Planos"]}),(0,ze.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#718096"},children:"Control documental de planos t\xe9cnicos y de ingenier\xeda"})]}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(10, 110, 189, 0.3)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(10, 110, 189, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"}),"Nuevo Plano"]})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px",marginBottom:"24px"},children:n.map(e=>(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-6px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.15)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 12px rgba(0, 0, 0, 0.08)"},onClick:()=>p(e),children:[(0,ze.jsxs)("div",{style:{height:"160px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(e.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,ze.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:m(e.disciplina)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"6px 14px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",color:g(e.estado)},children:e.estado})]}),(0,ze.jsxs)("div",{style:{padding:"16px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,ze.jsx)("span",{style:{background:"#f0f9ff",color:"#0a6ebd",padding:"4px 10px",borderRadius:"6px",fontSize:"11px",fontWeight:"700",letterSpacing:"0.5px"},children:e.codigo}),(0,ze.jsxs)("span",{style:{fontSize:"11px",color:"#6b7280",fontWeight:"600"},children:["Rev. ",e.revision]})]}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:"#2d3748",lineHeight:"1.3"},children:e.nombre}),(0,ze.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"13px",color:"#718096",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",fontSize:"12px",color:"#4a5568",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:new Date(e.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-layer-group",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.disciplina})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-ruler",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsxs)("span",{children:["Escala ",e.escala]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#0a6ebd",width:"14px"}}),(0,ze.jsx)("span",{children:e.formato})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("button",{onClick:e=>{e.stopPropagation(),alert("Funci\xf3n de descargar no implementada")},style:{flex:1,background:"#f0f9ff",color:"#0a6ebd",border:"none",padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsx)("button",{onClick:t=>{var r;t.stopPropagation(),r=e.id,window.confirm("\xbfEst\xe1s seguro de eliminar este plano?")&&a(n.filter(e=>e.id!==r))},style:{background:"#fef2f2",color:"#dc2626",border:"none",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#fee2e2",onMouseOut:e=>e.currentTarget.style.background="#fef2f2",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]})]},e.id))}),0===n.length&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"60px 40px",textAlign:"center",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.06)"},children:[(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"\ud83d\udcd0"}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"20px",color:"#2d3748"},children:"No hay planos registrados"}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#718096"},children:"Comienza agregando el primer plano t\xe9cnico del proyecto"}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"#0a6ebd",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"})," Crear Primer Plano"]})]}),l&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>c(!1),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"540px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,ze.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:"Nuevo Plano"}),(0,ze.jsx)("button",{onClick:()=>c(!1),style:{background:"none",border:"none",fontSize:"24px",color:"#9ca3af",cursor:"pointer",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#374151"},onMouseOut:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#9ca3af"},children:"\xd7"})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"16px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"C\xf3digo *"}),(0,ze.jsx)("input",{type:"text",value:u.codigo,onChange:e=>f(Ue(Ue({},u),{},{codigo:e.target.value})),placeholder:"ARQ-001",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Revisi\xf3n *"}),(0,ze.jsx)("input",{type:"text",value:u.revision,onChange:e=>f(Ue(Ue({},u),{},{revision:e.target.value})),placeholder:"A",maxLength:"2",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Nombre del Plano *"}),(0,ze.jsx)("input",{type:"text",value:u.nombre,onChange:e=>f(Ue(Ue({},u),{},{nombre:e.target.value})),placeholder:"Ej: Planta General - Nivel 1",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:u.descripcion,onChange:e=>f(Ue(Ue({},u),{},{descripcion:e.target.value})),placeholder:"Describe el contenido del plano...",rows:"3",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",resize:"vertical",fontFamily:"inherit",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#0a6ebd",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Fecha *"}),(0,ze.jsx)("input",{type:"date",value:u.fecha,onChange:e=>f(Ue(Ue({},u),{},{fecha:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Escala *"}),(0,ze.jsxs)("select",{value:u.escala,onChange:e=>f(Ue(Ue({},u),{},{escala:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"1:25",children:"1:25"}),(0,ze.jsx)("option",{value:"1:50",children:"1:50"}),(0,ze.jsx)("option",{value:"1:75",children:"1:75"}),(0,ze.jsx)("option",{value:"1:100",children:"1:100"}),(0,ze.jsx)("option",{value:"1:200",children:"1:200"}),(0,ze.jsx)("option",{value:"1:500",children:"1:500"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Disciplina *"}),(0,ze.jsxs)("select",{value:u.disciplina,onChange:e=>f(Ue(Ue({},u),{},{disciplina:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"Arquitectura",children:"Arquitectura"}),(0,ze.jsx)("option",{value:"Estructuras",children:"Estructuras"}),(0,ze.jsx)("option",{value:"Instalaciones",children:"Instalaciones"}),(0,ze.jsx)("option",{value:"Mec\xe1nica",children:"Mec\xe1nica"}),(0,ze.jsx)("option",{value:"Civil",children:"Civil"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"32px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsx)("button",{onClick:()=>c(!1),style:{flex:1,padding:"12px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#e5e7eb",onMouseOut:e=>e.currentTarget.style.background="#f3f4f6",children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:()=>{const e=Ue(Ue({id:n.length+1},u),{},{estado:"Borrador",formato:"DWG",portada:"/img/fondo-codelco.png"});a([...n,e]),c(!1),f({codigo:"",nombre:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],disciplina:"Arquitectura",escala:"1:100",revision:"A"})},disabled:!u.codigo||!u.nombre||!u.fecha,style:{flex:1,padding:"12px",background:u.codigo&&u.nombre&&u.fecha?"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)":"#d1d5db",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:u.codigo&&u.nombre&&u.fecha?"pointer":"not-allowed",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Crear Plano"]})]})]})}),d&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>p(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"0",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{height:"200px",background:"linear-gradient(135deg, rgba(10, 110, 189, 0.9), rgba(10, 50, 101, 0.95)), url(".concat(d.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",padding:"24px"},children:[(0,ze.jsx)("button",{onClick:()=>p(null),style:{position:"absolute",top:"16px",right:"16px",background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"none",width:"40px",height:"40px",borderRadius:"50%",fontSize:"24px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"}),(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"12px"},children:m(d.disciplina)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"8px 18px",borderRadius:"24px",fontSize:"13px",fontWeight:"600",color:g(d.estado)},children:d.estado})]}),(0,ze.jsxs)("div",{style:{padding:"32px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,ze.jsx)("span",{style:{background:"#f0f9ff",color:"#0a6ebd",padding:"6px 14px",borderRadius:"8px",fontSize:"13px",fontWeight:"700",letterSpacing:"0.5px"},children:d.codigo}),(0,ze.jsxs)("span",{style:{fontSize:"13px",color:"#6b7280",fontWeight:"600"},children:["Revisi\xf3n ",d.revision]})]}),(0,ze.jsx)("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:d.nombre}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"15px",color:"#718096",lineHeight:"1.6"},children:d.descripcion}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"24px"},children:[(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Fecha"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#0a6ebd",marginRight:"8px"}}),new Date(d.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Disciplina"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-layer-group",style:{color:"#0a6ebd",marginRight:"8px"}}),d.disciplina]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Escala"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-ruler",style:{color:"#0a6ebd",marginRight:"8px"}}),d.escala]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Formato"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#0a6ebd",marginRight:"8px"}}),d.formato]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsxs)("button",{onClick:()=>alert("Funci\xf3n de visualizar no implementada"),style:{flex:1,padding:"14px",background:"linear-gradient(135deg, #0a6ebd 0%, #0a3265 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-eye"})," Ver Plano"]}),(0,ze.jsx)("button",{onClick:()=>alert("Funci\xf3n de descargar no implementada"),style:{padding:"14px 20px",background:"#f0f9ff",color:"#0a6ebd",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#dbeafe",onMouseOut:e=>e.currentTarget.style.background="#f0f9ff",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]})]})]})})]})},ma=e=>{let{proyectoId:t,sidebarCollapsed:r}=e;const[n,a]=(0,o.useState)([]),[i,s]=(0,o.useState)(!0),[l,c]=(0,o.useState)(!1),[d,p]=(0,o.useState)(null),[u,f]=(0,o.useState)({codigo:"",nombre:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],tipo:"RCA",organismo:"",numero_resolucion:""});(0,o.useEffect)(()=>{h()},[t]);const h=()=>{s(!0),setTimeout(()=>{a([{id:1,codigo:"RCA-001",nombre:"Resoluci\xf3n de Calificaci\xf3n Ambiental Principal",descripcion:"RCA aprobada por el Servicio de Evaluaci\xf3n Ambiental para el proyecto",fecha:"2023-06-15",tipo:"RCA",organismo:"Servicio de Evaluaci\xf3n Ambiental (SEA)",numero_resolucion:"RES-2023-045",estado:"Vigente",vencimiento:"2028-06-15",portada:"/img/imagen_jej.jpg"},{id:2,codigo:"DIA-001",nombre:"Declaraci\xf3n de Impacto Ambiental",descripcion:"DIA presentada ante la autoridad ambiental con medidas de mitigaci\xf3n",fecha:"2023-03-20",tipo:"DIA",organismo:"SEA - Regi\xf3n Metropolitana",numero_resolucion:"DIA-2023-012",estado:"Aprobado",vencimiento:"2026-03-20",portada:"/img/muro.jpg"},{id:3,codigo:"PAS-001",nombre:"Permiso Ambiental Sectorial - Agua",descripcion:"PAS para extracci\xf3n y uso de recursos h\xeddricos",fecha:"2024-01-10",tipo:"PAS",organismo:"Direcci\xf3n General de Aguas (DGA)",numero_resolucion:"PAS-AGUA-2024-003",estado:"En Tr\xe1mite",vencimiento:null,portada:"/img/fondo-codelco.png"}]),s(!1)},500)},g=e=>{switch(e){case"Vigente":return"#10b981";case"Aprobado":return"#3b82f6";case"En Tr\xe1mite":return"#f59e0b";case"Rechazado":return"#ef4444";default:return"#6b7280"}},m=e=>{switch(e){case"RCA":return"\ud83c\udf3f";case"DIA":return"\ud83d\udccb";case"EIA":return"\ud83d\udcca";case"PAS":return"\ud83d\udca7";default:return"\ud83d\udcc4"}};return i?(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh",fontSize:"18px",color:"#0a3265"},children:"Cargando documentos RCA..."}):(0,ze.jsxs)("div",{style:{padding:"2rem",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"10px",padding:"20px 24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",borderLeft:"4px solid #10b981",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:"0 0 6px 0",fontSize:"22px",fontWeight:"600",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-leaf",style:{color:"#10b981"}}),"Documentos RCA"]}),(0,ze.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#718096"},children:"Gesti\xf3n de Resoluciones de Calificaci\xf3n Ambiental y permisos asociados"})]}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(16, 185, 129, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"}),"Nuevo Documento"]})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px",marginBottom:"24px"},children:n.map(e=>(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-6px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.15)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 12px rgba(0, 0, 0, 0.08)"},onClick:()=>p(e),children:[(0,ze.jsxs)("div",{style:{height:"160px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.9), rgba(5, 150, 105, 0.95)), url(".concat(e.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,ze.jsx)("div",{style:{fontSize:"48px",marginBottom:"8px"},children:m(e.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"6px 14px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",color:g(e.estado)},children:e.estado})]}),(0,ze.jsxs)("div",{style:{padding:"16px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,ze.jsx)("span",{style:{background:"#d1fae5",color:"#065f46",padding:"4px 10px",borderRadius:"6px",fontSize:"11px",fontWeight:"700",letterSpacing:"0.5px"},children:e.codigo}),(0,ze.jsx)("span",{style:{background:"#f0fdf4",color:"#16a34a",padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600"},children:e.tipo})]}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:"#2d3748",lineHeight:"1.3"},children:e.nombre}),(0,ze.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"13px",color:"#718096",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",fontSize:"12px",color:"#4a5568",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#10b981",width:"14px"}}),(0,ze.jsx)("span",{children:new Date(e.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{color:"#10b981",width:"14px"}}),(0,ze.jsx)("span",{style:{fontSize:"11px"},children:e.organismo})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-hashtag",style:{color:"#10b981",width:"14px"}}),(0,ze.jsx)("span",{children:e.numero_resolucion})]}),e.vencimiento&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-clock",style:{color:"#10b981",width:"14px"}}),(0,ze.jsxs)("span",{children:["Vence: ",new Date(e.vencimiento).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e2e8f0"},children:[(0,ze.jsxs)("button",{onClick:e=>{e.stopPropagation(),alert("Funci\xf3n de descargar no implementada")},style:{flex:1,background:"#d1fae5",color:"#065f46",border:"none",padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#a7f3d0",onMouseOut:e=>e.currentTarget.style.background="#d1fae5",children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsx)("button",{onClick:t=>{var r;t.stopPropagation(),r=e.id,window.confirm("\xbfEst\xe1s seguro de eliminar este documento?")&&a(n.filter(e=>e.id!==r))},style:{background:"#fef2f2",color:"#dc2626",border:"none",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#fee2e2",onMouseOut:e=>e.currentTarget.style.background="#fef2f2",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]})]},e.id))}),0===n.length&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"60px 40px",textAlign:"center",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.06)"},children:[(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"\ud83c\udf3f"}),(0,ze.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"20px",color:"#2d3748"},children:"No hay documentos registrados"}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#718096"},children:"Comienza agregando el primer documento ambiental del proyecto"}),(0,ze.jsxs)("button",{onClick:()=>c(!0),style:{background:"#10b981",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"})," Crear Primer Documento"]})]}),l&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>c(!1),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"540px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,ze.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:"Nuevo Documento RCA"}),(0,ze.jsx)("button",{onClick:()=>c(!1),style:{background:"none",border:"none",fontSize:"24px",color:"#9ca3af",cursor:"pointer",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#374151"},onMouseOut:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#9ca3af"},children:"\xd7"})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"C\xf3digo *"}),(0,ze.jsx)("input",{type:"text",value:u.codigo,onChange:e=>f(Ue(Ue({},u),{},{codigo:e.target.value})),placeholder:"RCA-001",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#10b981",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Tipo *"}),(0,ze.jsxs)("select",{value:u.tipo,onChange:e=>f(Ue(Ue({},u),{},{tipo:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"RCA",children:"RCA"}),(0,ze.jsx)("option",{value:"DIA",children:"DIA"}),(0,ze.jsx)("option",{value:"EIA",children:"EIA"}),(0,ze.jsx)("option",{value:"PAS",children:"PAS"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Nombre del Documento *"}),(0,ze.jsx)("input",{type:"text",value:u.nombre,onChange:e=>f(Ue(Ue({},u),{},{nombre:e.target.value})),placeholder:"Ej: Resoluci\xf3n de Calificaci\xf3n Ambiental",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#10b981",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:u.descripcion,onChange:e=>f(Ue(Ue({},u),{},{descripcion:e.target.value})),placeholder:"Describe el documento...",rows:"3",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box",resize:"vertical",fontFamily:"inherit",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor="#10b981",onBlur:e=>e.target.style.borderColor="#e5e7eb"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Fecha *"}),(0,ze.jsx)("input",{type:"date",value:u.fecha,onChange:e=>f(Ue(Ue({},u),{},{fecha:e.target.value})),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Organismo Emisor *"}),(0,ze.jsx)("input",{type:"text",value:u.organismo,onChange:e=>f(Ue(Ue({},u),{},{organismo:e.target.value})),placeholder:"Ej: Servicio de Evaluaci\xf3n Ambiental",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#374151"},children:"N\xfamero de Resoluci\xf3n *"}),(0,ze.jsx)("input",{type:"text",value:u.numero_resolucion,onChange:e=>f(Ue(Ue({},u),{},{numero_resolucion:e.target.value})),placeholder:"Ej: RES-2024-001",style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"32px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsx)("button",{onClick:()=>c(!1),style:{flex:1,padding:"12px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#e5e7eb",onMouseOut:e=>e.currentTarget.style.background="#f3f4f6",children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:()=>{const e=Ue(Ue({id:n.length+1},u),{},{estado:"En Tr\xe1mite",vencimiento:null,portada:"/img/fondo-codelco.png"});a([...n,e]),c(!1),f({codigo:"",nombre:"",descripcion:"",fecha:(new Date).toISOString().split("T")[0],tipo:"RCA",organismo:"",numero_resolucion:""})},disabled:!u.codigo||!u.nombre||!u.fecha||!u.organismo||!u.numero_resolucion,style:{flex:1,padding:"12px",background:u.codigo&&u.nombre&&u.fecha&&u.organismo&&u.numero_resolucion?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"#d1d5db",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:u.codigo&&u.nombre&&u.fecha&&u.organismo&&u.numero_resolucion?"pointer":"not-allowed",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Crear Documento"]})]})]})}),d&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:()=>p(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"0",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{height:"200px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.9), rgba(5, 150, 105, 0.95)), url(".concat(d.portada||"/img/fondo-codelco.png",")"),backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",padding:"24px"},children:[(0,ze.jsx)("button",{onClick:()=>p(null),style:{position:"absolute",top:"16px",right:"16px",background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"none",width:"40px",height:"40px",borderRadius:"50%",fontSize:"24px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"}),(0,ze.jsx)("div",{style:{fontSize:"64px",marginBottom:"12px"},children:m(d.tipo)}),(0,ze.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",padding:"8px 18px",borderRadius:"24px",fontSize:"13px",fontWeight:"600",color:g(d.estado)},children:d.estado})]}),(0,ze.jsxs)("div",{style:{padding:"32px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,ze.jsx)("span",{style:{background:"#d1fae5",color:"#065f46",padding:"6px 14px",borderRadius:"8px",fontSize:"13px",fontWeight:"700",letterSpacing:"0.5px"},children:d.codigo}),(0,ze.jsx)("span",{style:{background:"#f0fdf4",color:"#16a34a",padding:"6px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"600"},children:d.tipo})]}),(0,ze.jsx)("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",fontWeight:"700",color:"#0a3265"},children:d.nombre}),(0,ze.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"15px",color:"#718096",lineHeight:"1.6"},children:d.descripcion}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"24px"},children:[(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Fecha"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#10b981",marginRight:"8px"}}),new Date(d.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"N\xb0 Resoluci\xf3n"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-hashtag",style:{color:"#10b981",marginRight:"8px"}}),d.numero_resolucion]})]}),(0,ze.jsxs)("div",{style:{background:"#f9fafb",padding:"16px",borderRadius:"10px",border:"1px solid #e5e7eb",gridColumn:"1 / -1"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Organismo"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{color:"#10b981",marginRight:"8px"}}),d.organismo]})]}),d.vencimiento&&(0,ze.jsxs)("div",{style:{background:"#fef3c7",padding:"16px",borderRadius:"10px",border:"1px solid #fbbf24",gridColumn:"1 / -1"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#78350f",marginBottom:"4px"},children:"Vencimiento"}),(0,ze.jsxs)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#78350f"},children:[(0,ze.jsx)("i",{className:"fa fa-clock",style:{color:"#f59e0b",marginRight:"8px"}}),new Date(d.vencimiento).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",paddingTop:"24px",borderTop:"2px solid #f3f4f6"},children:[(0,ze.jsxs)("button",{onClick:()=>alert("Funci\xf3n de visualizar no implementada"),style:{flex:1,padding:"14px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-eye"})," Ver Documento"]}),(0,ze.jsx)("button",{onClick:()=>alert("Funci\xf3n de descargar no implementada"),style:{padding:"14px 20px",background:"#d1fae5",color:"#065f46",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#a7f3d0",onMouseOut:e=>e.currentTarget.style.background="#d1fae5",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]})]})]})})]})},xa=(e,t)=>!(!e||!e.rol)&&e.rol===t,ba=(e,t)=>!(!e||!e.rol)&&t.includes(e.rol),va=e=>xa(e,"super_admin"),ya=e=>ba(e,["super_admin","admin","trabajador"]),ja=e=>ba(e,["super_admin","admin"]),_a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!xa(e,"super_admin")||!(!xa(e,"trabajador")||!t)},Sa=e=>ba(e,["super_admin","admin","trabajador","visita"]);var wa={version:"0.18.5"},ka=1200,Ca=1252,Ea=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ta={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ra=function(e){-1!=Ea.indexOf(e)&&(Ca=Ta[0]=e)};var Na=function(e){ka=e,Ra(e)};function Aa(){Na(1200),Ra(1252)}function za(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ia,Oa=function(e){return String.fromCharCode(e)},Pa=function(e){return String.fromCharCode(e)};var Da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function La(e){for(var t="",r=0,n=0,o=0,a=0,i=0,s=0,l=0,c=0;c<e.length;)a=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(o=e.charCodeAt(c++))>>6,l=63&o,isNaN(n)?s=l=64:isNaN(o)&&(l=64),t+=Da.charAt(a)+Da.charAt(i)+Da.charAt(s)+Da.charAt(l);return t}function Ba(e){var t="",r=0,n=0,o=0,a=0,i=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Da.indexOf(e.charAt(l++))<<2|(a=Da.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&a)<<4|(i=Da.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(n)),o=(3&i)<<6|(s=Da.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(o));return t}var Fa=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Ma=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(Fh){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Wa(e){return Fa?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ua(e){return Fa?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ha=function(e){return Fa?Ma(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Va(e){if("undefined"===typeof ArrayBuffer)return Ha(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function Ga(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var Ya=Fa?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Ma(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),o=0;for(t=0,r=0;t<e.length;r+=o,++t)if(o=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var $a=/\u0000/g,qa=/[\u0001-\u0006]/g;function Xa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ka(e,t){var r=""+e;return r.length>=t?r:ls("0",t-r.length)+r}function Ja(e,t){var r=""+e;return r.length>=t?r:ls(" ",t-r.length)+r}function Qa(e,t){var r=""+e;return r.length>=t?r:r+ls(" ",t-r.length)}var Za=Math.pow(2,32);function ei(e,t){return e>Za||e<-Za?function(e,t){var r=""+Math.round(e);return r.length>=t?r:ls("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:ls("0",t-r.length)+r}(Math.round(e),t)}function ti(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var ri=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ni=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var oi={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},ai={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ii={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function si(e,t,r){for(var n=e<0?-1:1,o=e*n,a=0,i=1,s=0,l=1,c=0,d=0,p=Math.floor(o);c<t&&(s=(p=Math.floor(o))*i+a,d=p*c+l,!(o-p<5e-8));)o=1/(o-p),a=i,i=s,l=c,c=d;if(d>t&&(c>t?(d=l,s=a):(d=c,s=i)),!r)return[0,n*s,d];var u=Math.floor(n*s/d);return[u,n*s-u*d,d]}function li(e,t,r){if(e>2958465||e<0)return null;var n=0|e,o=Math.floor(86400*(e-n)),a=0,i=[],s={D:n,T:o,u:86400*(e-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++o&&(s.T=o=0,++n,++s.D)),60===n)i=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return s.y=i[0],s.m=i[1],s.d=i[2],s.S=o%60,o=Math.floor(o/60),s.M=o%60,o=Math.floor(o/60),s.H=o,s.q=a,s}var ci=new Date(1899,11,31,0,0,0),di=ci.getTime(),pi=new Date(1900,2,1,0,0,0);function ui(e,t){var r=e.getTime();return t?r-=1262304e5:e>=pi&&(r+=864e5),(r-(di+6e4*(e.getTimezoneOffset()-ci.getTimezoneOffset())))/864e5}function fi(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hi(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=fi(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=fi(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),fi(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function gi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):hi(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Di(14,ui(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mi(e,t,r,n){var o,a="",i=0,s=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:o=l%100,c=2;break;default:o=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:o=r.m,c=t.length;break;case 3:return ni[r.m-1][1];case 5:return ni[r.m-1][0];default:return ni[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,c=t.length;break;case 3:return ri[r.q][0];default:return ri[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(i=Math.round(s*(r.S+r.u)))>=60*s&&(i=0),"s"===t?0===i?"0":""+i/s:(a=Ka(i,2+n),"ss"===t?a.substr(0,2):"."+a.substr(2,t.length-1))):Ka(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":o=24*r.D+r.H;break;case"[m]":case"[mm]":o=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":o=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:o=l,c=1}return c>0?Ka(o,c):""}function xi(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var bi=/%/g;function vi(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+vi(e,-t);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%o;if(a<0&&(a+=o),-1===(r=(t/Math.pow(10,a)).toPrecision(n+1+(o+a)%o)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,o)+"."+r.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(o+a)%o)+"."+n.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var yi=/# (\?+)( ?)\/( ?)(\d+)/;var ji=/^#*0*\.([0#]+)/,_i=/\).*[0#]/,Si=/\(###\) ###\\?-####/;function wi(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function ki(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ci(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ei(e,t,r){if(40===e.charCodeAt(0)&&!t.match(_i)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ei("n",n,r):"("+Ei("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ni(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(bi,""),o=t.length-n.length;return Ni(e,n,r*Math.pow(10,2*o))+ls("%",o)}(e,t,r);if(-1!==t.indexOf("E"))return vi(t,r);if(36===t.charCodeAt(0))return"$"+Ei(e,t.substr(" "==t.charAt(1)?2:1),r);var o,a,i,s,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ei(l,t.length);if(t.match(/^[#?]+$/))return"0"===(o=ei(r,0))&&(o=""),o.length>t.length?o:wi(t.substr(0,t.length-o.length))+o;if(a=t.match(yi))return function(e,t,r){var n=parseInt(e[4],10),o=Math.round(t*n),a=Math.floor(o/n),i=o-a*n,s=n;return r+(0===a?"":""+a)+" "+(0===i?ls(" ",e[1].length+1+e[4].length):Ja(i,e[1].length)+e[2]+"/"+e[3]+Ka(s,e[4].length))}(a,l,c);if(t.match(/^#+0+$/))return c+ei(l,t.length-t.indexOf("0"));if(a=t.match(ji))return o=ki(r,a[1].length).replace(/^([^\.]+)$/,"$1."+wi(a[1])).replace(/\.$/,"."+wi(a[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+ls("0",wi(a[1]).length-t.length)}),-1!==t.indexOf("0.")?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+ki(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+xi(ei(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ei(e,t,-r):xi(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,a[1].length)))+"."+Ka(Ci(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ei(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Xa(Ei(e,t.replace(/[\\-]/g,""),r)),i=0,Xa(Xa(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<o.length?o.charAt(i++):"0"===e?"0":""}));if(t.match(Si))return"("+(o=Ei(e,"##########",r)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),s=si(l,Math.pow(10,i)-1,!1),o=""+c," "==(d=Ni("n",a[1],s[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),o+=d+a[2]+"/"+a[3],(d=Qa(s[2],i)).length<a[4].length&&(d=wi(a[4].substr(a[4].length-d.length))+d),o+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),c+((s=si(l,Math.pow(10,i)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Ja(s[1],i)+a[2]+"/"+a[3]+Qa(s[2],i):ls(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return o=ei(r,0),t.length<=o.length?o:wi(t.substr(0,t.length-o.length))+o;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=o.indexOf(".");var p=t.indexOf(".")-i,u=t.length-o.length-p;return wi(t.substr(0,p)+o+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Ci(r,a[1].length),r<0?"-"+Ei(e,t,-r):xi(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ka(0,3-e.length):"")+e})+"."+Ka(i,a[1].length);switch(t){case"###,##0.00":return Ei(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=xi(ei(l,0));return"0"!==f?c+f:"";case"###,###.00":return Ei(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ei(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ti(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Ti(e,-t);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%o;if(a<0&&(a+=o),!(r=(t/Math.pow(10,a)).toPrecision(n+1+(o+a)%o)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(o+a)%o)+"."+n.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ri(e,t,r){if(40===e.charCodeAt(0)&&!t.match(_i)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ri("n",n,r):"("+Ri("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ni(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(bi,""),o=t.length-n.length;return Ni(e,n,r*Math.pow(10,2*o))+ls("%",o)}(e,t,r);if(-1!==t.indexOf("E"))return Ti(t,r);if(36===t.charCodeAt(0))return"$"+Ri(e,t.substr(" "==t.charAt(1)?2:1),r);var o,a,i,s,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ka(l,t.length);if(t.match(/^[#?]+$/))return o=""+r,0===r&&(o=""),o.length>t.length?o:wi(t.substr(0,t.length-o.length))+o;if(a=t.match(yi))return function(e,t,r){return r+(0===t?"":""+t)+ls(" ",e[1].length+2+e[4].length)}(a,l,c);if(t.match(/^#+0+$/))return c+Ka(l,t.length-t.indexOf("0"));if(a=t.match(ji))return o=(o=(""+r).replace(/^([^\.]+)$/,"$1."+wi(a[1])).replace(/\.$/,"."+wi(a[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+ls("0",wi(a[1]).length-t.length)}),-1!==t.indexOf("0.")?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+xi(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ri(e,t,-r):xi(""+r)+"."+ls("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ri(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Xa(Ri(e,t.replace(/[\\-]/g,""),r)),i=0,Xa(Xa(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<o.length?o.charAt(i++):"0"===e?"0":""}));if(t.match(Si))return"("+(o=Ri(e,"##########",r)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),s=si(l,Math.pow(10,i)-1,!1),o=""+c," "==(d=Ni("n",a[1],s[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),o+=d+a[2]+"/"+a[3],(d=Qa(s[2],i)).length<a[4].length&&(d=wi(a[4].substr(a[4].length-d.length))+d),o+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),c+((s=si(l,Math.pow(10,i)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Ja(s[1],i)+a[2]+"/"+a[3]+Qa(s[2],i):ls(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return o=""+r,t.length<=o.length?o:wi(t.substr(0,t.length-o.length))+o;if(a=t.match(/^([#0]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=o.indexOf(".");var p=t.indexOf(".")-i,u=t.length-o.length-p;return wi(t.substr(0,p)+o+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ri(e,t,-r):xi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ka(0,3-e.length):"")+e})+"."+Ka(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=xi(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Ri(e,t.slice(0,t.lastIndexOf(".")),r)+wi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ni(e,t,r){return(0|r)===r?Ri(e,t,r):Ei(e,t,r)}var Ai=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ti(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(Ai))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Ii=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Oi(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function Pi(e,t){var r=function(e){for(var t=[],r=!1,n=0,o=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(o,n-o),o=n+1}if(t[t.length]=e.substr(o),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var a=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(Ii),s=r[1].match(Ii);return Oi(t,i)?[n,r[0]]:Oi(t,s)?[n,r[1]]:[n,r[null!=i&&null!=s?2:1]]}return[n,a]}function Di(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:oi)[e])&&(n=r.table&&r.table[ai[e]]||oi[ai[e]]),null==n&&(n=ii[e]||"General")}if(ti(n,0))return gi(t,r);t instanceof Date&&(t=ui(t,r.date1904));var o=Pi(n,t);if(ti(o[1]))return gi(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var o,a,i,s=[],l="",c=0,d="",p="t",u="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!ti(e,c))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);s[s.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),h="("===f||")"===f?f:"t";s[s.length]={t:h,v:f},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==o&&null==(o=li(t,r,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},p=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==o&&null==(o=li(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===p.toLowerCase()&&(d="M"),"h"===d&&(d=u),s[s.length]={t:d,v:l},p=d;break;case"A":case"a":case"\u4e0a":var g={t:d,v:d};if(null==o&&(o=li(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=o&&(g.v=o.H>=12?"P":"A"),g.t="T",u="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=o&&(g.v=o.H>=12?"PM":"AM"),g.t="T",c+=5,u="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=o&&(g.v=o.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",c+=5,u="h"):(g.t="t",++c),null==o&&"T"===g.t)return"";s[s.length]=g,p=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Ai)){if(null==o&&null==(o=li(t,r)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},p=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",zi(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=o){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;s[s.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;s[s.length]={t:d,v:l},p=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===n?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:d,v:d},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++c}var m,x=0,b=0;for(c=s.length-1,p="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=u,p="h",x<1&&(x=1);break;case"s":(m=s[c].v.match(/\.0+$/))&&(b=Math.max(b,m[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":p=s[c].t;break;case"m":"s"===p&&(s[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[c].v.match(/[Hh]/)&&(x=1),x<2&&s[c].v.match(/[Mm]/)&&(x=2),x<3&&s[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M)}var v,y="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=mi(s[c].t.charCodeAt(0),s[c].v,o,b),s[c].t="t";break;case"n":case"?":for(v=c+1;null!=s[v]&&("?"===(d=s[v].t)||"D"===d||(" "===d||"t"===d)&&null!=s[v+1]&&("?"===s[v+1].t||"t"===s[v+1].t&&"/"===s[v+1].v)||"("===s[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===s[v].v||" "===s[v].v&&null!=s[v+1]&&"?"==s[v+1].t));)s[c].v+=s[v].v,s[v]={v:"",t:";"},++v;y+=s[c].v,c=v-1;break;case"G":s[c].t="t",s[c].v=gi(t,r)}var j,_,S="";if(y.length>0){40==y.charCodeAt(0)?(j=t<0&&45===y.charCodeAt(0)?-t:t,_=Ni("n",y,j)):(_=Ni("n",y,j=t<0&&n>1?-t:t),j<0&&s[0]&&"t"==s[0].t&&(_=_.substr(1),s[0].v="-"+s[0].v)),v=_.length-1;var w=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){w=c;break}var k=s.length;if(w===s.length&&-1===_.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(v>=s[c].v.length-1?(v-=s[c].v.length,s[c].v=_.substr(v+1,s[c].v.length)):v<0?s[c].v="":(s[c].v=_.substr(0,v+1),v=-1),s[c].t="t",k=c);v>=0&&k<s.length&&(s[k].v=_.substr(0,v+1)+s[k].v)}else if(w!==s.length&&-1===_.indexOf("E")){for(v=_.indexOf(".")-1,c=w;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(a=s[c].v.indexOf(".")>-1&&c===w?s[c].v.indexOf(".")-1:s[c].v.length-1,S=s[c].v.substr(a+1);a>=0;--a)v>=0&&("0"===s[c].v.charAt(a)||"#"===s[c].v.charAt(a))&&(S=_.charAt(v--)+S);s[c].v=S,s[c].t="t",k=c}for(v>=0&&k<s.length&&(s[k].v=_.substr(0,v+1)+s[k].v),v=_.indexOf(".")+1,c=w;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===w)){for(a=s[c].v.indexOf(".")>-1&&c===w?s[c].v.indexOf(".")+1:0,S=s[c].v.substr(0,a);a<s[c].v.length;++a)v<_.length&&(S+=_.charAt(v++));s[c].v=S,s[c].t="t",k=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&(j=n>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=Ni(s[c].t,s[c].v,j),s[c].t="t");var C="";for(c=0;c!==s.length;++c)null!=s[c]&&(C+=s[c].v);return C}(o[1],t,r,o[0])}function Li(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=oi[r]){if(oi[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return oi[t]=e,t}function Bi(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Li(e[t],t)}function Fi(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',oi=e}var Mi=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Wi=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,o="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)o[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=o[t]=r>>>8^e[255&r];var a=[];for(n=1;16!=n;++n)a[n-1]="undefined"!==typeof Int32Array?o.subarray(256*n,256*n+256):o.slice(256*n,256*n+256);return a}(t),n=r[0],o=r[1],a=r[2],i=r[3],s=r[4],l=r[5],c=r[6],d=r[7],p=r[8],u=r[9],f=r[10],h=r[11],g=r[12],m=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,o=0,a=e.length;o<a;)n=n>>>8^t[255&(n^e.charCodeAt(o++))];return~n},e.buf=function(e,r){for(var b=-1^r,v=e.length-15,y=0;y<v;)b=x[e[y++]^255&b]^m[e[y++]^b>>8&255]^g[e[y++]^b>>16&255]^h[e[y++]^b>>>24]^f[e[y++]]^u[e[y++]]^p[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^s[e[y++]]^i[e[y++]]^a[e[y++]]^o[e[y++]]^n[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,r){for(var n=-1^r,o=0,a=e.length,i=0,s=0;o<a;)(i=e.charCodeAt(o++))<128?n=n>>>8^t[255&(n^i)]:i<2048?n=(n=n>>>8^t[255&(n^(192|i>>6&31))])>>>8^t[255&(n^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),s=1023&e.charCodeAt(o++),n=(n=(n=(n=n>>>8^t[255&(n^(240|i>>8&7))])>>>8^t[255&(n^(128|i>>2&63))])>>>8^t[255&(n^(128|s>>6&15|(3&i)<<4))])>>>8^t[255&(n^(128|63&s))]):n=(n=(n=n>>>8^t[255&(n^(224|i>>12&15))])>>>8^t[255&(n^(128|i>>6&63))])>>>8^t[255&(n^(128|63&i))];return~n},e}(),Ui=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function o(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function a(e){Ll(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),o=e.read_shift(2),a=e.l+o,i={};if(21589===n)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),o>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=a,t[n]=i}return t}function i(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=_(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Fa&&Buffer.isBuffer(e)?e.toString("binary"):_(e)).split("\r\n"),o=0,a="";for(o=0;o<n.length;++o)if(a=n[o],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),r||(r=a.slice(0,a.lastIndexOf("/")+1)),a.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),a.slice(0,r.length)!=r););var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var s="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};u(d);var p,f=0;for(o=0;o<n.length;++o){var h=n[o];h!==s&&h!==s+"--"||(f++&&ce(d,n.slice(p,o),r),p=o)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,o,a,i,s,f=512,h=[],g=e.slice(0,512);Ll(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(r=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Ll(g=e.slice(0,f),28);var v=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,r);var y=g.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);g.l+=4,a=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),i=g.read_shift(4,"i"),n=g.read_shift(4,"i"),s=g.read_shift(4,"i"),o=g.read_shift(4,"i");for(var j=-1,S=0;S<109&&!((j=g.read_shift(4,"i"))<0);++S)h[S]=j;var w=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],o=1;o<r;++o)n[o-1]=e.slice(o*t,(o+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(s,o,w,f,h);var k=function(e,t,r,n){var o=e.length,a=[],i=[],s=[],l=[],c=n-1,d=0,p=0,u=0,f=0;for(d=0;d<o;++d)if(s=[],(u=d+t)>=o&&(u-=o),!i[u]){l=[];var h=[];for(p=u;p>=0;){h[p]=!0,i[p]=!0,s[s.length]=p,l.push(e[p]);var g=r[Math.floor(4*p/n)];if(n<4+(f=4*p&c))throw new Error("FAT boundary crossed: "+p+" 4 "+n);if(!e[g])break;if(h[p=Rl(e[g],f)])break}a[u]={nodes:s,data:ol([l])}}return a}(w,a,h,f);k[a].name="!Directory",n>0&&i!==x&&(k[i].name="!MiniFAT"),k[h[0]].name="!FAT",k.fat_addrs=h,k.ssz=f;var C=[],E=[],T=[];!function(e,t,r,n,o,a,i,s){for(var c,u=0,f=n.length?2:0,h=t[e].data,g=0,m=0;g<h.length;g+=128){var b=h.slice(g,g+128);Ll(b,64),m=b.read_shift(2),c=il(b,0,m-f),n.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=p(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=p(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=x,v.name=""),5===v.type?(u=v.start,o>0&&u!==x&&(t[u].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:u!==x&&v.start!==x&&t[u]&&(v.content=l(v,t[u].data,(t[s]||{}).data))),v.content&&Ll(v.content,0),a[c]=v,i.push(v)}}(a,k,w,C,n,{},E,i),function(e,t,r){for(var n=0,o=0,a=0,i=0,s=0,l=r.length,c=[],d=[];n<l;++n)c[n]=d[n]=n,t[n]=r[n];for(;s<d.length;++s)o=e[n=d[s]].L,a=e[n].R,i=e[n].C,c[n]===n&&(-1!==o&&c[o]!==o&&(c[n]=c[o]),-1!==a&&c[a]!==a&&(c[n]=c[a])),-1!==i&&(c[i]=n),-1!==o&&n!=c[n]&&(c[o]=c[n],d.lastIndexOf(o)<s&&d.push(o)),-1!==a&&n!=c[n]&&(c[a]=c[n],d.lastIndexOf(a)<s&&d.push(a));for(n=1;n<l;++n)c[n]===n&&(-1!==a&&c[a]!==a?c[n]=c[a]:-1!==o&&c[o]!==o&&(c[n]=c[o]));for(n=1;n<l;++n)if(0!==e[n].type){if((s=n)!=c[s])do{s=c[s],t[n]=t[s]+"/"+t[n]}while(0!==s&&-1!==c[s]&&s!=c[s]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(E,T,C),C.shift();var R={FileIndex:E,FullPaths:T};return t&&t.raw&&(R.raw={header:v,sectors:w}),R}function l(e,t,r){for(var n=e.start,o=e.size,a=[],i=n;r&&o>0&&i>=0;)a.push(t.slice(i*m,i*m+m)),o-=m,i=Rl(r,4*i);return 0===a.length?Fl(0):Ya(a).slice(0,e.size)}function c(e,t,r,n,o){var a=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],s=(n>>>2)-1;if(!i)return;for(var l=0;l<s&&(a=Rl(i,4*l))!==x;++l)o.push(a);c(Rl(i,n-4),t-1,r,n,o)}}function d(e,t,r,n,o){var a=[],i=[];o||(o=[]);var s=n-1,l=0,c=0;for(l=t;l>=0;){o[l]=!0,a[a.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/n)];if(n<4+(c=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[d])break;l=Rl(e[d],c)}return{nodes:a,data:ol([i])}}function p(e,t){return new Date(1e3*(Tl(e,t+4)/1e7*Math.pow(2,32)+Tl(e,t)/1e7-11644473600))}function u(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Ui.find(e,"/"+t))return;var r=Fl(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){u(e);for(var o=!1,a=!1,i=e.FullPaths.length-1;i>=0;--i){var s=e.FileIndex[i];switch(s.type){case 0:a?o=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(s.R*s.L*s.C)&&(o=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(o=!0);break;default:o=!0}}if(o||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},p=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&p.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<p.length;++i){var f=r(p[i][0]);(a=d[f])||(p.push([f,{name:n(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[f]=!0)}for(p.sort(function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),o=0,a=0,i=Math.min(r.length,n.length);o<i;++o){if(a=r[o].length-n[o].length)return a;if(r[o]!=n[o])return r[o]<n[o]?-1:1}return r.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<p.length;++i)e.FullPaths[i]=p[i][0],e.FileIndex[i]=p[i][1];for(i=0;i<p.length;++i){var h=e.FileIndex[i],g=e.FullPaths[i];if(h.name=n(g).replace("/",""),h.L=h.R=h.C=-(h.color=1),h.size=h.content?h.content.length:0,h.start=0,h.clsid=h.clsid||y,0===i)h.C=p.length>1?1:-1,h.size=0,h.type=5;else if("/"==g.slice(-1)){for(c=i+1;c<p.length&&r(e.FullPaths[c])!=g;++c);for(h.C=c>=p.length?-1:c,c=i+1;c<p.length&&r(e.FullPaths[c])!=r(g);++c);h.R=c>=p.length?-1:c,h.type=1}else r(e.FullPaths[i+1]||"")==r(g)&&(h.R=i+1),h.type=2}}}function h(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",o=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],a=e.FullPaths[0],i=a,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(a.length),(s=e.FileIndex[l]).size&&s.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=s.content,d=Fa&&Buffer.isBuffer(c)?c.toString("binary"):_(c),p=0,u=Math.min(1024,d.length),f=0,h=0;h<=u;++h)(f=d.charCodeAt(h))>=32&&f<128&&++p;var g=p>=4*u/5;o.push(n),o.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),o.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),o.push("Content-Type: "+ie(s,i)),o.push(""),o.push(g?le(d):se(d))}return o.push(n+"--\r\n"),o.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],a=[],i=Fl(1),s=r.compression?8:0,l=0;0;var c=0,d=0,p=0,u=0,f=e.FullPaths[0],h=f,g=e.FileIndex[0],m=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(h=e.FullPaths[c].slice(f.length),(g=e.FileIndex[c]).size&&g.content&&"\x01Sh33tJ5"!=h){var b=p,v=Fl(h.length);for(d=0;d<h.length;++d)v.write_shift(1,127&h.charCodeAt(d));v=v.slice(0,v.l),m[u]=Wi.buf(g.content,0);var y=g.content;8==s&&(y=S(y)),(i=Fl(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,s),g.mt?o(i,g.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:m[u]),i.write_shift(4,8&l?0:y.length),i.write_shift(4,8&l?0:g.content.length),i.write_shift(2,v.length),i.write_shift(2,0),p+=i.length,n.push(i),p+=v.length,n.push(v),p+=y.length,n.push(y),8&l&&((i=Fl(12)).write_shift(-4,m[u]),i.write_shift(4,y.length),i.write_shift(4,g.content.length),p+=i.l,n.push(i)),(i=Fl(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,s),i.write_shift(4,0),i.write_shift(-4,m[u]),i.write_shift(4,y.length),i.write_shift(4,g.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),x+=i.l,a.push(i),x+=v.length,a.push(v),++u}return i=Fl(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,u),i.write_shift(2,u),i.write_shift(4,x),i.write_shift(4,p),i.write_shift(2,0),Ya([Ya(n),Ya(a),i])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var o=e.FileIndex[n];if(o.content){var a=o.content.length;a>0&&(a<4096?t+=a+63>>6:r+=a+511>>9)}}for(var i=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+r+i+s,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var p=[1,d,c,s,i,r,t,0];return e.FileIndex[0].size=t<<6,p[7]=(e.FileIndex[0].start=p[0]+p[1]+p[2]+p[3]+p[4]+p[5])+(p[6]+7>>3),p}(e),a=Fl(n[7]<<9),i=0,s=0;for(i=0;i<8;++i)a.write_shift(1,v[i]);for(i=0;i<8;++i)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),i=0;i<3;++i)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,n[2]),a.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:x),a.write_shift(4,n[3]),a.write_shift(-4,n[1]?n[0]-1:x),a.write_shift(4,n[1]),i=0;i<109;++i)a.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(s=0;s<n[1];++s){for(;i<236+127*s;++i)a.write_shift(-4,i<n[2]?n[1]+i:-1);a.write_shift(-4,s===n[1]-1?x:s+1)}var l=function(e){for(s+=e;i<s-1;++i)a.write_shift(-4,i+1);e&&(++i,a.write_shift(-4,x))};for(s=i=0,s+=n[1];i<s;++i)a.write_shift(-4,j.DIFSECT);for(s+=n[2];i<s;++i)a.write_shift(-4,j.FATSECT);l(n[3]),l(n[4]);for(var c=0,d=0,p=e.FileIndex[0];c<e.FileIndex.length;++c)(p=e.FileIndex[c]).content&&((d=p.content.length)<4096||(p.start=s,l(d+511>>9)));for(l(n[6]+7>>3);511&a.l;)a.write_shift(-4,j.ENDOFCHAIN);for(s=i=0,c=0;c<e.FileIndex.length;++c)(p=e.FileIndex[c]).content&&(!(d=p.content.length)||d>=4096||(p.start=s,l(d+63>>6)));for(;511&a.l;)a.write_shift(-4,j.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var u=e.FullPaths[i];if(u&&0!==u.length){p=e.FileIndex[i],0===i&&(p.start=p.size?p.start-1:x);var h=0===i&&r.root||p.name;if(d=2*(h.length+1),a.write_shift(64,h,"utf16le"),a.write_shift(2,d),a.write_shift(1,p.type),a.write_shift(1,p.color),a.write_shift(-4,p.L),a.write_shift(-4,p.R),a.write_shift(-4,p.C),p.clsid)a.write_shift(16,p.clsid,"hex");else for(c=0;c<4;++c)a.write_shift(4,0);a.write_shift(4,p.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,p.start),a.write_shift(4,p.size),a.write_shift(4,0)}else{for(c=0;c<17;++c)a.write_shift(4,0);for(c=0;c<3;++c)a.write_shift(4,-1);for(c=0;c<12;++c)a.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((p=e.FileIndex[i]).size>=4096)if(a.l=p.start+1<<9,Fa&&Buffer.isBuffer(p.content))p.content.copy(a,a.l,0,p.size),a.l+=p.size+511&-512;else{for(c=0;c<p.size;++c)a.write_shift(1,p.content[c]);for(;511&c;++c)a.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((p=e.FileIndex[i]).size>0&&p.size<4096)if(Fa&&Buffer.isBuffer(p.content))p.content.copy(a,a.l,0,p.size),a.l+=p.size+63&-64;else{for(c=0;c<p.size;++c)a.write_shift(1,p.content[c]);for(;63&c;++c)a.write_shift(1,0)}if(Fa)a.l=a.length;else for(;a.l<a.length;)a.write_shift(1,0);return a}t.version="1.2.1";var g,m=64,x=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",j={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function S(e){return g?g.deflateRawSync(e):q(e)}var w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function E(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var T="undefined"!==typeof Uint8Array,R=T?new Uint8Array(256):[],N=0;N<256;++N)R[N]=E(N);function A(e,t){var r=R[255&e];return t<=8?r>>>8-t:(r=r<<8|R[e>>8&255],t<=16?r>>>16-t:(r=r<<8|R[e>>16&255])>>>24-t)}function z(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function O(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function D(e,t,r){var n=7&t,o=t>>>3,a=(1<<r)-1,i=e[o]>>>n;return r<8-n?i&a:(i|=e[o+1]<<8-n,r<16-n?i&a:(i|=e[o+2]<<16-n,r<24-n?i&a:(i|=e[o+3]<<24-n)&a))}function L(e,t,r){var n=7&t,o=t>>>3;return n<=5?e[o]|=(7&r)<<n:(e[o]|=r<<n&255,e[o+1]=(7&r)>>8-n),t+3}function B(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function F(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function M(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function W(e,t){var r=e.length,n=2*r>t?2*r:t+5,o=0;if(r>=t)return e;if(Fa){var a=Ua(n);if(e.copy)e.copy(a);else for(;o<e.length;++o)a[o]=e[o];return a}if(T){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;o<r;++o)i[o]=e[o];return i}return e.length=n,e}function U(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var n=1,o=0,a=0,i=0,s=0,l=e.length,c=T?new Uint16Array(32):U(32);for(a=0;a<32;++a)c[a]=0;for(a=l;a<r;++a)e[a]=0;l=e.length;var d=T?new Uint16Array(l):U(l);for(a=0;a<l;++a)c[o=e[a]]++,n<o&&(n=o),d[a]=0;for(c[0]=0,a=1;a<=n;++a)c[a+16]=s=s+c[a-1]<<1;for(a=0;a<l;++a)0!=(s=e[a])&&(d[a]=c[s+16]++);var p=0;for(a=0;a<l;++a)if(0!=(p=e[a]))for(s=A(d[a],n)>>n-p,i=(1<<n+4-p)-1;i>=0;--i)t[s|i<<p]=15&p|a<<4;return n}var V=T?new Uint16Array(512):U(512),G=T?new Uint16Array(32):U(32);if(!T){for(var Y=0;Y<512;++Y)V[Y]=0;for(Y=0;Y<32;++Y)G[Y]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,V,288)}();var $=function(){for(var e=T?new Uint8Array(32768):[],t=0,r=0;t<C.length-1;++t)for(;r<C[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=T?new Uint8Array(259):[];for(t=0,r=0;t<k.length-1;++t)for(;r<k[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),o=r+n==e.length;for(t.write_shift(1,+o),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var o=0,a=0,i=T?new Uint16Array(32768):[];a<t.length;){var s=Math.min(65535,t.length-a);if(s<10){for(7&(o=L(r,o,+!(a+s!=t.length)))&&(o+=8-(7&o)),r.l=o/8|0,r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=t[a++];o=8*r.l}else{o=L(r,o,+!(a+s!=t.length)+2);for(var l=0;s-- >0;){var c=t[a],d=-1,p=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&a)>a&&(d-=32768),d<a))for(;t[d+p]==t[a+p]&&p<250;)++p;if(p>2){(c=n[p])<=22?o=F(r,o,R[c+1]>>1)-1:(F(r,o,3),F(r,o+=5,R[c-23]>>5),o+=3);var u=c<8?0:c-4>>2;u>0&&(M(r,o,p-k[c]),o+=u),c=e[a-d],o=F(r,o,R[c]>>3),o-=3;var f=c<4?0:c-2>>1;f>0&&(M(r,o,a-d-C[c]),o+=f);for(var h=0;h<p;++h)i[l]=32767&a,l=32767&(l<<5^t[a]),++a;s-=p-1}else c<=143?c+=48:o=B(r,o,1),o=F(r,o,R[c]),i[l]=32767&a,++a}o=F(r,o,0)-1}}return r.l=(o+7)/8|0,r.l}(t,r)}}();function q(e){var t=Fl(50+Math.floor(1.1*e.length)),r=$(e,t);return t.slice(0,r)}var X=T?new Uint16Array(32768):U(32768),K=T?new Uint16Array(32768):U(32768),J=T?new Uint16Array(128):U(128),Q=1,Z=1;function ee(e,t){var r=O(e,t)+257,n=O(e,t+=5)+1,o=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var a=0,i=T?new Uint8Array(19):U(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=T?new Uint8Array(8):U(8),d=T?new Uint8Array(8):U(8),p=i.length,u=0;u<o;++u)i[w[u]]=a=I(e,t),l<a&&(l=a),c[a]++,t+=3;var f=0;for(c[0]=0,u=1;u<=l;++u)d[u]=f=f+c[u-1]<<1;for(u=0;u<p;++u)0!=(f=i[u])&&(s[u]=d[f]++);var h=0;for(u=0;u<p;++u)if(0!=(h=i[u])){f=R[s[u]]>>8-h;for(var g=(1<<7-h)-1;g>=0;--g)J[f|g<<h]=7&h|u<<3}var m=[];for(l=1;m.length<r+n;)switch(t+=7&(f=J[P(e,t)]),f>>>=3){case 16:for(a=3+z(e,t),t+=2,f=m[m.length-1];a-- >0;)m.push(f);break;case 17:for(a=3+I(e,t),t+=3;a-- >0;)m.push(0);break;case 18:for(a=11+P(e,t),t+=7;a-- >0;)m.push(0);break;default:m.push(f),l<f&&(l=f)}var x=m.slice(0,r),b=m.slice(r);for(u=r;u<286;++u)x[u]=0;for(u=n;u<30;++u)b[u]=0;return Q=H(x,X,286),Z=H(b,K,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[Wa(t),2];for(var r=0,n=0,o=Ua(t||1<<18),a=0,i=o.length>>>0,s=0,l=0;0==(1&n);)if(n=I(e,r),r+=3,n>>>1!=0)for(n>>1==1?(s=9,l=5):(r=ee(e,r),s=Q,l=Z);;){!t&&i<a+32767&&(i=(o=W(o,a+32767)).length);var c=D(e,r,s),d=n>>>1==1?V[c]:X[c];if(r+=15&d,0===((d>>>=4)>>>8&255))o[a++]=d;else{if(256==d)break;var p=(d-=257)<8?0:d-4>>2;p>5&&(p=0);var u=a+k[d];p>0&&(u+=D(e,r,p),r+=p),c=D(e,r,l),r+=15&(d=n>>>1==1?G[c]:K[c]);var f=(d>>>=4)<4?0:d-2>>1,h=C[d];for(f>0&&(h+=D(e,r,f),r+=f),!t&&i<u&&(i=(o=W(o,u+100)).length);a<u;)o[a]=o[a-h],++a}}else{7&r&&(r+=8-(7&r));var g=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,g>0)for(!t&&i<a+g&&(i=(o=W(o,a+g)).length);g-- >0;)o[a++]=e[r>>>3],r+=8}return t?[o,r+7>>>3]:[o.slice(0,a),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;Ll(r,0);var n={FileIndex:[],FullPaths:[]};u(n,{root:t.root});for(var o=r.length-4;(80!=r[o]||75!=r[o+1]||5!=r[o+2]||6!=r[o+3])&&o>=0;)--o;r.l=o+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var s=r.read_shift(4);for(r.l=s,o=0;o<i;++o){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),p=r.read_shift(2),f=r.read_shift(2);r.l+=8;var h=r.read_shift(4),g=a(r.slice(r.l+d,r.l+d+p));r.l+=d+p+f;var m=r.l;r.l=h+4,oe(r,l,c,n,g),r.l=m}return n}function oe(e,t,r,n,o){e.l+=2;var i=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,o=31&r,a=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(a-1),n.setDate(o);var i=31&t,s=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(s),n.setSeconds(i<<1),n}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),p=e.read_shift(2),u=e.read_shift(2),f="",h=0;h<p;++h)f+=String.fromCharCode(e[e.l++]);if(u){var m=a(e.slice(e.l,e.l+u));(m[21589]||{}).mt&&(l=m[21589].mt),((o||{})[21589]||{}).mt&&(l=o[21589].mt)}e.l+=u;var x=e.slice(e.l,e.l+c);switch(s){case 8:x=function(e,t){if(!g)return te(e,t);var r=new(0,g.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),d!=r&&re(b,"Bad uncompressed size: "+r+" != "+d),de(n,f,x,{unsafe:!0,mt:l})}var ae={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&ae[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&ae[n[1]]?ae[n[1]]:"application/octet-stream"}function se(e){for(var t=La(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),o=0;o<n.length;++o){var a=n[o];if(0!=a.length)for(var i=0;i<a.length;){var s=76,l=a.slice(i,i+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=a.slice(i,i+s),(i+=s)<a.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,o="",a="",i="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":o=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":a=c[2].trim()}}switch(++s,a.toLowerCase()){case"base64":n=Ha(Ba(t.slice(s).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var o=0;o<t.length;++o)t[o]=t[o].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Ha(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+a)}var d=de(e,o.slice(r.length),n,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,o){var a=o&&o.unsafe;a||u(e);var i=!a&&Ui.find(e,t);if(!i){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(s),a||Ui.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,o&&(o.CLSID&&(i.clsid=o.CLSID),o.mt&&(i.mt=o.mt),o.ct&&(i.ct=o.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),o=!1;47===t.charCodeAt(0)?(o=!0,t=r[0].slice(0,-1)+t):o=-1!==t.indexOf("/");var a=t.toUpperCase(),i=!0===o?r.indexOf(a):n.indexOf(a);if(-1!==i)return e.FileIndex[i];var s=!a.match(qa);for(a=a.replace($a,""),s&&(a=a.replace(qa,"!")),i=0;i<r.length;++i){if((s?r[i].replace(qa,"!"):r[i]).replace($a,"")==a)return e.FileIndex[i];if((s?n[i].replace(qa,"!"):n[i]).replace($a,"")==a)return e.FileIndex[i]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||Fa&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return i(),s(e.readFileSync(t),r)}(t,r);case"base64":return s(Ha(Ba(t)),r);case"binary":return s(Ha(t),r)}return s(t,r)},t.parse=s,t.write=function(t,r){var n=h(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:_(n);case"base64":return La("string"==typeof n?n:_(n));case"buffer":if(Fa)return Buffer.isBuffer(n)?n:Ma(n);case"array":return"string"==typeof n?Ha(n):n}return n},t.writeFile=function(t,r,n){i();var o=h(t,n);e.writeFileSync(r,o)},t.utils={cfb_new:function(e){var t={};return u(t,e),t},cfb_add:de,cfb_del:function(e,t){u(e);var r=Ui.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){u(e);var o=Ui.find(e,t);if(o)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==o)return e.FileIndex[a].name=n(r),e.FullPaths[a]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Al,CheckField:Dl,prep_blob:Ll,bconcat:Ya,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(Fh){console.error("cannot use native zlib: "+(Fh.message||Fh))}},_deflateRaw:q,_inflateRaw:te,consts:j},t}();let Hi;function Vi(e){return"string"===typeof e?Va(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Gi(e,t,r){if("undefined"!==typeof Hi&&Hi.writeFileSync)return r?Hi.writeFileSync(e,t,r):Hi.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Va(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?Rs(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!==typeof Blob){var o=new Blob([Vi(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if("undefined"!==typeof saveAs)return saveAs(o,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(o);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=Ga(t)),s.write(t),s.close(),t}catch(Fh){if(!Fh.message||!Fh.message.match(/onstruct/))throw Fh}throw new Error("cannot save file "+e)}function Yi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $i(e,t){for(var r=[],n=Yi(e),o=0;o!==n.length;++o)null==r[e[n[o]][t]]&&(r[e[n[o]][t]]=n[o]);return r}function qi(e){for(var t=[],r=Yi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Xi(e){for(var t=[],r=Yi(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var Ki=new Date(1899,11,30,0,0,0);function Ji(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Ki.getTime()+6e4*(e.getTimezoneOffset()-Ki.getTimezoneOffset())))/864e5}var Qi=new Date,Zi=Ki.getTime()+6e4*(Qi.getTimezoneOffset()-Ki.getTimezoneOffset()),es=Qi.getTimezoneOffset();function ts(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Zi),t.getTimezoneOffset()!==es&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-es)),t}var rs=new Date("2017-02-19T19:06:09.000Z"),ns=isNaN(rs.getFullYear())?new Date("2/19/17"):rs,os=2017==ns.getFullYear();function as(e,t){var r=new Date(e);if(os)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==ns.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function is(e,t){if(Fa&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Rs(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Rs(za(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Rs(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Rs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(Fh){}for(var n=[],o=0;o!=e.length;++o)n.push(String.fromCharCode(e[o]));return n.join("")}function ss(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ss(e[r]));return t}function ls(e,t){for(var r="";r.length<t;)r+=e;return r}function cs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(n))?t:t/r):t/r}var ds=["january","february","march","april","may","june","july","august","september","october","november","december"];function ps(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),o=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ds.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(o>0||a>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}function us(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Fa?Ma(r):function(e){for(var t=[],r=0,n=e.length+250,o=Wa(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)o[r++]=i;else if(i<2048)o[r++]=192|i>>6&31,o[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var s=1023&e.charCodeAt(++a);o[r++]=240|i>>8&7,o[r++]=128|i>>2&63,o[r++]=128|s>>6&15|(3&i)<<4,o[r++]=128|63&s}else o[r++]=224|i>>12&15,o[r++]=128|i>>6&63,o[r++]=128|63&i;r>n&&(t.push(o.slice(0,r)),r=0,o=Wa(65535),n=65530)}return t.push(o.slice(0,r)),Ya(t)}(r),Ui.utils.cfb_add(e,t,n);Ui.utils.cfb_add(e,t,r)}else e.file(t,r)}function fs(){return Ui.utils.cfb_new()}var hs='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var gs={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ms=qi(gs),xs=/[&<>'"]/g,bs=/[\u0000-\u0008\u000b-\u001f]/g;function vs(e){return(e+"").replace(xs,function(e){return ms[e]}).replace(bs,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ys(e){return vs(e).replace(/ /g,"_x0020_")}var js=/[\u0000-\u001f]/g;function _s(e){return(e+"").replace(xs,function(e){return ms[e]}).replace(/\n/g,"<br/>").replace(js,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ss(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ws(e){for(var t="",r=0,n=0,o=0,a=0,i=0,s=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(o=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&o,t+=String.fromCharCode(i)):(a=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&a):(s=((7&n)<<18|(63&o)<<12|(63&a)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function ks(e){var t,r,n,o=Wa(2*e.length),a=1,i=0,s=0;for(r=0;r<e.length;r+=a)a=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),a=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),a=3):(a=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(o[i++]=255&s,o[i++]=s>>>8,s=0),o[i++]=t%256,o[i++]=t>>>8;return o.slice(0,i).toString("ucs2")}function Cs(e){return Ma(e,"binary").toString("utf8")}var Es="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Ts=Fa&&(Cs(Es)==ws(Es)&&Cs||ks(Es)==ws(Es)&&ks)||ws,Rs=Fa?function(e){return Ma(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,o=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,o=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(o>>18&7))),t.push(String.fromCharCode(144+(o>>12&63))),t.push(String.fromCharCode(128+(o>>6&63))),t.push(String.fromCharCode(128+(63&o)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},Ns=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}();var As=/(^\s|\s$|\n)/;function zs(e,t){return"<"+e+(t.match(As)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Is(e){return Yi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Os(e,t,r){return"<"+e+(null!=r?Is(r):"")+(null!=t?(t.match(As)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ps(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(Fh){if(t)throw Fh}return""}var Ds="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ls="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Bs="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fs="http://schemas.openxmlformats.org/package/2006/content-types",Ms="http://schemas.openxmlformats.org/package/2006/relationships",Ws="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Us="http://purl.org/dc/elements/1.1/",Hs="http://purl.org/dc/terms/",Vs="http://purl.org/dc/dcmitype/",Gs="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Ys="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",$s="http://www.w3.org/2001/XMLSchema-instance",qs="http://www.w3.org/2001/XMLSchema",Xs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ks="urn:schemas-microsoft-com:office:office",Js="urn:schemas-microsoft-com:office:excel",Qs="urn:schemas-microsoft-com:office:spreadsheet",Zs="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",el="http://macVmlSchemaUri",tl="urn:schemas-microsoft-com:vml",rl="http://www.w3.org/TR/REC-html40";var nl=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,o=e[0][r].length;n<o;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},ol=Fa?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Ma(e)})):nl(e)}:nl,al=function(e,t,r){for(var n=[],o=t;o<r;o+=2)n.push(String.fromCharCode(Cl(e,o)));return n.join("").replace($a,"")},il=Fa?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace($a,""):al(e,t,r)}:al,sl=function(e,t,r){for(var n=[],o=t;o<t+r;++o)n.push(("0"+e[o].toString(16)).slice(-2));return n.join("")},ll=Fa?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sl(e,t,r)}:sl,cl=function(e,t,r){for(var n=[],o=t;o<r;o++)n.push(String.fromCharCode(kl(e,o)));return n.join("")},dl=Fa?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):cl(e,t,r)}:cl,pl=function(e,t){var r=Tl(e,t);return r>0?dl(e,t+4,t+4+r-1):""},ul=pl,fl=function(e,t){var r=Tl(e,t);return r>0?dl(e,t+4,t+4+r-1):""},hl=fl,gl=function(e,t){var r=2*Tl(e,t);return r>0?dl(e,t+4,t+4+r-1):""},ml=gl,xl=function(e,t){var r=Tl(e,t);return r>0?il(e,t+4,t+4+r):""},bl=xl,vl=function(e,t){var r=Tl(e,t);return r>0?dl(e,t+4,t+4+r):""},yl=vl,jl=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),o=15&e[t+6],a=5;a>=0;--a)o=256*o+e[t+a];return 2047==n?0==o?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,o+=Math.pow(2,52)),r*Math.pow(2,n-52)*o)}(e,t)},_l=jl,Sl=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function wl(){il=function(e,t,r){return Ia.utils.decode(1200,e.slice(t,r)).replace($a,"")},dl=function(e,t,r){return Ia.utils.decode(65001,e.slice(t,r))},ul=function(e,t){var r=Tl(e,t);return r>0?Ia.utils.decode(Ca,e.slice(t+4,t+4+r-1)):""},hl=function(e,t){var r=Tl(e,t);return r>0?Ia.utils.decode(ka,e.slice(t+4,t+4+r-1)):""},ml=function(e,t){var r=2*Tl(e,t);return r>0?Ia.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},bl=function(e,t){var r=Tl(e,t);return r>0?Ia.utils.decode(1200,e.slice(t+4,t+4+r)):""},yl=function(e,t){var r=Tl(e,t);return r>0?Ia.utils.decode(65001,e.slice(t+4,t+4+r)):""}}Fa&&(ul=function(e,t){if(!Buffer.isBuffer(e))return pl(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},hl=function(e,t){if(!Buffer.isBuffer(e))return fl(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},ml=function(e,t){if(!Buffer.isBuffer(e))return gl(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},bl=function(e,t){if(!Buffer.isBuffer(e))return xl(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},yl=function(e,t){if(!Buffer.isBuffer(e))return vl(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},_l=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):jl(e,t)},Sl=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Ia&&wl();var kl=function(e,t){return e[t]},Cl=function(e,t){return 256*e[t+1]+e[t]},El=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Tl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Rl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Nl=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Al(e,t){var r,n,o,a,i,s,l="",c=[];switch(t){case"dbcs":if(s=this.l,Fa&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Cl(this,s)),s+=2;e*=2;break;case"utf8":l=dl(this,this.l,this.l+e);break;case"utf16le":e*=2,l=il(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Ia)return Al.call(this,e,"dbcs");l=Ia.utils.decode(ka,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=ul(this,this.l),e=4+Tl(this,this.l);break;case"lpstr-cp":l=hl(this,this.l),e=4+Tl(this,this.l);break;case"lpwstr":l=ml(this,this.l),e=4+2*Tl(this,this.l);break;case"lpp4":e=4+Tl(this,this.l),l=bl(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Tl(this,this.l),l=yl(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(o=kl(this,this.l+e++));)c.push(Oa(o));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(o=Cl(this,this.l+e));)c.push(Oa(o)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",s=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(s))return o=kl(this,s),this.l=s+1,a=Al.call(this,e-i,o?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(Oa(Cl(this,s))),s+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Ia){l=Ia.utils.decode(ka,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",s=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(s))return o=kl(this,s),this.l=s+1,a=Al.call(this,e-i,o?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(Oa(kl(this,s))),s+=1}l=c.join("");break;default:switch(e){case 1:return r=kl(this,this.l),this.l++,r;case 2:return r=("i"===t?El:Cl)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Rl:Nl)(this,this.l),this.l+=4,r):(n=Tl(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?_l(this,this.l):_l([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=ll(this,this.l,e)}}return this.l+=e,l}var zl=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Il=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ol=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Pl(e,t,r){var n=0,o=0;if("dbcs"===r){for(o=0;o!=t.length;++o)Ol(this,t.charCodeAt(o),this.l+2*o);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof Ia&&874==Ca)for(o=0;o!=t.length;++o){var a=Ia.utils.encode(Ca,t.charAt(o));this[this.l+o]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=t.length;++o)this[this.l+o]=255&t.charCodeAt(o);n=t.length}else{if("hex"===r){for(;o<e;++o)this[this.l++]=parseInt(t.slice(2*o,2*o+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(o=0;o<Math.min(t.length,e);++o){var s=t.charCodeAt(o);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,zl(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,o=0,a=0,i=n?-t:t;isFinite(i)?0==i?o=a=0:(o=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-o),o<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?o=-1022:(a-=Math.pow(2,52),o+=1023)):(o=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)e[r+s]=255&a;e[r+6]=(15&o)<<4|15&a,e[r+7]=o>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,Il(this,t,this.l)}}return this.l+=n,this}function Dl(e,t){var r=ll(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ll(e,t){e.l=t,e.read_shift=Al,e.chk=Dl,e.write_shift=Pl}function Bl(e,t){e.l+=t}function Fl(e){var t=Wa(e);return Ll(t,0),t}function Ml(){var e=[],t=Fa?256:2048,r=function(e){var t=Fl(e);return Ll(t,0),t},n=r(t),o=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},a=function(e){return n&&e<n.length-n.l?n:(o(),n=r(Math.max(e+1,t)))};return{next:a,push:function(e){o(),null==(n=e).l&&(n.l=n.length),a(t)},end:function(){return o(),Ya(e)},_bufs:e}}function Wl(e,t,r,n){var o,a=+t;if(!isNaN(a)){n||(n=rf[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var i=e.next(o);a<=127?i.write_shift(1,a):(i.write_shift(1,128+(127&a)),i.write_shift(1,a>>7));for(var s=0;4!=s;++s){if(!(n>=128)){i.write_shift(1,n);break}i.write_shift(1,128+(127&n)),n>>=7}n>0&&Sl(r)&&e.push(r)}}function Ul(e,t,r){var n=ss(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hl(e,t,r){var n=ss(e);return n.s=Ul(n.s,t.s,r),n.e=Ul(n.e,t.s,r),n}function Vl(e,t){if(e.cRel&&e.c<0)for(e=ss(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ss(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Jl(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Gl(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Vl(e.s,t.biff)+":"+Vl(e.e,t.biff):(e.s.rRel?"":"$")+$l(e.s.r)+":"+(e.e.rRel?"":"$")+$l(e.e.r):(e.s.cRel?"":"$")+Xl(e.s.c)+":"+(e.e.cRel?"":"$")+Xl(e.e.c)}function Yl(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function $l(e){return""+(e+1)}function ql(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Xl(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Kl(e){for(var t=0,r=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o>=48&&o<=57?t=10*t+(o-48):o>=65&&o<=90&&(r=26*r+(o-64))}return{c:r-1,r:t-1}}function Jl(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ql(e){var t=e.indexOf(":");return-1==t?{s:Kl(e),e:Kl(e)}:{s:Kl(e.slice(0,t)),e:Kl(e.slice(t+1))}}function Zl(e,t){return"undefined"===typeof t||"number"===typeof t?Zl(e.s,e.e):("string"!==typeof e&&(e=Jl(e)),"string"!==typeof t&&(t=Jl(t)),e==t?e:e+":"+t)}function ec(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,o=0,a=e.length;for(r=0;n<a&&!((o=e.charCodeAt(n)-64)<1||o>26);++n)r=26*r+o;for(t.s.c=--r,r=0;n<a&&!((o=e.charCodeAt(n)-48)<0||o>9);++n)r=10*r+o;if(t.s.r=--r,n===a||10!=o)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((o=e.charCodeAt(n)-64)<1||o>26);++n)r=26*r+o;for(t.e.c=--r,r=0;n!=a&&!((o=e.charCodeAt(n)-48)<0||o>9);++n)r=10*r+o;return t.e.r=--r,t}function tc(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Di(e.z,r?Ji(t):t)}catch(Fh){}try{return e.w=Di((e.XF||{}).numFmtId||(r?14:0),r?Ji(t):t)}catch(Fh){return""+t}}function rc(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Lc[e.v]||e.v:tc(e,void 0==t?e.v:t))}function nc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function oc(e,t,r){var n=r||{},o=e?Array.isArray(e):n.dense;var a=e||(o?[]:{}),i=0,s=0;if(a&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?Kl(n.origin):n.origin;i=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ec(a["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[p].length;++u)if("undefined"!==typeof t[p][u]){var f={v:t[p][u]},h=i+p,g=s+u;if(c.s.r>h&&(c.s.r=h),c.s.c>g&&(c.s.c=g),c.e.r<h&&(c.e.r=h),c.e.c<g&&(c.e.c=g),!t[p][u]||"object"!==typeof t[p][u]||Array.isArray(t[p][u])||t[p][u]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[p][u][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||oi[14],n.cellDates?(f.t="d",f.w=Di(f.z,Ji(f.v))):(f.t="n",f.v=Ji(f.v),f.w=Di(f.z,f.v))):f.t="s";else f=t[p][u];if(o)a[h]||(a[h]=[]),a[h][g]&&a[h][g].z&&(f.z=a[h][g].z),a[h][g]=f;else{var m=Jl({c:g,r:h});a[m]&&a[m].z&&(f.z=a[m].z),a[m]=f}}}return c.s.c<1e7&&(a["!ref"]=Zl(c)),a}function ac(e,t){return oc(null,e,t)}function ic(e,t){return t||(t=Fl(4)),t.write_shift(4,e),t}function sc(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function lc(e,t){var r=!1;return null==t&&(r=!0,t=Fl(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cc(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dc(e,t){var r=e.l,n=e.read_shift(1),o=sc(e),a=[],i={t:o,h:o};if(0!==(1&n)){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(cc(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var pc=dc;function uc(e,t){var r=!1;return null==t&&(r=!0,t=Fl(23+4*e.t.length)),t.write_shift(1,1),lc(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Fl(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function fc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function hc(e,t){return null==t&&(t=Fl(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function gc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function mc(e,t){return null==t&&(t=Fl(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var xc=sc,bc=lc;function vc(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function yc(e,t){var r=!1;return null==t&&(r=!0,t=Fl(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jc=sc,_c=vc,Sc=yc;function wc(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var o=0===n?_l([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Rl(t,0)>>2;return r?o/100:o}function kc(e,t){null==t&&(t=Fl(4));var r=0,n=0,o=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:o==(0|o)&&o>=-(1<<29)&&o<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?o:e)<<2)+(r+2))}function Cc(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ec=Cc,Tc=function(e,t){return t||(t=Fl(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Rc(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Nc(e,t){return(t||Fl(8)).write_shift(8,e,"f")}function Ac(e,t){if(t||(t=Fl(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var zc=80,Ic={1:{n:"CodePage",t:2},2:{n:"Category",t:zc},3:{n:"PresentationFormat",t:zc},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:zc},15:{n:"Company",t:zc},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:zc},27:{n:"ContentStatus",t:zc},28:{n:"Language",t:zc},29:{n:"Version",t:zc},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Oc={1:{n:"CodePage",t:2},2:{n:"Title",t:zc},3:{n:"Subject",t:zc},4:{n:"Author",t:zc},5:{n:"Keywords",t:zc},6:{n:"Comments",t:zc},7:{n:"Template",t:zc},8:{n:"LastAuthor",t:zc},9:{n:"RevNumber",t:zc},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:zc},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Pc(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Dc=ss(Pc([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Lc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Bc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Mc(e,t){var r,n=function(e){for(var t=[],r=Yi(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(Bc),o=[];o[o.length]=hs,o[o.length]=Os("Types",null,{xmlns:Fs,"xmlns:xsd":qs,"xmlns:xsi":$s}),o=o.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Os("Default",null,{Extension:e[0],ContentType:e[1]})}));var a=function(n){e[n]&&e[n].length>0&&(r=e[n][0],o[o.length]=Os("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:Fc[n][t.bookType]||Fc[n].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){o[o.length]=Os("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Fc[r][t.bookType]||Fc[r].xlsx})})},s=function(t){(e[t]||[]).forEach(function(e){o[o.length]=Os("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:n[t][0]})})};return a("workbooks"),i("sheets"),i("charts"),s("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),i("metadata"),s("people"),o.length>2&&(o[o.length]="</Types>",o[1]=o[1].replace("/>",">")),o.join("")}var Wc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Uc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Hc(e){var t=[hs,Os("Relationships",null,{xmlns:Ms})];return Yi(e["!id"]).forEach(function(r){t[t.length]=Os("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Vc(e,t,r,n,o,a){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,o.Id="rId"+t,o.Type=n,o.Target=r,a?o.TargetMode=a:[Wc.HLINK,Wc.XPATH,Wc.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,t}function Gc(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Yc(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function $c(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wa.version+"</meta:generator></office:meta></office:document-meta>"}var qc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Xc(e,t,r,n,o){null==o[e]&&null!=t&&""!==t&&(o[e]=t,t=vs(t),n[n.length]=r?Os(e,t,r):zs(e,t))}function Kc(e,t){var r=t||{},n=[hs,Os("cp:coreProperties",null,{"xmlns:cp":Ds,"xmlns:dc":Us,"xmlns:dcterms":Hs,"xmlns:dcmitype":Vs,"xmlns:xsi":$s})],o={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&Xc("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Ps(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,o),null!=e.ModifiedDate&&Xc("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Ps(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,o));for(var a=0;a!=qc.length;++a){var i=qc[a],s=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&Xc(i[0],s,null,n,o)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Jc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Qc=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Zc(e){var t=[],r=Os;return e||(e={}),e.Application="SheetJS",t[t.length]=hs,t[t.length]=Os("Properties",null,{xmlns:Bs,"xmlns:vt":Ys}),Jc.forEach(function(n){if(void 0!==e[n[1]]){var o;switch(n[2]){case"string":o=vs(String(e[n[1]]));break;case"bool":o=e[n[1]]?"true":"false"}void 0!==o&&(t[t.length]=r(n[0],o))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+vs(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function ed(e){var t=[hs,Os("Properties",null,{xmlns:Ls,"xmlns:vt":Ys})];if(!e)return t.join("");var r=1;return Yi(e).forEach(function(n){++r,t[t.length]=Os("property",function(e,t){switch(typeof e){case"string":var r=Os("vt:lpwstr",vs(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Os((0|e)==e?"vt:i4":"vt:r8",vs(String(e)));case"boolean":return Os("vt:bool",e?"true":"false")}if(e instanceof Date)return Os("vt:filetime",Ps(e));throw new Error("Unable to serialize "+e)}(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:vs(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var td={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rd(e,t){var r=Fl(4),n=Fl(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=Fl(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var o=(r*=1e7)/Math.pow(2,32)|0;o>0&&(r%=Math.pow(2,32),n+=o);var a=Fl(8);return a.write_shift(4,r),a.write_shift(4,n),a}(t);break;case 31:case 80:for((n=Fl(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ya([r,n])}var nd=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function od(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ad(e,t,r){var n=Fl(8),o=[],a=[],i=8,s=0,l=Fl(8),c=Fl(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),o.push(c),i+=8+l.length,!t){(c=Fl(8)).write_shift(4,0),o.unshift(c);var d=[Fl(4)];for(d[0].write_shift(4,e.length),s=0;s<e.length;++s){var p=e[s][0];for((l=Fl(8+2*(p.length+1)+(p.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Ya(d),a.unshift(l),i+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!(nd.indexOf(e[s][0])>-1||Qc.indexOf(e[s][0])>-1)&&null!=e[s][1]){var u=e[s][1],f=0;if(t){var h=r[f=+t[e[s][0]]];if("version"==h.p&&"string"==typeof u){var g=u.split(".");u=(+g[0]<<16)+(+g[1]||0)}l=rd(h.t,u)}else{var m=od(u);-1==m&&(m=31,u=String(u)),l=rd(m,u)}a.push(l),(c=Fl(8)).write_shift(4,t?f:2+s),o.push(c),i+=8+l.length}var x=8*(a.length+1);for(s=0;s<a.length;++s)o[s].write_shift(4,x),x+=a[s].length;return n.write_shift(4,i),n.write_shift(4,a.length),Ya([n].concat(o).concat(a))}function id(e,t,r,n,o,a){var i=Fl(o?68:48),s=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ui.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,o?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,o?68:48);var l=ad(e,r,n);if(s.push(l),o){var c=ad(o,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),s.push(c)}return Ya(s)}function sd(e,t){return 1===e.read_shift(t)}function ld(e,t){return t||(t=Fl(2)),t.write_shift(2,+!!e),t}function cd(e){return e.read_shift(2,"u")}function dd(e,t){return t||(t=Fl(2)),t.write_shift(2,e),t}function pd(e,t,r){return r||(r=Fl(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function ud(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),o="sbcs-cont",a=ka;(r&&r.biff>=8&&(ka=1200),r&&8!=r.biff)?12==r.biff&&(o="wstr"):e.read_shift(1)&&(o="dbcs-cont");r.biff>=2&&r.biff<=5&&(o="cpstr");var i=n?e.read_shift(n,o):"";return ka=a,i}function fd(e){var t=e.t||"",r=Fl(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Fl(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),Ya([r,n])}function hd(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function gd(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):hd(e,n,r)}function md(e,t,r){if(r.biff>5)return gd(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function xd(e,t,r){return r||(r=Fl(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function bd(e,t){t||(t=Fl(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function vd(e){var t=Fl(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var o=n.indexOf("#"),a=o>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==a)bd(n=n.slice(1),t);else if(2&a){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var s=o>-1?n.slice(0,o):n;for(t.write_shift(4,2*(s.length+1)),r=0;r<s.length;++r)t.write_shift(2,s.charCodeAt(r));t.write_shift(2,0),8&a&&bd(o>-1?n.slice(o+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,255&n.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function yd(e,t,r,n){return n||(n=Fl(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function jd(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function _d(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function Sd(e,t){return t||(t=Fl(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function wd(e,t,r){var n=1536,o=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,o=8;break;case"biff4":n=4,o=6;break;case"biff3":n=3,o=6;break;case"biff2":n=2,o=4;break;default:throw new Error("unsupported BIFF version")}var a=Fl(o);return a.write_shift(2,n),a.write_shift(2,t),o>4&&a.write_shift(2,29282),o>6&&a.write_shift(2,1997),o>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function kd(e,t){var r=!t||t.biff>=8?2:1,n=Fl(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var o=n.slice(0,n.l);return o.l=n.l,o}function Cd(e,t,r,n){var o=r&&5==r.biff;n||(n=Fl(o?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(o?1:2,t.length),o||n.write_shift(1,1),n.write_shift((o?1:2)*t.length,t,o?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return null==a.l&&(a.l=a.length),a}function Ed(e,t,r,n){var o=r&&5==r.biff;n||(n=Fl(o?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&o&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),o||n.write_shift(4,0),n.write_shift(2,0),n}function Td(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=ud(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],o=e.l+t,a=e.read_shift(r.biff>8?4:2);0!==a--;)n.push(jd(e,r.biff,r));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return n}function Rd(e){var t=Fl(24),r=Kl(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)t.write_shift(1,parseInt(n[o],16));return Ya([t,vd(e[1])])}function Nd(e){var t=e[1].Tooltip,r=Fl(10+2*(t.length+1));r.write_shift(2,2048);var n=Kl(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var o=0;o<t.length;++o)r.write_shift(2,t.charCodeAt(o));return r.write_shift(2,0),r}function Ad(e,t,r){if(!r.cellStyles)return Bl(e,t);var n=r&&r.biff>=12?4:2,o=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:o,e:a,w:i,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var zd=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var o=ac(function(t,r){var n=[],o=Wa(1);switch(r.type){case"base64":o=Ha(Ba(t));break;case"binary":o=Ha(t);break;case"buffer":case"array":o=t}Ll(o,0);var a=o.read_shift(1),i=!!(136&a),s=!1,l=!1;switch(a){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var c=0,d=521;2==a&&(c=o.read_shift(2)),o.l+=3,2!=a&&(c=o.read_shift(4)),c>1048576&&(c=1e6),2!=a&&(d=o.read_shift(2));var p=o.read_shift(2),u=r.codepage||1252;2!=a&&(o.l+=16,o.read_shift(1),0!==o[o.l]&&(u=e[o[o.l]]),o.l+=1,o.l+=2),l&&(o.l+=36);for(var f=[],h={},g=Math.min(o.length,2==a?521:d-10-(s?264:0)),m=l?32:11;o.l<g&&13!=o[o.l];)switch((h={}).name=Ia.utils.decode(u,o.slice(o.l,o.l+m)).replace(/[\u0000\r\n].*$/g,""),o.l+=m,h.type=String.fromCharCode(o.read_shift(1)),2==a||l||(h.offset=o.read_shift(4)),h.len=o.read_shift(1),2==a&&(h.offset=o.read_shift(2)),h.dec=o.read_shift(1),h.name.length&&f.push(h),2!=a&&(o.l+=l?13:14),h.type){case"B":s&&8==h.len||!r.WTF||console.log("Skipping "+h.name+":"+h.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+h.name+":"+h.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+h.type)}if(13!==o[o.l]&&(o.l=d-1),13!==o.read_shift(1))throw new Error("DBF Terminator not found "+o.l+" "+o[o.l]);o.l=d;var x=0,b=0;for(n[0]=[],b=0;b!=f.length;++b)n[0][b]=f[b].name;for(;c-- >0;)if(42!==o[o.l])for(++o.l,n[++x]=[],b=0,b=0;b!=f.length;++b){var v=o.slice(o.l,o.l+f[b].len);o.l+=f[b].len,Ll(v,0);var y=Ia.utils.decode(u,v);switch(f[b].type){case"C":y.trim().length&&(n[x][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?n[x][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):n[x][b]=y;break;case"F":n[x][b]=parseFloat(y.trim());break;case"+":case"I":n[x][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":n[x][b]=!0;break;case"N":case"F":n[x][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));n[x][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(n[x][b]=+y||0);break;case"@":n[x][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":n[x][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":n[x][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[x][b]=-v.read_shift(-8,"f");break;case"B":if(s&&8==f[b].len){n[x][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else o.l+=p;if(2!=a&&o.l<o.length&&26!=o[o.l++])throw new Error("DBF EOF Marker missing "+(o.l-1)+" of "+o.length+" "+o[o.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return o["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,o}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return nc(r(e,t),t)}catch(Fh){if(t&&t.WTF)throw Fh}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var o=r||{};if(+o.codepage>=0&&Na(+o.codepage),"string"==o.type)throw new Error("Cannot write DBF to JS string");var a=Ml(),i=th(e,{header:1,raw:!0,cellDates:!0}),s=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,p=0,u=0,f=1;for(d=0;d<s.length;++d)if(((c[d]||{}).DBF||{}).name)s[d]=c[d].DBF.name,++u;else if(null!=s[d]){if(++u,"number"===typeof s[d]&&(s[d]=s[d].toString(10)),"string"!==typeof s[d])throw new Error("DBF Invalid column name "+s[d]+" |"+typeof s[d]+"|");if(s.indexOf(s[d])!==d)for(p=0;p<1024;++p)if(-1==s.indexOf(s[d]+"_"+p)){s[d]+="_"+p;break}}var h=ec(e["!ref"]),g=[],m=[],x=[];for(d=0;d<=h.e.c-h.s.c;++d){var b="",v="",y=0,j=[];for(p=0;p<l.length;++p)null!=l[p][d]&&j.push(l[p][d]);if(0!=j.length&&null!=s[d]){for(p=0;p<j.length;++p){switch(typeof j[p]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=j[p]instanceof Date?"D":"C"}y=Math.max(y,String(j[p]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),m[d]="C"==b||"N"==v?y:n[b]||0,f+=m[d],g[d]=b}else g[d]="?"}var _=a.next(32);for(_.write_shift(4,318902576),_.write_shift(4,l.length),_.write_shift(2,296+32*u),_.write_shift(2,f),d=0;d<4;++d)_.write_shift(4,0);for(_.write_shift(4,(+t[Ca]||3)<<8),d=0,p=0;d<s.length;++d)if(null!=s[d]){var S=a.next(32),w=(s[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,w,"sbcs"),S.write_shift(1,"?"==g[d]?"C":g[d],"sbcs"),S.write_shift(4,p),S.write_shift(1,m[d]||n[g[d]]||0),S.write_shift(1,x[d]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),p+=m[d]||n[g[d]]||0}var k=a.next(264);for(k.write_shift(4,13),d=0;d<65;++d)k.write_shift(4,0);for(d=0;d<l.length;++d){var C=a.next(f);for(C.write_shift(1,0),p=0;p<s.length;++p)if(null!=s[p])switch(g[p]){case"L":C.write_shift(1,null==l[d][p]?63:l[d][p]?84:70);break;case"B":C.write_shift(8,l[d][p]||0,"f");break;case"N":var E="0";for("number"==typeof l[d][p]&&(E=l[d][p].toFixed(x[p]||0)),u=0;u<m[p]-E.length;++u)C.write_shift(1,32);C.write_shift(1,E,"sbcs");break;case"D":l[d][p]?(C.write_shift(4,("0000"+l[d][p].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(l[d][p].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+l[d][p].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var T=String(null!=l[d][p]?l[d][p]:"").slice(0,m[p]);for(C.write_shift(1,T,"sbcs"),u=0;u<m[p]-T.length;++u)C.write_shift(1,32)}}return a.next(1).write_shift(1,26),a.end()}}}(),Id=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Yi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?Pa(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:Pa(n)};function o(e,o){var a,i=e.split(/[\n\r]+/),s=-1,l=-1,c=0,d=0,p=[],u=[],f=null,h={},g=[],m=[],x=[],b=0;for(+o.codepage>=0&&Na(+o.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),j=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),_=j[0];if(y.length>0)switch(_){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==j[1].charAt(0)&&u.push(y.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,w=!1,k=!1,C=!1,E=-1,T=-1;for(d=1;d<j.length;++d)switch(j[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(j[d].slice(1))-1,w=!0;break;case"Y":for(s=parseInt(j[d].slice(1))-1,w||(l=0),a=p.length;a<=s;++a)p[a]=[];break;case"K":'"'===(v=j[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(cs(v))?isNaN(ps(v).getDate())||(v=as(v)):(v=cs(v),null!==f&&zi(f)&&(v=ts(v))),"undefined"!==typeof Ia&&"string"==typeof v&&"string"!=(o||{}).type&&(o||{}).codepage&&(v=Ia.utils.decode(o.codepage,v)),S=!0;break;case"E":C=!0;var R=wp(j[d].slice(1),{r:s,c:l});p[s][l]=[p[s][l],R];break;case"S":k=!0,p[s][l]=[p[s][l],"S5S"];break;case"R":E=parseInt(j[d].slice(1))-1;break;case"C":T=parseInt(j[d].slice(1))-1;break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+y)}if(S&&(p[s][l]&&2==p[s][l].length?p[s][l][0]=v:p[s][l]=v,f=null),k){if(C)throw new Error("SYLK shared formula cannot have own formula");var N=E>-1&&p[E][T];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");p[s][l][1]=Ep(N[1],{r:s-E,c:l-T})}break;case"F":var A=0;for(d=1;d<j.length;++d)switch(j[d].charAt(0)){case"X":l=parseInt(j[d].slice(1))-1,++A;break;case"Y":for(s=parseInt(j[d].slice(1))-1,a=p.length;a<=s;++a)p[a]=[];break;case"M":b=parseInt(j[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=u[parseInt(j[d].slice(1))];break;case"W":for(x=j[d].slice(1).split(" "),a=parseInt(x[0],10);a<=parseInt(x[1],10);++a)b=parseInt(x[2],10),m[a-1]=0===b?{hidden:!0}:{wch:b},Kd(m[a-1]);break;case"C":m[l=parseInt(j[d].slice(1))-1]||(m[l]={});break;case"R":g[s=parseInt(j[d].slice(1))-1]||(g[s]={}),b>0?(g[s].hpt=b,g[s].hpx=Zd(b)):0===b&&(g[s].hidden=!0);break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+y)}A<1&&(f=null);break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+y)}}return g.length>0&&(h["!rows"]=g),m.length>0&&(h["!cols"]=m),o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),[p,h]}function a(e,t){var r=function(e,t){switch(t.type){case"base64":return o(Ba(e),t);case"binary":return o(e,t);case"buffer":return o(Fa&&Buffer.isBuffer(e)?e.toString("binary"):Ga(e),t);case"array":return o(is(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],a=r[1],i=ac(n,t);return Yi(a).forEach(function(e){i[e]=a[e]}),i}function i(e,t,r,n){var o="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":o+=e.v||0,e.f&&!e.F&&(o+=";E"+Cp(e.f,{r:r,c:n}));break;case"b":o+=e.v?"TRUE":"FALSE";break;case"e":o+=e.w||e.v;break;case"d":o+='"'+(e.w||e.v)+'"';break;case"s":o+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return o}return e["|"]=254,{to_workbook:function(e,t){return nc(a(e,t),t)},to_sheet:a,from_sheet:function(e,t){var r,n,o=["ID;PWXL;N;E"],a=[],s=ec(e["!ref"]),l=Array.isArray(e),c="\r\n";o.push("P;PGeneral"),o.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=o,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=$d(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=qd(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*Qd(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))})}(o,e["!rows"]),o.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var d=s.s.r;d<=s.e.r;++d)for(var p=s.s.c;p<=s.e.c;++p){var u=Jl({r:d,c:p});(r=l?(e[d]||[])[p]:e[u])&&(null!=r.v||r.f&&!r.F)&&a.push(i(r,0,d,p))}return o.join(c)+c+a.join(c)+c+"E"+c}}}(),Od=function(){function e(e,t){for(var r=e.split("\n"),n=-1,o=-1,a=0,i=[];a!==r.length;++a)if("BOT"!==r[a].trim()){if(!(n<0)){for(var s=r[a].trim().split(","),l=s[0],c=s[1],d=r[++a]||"";1&(d.match(/["]/g)||[]).length&&a<r.length-1;)d+="\n"+r[++a];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++n]=[],o=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[n][o]=!0:"FALSE"===d?i[n][o]=!1:isNaN(cs(c))?isNaN(ps(c).getDate())?i[n][o]=c:i[n][o]=as(c):i[n][o]=cs(c),++o;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[n][o++]=""!==d?d:null}if("EOD"===d)break}}else i[++n]=[],o=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return ac(function(t,r){switch(r.type){case"base64":return e(Ba(t),r);case"binary":return e(t,r);case"buffer":return e(Fa&&Buffer.isBuffer(t)?t.toString("binary"):Ga(t),r);case"array":return e(is(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return nc(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,o){e.push(t),e.push(r+","+n),e.push('"'+o.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,o=[],a=ec(r["!ref"]),i=Array.isArray(r);e(o,"TABLE",0,1,"sheetjs"),e(o,"VECTORS",0,a.e.r-a.s.r+1,""),e(o,"TUPLES",0,a.e.c-a.s.c+1,""),e(o,"DATA",0,0,"");for(var s=a.s.r;s<=a.e.r;++s){t(o,-1,0,"BOT");for(var l=a.s.c;l<=a.e.c;++l){var c=Jl({r:s,c:l});if(n=i?(r[s]||[])[l]:r[c])switch(n.t){case"n":var d=n.w;d||null==n.v||(d=n.v),null==d?n.f&&!n.F?t(o,1,0,"="+n.f):t(o,1,0,""):t(o,0,d,"V");break;case"b":t(o,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(o,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=Di(n.z||oi[14],Ji(as(n.v)))),t(o,0,n.w,"V");break;default:t(o,1,0,"")}else t(o,1,0,"")}}t(o,-1,0,"EOD");return o.join("\r\n")}}()}}(),Pd=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return ac(function(t,r){for(var n=t.split("\n"),o=-1,a=-1,i=0,s=[];i!==n.length;++i){var l=n[i].trim().split(":");if("cell"===l[0]){var c=Kl(l[1]);if(s.length<=c.r)for(o=s.length;o<=c.r;++o)s[o]||(s[o]=[]);switch(o=c.r,a=c.c,l[2]){case"t":s[o][a]=e(l[3]);break;case"v":s[o][a]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?s[o][a]=!!+l[4]:s[o][a]=+l[4],"vtf"==l[2]&&(s[o][a]=[s[o][a],d])}}}return r&&r.sheetRows&&(s=s.slice(0,r.sheetRows)),s}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function s(e){if(!e||!e["!ref"])return"";for(var r,n=[],o=[],a="",i=Ql(e["!ref"]),s=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(a=Jl({r:l,c:c}),(r=s?(e[l]||[])[c]:e[a])&&null!=r.v&&"z"!==r.t){switch(o=["cell",a,"t"],r.t){case"s":case"str":o.push(t(r.v));break;case"n":r.f?(o[2]="vtf",o[3]="n",o[4]=r.v,o[5]=t(r.f)):(o[2]="v",o[3]=r.v);break;case"b":o[2]="vt"+(r.f?"f":"c"),o[3]="nl",o[4]=r.v?"1":"0",o[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=Ji(as(r.v));o[2]="vtc",o[3]="nd",o[4]=""+d,o[5]=r.w||Di(r.z||oi[14],d);break;case"e":continue}n.push(o.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return nc(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,o,a,o,s(e),i].join("\n")}}}(),Dd=function(){function e(e,t,r,n,o){o.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(cs(e))?isNaN(ps(e).getDate())?t[r][n]=e:t[r][n]=as(e):t[r][n]=cs(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},o=!1,a=0,i=0;a<e.length;++a)34==(i=e.charCodeAt(a))?o=!o:!o&&i in t&&(n[i]=(n[i]||0)+1);for(a in i=[],n)Object.prototype.hasOwnProperty.call(n,a)&&i.push([n[a],a]);if(!i.length)for(a in n=r)Object.prototype.hasOwnProperty.call(n,a)&&i.push([n[a],a]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function o(e,t){var r=t||{},o="";var a=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(o=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(o=e.charAt(4),e=e.slice(6)):o=n(e.slice(0,1024)):o=r&&r.FS?r.FS:n(e.slice(0,1024));var s=0,l=0,c=0,d=0,p=0,u=o.charCodeAt(0),f=!1,h=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=r.dateNF?function(e){var t="number"==typeof e?oi[e]:e;return t=t.replace(Mi,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function x(){var t=e.slice(d,p),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=cs(t)))if(!isNaN(ps(t).getDate())||m&&t.match(m)){n.z=r.dateNF||oi[14];var o=0;m&&t.match(m)&&(t=function(e,t,r){var n=-1,o=-1,a=-1,i=-1,s=-1,l=-1;(t.match(Mi)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":a=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?s=c:o=c}}),l>=0&&-1==s&&o>=0&&(s=o,o=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==s&&-1==l?c:-1==n&&-1==o&&-1==a?d:c+"T"+d}(0,r.dateNF,t.match(m)||[]),o=1),r.cellDates?(n.t="d",n.v=as(t,o)):(n.t="n",n.v=Ji(as(t,o))),!1!==r.cellText&&(n.w=Di(n.z,n.v instanceof Date?Ji(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(a[s]||(a[s]=[]),a[s][l]=n):a[Jl({c:l,r:s})]=n),d=p+1,g=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<s&&(i.e.r=s),h==u)++l;else if(l=0,++s,r.sheetRows&&r.sheetRows<=s)return!0}e:for(;p<e.length;++p)switch(h=e.charCodeAt(p)){case 34:34===g&&(f=!f);break;case u:case 10:case 13:if(!f&&x())break e}return p-d>0&&x(),a["!ref"]=Zl(i),a}function a(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?o(t,r):ac(function(t,r){var n=r||{},o=[];if(!t||0===t.length)return o;for(var a=t.split(/[\r\n]/),i=a.length-1;i>=0&&0===a[i].length;)--i;for(var s=10,l=0,c=0;c<=i;++c)-1==(l=a[c].indexOf(" "))?l=a[c].length:l++,s=Math.max(s,l);for(c=0;c<=i;++c){o[c]=[];var d=0;for(e(a[c].slice(0,s).trim(),o,c,d,n),d=1;d<=(a[c].length-s)/10+1;++d)e(a[c].slice(s+10*(d-1),s+10*d).trim(),o,c,d,n)}return n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,r),r):o(t,r)}function i(e,t){var r="",n="string"==t.type?[0,0,0,0]:Yf(e,t);switch(t.type){case"base64":r=Ba(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Ia?Ia.utils.decode(t.codepage,e):Fa&&Buffer.isBuffer(e)?e.toString("binary"):Ga(e);break;case"array":r=is(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Ts(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Ts(r):"binary"==t.type&&"undefined"!==typeof Ia&&t.codepage&&(r=Ia.utils.decode(t.codepage,Ia.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Pd.to_sheet("string"==t.type?r:Ts(r),t):a(r,t)}return{to_workbook:function(e,t){return nc(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],n=ec(e["!ref"]),o=Array.isArray(e),a=n.s.r;a<=n.e.r;++a){for(var i=[],s=n.s.c;s<=n.e.c;++s){var l=Jl({r:a,c:s});if((t=o?(e[a]||[])[s]:e[l])&&null!=t.v){for(var c=(t.w||(rc(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===s?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var Ld=function(){function e(e,t,r){if(e){Ll(e,e.l||0);for(var n=r.Enum||x;e.l<e.length;){var o=e.read_shift(2),a=n[o]||n[65535],i=e.read_shift(2),s=e.l+i,l=a.f&&a.f(e,i,r);if(e.l=s,t(l,a,o))return}}}function t(t,r){if(!t)return t;var n=r||{};var o=n.dense?[]:{},a="Sheet1",i="",s=0,l={},c=[],d=[],p={s:{r:0,c:0},e:{r:0,c:0}},u=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=x,e(t,function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:p=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||oi[14],n.cellDates&&(e[1].t="d",e[1].v=ts(e[1].v))),n.qpro&&e[3]>s&&(o["!ref"]=Zl(p),l[a]=o,c.push(a),o=n.dense?[]:{},p={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],a=i||"Sheet"+(s+1),i="");var d=n.dense?(o[e[0].r]||[])[e[0].c]:o[Jl(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}n.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[Jl(e[0])]=e[1]}},n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=b,14==t[2]&&(n.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:a=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(o["!ref"]=Zl(p),l[a]=o,c.push(a),o=n.dense?[]:{},p={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],a="Sheet"+(s+1)),u>0&&e[0].r>=u)break;n.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[Jl(e[0])]=e[1],p.e.c<e[0].c&&(p.e.c=e[0].c),p.e.r<e[0].r&&(p.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==s&&(a=e[1])}},n)}if(o["!ref"]=Zl(p),l[i||a]=o,c.push(i||a),!d.length)return{SheetNames:c,Sheets:l};for(var f={},h=[],g=0;g<d.length;++g)l[c[g]]?(h.push(d[g]||c[g]),f[d[g]]=l[d[g]]||l[c[g]]):(h.push(d[g]),f[d[g]]={"!ref":"A1"});return{SheetNames:h,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var o=e.l+t,a=r(e,0,n);if(a[1].t="s",20768==n.vers){e.l++;var i=e.read_shift(1);return a[1].v=e.read_shift(i,"utf8"),a}return n.qpro&&e.l++,a[1].v=e.read_shift(o-e.l,"cstr"),a}function o(e,t,r){var n=Fl(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var o=0;o<n.length;++o){var a=r.charCodeAt(o);n.write_shift(1,a>=128?95:a)}return n.write_shift(1,0),n}function a(e,t,r){var n=Fl(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function i(e,t,r){var n=Fl(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function s(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?Xl(t):$l(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function p(e,t,r,n){var o=Fl(6+n.length);o.write_shift(2,e),o.write_shift(1,r),o.write_shift(1,t),o.write_shift(1,39);for(var a=0;a<n.length;++a){var i=n.charCodeAt(a);o.write_shift(1,i>=128?95:i)}return o.write_shift(1,0),o}function u(e,t){var r=d(e),n=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);if(65535==a)return 0===n&&3221225472===o?(r[1].t="e",r[1].v=15):0===n&&3489660928===o?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&a;return a=(32767&a)-16446,r[1].v=(1-2*i)*(o*Math.pow(2,a+32)+n*Math.pow(2,a)),r}function f(e,t,r,n){var o=Fl(14);if(o.write_shift(2,e),o.write_shift(1,r),o.write_shift(1,t),0==n)return o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,65535),o;var a,i=0,s=0,l=0;return n<0&&(i=1,n=-n),s=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,s-31))>>>0))&&(++s,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,a=(n*=Math.pow(2,32))>>>0,o.write_shift(4,a),o.write_shift(4,l),s+=16383+(i?32768:0),o.write_shift(2,s),o}function h(e,t){var r=d(e),n=e.read_shift(8,"f");return r[1].v=n,r}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var r=Fl(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var o=e.charCodeAt(n);r[r.l++]=o>127?95:o}return r[r.l++]=0,r}var x={0:{n:"BOF",f:cd},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var o=r(e,0,n);return o[1].v=e.read_shift(2,"i"),o}},14:{n:"NUMBER",f:function(e,t,n){var o=r(e,0,n);return o[1].v=e.read_shift(8,"f"),o}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var o=e.l+t,a=r(e,0,n);if(a[1].v=e.read_shift(8,"f"),n.qpro)e.l=o;else{var i=e.read_shift(2);!function(e,t){Ll(e,0);var r=[],n=0,o="",a="",i="",d="";for(;e.l<e.length;){var p=e[e.l++];switch(p){case 0:r.push(e.read_shift(8,"f"));break;case 1:a=s(t[0].c,e.read_shift(2),!0),o=s(t[0].r,e.read_shift(2),!1),r.push(a+o);break;case 2:var u=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);a=s(t[0].c,e.read_shift(2),!0),o=s(t[0].r,e.read_shift(2),!1),r.push(u+f+":"+a+o);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var h="";p=e[e.l++];)h+=String.fromCharCode(p);r.push('"'+h.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][p-20]+"("+i+","+d+")");break;default:if(p<32&&c[p])d=r.pop(),i=r.pop(),r.push(i+c[p]+d);else{if(!l[p])return p<=7?console.error("WK1 invalid opcode "+p.toString(16)):p<=24?console.error("WK1 unsupported op "+p.toString(16)):p<=30?console.error("WK1 invalid opcode "+p.toString(16)):p<=115?console.error("WK1 unsupported function opcode "+p.toString(16)):console.error("WK1 unrecognized opcode "+p.toString(16));if(69==(n=l[p][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+p.toString(16)+":|"+r.join("|")+"|");var g=r.slice(-n);r.length-=n,r.push(l[p][0]+"("+g.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),a),e.l+=i}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:u},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=u(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var o=e.read_shift(2);if(14e3==o){for(r[o]=[0,""],r[o][0]=e.read_shift(2);e[e.l];)r[o][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:h},40:{n:"FORMULA28",f:function(e,t){var r=h(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Na(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=Ml(),s=ec(e["!ref"]),l=Array.isArray(e),c=[];nf(n,0,function(e){var t=Fl(2);return t.write_shift(2,e),t}(1030)),nf(n,6,function(e){var t=Fl(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var d=Math.min(s.e.r,8191),p=s.s.r;p<=d;++p)for(var u=$l(p),f=s.s.c;f<=s.e.c;++f){p===s.s.r&&(c[f]=Xl(f));var h=c[f]+u,g=l?(e[p]||[])[f]:e[h];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?nf(n,13,a(p,f,g.v)):nf(n,14,i(p,f,g.v));else nf(n,15,o(p,f,rc(g).slice(0,239)))}return nf(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Na(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Ml();nf(n,0,function(e){var t=Fl(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,o=0,a=0;a<e.SheetNames.length;++a){var i=e.SheetNames[a],s=e.Sheets[i];if(s&&s["!ref"]){++o;var l=Ql(s["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,o),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var o=0,a=0;o<e.SheetNames.length;++o)(e.Sheets[e.SheetNames[o]]||{})["!ref"]&&nf(n,27,m(e.SheetNames[o],a++));var i=0;for(o=0;o<e.SheetNames.length;++o){var s=e.Sheets[e.SheetNames[o]];if(s&&s["!ref"]){for(var l=ec(s["!ref"]),c=Array.isArray(s),d=[],u=Math.min(l.e.r,8191),h=l.s.r;h<=u;++h)for(var g=$l(h),x=l.s.c;x<=l.e.c;++x){h===l.s.r&&(d[x]=Xl(x));var b=d[x]+g,v=c?(s[h]||[])[x]:s[b];if(v&&"z"!=v.t)if("n"==v.t)nf(n,23,f(h,x,i,v.v));else nf(n,22,p(h,x,i,rc(v).slice(0,239)))}++i}}return nf(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(Ha(Ba(e)),r);case"binary":return t(Ha(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Bd=/^\s|\s$|[\t\n\r]/;function Fd(e,t){if(!t.bookSST)return"";var r=[hs];r[r.length]=Os("sst",null,{xmlns:Xs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var o=e[n],a="<si>";o.r?a+=o.r:(a+="<t",o.t||(o.t=""),o.t.match(Bd)&&(a+=' xml:space="preserve"'),a+=">"+vs(o.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var Md=function(e,t){var r=!1;return null==t&&(r=!0,t=Fl(15+4*e.t.length)),t.write_shift(1,0),lc(e.t,t),r?t.slice(0,t.l):t};function Wd(e){var t=Ml();Wl(t,159,function(e,t){return t||(t=Fl(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Wl(t,19,Md(e[r]));return Wl(t,160),t.end()}function Ud(e){if("undefined"!==typeof Ia)return Ia.utils.encode(Ca,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Hd(e){var t,r,n=0,o=Ud(e),a=o.length+1;for((t=Wa(a))[0]=o.length,r=1;r!=a;++r)t[r]=o[r-1];for(r=a-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var Vd=function(){function e(e,r){switch(r.type){case"base64":return t(Ba(e),r);case"binary":return t(e,r);case"buffer":return t(Fa&&Buffer.isBuffer(e)?e.toString("binary"):Ga(e),r);case"array":return t(is(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,a=/\\\w+\b/g,i=0,s=-1;n=a.exec(e);){if("\\cell"===n[0]){var l=e.slice(i,a.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][s]=c:r[Jl({r:t,c:s})]=c}}i=a.lastIndex}s>o.e.c&&(o.e.c=s)}),r["!ref"]=Zl(o),r}return{to_workbook:function(t,r){return nc(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=ec(e["!ref"]),o=Array.isArray(e),a=n.s.r;a<=n.e.r;++a){r.push("\\trowd\\trautofit1");for(var i=n.s.c;i<=n.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=n.s.c;i<=n.e.c;++i){var s=Jl({r:a,c:i});(t=o?(e[a]||[])[i]:e[s])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(rc(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function Gd(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Yd=6;function $d(e){return Math.floor((e+Math.round(128/Yd)/256)*Yd)}function qd(e){return Math.floor((e-5)/Yd*100+.5)/100}function Xd(e){return Math.round((e*Yd+5)/Yd*256)/256}function Kd(e){e.width?(e.wpx=$d(e.width),e.wch=qd(e.wpx),e.MDW=Yd):e.wpx?(e.wch=qd(e.wpx),e.width=Xd(e.wch),e.MDW=Yd):"number"==typeof e.wch&&(e.width=Xd(e.wch),e.wpx=$d(e.width),e.MDW=Yd),e.customWidth&&delete e.customWidth}var Jd=96;function Qd(e){return 96*e/Jd}function Zd(e){return e*Jd/96}function ep(e,t){var r,n=[hs,Os("styleSheet",null,{xmlns:Xs[0],"xmlns:vt":Ys})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=Os("numFmt",null,{numFmtId:n,formatCode:vs(e[n])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Os("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=Os("cellXfs",null),e.forEach(function(e){t[t.length]=Os("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Os("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function tp(e,t,r){r||(r=Fl(6+4*t.length)),r.write_shift(2,e),lc(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function rp(e,t){t||(t=Fl(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Fl(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ac(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),lc(e.name,t),t.length>t.l?t.slice(0,t.l):t}var np,op=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ap=Bl;function ip(e,t){t||(t=Fl(84)),np||(np=qi(op));var r=np[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(Ac({auto:1},t),Ac({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function sp(e,t,r){r||(r=Fl(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function lp(e,t){return t||(t=Fl(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var cp=Bl;function dp(e){var t;Wl(e,613,ic(1)),Wl(e,46,(t||(t=Fl(51)),t.write_shift(1,0),lp(0,t),lp(0,t),lp(0,t),lp(0,t),lp(0,t),t.length>t.l?t.slice(0,t.l):t)),Wl(e,614)}function pp(e){var t,r;Wl(e,619,ic(1)),Wl(e,48,(t={xfId:0,builtinId:0,name:"Normal"},r||(r=Fl(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),yc(t.name||"",r),r.length>r.l?r.slice(0,r.l):r)),Wl(e,620)}function up(e){Wl(e,508,function(e,t,r){var n=Fl(2052);return n.write_shift(4,e),yc(t,n),yc(r,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),Wl(e,509)}function fp(e,t){var r=Ml();return Wl(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r}),0!=r&&(Wl(e,615,ic(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&Wl(e,44,tp(n,t[n]))}),Wl(e,616))}}(r,e.SSF),function(e){Wl(e,611,ic(1)),Wl(e,43,rp({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Wl(e,612)}(r),function(e){Wl(e,603,ic(2)),Wl(e,45,ip({patternType:"none"})),Wl(e,45,ip({patternType:"gray125"})),Wl(e,604)}(r),dp(r),function(e){Wl(e,626,ic(1)),Wl(e,47,sp({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Wl(e,627)}(r),function(e,t){Wl(e,617,ic(t.length)),t.forEach(function(t){Wl(e,47,sp(t,0))}),Wl(e,618)}(r,t.cellXfs),pp(r),function(e){Wl(e,505,ic(0)),Wl(e,506)}(r),up(r),Wl(r,279),r.end()}function hp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[hs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function gp(){var e=Ml();return Wl(e,332),Wl(e,334,ic(1)),Wl(e,335,function(e){var t=Fl(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),lc(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Wl(e,336),Wl(e,339,function(e,t){var r=Fl(8+2*t.length);return r.write_shift(4,e),lc(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Wl(e,52),Wl(e,35,ic(514)),Wl(e,4096,ic(0)),Wl(e,4097,dd(1)),Wl(e,36),Wl(e,53),Wl(e,340),Wl(e,337,function(e,t){var r=Fl(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Wl(e,51,function(e){var t=Fl(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Wl(e,338),Wl(e,333),e.end()}function mp(){var e=[hs];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var xp=1024;function bp(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),o=[Os("xml",null,{"xmlns:v":tl,"xmlns:o":Ks,"xmlns:x":Js,"xmlns:mv":el}).replace(/\/>/,">"),Os("o:shapelayout",Os("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Os("v:shapetype",[Os("v:stroke",null,{joinstyle:"miter"}),Os("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];xp<1e3*e;)xp+=1e3;return t.forEach(function(e){var t=Kl(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var n="gradient"==r.type?Os("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=Os("v:fill",n,r);++xp,o=o.concat(["<v:shape"+Is({id:"_x0000_s"+xp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,Os("v:shadow",null,{on:"t",obscured:"t"}),Os("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zs("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),zs("x:AutoFill","False"),zs("x:Row",String(t.r)),zs("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function vp(e){var t=[hs,Os("comments",null,{xmlns:Xs[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var n=vs(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var n=0,o=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?n=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(n=r.indexOf(vs(e.a))),o.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>'),o.length<=1)t.push(zs("t",vs(o[0]||"")));else{for(var a="Comment:\n    "+o[0]+"\n",i=1;i<o.length;++i)a+="Reply:\n    "+o[i]+"\n";t.push(zs("t",vs(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function yp(e,t,r){var n=[hs,Os("ThreadedComments",null,{xmlns:Ws}).replace(/[\/]>/,">")];return e.forEach(function(e){var o="";(e[1]||[]).forEach(function(a,i){if(a.T){a.a&&-1==t.indexOf(a.a)&&t.push(a.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?o=s.id:s.parentId=o,a.ID=s.id,a.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Os("threadedComment",zs("text",a.t||""),s))}else delete a.ID})}),n.push("</ThreadedComments>"),n.join("")}var jp=sc;function _p(e){var t=Ml(),r=[];return Wl(t,628),Wl(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Wl(t,632,function(e){return lc(e.slice(0,54))}(e.a)))})}),Wl(t,631),Wl(t,633),e.forEach(function(e){e[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var o={s:Kl(e[0]),e:Kl(e[0])};Wl(t,635,function(e,t){return null==t&&(t=Fl(36)),t.write_shift(4,e[1].iauthor),Tc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([o,n])),n.t&&n.t.length>0&&Wl(t,637,uc(n)),Wl(t,636),delete n.iauthor})}),Wl(t,634),Wl(t,629),t.end()}var Sp=["xlsb","xlsm","xlam","biff8","xla"];var wp=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,o){var a=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==o.length?a=!0:"["==o.charAt(0)&&(a=!0,o=o.slice(1,-1));var s=n.length>0?0|parseInt(n,10):0,l=o.length>0?0|parseInt(o,10):0;return a?l+=t.c:--l,i?s+=t.r:--s,r+(a?"":"$")+Xl(l)+(i?"":"$")+$l(s)}return function(n,o){return t=o,n.replace(e,r)}}(),kp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Cp=function(){return function(e,t){return e.replace(kp,function(e,r,n,o,a,i){var s=ql(o)-(n?0:t.c),l=Yl(i)-(a?0:t.r);return r+"R"+(0==l?"":a?l+1:"["+l+"]")+"C"+(0==s?"":n?s+1:"["+s+"]")})}}();function Ep(e,t){return e.replace(kp,function(e,r,n,o,a,i){return r+("$"==n?n+o:Xl(ql(o)+t.c))+("$"==a?a+i:$l(Yl(i)+t.r))})}function Tp(e){e.l+=1}function Rp(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function Np(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Ap(e);12==r.biff&&(n=4)}var o=e.read_shift(n),a=e.read_shift(n),i=Rp(e,2),s=Rp(e,2);return{s:{r:o,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Ap(e){var t=Rp(e,2),r=Rp(e,2),n=e.read_shift(1),o=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:o,cRel:r[1],rRel:r[2]}}}function zp(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Rp(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),o=Rp(e,2);return{r:n,c:o[0],cRel:o[1],rRel:o[2]}}function Ip(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Op(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Pp(e){return[e.read_shift(1),e.read_shift(1)]}function Dp(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=sd(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Lc[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rc(e);break;case 2:r[1]=md(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Lp(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),o=[],a=0;a!=n;++a)o.push((12==r.biff?Ec:_d)(e,8));return o}function Bp(e,t,r){var n=0,o=0;12==r.biff?(n=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--o&&(o=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var s=0;s!=o;++s)i[a][s]=Dp(e,r.biff);return i}function Fp(e,t,r){return e.l+=2,[Ip(e)]}function Mp(e){return e.l+=6,[]}function Wp(e){return e.l+=2,[cd(e),1&e.read_shift(2)]}var Up=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Hp={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Bl},3:{n:"PtgAdd",f:Tp},4:{n:"PtgSub",f:Tp},5:{n:"PtgMul",f:Tp},6:{n:"PtgDiv",f:Tp},7:{n:"PtgPower",f:Tp},8:{n:"PtgConcat",f:Tp},9:{n:"PtgLt",f:Tp},10:{n:"PtgLe",f:Tp},11:{n:"PtgEq",f:Tp},12:{n:"PtgGe",f:Tp},13:{n:"PtgGt",f:Tp},14:{n:"PtgNe",f:Tp},15:{n:"PtgIsect",f:Tp},16:{n:"PtgUnion",f:Tp},17:{n:"PtgRange",f:Tp},18:{n:"PtgUplus",f:Tp},19:{n:"PtgUminus",f:Tp},20:{n:"PtgPercent",f:Tp},21:{n:"PtgParen",f:Tp},22:{n:"PtgMissArg",f:Tp},23:{n:"PtgStr",f:function(e,t,r){return e.l++,ud(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Lc[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Rc(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(r&&r.biff<=3?1:2);return[lu[o],su[o],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],o=e.read_shift(1),a=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[o,(0===a[0]?su:iu)[a[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,o=!r||r.biff>=8?4:2,a=e.read_shift(o);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,a]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,zp(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Np(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Bl},40:{n:"PtgMemNoMem",f:Bl},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var o=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,o=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==o&&r>=128&&(r-=256),{r:t,c:r,cRel:o,rRel:n}}(e);var o=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(16384&a)>>14,s=(32768&a)>>15;if(a&=16383,1==s)for(;o>524287;)o-=1048576;if(1==i)for(;a>8191;)a-=16384;return{r:o,c:a,cRel:i,rRel:s}}(e,0,r);return[n,o]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,o=function(e,t,r){if(r.biff<8)return Ap(e);var n=e.read_shift(12==r.biff?4:2),o=e.read_shift(12==r.biff?4:2),a=Rp(e,2),i=Rp(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[n,o]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,o,zp(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,o=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,o,Np(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,o=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[n,o]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,o=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[n,o]}},255:{}},Vp={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Gp={1:{n:"PtgElfLel",f:Wp},2:{n:"PtgElfRw",f:Fp},3:{n:"PtgElfCol",f:Fp},6:{n:"PtgElfRwV",f:Fp},7:{n:"PtgElfColV",f:Fp},10:{n:"PtgElfRadical",f:Fp},11:{n:"PtgElfRadicalS",f:Mp},13:{n:"PtgElfColS",f:Mp},15:{n:"PtgElfColSV",f:Mp},16:{n:"PtgElfRadicalLel",f:Wp},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),o=e.read_shift(2),a=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Up[r>>2&31],idx:n,c:o,C:a}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Yp={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),o=[],a=0;a<=n;++a)o.push(e.read_shift(r&&2==r.biff?1:2));return o}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Op},33:{n:"PtgAttrBaxcel",f:Op},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Pp(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Pp(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function $p(e,t,r,n){if(n.biff<8)return Bl(e,t);for(var o=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Bp(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Lp(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=o-e.l)&&a.push(Bl(e,t)),a}function qp(e,t,r){for(var n,o,a=e.l+t,i=[];a!=e.l;)t=a-e.l,o=e[e.l],n=Hp[o]||Hp[Vp[o]],24!==o&&25!==o||(n=(24===o?Gp:Yp)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):Bl(e,t);return i}function Xp(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],o=[],a=0;a<n.length;++a){var i=n[a];if(i)if(2===i[0])o.push('"'+i[1].replace(/"/g,'""')+'"');else o.push(i[1]);else o.push("")}t.push(o.join(","))}return t.join(";")}var Kp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Jp(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var o="";if(r.biff>8)switch(e[n[0]][0]){case 357:return o=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?o:o+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return o=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?o:o+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(o=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?o:o+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Qp(e,t,r){var n=Jp(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function Zp(e,t,r,n,o){var a,i,s,l,c=o&&o.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},p=[],u=0,f=0,h="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",x=0,b=e[0].length;x<b;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=p.pop(),i=p.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=ls(" ",e[0][g][1][1]);break;case 1:m=ls("\r",e[0][g][1][1]);break;default:if(m="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}i+=m,g=-1}p.push(i+Kp[v[0]]+a);break;case"PtgIsect":a=p.pop(),i=p.pop(),p.push(i+" "+a);break;case"PtgUnion":a=p.pop(),i=p.pop(),p.push(i+","+a);break;case"PtgRange":a=p.pop(),i=p.pop(),p.push(i+":"+a);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=Ul(v[1][1],d,o),p.push(Vl(s,c));break;case"PtgRefN":s=r?Ul(v[1][1],r,o):v[1][1],p.push(Vl(s,c));break;case"PtgRef3d":u=v[1][1],s=Ul(v[1][2],d,o);h=Qp(n,u,o);p.push(h+"!"+Vl(s,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],j=v[1][1];y||(y=0);var _=0==(y&=127)?[]:p.slice(-y);p.length-=y,"User"===j&&(j=_.shift()),p.push(j+"("+_.join(",")+")");break;case"PtgBool":p.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":p.push(v[1]);break;case"PtgNum":p.push(String(v[1]));break;case"PtgStr":p.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Hl(v[1][1],r?{s:r}:d,o),p.push(Gl(l,o));break;case"PtgArea":l=Hl(v[1][1],d,o),p.push(Gl(l,o));break;case"PtgArea3d":u=v[1][1],l=v[1][2],h=Qp(n,u,o),p.push(h+"!"+Gl(l,o));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgName":f=v[1][2];var S=(n.names||[])[f-1]||(n[0]||[])[f],w=S?S.Name:"SH33TJSNAME"+String(f);w&&"_xlfn."==w.slice(0,6)&&!o.xlfn&&(w=w.slice(6)),p.push(w);break;case"PtgNameX":var k,C=v[1][1];if(f=v[1][2],!(o.biff<=5)){var E="";if(14849==((n[C]||[])[0]||[])[0]||(1025==((n[C]||[])[0]||[])[0]?n[C][f]&&n[C][f].itab>0&&(E=n.SheetNames[n[C][f].itab-1]+"!"):E=n.SheetNames[f-1]+"!"),n[C]&&n[C][f])E+=n[C][f].Name;else if(n[0]&&n[0][f])E+=n[0][f].Name;else{var T=(Jp(n,C,o)||"").split(";;");T[f-1]?E=T[f-1]:E+="SH33TJSERRX"}p.push(E);break}C<0&&(C=-C),n[C]&&(k=n[C][f]),k||(k={Name:"SH33TJSERRY"}),p.push(k.Name);break;case"PtgParen":var R="(",N=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:R=ls(" ",e[0][g][1][1])+R;break;case 3:R=ls("\r",e[0][g][1][1])+R;break;case 4:N=ls(" ",e[0][g][1][1])+N;break;case 5:N=ls("\r",e[0][g][1][1])+N;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}p.push(R+p.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":p.push("#REF!");break;case"PtgExp":s={c:v[1][1],r:v[1][0]};var A={c:r.c,r:r.r};if(n.sharedf[Jl(s)]){var z=n.sharedf[Jl(s)];p.push(Zp(z,d,A,n,o))}else{var I=!1;for(a=0;a!=n.arrayf.length;++a)if(i=n.arrayf[a],!(s.c<i[0].s.c||s.c>i[0].e.c)&&!(s.r<i[0].s.r||s.r>i[0].e.r)){p.push(Zp(i[1],d,A,n,o)),I=!0;break}I||p.push(v[1])}break;case"PtgArray":p.push("{"+Xp(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgMissArg":p.push("");break;case"PtgList":p.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=o.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var O=!0;switch((v=e[0][g])[1][0]){case 4:O=!1;case 0:m=ls(" ",v[1][1]);break;case 5:O=!1;case 1:m=ls("\r",v[1][1]);break;default:if(m="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}p.push((O?m:"")+p.pop()+(O?"":m)),g=-1}}if(p.length>1&&o.WTF)throw new Error("bad formula stack");return p[0]}function eu(e,t,r,n,o){var a=yd(t,r,o),i=function(e){if(null==e){var t=Fl(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Nc("number"==typeof e?e:0)}(e.v),s=Fl(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=Fl(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Ya([a,i,s,l])}function tu(e,t,r){var n=e.read_shift(4),o=qp(e,n,r),a=e.read_shift(4);return[o,a>0?$p(e,a,o,r):null]}var ru=tu,nu=tu,ou=tu,au=tu,iu={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},su={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lu={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cu(e){return("of:="+e.replace(kp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function du(e){return e.replace(/\./,"!")}var pu="undefined"!==typeof Map;function uu(e,t,r){var n=0,o=e.length;if(r){if(pu?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var a=pu?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}else for(;n<o;++n)if(e[n].t===t)return e.Count++,n;return e[o]={t:t},e.Count++,e.Unique++,r&&(pu?(r.has(t)||r.set(t,[]),r.get(t).push(o)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(o))),o}function fu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Yd=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=qd(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=Xd(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function hu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function gu(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],o=60,a=e.length;if(null==n&&r.ssf)for(;o<392;++o)if(null==r.ssf[o]){Li(t.z,o),r.ssf[o]=t.z,r.revssf[t.z]=n=o;break}for(o=0;o!=a;++o)if(e[o].numFmtId===n)return o;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function mu(e,t,r){if(e&&e["!ref"]){var n=ec(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var xu=["objects","scenarios","selectLockedCells","selectUnlockedCells"],bu=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vu(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var o="",a=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=Lc[e.v];break;case"d":n&&n.cellDates?o=as(e.v,-1).toISOString():((e=ss(e)).t="n",o=""+(e.v=Ji(as(e.v)))),"undefined"===typeof e.z&&(e.z=oi[14]);break;default:o=e.v}var s=zs("v",vs(o)),l={r:t},c=gu(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){s=zs("v",""+uu(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=a&&(e.t=a,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=Os("f",vs(e.f),d)+(null!=e.v?s:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Os("c",s,l)}function yu(e,t,r,n){var o,a=[hs,Os("worksheet",null,{xmlns:Xs[0],"xmlns:r":Gs})],i=r.SheetNames[e],s="",l=r.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",d=ec(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Zl(d)}n||(n={}),l["!comments"]=[];var p=[];!function(e,t,r,n,o){var a=!1,i={},s=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(Fh){}a=!0,i.codeName=Rs(vs(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),s=(s||"")+Os("outlinePr",null,c)}(a||s)&&(o[o.length]=Os("sheetPr",s,i))}(l,r,e,t,a),a[a.length]=Os("dimension",null,{ref:c}),a[a.length]=function(e,t,r,n){var o={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Os("sheetViews",Os("sheetView",null,o),{})}(0,0,0,r),t.sheetFormat&&(a[a.length]=Os("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(a[a.length]=function(e,t){for(var r,n=["<cols>"],o=0;o!=t.length;++o)(r=t[o])&&(n[n.length]=Os("col",null,fu(o,r)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),a[o=a.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t){var r,n,o=[],a=[],i=ec(e["!ref"]),s="",l="",c=[],d=0,p=0,u=e["!rows"],f=Array.isArray(e),h={r:l},g=-1;for(p=i.s.c;p<=i.e.c;++p)c[p]=Xl(p);for(d=i.s.r;d<=i.e.r;++d){for(a=[],l=$l(d),p=i.s.c;p<=i.e.c;++p){r=c[p]+l;var m=f?(e[d]||[])[p]:e[r];void 0!==m&&null!=(s=vu(m,r,e,t))&&a.push(s)}(a.length>0||u&&u[d])&&(h={r:l},u&&u[d]&&((n=u[d]).hidden&&(h.hidden=1),g=-1,n.hpx?g=Qd(n.hpx):n.hpt&&(g=n.hpt),g>-1&&(h.ht=g,h.customHeight=1),n.level&&(h.outlineLevel=n.level)),o[o.length]=Os("row",a.join(""),h))}if(u)for(;d<u.length;++d)u&&u[d]&&(h={r:d+1},(n=u[d]).hidden&&(h.hidden=1),g=-1,n.hpx?g=Qd(n.hpx):n.hpt&&(g=n.hpt),g>-1&&(h.ht=g,h.customHeight=1),n.level&&(h.outlineLevel=n.level),o[o.length]=Os("row","",h));return o.join("")}(l,t,0,0),s.length>0&&(a[a.length]=s)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),l["!protect"]&&(a[a.length]=function(e){var t={sheet:1};return xu.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),bu.forEach(function(r){null==e[r]||e[r]||(t[r]="0")}),e.password&&(t.password=Hd(e.password).toString(16).toUpperCase()),Os("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(a[a.length]=function(e,t,r,n){var o="string"==typeof e.ref?e.ref:Zl(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Ql(o);i.s.r==i.e.r&&(i.e.r=Ql(t["!ref"]).e.r,o=Zl(i));for(var s=0;s<a.length;++s){var l=a[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+o;break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Os("autoFilter",null,{ref:o})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(a[a.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zl(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var u,f,h=-1,g=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(u={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=Vc(n,-1,vs(e[1].Target).replace(/#.*$/,""),Wc.HLINK),u["r:id"]="rId"+g),(h=e[1].Target.indexOf("#"))>-1&&(u.location=vs(e[1].Target.slice(h+1))),e[1].Tooltip&&(u.tooltip=vs(e[1].Tooltip)),a[a.length]=Os("hyperlink",null,u))}),a[a.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(a[a.length]=(hu(f=l["!margins"]),Os("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(a[a.length]=zs("ignoredErrors",Os("ignoredError",null,{numberStoredAsText:1,sqref:c}))),p.length>0&&(g=Vc(n,-1,"../drawings/drawing"+(e+1)+".xml",Wc.DRAW),a[a.length]=Os("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=p),l["!comments"].length>0&&(g=Vc(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Wc.VML),a[a.length]=Os("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function ju(e,t,r,n){var o=function(e,t,r){var n=Fl(145),o=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;o.hpx?a=20*Qd(o.hpx):o.hpt&&(a=20*o.hpt),n.write_shift(2,a),n.write_shift(1,0);var i=0;o.level&&(i|=o.level),o.hidden&&(i|=16),(o.hpx||o.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var s=0,l=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var p=-1,u=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[Jl(c)])&&(p<0&&(p=f),u=f);p<0||(++s,n.write_shift(4,p),n.write_shift(4,u))}var h=n.l;return n.l=l,n.write_shift(4,s),n.l=h,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(o.length>17||(t["!rows"]||[])[n])&&Wl(e,0,o)}var _u=Ec,Su=Tc;function wu(e){return[gc(e),Rc(e),"n"]}var ku=Ec,Cu=Tc;var Eu=["left","right","top","bottom","header","footer"];function Tu(e,t,r,n,o,a,i){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=ss(t)).z=t.z||oi[14],t.v=Ji(as(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:r,c:n};switch(l.s=gu(o.cellXfs,t,o),t.l&&a["!links"].push([Jl(l),t.l]),t.c&&a["!comments"].push([Jl(l),t.c]),t.t){case"s":case"str":return o.bookSST?(s=uu(o.Strings,t.v,o.revStrings),l.t="s",l.v=s,i?Wl(e,18,function(e,t,r){return null==r&&(r=Fl(8)),mc(t,r),r.write_shift(4,t.v),r}(0,l)):Wl(e,7,function(e,t,r){return null==r&&(r=Fl(12)),hc(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",i?Wl(e,17,function(e,t,r){return null==r&&(r=Fl(8+4*e.v.length)),mc(t,r),lc(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Wl(e,6,function(e,t,r){return null==r&&(r=Fl(12+4*e.v.length)),hc(t,r),lc(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Wl(e,13,function(e,t,r){return null==r&&(r=Fl(8)),mc(t,r),kc(e.v,r),r}(t,l)):Wl(e,2,function(e,t,r){return null==r&&(r=Fl(12)),hc(t,r),kc(e.v,r),r}(t,l)):i?Wl(e,16,function(e,t,r){return null==r&&(r=Fl(12)),mc(t,r),Nc(e.v,r),r}(t,l)):Wl(e,5,function(e,t,r){return null==r&&(r=Fl(16)),hc(t,r),Nc(e.v,r),r}(t,l)),!0;case"b":return l.t="b",i?Wl(e,15,function(e,t,r){return null==r&&(r=Fl(5)),mc(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Wl(e,4,function(e,t,r){return null==r&&(r=Fl(9)),hc(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",i?Wl(e,14,function(e,t,r){return null==r&&(r=Fl(8)),mc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Wl(e,3,function(e,t,r){return null==r&&(r=Fl(9)),hc(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return i?Wl(e,12,function(e,t,r){return null==r&&(r=Fl(4)),mc(t,r)}(0,l)):Wl(e,1,function(e,t,r){return null==r&&(r=Fl(8)),hc(t,r)}(0,l)),!0}function Ru(e,t){var r,n;t&&t["!merges"]&&(Wl(e,177,(r=t["!merges"].length,null==n&&(n=Fl(4)),n.write_shift(4,r),n)),t["!merges"].forEach(function(t){Wl(e,176,Cu(t))}),Wl(e,178))}function Nu(e,t){t&&t["!cols"]&&(Wl(e,390),t["!cols"].forEach(function(t,r){t&&Wl(e,60,function(e,t,r){null==r&&(r=Fl(18));var n=fu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var o=0;return t.hidden&&(o|=1),"number"==typeof n.width&&(o|=2),t.level&&(o|=t.level<<8),r.write_shift(2,o),r}(r,t))}),Wl(e,391))}function Au(e,t){t&&t["!ref"]&&(Wl(e,648),Wl(e,649,function(e){var t=Fl(24);return t.write_shift(4,4),t.write_shift(4,1),Tc(e,t),t}(ec(t["!ref"]))),Wl(e,650))}function zu(e,t,r){t["!links"].forEach(function(t){if(t[1].Target){var n=Vc(r,-1,t[1].Target.replace(/#.*$/,""),Wc.HLINK);Wl(e,494,function(e,t){var r=Fl(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Tc({s:Kl(e[0]),e:Kl(e[0])},r),Sc("rId"+t,r);var n=e[1].Target.indexOf("#");return lc((-1==n?"":e[1].Target.slice(n+1))||"",r),lc(e[1].Tooltip||"",r),lc("",r),r.slice(0,r.l)}(t,n))}}),delete t["!links"]}function Iu(e,t,r){Wl(e,133),Wl(e,137,function(e,t,r){null==r&&(r=Fl(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Wl(e,138),Wl(e,134)}function Ou(e,t){var r,n;t["!protect"]&&Wl(e,535,(r=t["!protect"],null==n&&(n=Fl(66)),n.write_shift(2,r.password?Hd(r.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?n.write_shift(4,null==r[e[0]]||r[e[0]]?0:1):n.write_shift(4,null!=r[e[0]]&&r[e[0]]?0:1)}),n))}function Pu(e,t,r,n){var o=Ml(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=a;try{r&&r.Workbook&&(s=r.Workbook.Sheets[e].CodeName||s)}catch(Fh){}var l,c,d=ec(i["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Wl(o,129),(r.vbaraw||i["!outline"])&&Wl(o,147,function(e,t,r){null==r&&(r=Fl(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var o=1;o<3;++o)r.write_shift(1,0);return Ac({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),bc(e,r),r.slice(0,r.l)}(s,i["!outline"])),Wl(o,148,Su(d)),Iu(o,0,r.Workbook),Nu(o,i),function(e,t,r,n){var o,a=ec(t["!ref"]||"A1"),i="",s=[];Wl(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=c;++d){i=$l(d),ju(e,t,a,d);var p=!1;if(d<=a.e.r)for(var u=a.s.c;u<=a.e.c;++u){d===a.s.r&&(s[u]=Xl(u)),o=s[u]+i;var f=l?(t[d]||[])[u]:t[o];p=!!f&&Tu(e,f,d,u,n,t,p)}}Wl(e,146)}(o,i,0,t),Ou(o,i),function(e,t,r,n){if(t["!autofilter"]){var o=t["!autofilter"],a="string"===typeof o.ref?o.ref:Zl(o.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Ql(a);s.s.r==s.e.r&&(s.e.r=Ql(t["!ref"]).e.r,a=Zl(s));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Wl(e,161,Tc(ec(a))),Wl(e,162)}}(o,i,r,e),Ru(o,i),zu(o,i,n),i["!margins"]&&Wl(o,476,(l=i["!margins"],null==c&&(c=Fl(48)),hu(l),Eu.forEach(function(e){Nc(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||Au(o,i),function(e,t,r,n){if(t["!comments"].length>0){var o=Vc(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Wc.VML);Wl(e,551,Sc("rId"+o)),t["!legacy"]=o}}(o,i,e,n),Wl(o,130),o.end()}var Du=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var Lu="][*?/\\".split("");function Bu(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Lu.forEach(function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function Fu(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,r,n,o=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=o,n=!!e.vbaraw,t.forEach(function(e,o){Bu(e);for(var a=0;a<o;++a)if(e==t[a])throw new Error("Duplicate Sheet Name: "+e);if(n){var i=r&&r[o]&&r[o].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}});for(var a=0;a<e.SheetNames.length;++a)mu(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}function Mu(e){var t=[hs];t[t.length]=Os("workbook",null,{xmlns:Xs[0],"xmlns:r":Gs});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Du.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Os("workbookPr",null,n);var o=e.Workbook&&e.Workbook.Sheets||[],a=0;if(o&&o[0]&&o[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&o[a]&&o[a].Hidden;++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:vs(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),o[a])switch(o[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Os("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Os("definedName",vs(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Wu(e,t){return t||(t=Fl(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Sc(e.strRelID,t),lc(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Uu(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,n,o=t.Workbook.Sheets,a=0,i=-1,s=-1;a<o.length;++a)!o[a]||!o[a].Hidden&&-1==i?i=a:1==o[a].Hidden&&-1==s&&(s=a);if(!(s>i))Wl(e,135),Wl(e,158,(r=i,n||(n=Fl(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,r),n.write_shift(4,r),n.write_shift(1,120),n.length>n.l?n.slice(0,n.l):n)),Wl(e,136)}}function Hu(e,t){var r=Ml();return Wl(r,131),Wl(r,128,function(e,t){t||(t=Fl(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return lc("SheetJS",t),lc(wa.version,t),lc(wa.version,t),lc("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Wl(r,153,function(e,t){t||(t=Fl(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),bc(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Uu(r,e),function(e,t){Wl(e,143);for(var r=0;r!=t.SheetNames.length;++r)Wl(e,156,Wu({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Wl(e,144)}(r,e),Wl(r,132),r.end()}function Vu(e,t,r,n,o){return(".bin"===t.slice(-4)?Pu:yu)(e,r,n,o)}function Gu(e,t,r){return(".bin"===t.slice(-4)?_p:vp)(e,r)}function Yu(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return Yi(td).map(function(e){for(var t=0;t<qc.length;++t)if(qc[t][1]==e)return qc[t];for(t=0;t<Jc.length;++t)if(Jc[t][1]==e)return Jc[t];throw e}).forEach(function(n){if(null!=e[n[1]]){var o=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof o?o=String(o):!0===o||!1===o?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),r.push(zs(td[n[1]]||n[1],o))}}),Os("DocumentProperties",r.join(""),{xmlns:Ks})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",o=[];return e&&Yi(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<qc.length;++n)if(t==qc[n][1])return;for(n=0;n<Jc.length;++n)if(t==Jc[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var a=e[t],i="string";"number"==typeof a?(i="float",a=String(a)):!0===a||!1===a?(i="boolean",a=a?"1":"0"):a=String(a),o.push(Os(ys(t),a,{"dt:dt":i}))}}),t&&Yi(t).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],a="string";"number"==typeof n?(a="float",n=String(n)):!0===n||!1===n?(a="boolean",n=n?"1":"0"):n instanceof Date?(a="dateTime.tz",n=n.toISOString()):n=String(n),o.push(Os(ys(r),n,{"dt:dt":a}))}}),"<"+n+' xmlns="'+Ks+'">'+o.join("")+"</"+n+">"}(e.Props,e.Custprops)),r.join("")}function $u(e){return Os("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Cp(e.Ref,{r:0,c:0})})}function qu(e,t,r,n,o,a,i){if(!e||void 0==e.v&&void 0==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+vs(Cp(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Kl(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=vs(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=vs(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(s["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(s["ss:MergeDown"]=c[d].e.r-c[d].s.r));var p="",u="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",u=String(e.v);break;case"b":p="Boolean",u=e.v?"1":"0";break;case"e":p="Error",u=Lc[e.v];break;case"d":p="DateTime",u=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||oi[14]);break;case"s":p="String",u=((e.v||"")+"").replace(xs,function(e){return ms[e]}).replace(js,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=gu(n.cellXfs,e,n);s["ss:StyleID"]="s"+(21+f),s["ss:Index"]=i.c+1;var h=null!=e.v?u:"",g="z"==e.t?"":'<Data ss:Type="'+p+'">'+h+"</Data>";return(e.c||[]).length>0&&(g+=e.c.map(function(e){var t=Os("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Os("Comment",t,{"ss:Author":e.a})}).join("")),Os("Cell",g,s)}function Xu(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Zd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Ku(e,t,r){var n=[],o=r.SheetNames[e],a=r.Sheets[o],i=a?function(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var o=n.Workbook.Names,a=[],i=0;i<o.length;++i){var s=o[i];s.Sheet==r&&(s.Name.match(/^_xlfn\./)||a.push($u(s)))}return a.join("")}(a,0,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?function(e,t){if(!e["!ref"])return"";var r=ec(e["!ref"]),n=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(e,t){Kd(e);var r=!!e.width,n=fu(t,e),o={"ss:Index":t+1};r&&(o["ss:Width"]=$d(n.width)),e.hidden&&(o["ss:Hidden"]="1"),a.push(Os("Column",null,o))});for(var i=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){for(var l=[Xu(s,(e["!rows"]||[])[s])],c=r.s.c;c<=r.e.c;++c){var d=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>c)&&!(n[o].s.r>s)&&!(n[o].e.c<c)&&!(n[o].e.r<s)){n[o].s.c==c&&n[o].s.r==s||(d=!0);break}if(!d){var p={r:s,c:c},u=Jl(p),f=i?(e[s]||[])[c]:e[u];l.push(qu(f,u,e,t,0,0,p))}}l.push("</Row>"),l.length>2&&a.push(l.join(""))}return a.join("")}(a,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(function(e,t,r,n){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(Os("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(Os("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(Os("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)o.push(Os("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&(!n.Workbook.Sheets[a]||n.Workbook.Sheets[a].Hidden);++a);a==r&&o.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(zs("ProtectContents","True")),e["!protect"].objects&&o.push(zs("ProtectObjects","True")),e["!protect"].scenarios&&o.push(zs("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||o.push(zs("EnableSelection","UnlockedCells")):o.push(zs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&o.push("<"+t[1]+"/>")})),0==o.length?"":Os("WorksheetOptions",o.join(""),{xmlns:Js})}(a,0,e,r)),n.join("")}function Ju(e,t){t||(t={}),e.SSF||(e.SSF=ss(oi)),e.SSF&&(Fi(),Bi(e.SSF),t.revssf=Xi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gu(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Yu(e,t)),r.push(""),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Os("Worksheet",Ku(n,t,e),{"ss:Name":vs(e.SheetNames[n])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var n=[];n.push(Os("NumberFormat",null,{"ss:Format":vs(oi[e.numFmtId])}));var o={"ss:ID":"s"+(21+t)};r.push(Os("Style",n.join(""),o))}),Os("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var o=t[n];null==o.Sheet&&(o.Name.match(/^_xlfn\./)||r.push($u(o)))}return Os("Names",r.join(""))}(e),hs+Os("Workbook",r.join(""),{xmlns:Qs,"xmlns:o":Ks,"xmlns:x":Js,"xmlns:ss":Qs,"xmlns:dt":Zs,"xmlns:html":rl})}var Qu="e0859ff2f94f6810ab9108002b27b3d9",Zu="02d5cdd59c2e1b10939708002b2cf9ae",ef="05d5cdd59c2e1b10939708002b2cf9ae";function tf(e,t){var r=t||{},n=Ui.utils.cfb_new({root:"R"}),o="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":o="/Workbook",r.biff=8;break;case"biff5":o="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ui.utils.cfb_add(n,o,ff(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,n=[],o=[],a=[],i=0,s=$i(Ic,"n"),l=$i(Oc,"n");if(e.Props)for(r=Yi(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(s,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?o:a).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=Yi(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(s,r[i])?n:Object.prototype.hasOwnProperty.call(l,r[i])?o:a).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<a.length;++i)nd.indexOf(a[i][0])>-1||Qc.indexOf(a[i][0])>-1||null!=a[i][1]&&c.push(a[i]);o.length&&Ui.utils.cfb_add(t,"/\x05SummaryInformation",id(o,Qu,l,Oc)),(n.length||c.length)&&Ui.utils.cfb_add(t,"/\x05DocumentSummaryInformation",id(n,Zu,s,Ic,c.length?c:null,ef))}(e,n),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(r,n){if(0!=n){var o=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==o.slice(-1)&&Ui.utils.cfb_add(e,o,t.FileIndex[n].content)}})}(n,Ui.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var rf={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,7&a&&(r.level=7&a),16&a&&(r.hidden=!0),32&a&&(r.hpt=o/20),r}},1:{f:function(e){return[fc(e)]}},2:{f:function(e){return[fc(e),wc(e),"n"]}},3:{f:function(e){return[fc(e),e.read_shift(1),"e"]}},4:{f:function(e){return[fc(e),e.read_shift(1),"b"]}},5:{f:function(e){return[fc(e),Rc(e),"n"]}},6:{f:function(e){return[fc(e),sc(e),"str"]}},7:{f:function(e){return[fc(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,o=fc(e);o.r=r["!row"];var a=[o,sc(e),"str"];if(r.cellFormula){e.l+=2;var i=nu(e,n-e.l,r);a[3]=Zp(i,0,o,r.supbooks,r)}else e.l=n;return a}},9:{f:function(e,t,r){var n=e.l+t,o=fc(e);o.r=r["!row"];var a=[o,Rc(e),"n"];if(r.cellFormula){e.l+=2;var i=nu(e,n-e.l,r);a[3]=Zp(i,0,o,r.supbooks,r)}else e.l=n;return a}},10:{f:function(e,t,r){var n=e.l+t,o=fc(e);o.r=r["!row"];var a=[o,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=nu(e,n-e.l,r);a[3]=Zp(i,0,o,r.supbooks,r)}else e.l=n;return a}},11:{f:function(e,t,r){var n=e.l+t,o=fc(e);o.r=r["!row"];var a=[o,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=nu(e,n-e.l,r);a[3]=Zp(i,0,o,r.supbooks,r)}else e.l=n;return a}},12:{f:function(e){return[gc(e)]}},13:{f:function(e){return[gc(e),wc(e),"n"]}},14:{f:function(e){return[gc(e),e.read_shift(1),"e"]}},15:{f:function(e){return[gc(e),e.read_shift(1),"b"]}},16:{f:wu},17:{f:function(e){return[gc(e),sc(e),"str"]}},18:{f:function(e){return[gc(e),e.read_shift(4),"s"]}},19:{f:dc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var o=e.read_shift(4),a=jc(e),i=ou(e,0,r),s=vc(e);e.l=n;var l={Name:a,Ptg:i};return o<268435455&&(l.Sheet=o),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var o=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(o.fItalic&&(n.italic=1),o.fCondense&&(n.condense=1),o.fExtend&&(n.extend=1),o.fShadow&&(n.shadow=1),o.fOutline&&(n.outline=1),o.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var a=e.read_shift(1);0!=a&&(n.underline=a);var i=e.read_shift(1);i>0&&(n.family=i);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),o=e.read_shift(2,"i"),a=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=Dc[n];l&&(t.rgb=Gd(l));break;case 2:t.rgb=Gd([a,i,s]);break;case 3:t.theme=n}return 0!=o&&(t.tint=o>0?o/32767:o/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=sc(e),n}},44:{f:function(e,t){return[e.read_shift(2),sc(e)]}},45:{f:ap},46:{f:cp},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),o=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:o}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ad},62:{f:function(e){return[fc(e),dc(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Jl(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=xc(e,t-19),r}},148:{f:_u,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var o=t>8?sc(e):"";return o.length>0&&(r.CodeName=o),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=_c(e,t-8),r.name=sc(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Ec},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ku},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:sc(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_c},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Td},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,o=Cc(e),a=e.read_shift(1),i=[o];if(i[2]=a,r.cellFormula){var s=ru(e,n-e.l,r);i[1]=s}else e.l=n;return i}},427:{f:function(e,t,r){var n=e.l+t,o=[Ec(e,16)];if(r.cellFormula){var a=au(e,n-e.l,r);o[1]=a,e.l=n}else e.l=n;return o}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Eu.forEach(function(r){t[r]=Rc(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=Ec(e,16),o=vc(e),a=sc(e),i=sc(e),s=sc(e);e.l=r;var l={rfx:n,relId:o,loc:a,display:s};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_c},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jp},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Ec(e,16);return t.rfx=r.s,t.ref=Jl(r.s),e.l+=16,t}},636:{T:-1},637:{f:pc},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:sc(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function nf(e,t,r,n){var o=t;if(!isNaN(o)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,o),i.write_shift(2,a),a>0&&Sl(r)&&e.push(r)}}function of(e,t,r){return e||(e=Fl(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function af(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var o="d"==t.t?Ji(as(t.v)):t.v;return void(o==(0|o)&&o>=0&&o<65536?nf(e,2,function(e,t,r){var n=Fl(9);return of(n,e,t),n.write_shift(2,r),n}(r,n,o)):nf(e,3,function(e,t,r){var n=Fl(15);return of(n,e,t),n.write_shift(8,r,"f"),n}(r,n,o)));case"b":case"e":return void nf(e,5,function(e,t,r,n){var o=Fl(9);return of(o,e,t),pd(r,n||"b",o),o}(r,n,t.v,t.t));case"s":case"str":return void nf(e,4,function(e,t,r){var n=Fl(8+2*r.length);return of(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(r,n,(t.v||"").slice(0,255)))}nf(e,1,of(null,r,n))}function sf(e,t){var r=t||{};for(var n=Ml(),o=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(o=a);if(0==o&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return nf(n,4==r.biff?1033:3==r.biff?521:9,wd(0,16,r)),function(e,t,r,n){var o,a=Array.isArray(t),i=ec(t["!ref"]||"A1"),s="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Zl(i)}for(var c=i.s.r;c<=i.e.r;++c){s=$l(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=Xl(d)),o=l[d]+s;var p=a?(t[c]||[])[d]:t[o];p&&af(e,p,c,d)}}}(n,e.Sheets[e.SheetNames[o]],0,r),nf(n,10),n.end()}function lf(e,t,r){nf(e,49,function(e,t){var r=e.name||"Arial",n=t&&5==t.biff,o=Fl(n?15+r.length:16+2*r.length);return o.write_shift(2,20*(e.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function cf(e,t){if(t){var r=0;t.forEach(function(t,n){++r<=256&&t&&nf(e,125,function(e,t){var r=Fl(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}(fu(n,t),n))})}}function df(e,t,r,n,o){var a=16+gu(o.cellXfs,t,o);if(null!=t.v||t.bf)if(t.bf)nf(e,6,eu(t,r,n,0,a));else switch(t.t){case"d":case"n":nf(e,515,function(e,t,r,n){var o=Fl(14);return yd(e,t,n,o),Nc(r,o),o}(r,n,"d"==t.t?Ji(as(t.v)):t.v,a));break;case"b":case"e":nf(e,517,function(e,t,r,n,o,a){var i=Fl(8);return yd(e,t,n,i),pd(r,a,i),i}(r,n,t.v,a,0,t.t));break;case"s":case"str":if(o.bookSST)nf(e,253,function(e,t,r,n){var o=Fl(10);return yd(e,t,n,o),o.write_shift(4,r),o}(r,n,uu(o.Strings,t.v,o.revStrings),a));else nf(e,516,function(e,t,r,n,o){var a=!o||8==o.biff,i=Fl(+a+8+(1+a)*r.length);return yd(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}(r,n,(t.v||"").slice(0,255),a,o));break;default:nf(e,513,yd(r,n,a))}else nf(e,513,yd(r,n,a))}function pf(e,t,r){var n,o=Ml(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=Array.isArray(i),d=8==t.biff,p="",u=[],f=ec(i["!ref"]||"A1"),h=d?65536:16384;if(f.e.c>255||f.e.r>=h){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,h-1)}nf(o,2057,wd(0,16,t)),nf(o,13,dd(1)),nf(o,12,dd(100)),nf(o,15,ld(!0)),nf(o,17,ld(!1)),nf(o,16,Nc(.001)),nf(o,95,ld(!0)),nf(o,42,ld(!1)),nf(o,43,ld(!1)),nf(o,130,dd(1)),nf(o,128,function(e){var t=Fl(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),nf(o,131,ld(!1)),nf(o,132,ld(!1)),d&&cf(o,i["!cols"]),nf(o,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,n=Fl(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),d&&(i["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){p=$l(g);for(var m=f.s.c;m<=f.e.c;++m){g===f.s.r&&(u[m]=Xl(m)),n=u[m]+p;var x=c?(i[g]||[])[m]:i[n];x&&(df(o,x,g,m,t),d&&x.l&&i["!links"].push([n,x.l]))}}var b=l.CodeName||l.name||a;return d&&nf(o,574,function(e){var t=Fl(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((s.Views||[])[0])),d&&(i["!merges"]||[]).length&&nf(o,229,function(e){var t=Fl(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Sd(e[r],t);return t}(i["!merges"])),d&&function(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];nf(e,440,Rd(n)),n[1].Tooltip&&nf(e,2048,Nd(n))}delete t["!links"]}(o,i),nf(o,442,xd(b)),d&&function(e,t){var r=Fl(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),nf(e,2151,r),(r=Fl(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Sd(ec(t["!ref"]||"A1"),r),r.write_shift(4,4),nf(e,2152,r)}(o,i),nf(o,10),o.end()}function uf(e,t,r){var n=Ml(),o=(e||{}).Workbook||{},a=o.Sheets||[],i=o.WBProps||{},s=8==r.biff,l=5==r.biff;(nf(n,2057,wd(0,5,r)),"xla"==r.bookType&&nf(n,135),nf(n,225,s?dd(1200):null),nf(n,193,function(e,t){t||(t=Fl(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&nf(n,191),l&&nf(n,192),nf(n,226),nf(n,92,function(e,t){var r=!t||8==t.biff,n=Fl(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}(0,r)),nf(n,66,dd(s?1200:1252)),s&&nf(n,353,dd(0)),s&&nf(n,448),nf(n,317,function(e){for(var t=Fl(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&nf(n,211),s&&e.vbaraw)&&nf(n,442,xd(i.CodeName||"ThisWorkbook"));nf(n,156,dd(17)),nf(n,25,ld(!1)),nf(n,18,ld(!1)),nf(n,19,dd(0)),s&&nf(n,431,ld(!1)),s&&nf(n,444,dd(0)),nf(n,61,function(){var e=Fl(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),nf(n,64,ld(!1)),nf(n,141,dd(0)),nf(n,34,ld("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&Ss(e.Workbook.WBProps.date1904)?"true":"false"}(e))),nf(n,14,ld(!0)),s&&nf(n,439,ld(!1)),nf(n,218,dd(0)),lf(n,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var o=n[0];o<=n[1];++o)null!=t[o]&&nf(e,1054,Cd(o,t[o],r))})}(n,e.SSF,r),function(e,t){for(var r=0;r<16;++r)nf(e,224,Ed({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){nf(e,224,Ed(r,0,t))})}(n,r),s&&nf(n,352,ld(!1));var c,d=n.end(),p=Ml();s&&nf(p,140,(c||(c=Fl(4)),c.write_shift(2,1),c.write_shift(2,1),c)),s&&r.Strings&&function(e,t,r,n){var o=n||(r||[]).length||0;if(o<=8224)return nf(e,t,r,o);var a=t;if(!isNaN(a)){for(var i=r.parts||[],s=0,l=0,c=0;c+(i[s]||8224)<=8224;)c+=i[s]||8224,s++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<o;){for((d=e.next(4)).write_shift(2,60),c=0;c+(i[s]||8224)<=8224;)c+=i[s]||8224,s++;d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(p,252,function(e){var t=Fl(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],n=0;n<e.length;++n)r[n]=fd(e[n]);var o=Ya([t].concat(r));return o.parts=[t.length].concat(r.map(function(e){return e.length})),o}(r.Strings)),nf(p,10);var u=p.end(),f=Ml(),h=0,g=0;for(g=0;g<e.SheetNames.length;++g)h+=(s?12:11)+(s?2:1)*e.SheetNames[g].length;var m=d.length+h+u.length;for(g=0;g<e.SheetNames.length;++g){nf(f,133,kd({pos:m,hs:(a[g]||{}).Hidden||0,dt:0,name:e.SheetNames[g]},r)),m+=t[g].length}var x=f.end();if(h!=x.length)throw new Error("BS8 "+h+" != "+x.length);var b=[];return d.length&&b.push(d),x.length&&b.push(x),u.length&&b.push(u),Ya(b)}function ff(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"])Ql(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var o=t||{};switch(o.biff||2){case 8:case 5:return function(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ss(oi)),e&&e.SSF&&(Fi(),Bi(e.SSF),r.revssf=Xi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Hf(r),r.cellXfs=[],gu(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)n[n.length]=pf(o,r,e);return n.unshift(uf(e,n,r)),Ya(n)}(e,t);case 4:case 3:case 2:return sf(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function hf(e,t,r,n){for(var o=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var s=0,l=0,c=0;c<o.length;++c)if(!(o[c].s.r>r||o[c].s.c>i)&&!(o[c].e.r<r||o[c].e.c<i)){if(o[c].s.r<r||o[c].s.c<i){s=-1;break}s=o[c].e.r-o[c].s.r+1,l=o[c].e.c-o[c].s.c+1;break}if(!(s<0)){var d=Jl({r:r,c:i}),p=n.dense?(e[r]||[])[i]:e[d],u=p&&null!=p.v&&(p.h||_s(p.w||(rc(p),p.w)||""))||"",f={};s>1&&(f.rowspan=s),l>1&&(f.colspan=l),n.editable?u='<span contenteditable="true">'+u+"</span>":p&&(f["data-t"]=p&&p.t||"z",null!=p.v&&(f["data-v"]=p.v),null!=p.z&&(f["data-z"]=p.z),p.l&&"#"!=(p.l.Target||"#").charAt(0)&&(u='<a href="'+p.l.Target+'">'+u+"</a>")),f.id=(n.id||"sjs")+"-"+d,a.push(Os("td",u,f))}}return"<tr>"+a.join("")+"</tr>"}var gf='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mf="</body></html>";function xf(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bf(e,t){var r=t||{},n=null!=r.header?r.header:gf,o=null!=r.footer?r.footer:mf,a=[n],i=Ql(e["!ref"]);r.dense=Array.isArray(e),a.push(xf(0,0,r));for(var s=i.s.r;s<=i.e.r;++s)a.push(hf(e,i,s,r));return a.push("</table>"+o),a.join("")}function vf(e,t,r){var n=r||{};var o=0,a=0;if(null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var i="string"==typeof n.origin?Kl(n.origin):n.origin;o=i.r,a=i.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:o,c:a}};if(e["!ref"]){var d=Ql(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==o&&(c.e.r=o=d.e.r+1)}var p=[],u=0,f=e["!rows"]||(e["!rows"]=[]),h=0,g=0,m=0,x=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);h<s.length&&g<l;++h){var y=s[h];if(jf(y)){if(n.display)continue;f[g]={hidden:!0}}var j=y.children;for(m=x=0;m<j.length;++m){var _=j[m];if(!n.display||!jf(_)){var S=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):Ns(_.innerHTML),w=_.getAttribute("data-z")||_.getAttribute("z");for(u=0;u<p.length;++u){var k=p[u];k.s.c==x+a&&k.s.r<g+o&&g+o<=k.e.r&&(x=k.e.c+1-a,u=-1)}v=+_.getAttribute("colspan")||1,((b=+_.getAttribute("rowspan")||1)>1||v>1)&&p.push({s:{r:g+o,c:x+a},e:{r:g+o+(b||1)-1,c:x+a+(v||1)-1}});var C={t:"s",v:S},E=_.getAttribute("data-t")||_.getAttribute("t")||"";null!=S&&(0==S.length?C.t=E||"z":n.raw||0==S.trim().length||"s"==E||("TRUE"===S?C={t:"b",v:!0}:"FALSE"===S?C={t:"b",v:!1}:isNaN(cs(S))?isNaN(ps(S).getDate())||(C={t:"d",v:as(S)},n.cellDates||(C={t:"n",v:Ji(C.v)}),C.z=n.dateNF||oi[14]):C={t:"n",v:cs(S)})),void 0===C.z&&null!=w&&(C.z=w);var T="",R=_.getElementsByTagName("A");if(R&&R.length)for(var N=0;N<R.length&&(!R[N].hasAttribute("href")||"#"==(T=R[N].getAttribute("href")).charAt(0));++N);T&&"#"!=T.charAt(0)&&(C.l={Target:T}),n.dense?(e[g+o]||(e[g+o]=[]),e[g+o][x+a]=C):e[Jl({c:x+a,r:g+o})]=C,c.e.c<x+a&&(c.e.c=x+a),x+=v}}++g}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),c.e.r=Math.max(c.e.r,g-1+o),e["!ref"]=Zl(c),g>=l&&(e["!fullref"]=Zl((c.e.r=s.length-h+g-1+o,c))),e}function yf(e,t){return vf((t||{}).dense?[]:{},e,t)}function jf(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var _f=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return hs+t}}(),Sf=function(){var e=function(e){return vs(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,n,o){var a=[];a.push('      <table:table table:name="'+vs(n.SheetNames[o])+'" table:style-name="ta1">\n');var i=0,s=0,l=Ql(r["!ref"]||"A1"),c=r["!merges"]||[],d=0,p=Array.isArray(r);if(r["!cols"])for(s=0;s<=l.e.c;++s)a.push("        <table:table-column"+(r["!cols"][s]?' table:style-name="co'+r["!cols"][s].ods+'"':"")+"></table:table-column>\n");var u="",f=r["!rows"]||[];for(i=0;i<l.s.r;++i)u=f[i]?' table:style-name="ro'+f[i].ods+'"':"",a.push("        <table:table-row"+u+"></table:table-row>\n");for(;i<=l.e.r;++i){for(u=f[i]?' table:style-name="ro'+f[i].ods+'"':"",a.push("        <table:table-row"+u+">\n"),s=0;s<l.s.c;++s)a.push(t);for(;s<=l.e.c;++s){var h=!1,g={},m="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>s)&&!(c[d].s.r>i)&&!(c[d].e.c<s)&&!(c[d].e.r<i)){c[d].s.c==s&&c[d].s.r==i||(h=!0),g["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,g["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(h)a.push("          <table:covered-table-cell/>\n");else{var x=Jl({r:i,c:s}),b=p?(r[i]||[])[s]:r[x];if(b&&b.f&&(g["table:formula"]=vs(cu(b.f)),b.F&&b.F.slice(0,x.length)==x)){var v=Ql(b.F);g["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,g["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1}if(b){switch(b.t){case"b":m=b.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=b.v?"true":"false";break;case"n":m=b.w||String(b.v||0),g["office:value-type"]="float",g["office:value"]=b.v||0;break;case"s":case"str":m=null==b.v?"":b.v,g["office:value-type"]="string";break;case"d":m=b.w||as(b.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=as(b.v).toISOString(),g["table:style-name"]="ce1";break;default:a.push(t);continue}var y=e(m);if(b.l&&b.l.Target){var j=b.l.Target;"#"==(j="#"==j.charAt(0)?"#"+du(j.slice(1)):j).charAt(0)||j.match(/^\w+:/)||(j="../"+j),y=Os("text:a",y,{"xlink:href":j.replace(/&/g,"&amp;")})}a.push("          "+Os("table:table-cell",Os("text:p",y,{}),g)+"\n")}else a.push(t)}}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")};return function(e,t){var n=[hs],o=Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),a=Is({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(n.push("<office:document"+o+a+">\n"),n.push($c().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+o+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var o=t["!cols"][n];if(null==o.width&&null==o.wpx&&null==o.wch)continue;Kd(o),o.ods=r;var a=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}});var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var o=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+o+'"/>\n'),e.push("  </style:style>\n"),++n}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(n,e),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)n.push(r(e.Sheets[e.SheetNames[i]],e,i));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function wf(e,t){if("fods"==t.bookType)return Sf(e,t);var r=fs(),n="",o=[],a=[];return us(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),us(r,n="content.xml",Sf(e,t)),o.push([n,"text/xml"]),a.push([n,"ContentFile"]),us(r,n="styles.xml",_f(e,t)),o.push([n,"text/xml"]),a.push([n,"StylesFile"]),us(r,n="meta.xml",hs+$c()),o.push([n,"text/xml"]),a.push([n,"MetadataFile"]),us(r,n="manifest.rdf",function(e){var t=[hs];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(Gc(e[r][0],e[r][1])),t.push(Yc("",e[r][0]));return t.push(Gc("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(a)),o.push([n,"application/rdf+xml"]),us(r,n="META-INF/manifest.xml",function(e){var t=[hs];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(o)),r}function kf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Cf(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Ha(Rs(e))}function Ef(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}function Tf(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function Rf(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Nf(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Af(e){for(var t=[],r=[0];r[0]<e.length;){var n,o=r[0],a=Tf(e,r),i=7&a,s=0;if(0==(a=Math.floor(a/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:s=4,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Tf(e,r),n=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(o))}var c={data:n,type:i};null==t[a]?t[a]=[c]:t[a].push(c)}return t}function zf(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(Rf(8*r+e.type)),2==e.type&&t.push(Rf(e.data.length)),t.push(e.data))})}),Ef(t)}function If(e){for(var t,r=[],n=[0];n[0]<e.length;){var o=Tf(e,n),a=Af(e.slice(n[0],n[0]+o));n[0]+=o;var i={id:Nf(a[1][0].data),messages:[]};a[2].forEach(function(t){var r=Af(t.data),o=Nf(r[3][0].data);i.messages.push({meta:r,data:e.slice(n[0],n[0]+o)}),n[0]+=o}),(null==(t=a[3])?void 0:t[0])&&(i.merge=Nf(a[3][0].data)>>>0>0),r.push(i)}return r}function Of(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:Rf(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:Rf(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(e){n.push(e.data),e.meta[3]=[{type:0,data:Rf(e.data.length)}],r[2].push({data:zf(e.meta),type:2})});var o=zf(r);t.push(Rf(o.length)),t.push(o),n.forEach(function(e){return t.push(e)})}),Ef(t)}function Pf(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Tf(t,r),o=[];r[0]<t.length;){var a=3&t[r[0]];if(0!=a){var i=0,s=0;if(1==a?(s=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(s=1+(t[r[0]++]>>2),2==a?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),o=[Ef(o)],0==i)throw new Error("Invalid offset 0");if(i>o[0].length)throw new Error("Invalid offset beyond length");if(s>=i)for(o.push(o[0].slice(-i)),s-=i;s>=o[o.length-1].length;)o.push(o[o.length-1]),s-=o[o.length-1].length;o.push(o[0].slice(-i,-i+s))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}o.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var d=Ef(o);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Df(e){for(var t=[],r=0;r<e.length;){var n=e[r++],o=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Pf(n,e.slice(r,r+o))),r+=o}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ef(t)}function Lf(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),o=new Uint8Array(4);t.push(o);var a=Rf(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,o[0]=0,o[1]=255&i,o[2]=i>>8&255,o[3]=i>>16&255,r+=n}return Ef(t)}function Bf(e,t){var r=new Uint8Array(32),n=kf(r),o=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,o=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var a=0;o>=1;++a,o/=256)e[t+a]=255&o;e[t+15]|=r>=0?0:128}(r,o,e.v),a|=1,o+=16;break;case"b":r[1]=6,n.setFloat64(o,e.v?1:0,!0),a|=2,o+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(o,t.indexOf(e.v),!0),a|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,o)}function Ff(e,t){var r=new Uint8Array(32),n=kf(r),o=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(o,e.v,!0),a|=32,o+=8;break;case"b":r[2]=6,n.setFloat64(o,e.v?1:0,!0),a|=32,o+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(o,t.indexOf(e.v),!0),a|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,o)}function Mf(e){return Tf(Af(e)[1][0].data)}function Wf(e,t,r){var n,o,a,i;if(!(null==(n=e[6])?void 0:n[0])||!(null==(o=e[7])?void 0:o[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(a=e[8])?void 0:a[0])?void 0:i.data)&&Nf(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=kf(e[7][0].data),c=0,d=[],p=kf(e[4][0].data),u=0,f=[],h=0;h<t.length;++h)if(null!=t[h]){var g,m;switch(l.setUint16(2*h,c,!0),p.setUint16(2*h,u,!0),typeof t[h]){case"string":g=Bf({t:"s",v:t[h]},r),m=Ff({t:"s",v:t[h]},r);break;case"number":g=Bf({t:"n",v:t[h]},r),m=Ff({t:"n",v:t[h]},r);break;case"boolean":g=Bf({t:"b",v:t[h]},r),m=Ff({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}d.push(g),c+=g.length,f.push(m),u+=m.length,++s}else l.setUint16(2*h,65535,!0),p.setUint16(2*h,65535);for(e[2][0].data=Rf(s);h<e[7][0].data.length/2;++h)l.setUint16(2*h,65535,!0),p.setUint16(2*h,65535,!0);return e[6][0].data=Ef(d),e[3][0].data=Ef(f),s}function Uf(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function Hf(e){Uf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Vf(e,t){return"ods"==t.bookType?wf(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ql(r["!ref"]);n.s.r=n.s.c=0;var o=!1;n.e.c>9&&(o=!0,n.e.c=9),n.e.r>49&&(o=!0,n.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(Zl(n)));var a=th(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var s={},l=[],c=Ui.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&If(Df(t.content)).forEach(function(e){l.push(e.id),s[e.id]={deps:[],location:r,type:Nf(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var d=l.filter(function(e){return e>1}).map(function(e){return[e,Rf(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&If(Df(t.content)).forEach(function(e){e.messages.forEach(function(t){d.forEach(function(t){e.messages.some(function(e){return 11006!=Nf(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])})&&s[t[0]].deps.push(e.id)})})})});for(var p,u=Ui.find(c,s[1].location),f=If(Df(u.content)),h=0;h<f.length;++h){var g=f[h];1==g.id&&(p=g)}var m=Mf(Af(p.messages[0].data)[1][0].data);for(f=If(Df((u=Ui.find(c,s[m].location)).content)),h=0;h<f.length;++h)(g=f[h]).id==m&&(p=g);for(m=Mf(Af(p.messages[0].data)[2][0].data),f=If(Df((u=Ui.find(c,s[m].location)).content)),h=0;h<f.length;++h)(g=f[h]).id==m&&(p=g);for(m=Mf(Af(p.messages[0].data)[2][0].data),f=If(Df((u=Ui.find(c,s[m].location)).content)),h=0;h<f.length;++h)(g=f[h]).id==m&&(p=g);var x=Af(p.messages[0].data);x[6][0].data=Rf(n.e.r+1),x[7][0].data=Rf(n.e.c+1);for(var b=Mf(x[46][0].data),v=Ui.find(c,s[b].location),y=If(Df(v.content)),j=0;j<y.length&&y[j].id!=b;++j);if(y[j].id!=b)throw"Bad ColumnRowUIDMapArchive";var _=Af(y[j].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var S=0;S<=n.e.c;++S){var w=[];w[1]=w[2]=[{type:0,data:Rf(S+420690)}],_[1].push({type:2,data:zf(w)}),_[2].push({type:0,data:Rf(S)}),_[3].push({type:0,data:Rf(S)})}_[4]=[],_[5]=[],_[6]=[];for(var k=0;k<=n.e.r;++k)(w=[])[1]=w[2]=[{type:0,data:Rf(k+726270)}],_[4].push({type:2,data:zf(w)}),_[5].push({type:0,data:Rf(k)}),_[6].push({type:0,data:Rf(k)});y[j].messages[0].data=zf(_),v.content=Lf(Of(y)),v.size=v.content.length,delete x[46];var C=Af(x[4][0].data);C[7][0].data=Rf(n.e.r+1);var E=Mf(Af(C[1][0].data)[2][0].data);if((y=If(Df((v=Ui.find(c,s[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";var T=Af(y[0].messages[0].data);for(k=0;k<a.length;++k){var R=Af(T[2][0].data);R[1][0].data=Rf(k),R[4][0].data=Rf(a[k].length),T[2][k]={type:T[2][0].type,data:zf(R)}}y[0].messages[0].data=zf(T),v.content=Lf(Of(y)),v.size=v.content.length;var N=Mf(C[2][0].data);if((y=If(Df((v=Ui.find(c,s[N].location)).content)))[0].id!=N)throw"Bad HeaderStorageBucket";for(T=Af(y[0].messages[0].data),S=0;S<=n.e.c;++S)(R=Af(T[2][0].data))[1][0].data=Rf(S),R[4][0].data=Rf(n.e.r+1),T[2][S]={type:T[2][0].type,data:zf(R)};y[0].messages[0].data=zf(T),v.content=Lf(Of(y)),v.size=v.content.length;var A=Mf(C[4][0].data);!function(){for(var e,t=Ui.find(c,s[A].location),r=If(Df(t.content)),n=0;n<r.length;++n){var o=r[n];o.id==A&&(e=o)}var a=Af(e.messages[0].data);a[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:Rf(t)}],l[2]=[{type:0,data:Rf(1)}],l[3]=[{type:2,data:Cf(e)}],a[3].push({type:2,data:zf(l)})}),e.messages[0].data=zf(a);var d=Lf(Of(r));t.content=d,t.size=t.content.length}();var z=Af(C[3][0].data),I=z[1][0];delete z[2];var O=Af(I.data),P=Mf(O[2][0].data);!function(){for(var e,t=Ui.find(c,s[P].location),r=If(Df(t.content)),o=0;o<r.length;++o){var l=r[o];l.id==P&&(e=l)}var d=Af(e.messages[0].data);delete d[6],delete z[7];var p=new Uint8Array(d[5][0].data);d[5]=[];for(var u=0,f=0;f<=n.e.r;++f){var h=Af(p);u+=Wf(h,a[f],i),h[1][0].data=Rf(f),d[5].push({data:zf(h),type:2})}d[1]=[{type:0,data:Rf(n.e.c+1)}],d[2]=[{type:0,data:Rf(n.e.r+1)}],d[3]=[{type:0,data:Rf(u)}],d[4]=[{type:0,data:Rf(n.e.r+1)}],e.messages[0].data=zf(d);var g=Lf(Of(r));t.content=g,t.size=t.content.length}(),I.data=zf(O),C[3][0].data=zf(z),x[4][0].data=zf(C),p.messages[0].data=zf(x);var D=Lf(Of(f));return u.content=D,u.size=u.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){xp=1024,e&&!e.SSF&&(e.SSF=ss(oi));e&&e.SSF&&(Fi(),Bi(e.SSF),t.revssf=Xi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=Sp.indexOf(t.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Hf(t=t||{});var a=fs(),i="",s=0;t.cellXfs=[],gu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(us(a,i="docProps/core.xml",Kc(e.Props,t)),o.coreprops.push(i),Vc(t.rels,2,i,Wc.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,us(a,i,Zc(e.Props)),o.extprops.push(i),Vc(t.rels,3,i,Wc.EXT_PROPS),e.Custprops!==e.Props&&Yi(e.Custprops||{}).length>0&&(us(a,i="docProps/custom.xml",ed(e.Custprops)),o.custprops.push(i),Vc(t.rels,4,i,Wc.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var d={"!id":{}},p=e.Sheets[e.SheetNames[s-1]];(p||{})["!type"];if(us(a,i="xl/worksheets/sheet"+s+"."+r,Vu(s-1,i,t,e,d)),o.sheets.push(i),Vc(t.wbrels,-1,"worksheets/sheet"+s+"."+r,Wc.WS[0]),p){var u=p["!comments"],f=!1,h="";u&&u.length>0&&(us(a,h="xl/comments"+s+"."+r,Gu(u,h,t)),o.comments.push(h),Vc(d,-1,"../comments"+s+"."+r,Wc.CMNT),f=!0),p["!legacy"]&&f&&us(a,"xl/drawings/vmlDrawing"+s+".vml",bp(s,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&us(a,Uc(i),Hc(d))}null!=t.Strings&&t.Strings.length>0&&(us(a,i="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?Wd:Fd)(e,r)}(t.Strings,i,t)),o.strs.push(i),Vc(t.wbrels,-1,"sharedStrings."+r,Wc.SST));us(a,i="xl/workbook."+r,function(e,t,r){return(".bin"===t.slice(-4)?Hu:Mu)(e,r)}(e,i,t)),o.workbooks.push(i),Vc(t.rels,1,i,Wc.WB),us(a,i="xl/theme/theme1.xml",hp(e.Themes,t)),o.themes.push(i),Vc(t.wbrels,-1,"theme/theme1.xml",Wc.THEME),us(a,i="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?fp:ep)(e,r)}(e,i,t)),o.styles.push(i),Vc(t.wbrels,-1,"styles."+r,Wc.STY),e.vbaraw&&n&&(us(a,i="xl/vbaProject.bin",e.vbaraw),o.vba.push(i),Vc(t.wbrels,-1,"vbaProject.bin",Wc.VBA));return us(a,i="xl/metadata."+r,function(e){return(".bin"===e.slice(-4)?gp:mp)()}(i)),o.metadata.push(i),Vc(t.wbrels,-1,"metadata."+r,Wc.XLMETA),us(a,"[Content_Types].xml",Mc(o,t)),us(a,"_rels/.rels",Hc(t.rels)),us(a,"xl/_rels/workbook."+r+".rels",Hc(t.wbrels)),delete t.revssf,delete t.ssf,a}(e,t):Gf(e,t)}function Gf(e,t){xp=1024,e&&!e.SSF&&(e.SSF=ss(oi)),e&&e.SSF&&(Fi(),Bi(e.SSF),t.revssf=Xi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Sp.indexOf(t.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Hf(t=t||{});var a=fs(),i="",s=0;if(t.cellXfs=[],gu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),us(a,i="docProps/core.xml",Kc(e.Props,t)),o.coreprops.push(i),Vc(t.rels,2,i,Wc.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,us(a,i,Zc(e.Props)),o.extprops.push(i),Vc(t.rels,3,i,Wc.EXT_PROPS),e.Custprops!==e.Props&&Yi(e.Custprops||{}).length>0&&(us(a,i="docProps/custom.xml",ed(e.Custprops)),o.custprops.push(i),Vc(t.rels,4,i,Wc.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var p={"!id":{}},u=e.Sheets[e.SheetNames[s-1]];(u||{})["!type"];if(us(a,i="xl/worksheets/sheet"+s+"."+r,yu(s-1,t,e,p)),o.sheets.push(i),Vc(t.wbrels,-1,"worksheets/sheet"+s+"."+r,Wc.WS[0]),u){var f=u["!comments"],h=!1,g="";if(f&&f.length>0){var m=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(m=!0)})}),m&&(us(a,g="xl/threadedComments/threadedComment"+s+"."+r,yp(f,d,t)),o.threadedcomments.push(g),Vc(p,-1,"../threadedComments/threadedComment"+s+"."+r,Wc.TCMNT)),us(a,g="xl/comments"+s+"."+r,vp(f)),o.comments.push(g),Vc(p,-1,"../comments"+s+"."+r,Wc.CMNT),h=!0}u["!legacy"]&&h&&us(a,"xl/drawings/vmlDrawing"+s+".vml",bp(s,u["!comments"])),delete u["!comments"],delete u["!legacy"]}p["!id"].rId1&&us(a,Uc(i),Hc(p))}return null!=t.Strings&&t.Strings.length>0&&(us(a,i="xl/sharedStrings."+r,Fd(t.Strings,t)),o.strs.push(i),Vc(t.wbrels,-1,"sharedStrings."+r,Wc.SST)),us(a,i="xl/workbook."+r,Mu(e)),o.workbooks.push(i),Vc(t.rels,1,i,Wc.WB),us(a,i="xl/theme/theme1.xml",hp(e.Themes,t)),o.themes.push(i),Vc(t.wbrels,-1,"theme/theme1.xml",Wc.THEME),us(a,i="xl/styles."+r,ep(e,t)),o.styles.push(i),Vc(t.wbrels,-1,"styles."+r,Wc.STY),e.vbaraw&&n&&(us(a,i="xl/vbaProject.bin",e.vbaraw),o.vba.push(i),Vc(t.wbrels,-1,"vbaProject.bin",Wc.VBA)),us(a,i="xl/metadata."+r,mp()),o.metadata.push(i),Vc(t.wbrels,-1,"metadata."+r,Wc.XLMETA),d.length>1&&(us(a,i="xl/persons/person.xml",function(e){var t=[hs,Os("personList",null,{xmlns:Ws,"xmlns:x":Xs[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,r){t.push(Os("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),o.people.push(i),Vc(t.wbrels,-1,"persons/person.xml",Wc.PEOPLE)),us(a,"[Content_Types].xml",Mc(o,t)),us(a,"_rels/.rels",Hc(t.rels)),us(a,"xl/_rels/workbook.xml.rels",Hc(t.wbrels)),delete t.revssf,delete t.ssf,a}function Yf(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ba(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function $f(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gi(t.file,Ui.write(e,{type:Fa?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ui.write(e,t)}function qf(e,t){var r={},n=Fa?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var o=e.FullPaths?Ui.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof o){if("binary"==t.type||"base64"==t.type)return o;o=new Uint8Array(Va(o))}return t.password&&"undefined"!==typeof encrypt_agile?$f(encrypt_agile(o,t.password),t):"file"===t.type?Gi(t.file,o):"string"==t.type?Ts(o):o}function Xf(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return La(Rs(n));case"binary":return Rs(n);case"string":return e;case"file":return Gi(t.file,n,"utf8");case"buffer":return Fa?Ma(n,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(n):Xf(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Kf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?La(r):"string"==t.type?Ts(r):r;case"file":return Gi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Jf(e,t){Aa(),Fu(e);var r=ss(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=Jf(e,r);return r.type="array",Va(n)}var o=0;if(r.sheet&&(o="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Xf(Ju(e,r),r);case"slk":case"sylk":return Xf(Id.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"htm":case"html":return Xf(bf(e.Sheets[e.SheetNames[o]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return La(e);case"binary":case"string":return e;case"file":return Gi(t.file,e,"binary");case"buffer":return Fa?Ma(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(ah(e.Sheets[e.SheetNames[o]],r),r);case"csv":return Xf(oh(e.Sheets[e.SheetNames[o]],r),r,"\ufeff");case"dif":return Xf(Od.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return Kf(zd.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return Xf(Dd.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return Xf(Vd.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"eth":return Xf(Pd.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return Xf(wf(e,r),r);case"wk1":return Kf(Ld.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return Kf(Ld.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Kf(ff(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return $f(tf(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=ss(t||{});return qf(Vf(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Qf(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Zf(e,t,r){var n=r||{};return n.type="file",n.file=t,Qf(n),Jf(e,n)}function eh(e,t,r,n,o,a,i,s){var l=$l(r),c=s.defval,d=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),p=!0,u=1===o?[]:{};if(1!==o)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch(Fh){u.__rowNum__=r}else u.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var h=i?e[r][f]:e[n[f]+l];if(void 0!==h&&void 0!==h.t){var g=h.v;switch(h.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(null!=a[f]){if(null==g)if("e"==h.t&&null===g)u[a[f]]=null;else if(void 0!==c)u[a[f]]=c;else{if(!d||null!==g)continue;u[a[f]]=null}else u[a[f]]=d&&("n"!==h.t||"n"===h.t&&!1!==s.rawNumbers)?g:rc(h,g,s);null!=g&&(p=!1)}}else{if(void 0===c)continue;null!=a[f]&&(u[a[f]]=c)}}return{row:u,isempty:p}}function th(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,o=1,a=[],i=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof d){case"string":l=ec(d);break;case"number":(l=ec(e["!ref"])).s.r=d;break;default:l=d}n>0&&(o=0);var p=$l(l.s.r),u=[],f=[],h=0,g=0,m=Array.isArray(e),x=l.s.r,b=0,v={};m&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],j=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(u[b]=Xl(b),r=m?e[x][b]:e[u[b]+p],n){case 1:a[b]=b-l.s.c;break;case 2:a[b]=u[b];break;case 3:a[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),s=i=rc(r,null,c),g=v[i]||0){do{s=i+"_"+g++}while(v[s]);v[i]=g,v[s]=1}else v[i]=1;a[b]=s}for(x=l.s.r+o;x<=l.e.r;++x)if(!(j[x]||{}).hidden){var _=eh(e,l,x,u,n,a,m,c);(!1===_.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[h++]=_.row)}return f.length=h,f}var rh=/"/g;function nh(e,t,r,n,o,a,i,s){for(var l=!0,c=[],d="",p=$l(r),u=t.s.c;u<=t.e.c;++u)if(n[u]){var f=s.dense?(e[r]||[])[u]:e[n[u]+p];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(s.rawNumbers&&"n"==f.t?f.v:rc(f,null,s));for(var h=0,g=0;h!==d.length;++h)if((g=d.charCodeAt(h))===o||g===a||34===g||s.forceQuotes){d='"'+d.replace(rh,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(rh,'""')+'"'));c.push(d)}return!1===s.blankrows&&l?null:c.join(i)}function oh(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var o=ec(e["!ref"]),a=void 0!==n.FS?n.FS:",",i=a.charCodeAt(0),s=void 0!==n.RS?n.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var u=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],h=o.s.c;h<=o.e.c;++h)(u[h]||{}).hidden||(p[h]=Xl(h));for(var g=0,m=o.s.r;m<=o.e.r;++m)(f[m]||{}).hidden||null!=(d=nh(e,o,m,p,i,l,a,n))&&(n.strip&&(d=d.replace(c,"")),(d||!1!==n.blankrows)&&r.push((g++?s:"")+d));return delete n.dense,r.join("")}function ah(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=oh(e,t);if("undefined"==typeof Ia||"string"==t.type)return r;var n=Ia.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function ih(e,t,r){var n,o=r||{},a=+!o.skipHeader,i=e||{},s=0,l=0;if(i&&null!=o.origin)if("number"==typeof o.origin)s=o.origin;else{var c="string"==typeof o.origin?Kl(o.origin):o.origin;s=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:s+t.length-1+a}};if(i["!ref"]){var p=ec(i["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),-1==s&&(s=p.e.r+1,d.e.r=s+t.length-1+a)}else-1==s&&(s=0,d.e.r=t.length-1+a);var u=o.header||[],f=0;t.forEach(function(e,t){Yi(e).forEach(function(r){-1==(f=u.indexOf(r))&&(u[f=u.length]=r);var c=e[r],d="z",p="",h=Jl({c:l+f,r:s+t+a});n=sh(i,h),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",o.cellDates||(d="n",c=Ji(c)),p=o.dateNF||oi[14]):null===c&&o.nullError&&(d="e",c=0),n?(n.t=d,n.v=c,delete n.w,delete n.R,p&&(n.z=p)):i[h]=n={t:d,v:c},p&&(n.z=p)):i[h]=c})}),d.e.c=Math.max(d.e.c,l+u.length-1);var h=$l(s);if(a)for(f=0;f<u.length;++f)i[Xl(f+l)+h]={t:"s",v:u[f]};return i["!ref"]=Zl(d),i}function sh(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=Kl(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return sh(e,Jl("number"!=typeof t?t:{r:t,c:r||0}))}function lh(){return{SheetNames:[],Sheets:{}}}function ch(e,t,r,n){var o=1;if(!r)for(;o<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+o);++o,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);o=a&&+a[2]||0;var i=a&&a[1]||r;for(++o;o<=65535&&-1!=e.SheetNames.indexOf(r=i+o);++o);}if(Bu(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dh(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var ph={encode_col:Xl,encode_row:$l,encode_cell:Jl,encode_range:Zl,decode_col:ql,decode_row:Yl,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Kl,decode_range:Ql,format_cell:rc,sheet_add_aoa:oc,sheet_add_json:ih,sheet_add_dom:vf,aoa_to_sheet:ac,json_to_sheet:function(e,t){return ih(null,e,t)},table_to_sheet:yf,table_to_book:function(e,t){return nc(yf(e,t),t)},sheet_to_csv:oh,sheet_to_txt:ah,sheet_to_json:th,sheet_to_html:bf,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var o,a=ec(e["!ref"]),i="",s=[],l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Xl(o);for(var d=a.s.r;d<=a.e.r;++d)for(i=$l(d),o=a.s.c;o<=a.e.c;++o)if(r=s[o]+i,n="",void 0!==(t=c?(e[d]||[])[o]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:th,sheet_get_cell:sh,book_new:lh,book_append_sheet:ch,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:dh,cell_set_internal_link:function(e,t,r){return dh(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var o="string"!=typeof t?t:ec(t),a="string"==typeof t?t:Zl(t),i=o.s.r;i<=o.e.r;++i)for(var s=o.s.c;s<=o.e.c;++s){var l=sh(e,i,s);l.t="n",l.F=a,delete l.v,i==o.s.r&&s==o.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};wa.version;const uh=e=>{if(!e)return"Fecha no disponible";return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},fh=e=>{var t,r;if(!e)return!1;const n=(null===(t=e.nombre_original)||void 0===t?void 0:t.split(".").pop().toLowerCase())||"",o=(null===(r=e.tipo_mime)||void 0===r?void 0:r.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg"].includes(n)||o.startsWith("image/")},hh=e=>{if(!e)return null;if(e.startsWith("http"))return e;let t="";if(t=window.location.origin,e.match(/^icono_[a-f0-9]+_\d+\.(png|jpg|jpeg|gif|svg|webp)$/i))return"".concat(t,"/img/iconos/").concat(e);if(e.includes("/api/uploads/iconos_carpetas/")||e.includes("/api/archivos/uploads/iconos_carpetas/")){const r=e.split("/").pop();return"".concat(t,"/img/iconos/").concat(r)}return e.startsWith("/img/iconos/")||e.startsWith("/")?t+e:"".concat(t,"/img/iconos/").concat(e)},gh=e=>{if(!e||"-"===e)return"-";const t=e.split("|");if(2===t.length){const e=t[0].trim(),r=t[1].trim(),n=uh(r);return"".concat(e," - ").concat(n)}return e},mh=e=>{const t=(null===e||void 0===e?void 0:e.nombre)||(null===e||void 0===e?void 0:e.email)||"Usuario",r=(new Date).toISOString().slice(0,19).replace("T"," ");return"".concat(t,"|").concat(r)},xh=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r){return{primary:r,secondary:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)||bh(r),iconBg:"rgba(255,255,255,0.25)"}}const n=[{primary:"#FF6B35",secondary:"#FF8C5A",iconBg:"rgba(255,255,255,0.25)"},{primary:"#F77F00",secondary:"#FCBF49",iconBg:"rgba(255,255,255,0.25)"},{primary:"#E63946",secondary:"#F77F00",iconBg:"rgba(255,255,255,0.25)"},{primary:"#06A77D",secondary:"#0AD3A3",iconBg:"rgba(255,255,255,0.25)"},{primary:"#118AB2",secondary:"#06D6A0",iconBg:"rgba(255,255,255,0.25)"},{primary:"#073B4C",secondary:"#118AB2",iconBg:"rgba(255,255,255,0.25)"},{primary:"#1A659E",secondary:"#4A90E2",iconBg:"rgba(255,255,255,0.25)"},{primary:"#7209B7",secondary:"#B5179E",iconBg:"rgba(255,255,255,0.25)"},{primary:"#560BAD",secondary:"#7209B7",iconBg:"rgba(255,255,255,0.25)"},{primary:"#6A4C93",secondary:"#9D4EDD",iconBg:"rgba(255,255,255,0.25)"},{primary:"#2D6A4F",secondary:"#40916C",iconBg:"rgba(255,255,255,0.25)"},{primary:"#06FFA5",secondary:"#38E4AE",iconBg:"rgba(0,0,0,0.1)"},{primary:"#52B788",secondary:"#74C69D",iconBg:"rgba(255,255,255,0.25)"},{primary:"#F2A900",secondary:"#FFC947",iconBg:"rgba(255,255,255,0.25)"},{primary:"#F77F00",secondary:"#FCBF49",iconBg:"rgba(255,255,255,0.25)"},{primary:"#C77DFF",secondary:"#E0AAFF",iconBg:"rgba(255,255,255,0.25)"},{primary:"#D90429",secondary:"#EF233C",iconBg:"rgba(255,255,255,0.25)"},{primary:"#17a2b8",secondary:"#FF8C00",iconBg:"rgba(255,255,255,0.25)"}],o=(e+t.toString()).split("").reduce((e,t)=>t.charCodeAt(0)+((e<<5)-e),0);return n[Math.abs(o)%n.length]},bh=e=>{if(!e||!e.startsWith("#"))return"#FFC947";const t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16),o=Math.min(255,Math.floor(t+.3*(255-t))),a=Math.min(255,Math.floor(r+.3*(255-r))),i=Math.min(255,Math.floor(n+.3*(255-n)));return"#".concat(o.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0")).concat(i.toString(16).padStart(2,"0")).toUpperCase()},vh=e=>{if(!e)return[];const t=e.split(/[\r\n]+|;/).map(e=>e.trim()).filter(Boolean).map(e=>e.replace(/^\-\s*/,"").replace(/^\u2022\s*/,""));return t.length?t:[e.trim()]},yh=["guia","riesgo","bowtie","diagrama","linea_base","archivos","foro","tareas"],jh=["bowtie","linea_base","archivos","foro","tareas"],_h=["archivos"],Sh=(e,t)=>!!e&&("super_admin"===e.rol||"admin"===e.rol&&2===t.length),wh=(e,t)=>!!e&&("super_admin"===e.rol||("admin"===e.rol&&2===t.length||"trabajador"===e.rol&&2===t.length)),kh=(e,t,r)=>{if(!e)return!1;if("super_admin"===e.rol)return!0;if("admin"===e.rol&&2===t.length)return!0;if("trabajador"===e.rol&&2===t.length){return["porcentaje_avance","comentario_trabajador","archivos_respaldo"].includes(r)}return!1},Ch=e=>{let{carpetaActual:t,carpetas:r,API_BASE:n}=e;const[a,i]=(0,o.useState)(70),[s,l]=(0,o.useState)({}),[c,d]=(0,o.useState)(!0),[p,u]=(0,o.useState)(""),[f,h]=(0,o.useState)(!1),[g,m]=(0,o.useState)({x:0,y:0}),[x,b]=(0,o.useState)({x:0,y:0}),v=o.useRef(null),y=o.useRef(null);(0,o.useEffect)(()=>{(async()=>{if(!t)return;d(!0);const e=r.filter(e=>e.carpeta_padre_id===t.id),o={};for(let t=0;t<e.length;t++){const r=e[t];u("Cargando ".concat(r.nombre," (").concat(t+1,"/").concat(e.length,")...")),o[r.id]={carpetasArchivos:[],registrosLineaBase:[],carpetasDocumentosLB:{}};try{const e=await fetch("".concat(n,"/archivos/archivos_carpetas.php?carpeta_id=").concat(r.id));if(e.ok){const t=await e.json();t.success&&t.carpetas?o[r.id].carpetasArchivos=t.carpetas:Array.isArray(t)&&(o[r.id].carpetasArchivos=t)}}catch(Fh){console.log("Error cargando carpetas de archivos:",Fh)}try{const e=await fetch("".concat(n,"/archivos/carpeta_linea_base.php?carpeta_id=").concat(r.id));if(e.ok){const t=await e.json();if(t.success&&t.linea_base){o[r.id].registrosLineaBase=t.linea_base;for(const e of t.linea_base)try{const t=await fetch("".concat(n,"/archivos/linea_base_carpetas.php?linea_base_id=").concat(e.id));if(t.ok){const n=await t.json();n.success&&n.carpetas&&(o[r.id].carpetasDocumentosLB[e.id]=n.carpetas)}}catch(Fh){console.log("Error cargando carpetas de documentos LB:",Fh)}}}}catch(Fh){console.log("Error cargando l\xednea base:",Fh)}}l(o),d(!1),u("")})()},[t,r,n]),(0,o.useEffect)(()=>{if(!c&&"undefined"!==typeof window&&window.mermaid){const e=setTimeout(()=>{try{const e=document.querySelectorAll("#mermaid-diagram");e.forEach(e=>{e.removeAttribute("data-processed")}),window.mermaid.run({nodes:e,suppressErrors:!0})}catch(Fh){console.log("Mermaid render:",Fh)}},300);return()=>clearTimeout(e)}},[c,s,t]);const j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;if(!e)return"";const r=e.replace(/["\n\r<>{}[\]|]/g," ").replace(/\s+/g," ").trim();return r.length>t?r.substring(0,t-3)+"...":r},_=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t)return"graph TD\n  A[Sin datos]";let n="graph TD\n";const o="C".concat(t.id),a=t.evento_no_deseado||"Evento No Deseado",i=t.evento_riesgo||"",l=e?999:3,c=e?999:4,d=e?999:2;n+="  ".concat(o,'["\ud83c\udfaf ').concat(j(t.nombre,60),'"]\n'),n+="  style ".concat(o," fill:#dc3545,stroke:#a71d2a,color:#fff,stroke-width:3px\n");const p="END";if(n+="  ".concat(p,'["\u26a0\ufe0f ').concat(j(a,80),'"]\n'),n+="  style ".concat(p," fill:#ffc107,stroke:#e0a800,color:#000,stroke-width:2px\n"),n+="  ".concat(o," --\x3e ").concat(p,"\n"),i){const e="ER";n+="  ".concat(e,'["\ud83d\udd25 ').concat(j(i,80),'"]\n'),n+="  style ".concat(e," fill:#fd7e14,stroke:#dc6000,color:#fff,stroke-width:2px\n"),n+="  ".concat(p," --\x3e ").concat(e,"\n")}if(t.controles_supervisor)try{const e="string"===typeof t.controles_supervisor?JSON.parse(t.controles_supervisor):t.controles_supervisor;e.preventivos&&e.preventivos.length>0&&(n+='  SUP_PREV["\ud83d\udc77 Ctrl. Preventivos Supervisor: '.concat(e.preventivos.length,'"]\n'),n+="  style SUP_PREV fill:#28a745,stroke:#1e7e34,color:#fff\n",n+="  ".concat(o," --\x3e SUP_PREV\n")),e.mitigadores&&e.mitigadores.length>0&&(n+='  SUP_MIT["\ud83d\udc77 Ctrl. Mitigadores Supervisor: '.concat(e.mitigadores.length,'"]\n'),n+="  style SUP_MIT fill:#17a2b8,stroke:#117a8b,color:#fff\n",n+="  ".concat(p," --\x3e SUP_MIT\n"))}catch(Fh){}if(t.controles_trabajador)try{const e="string"===typeof t.controles_trabajador?JSON.parse(t.controles_trabajador):t.controles_trabajador;e.preventivos&&e.preventivos.length>0&&(n+='  TRAB_PREV["\ud83d\udc64 Ctrl. Preventivos Trabajador: '.concat(e.preventivos.length,'"]\n'),n+="  style TRAB_PREV fill:#20c997,stroke:#17a085,color:#fff\n",n+="  ".concat(o," --\x3e TRAB_PREV\n")),e.mitigadores&&e.mitigadores.length>0&&(n+='  TRAB_MIT["\ud83d\udc64 Ctrl. Mitigadores Trabajador: '.concat(e.mitigadores.length,'"]\n'),n+="  style TRAB_MIT fill:#6f42c1,stroke:#563d7c,color:#fff\n",n+="  ".concat(p," --\x3e TRAB_MIT\n"))}catch(Fh){}const u=r.filter(e=>e.carpeta_padre_id===t.id);return u.length>0&&(n+='  EMPRESAS["\ud83d\udcc1 Empresas / Subcarpetas: '.concat(u.length,'"]\n'),n+="  style EMPRESAS fill:#6c757d,stroke:#495057,color:#fff\n",n+="  ".concat(o," --\x3e EMPRESAS\n"),u.forEach((t,r)=>{const o="EMP".concat(r);n+="  ".concat(o,'["\ud83d\udcc2 ').concat(j(t.nombre,50),'"]\n'),n+="  style ".concat(o," fill:#495057,stroke:#343a40,color:#fff\n"),n+="  EMPRESAS --\x3e ".concat(o,"\n");const a=s[t.id];if(a&&a.carpetasArchivos&&a.carpetasArchivos.length>0){const t="ARCH".concat(r);n+="  ".concat(t,'["\ud83d\udcc1 Archivos: ').concat(a.carpetasArchivos.length,' carpetas"]\n'),n+="  style ".concat(t," fill:#fd7e14,stroke:#dc6000,color:#fff\n"),n+="  ".concat(o," --\x3e ").concat(t,"\n"),a.carpetasArchivos.slice(0,l).forEach((e,o)=>{const a="CARCH".concat(r,"_").concat(o);n+="  ".concat(a,'["\ud83d\udcc2 ').concat(j(e.nombre,40),'"]\n'),n+="  style ".concat(a," fill:#fff3e0,stroke:#ffcc80,color:#e65100\n"),n+="  ".concat(t," --\x3e ").concat(a,"\n")}),!e&&a.carpetasArchivos.length>l&&(n+="  ARCHMAS".concat(r,'["... +').concat(a.carpetasArchivos.length-l,'"]\n'),n+="  style ARCHMAS".concat(r," fill:#f8f9fa,stroke:#dee2e6,color:#666\n"),n+="  ".concat(t," --\x3e ARCHMAS").concat(r,"\n"))}if(a&&a.registrosLineaBase&&a.registrosLineaBase.length>0){const t="LB".concat(r);n+="  ".concat(t,'["\ud83d\udccb L\xednea Base: ').concat(a.registrosLineaBase.length,' controles"]\n'),n+="  style ".concat(t," fill:#e83e8c,stroke:#d63384,color:#fff\n"),n+="  ".concat(o," --\x3e ").concat(t,"\n"),a.registrosLineaBase.slice(0,c).forEach((o,i)=>{const s="REG".concat(r,"_").concat(i),l=o.codigo||"Ctrl ".concat(i+1);n+="  ".concat(s,'["\ud83d\udcdd ').concat(j(l,40),'"]\n'),n+="  style ".concat(s," fill:#fce4ec,stroke:#f48fb1,color:#880e4f\n"),n+="  ".concat(t," --\x3e ").concat(s,"\n");const c=a.carpetasDocumentosLB[o.id];if(c&&c.length>0){const t="DOC".concat(r,"_").concat(i);n+="  ".concat(t,'["\ud83d\udcc1 Docs: ').concat(c.length,'"]\n'),n+="  style ".concat(t," fill:#007bff,stroke:#0056b3,color:#fff\n"),n+="  ".concat(s," --\x3e ").concat(t,"\n"),c.slice(0,d).forEach((e,o)=>{const a="CDOC".concat(r,"_").concat(i,"_").concat(o);n+="  ".concat(a,'["\ud83d\udcc4 ').concat(j(e.nombre,40),'"]\n'),n+="  style ".concat(a," fill:#e7f1ff,stroke:#b6d4fe,color:#0d6efd\n"),n+="  ".concat(t," --\x3e ").concat(a,"\n")}),!e&&c.length>d&&(n+="  CDOCMAS".concat(r,"_").concat(i,'["... +').concat(c.length-d,'"]\n'),n+="  style CDOCMAS".concat(r,"_").concat(i," fill:#f8f9fa,stroke:#dee2e6,color:#666\n"),n+="  ".concat(t," --\x3e CDOCMAS").concat(r,"_").concat(i,"\n"))}}),!e&&a.registrosLineaBase.length>c&&(n+="  REGMAS".concat(r,'["... +').concat(a.registrosLineaBase.length-c,' controles"]\n'),n+="  style REGMAS".concat(r," fill:#f8f9fa,stroke:#dee2e6,color:#666\n"),n+="  ".concat(t," --\x3e REGMAS").concat(r,"\n"))}})),n}(!1);return(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",color:"white"},children:[(0,ze.jsxs)("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-sitemap"}),"Diagrama de Estructura - ",(null===t||void 0===t?void 0:t.nombre)||"Riesgo Cr\xedtico"]}),(0,ze.jsx)("p",{style:{margin:"0.5rem 0 0 0",opacity:.9,fontSize:"14px"},children:"Visualizaci\xf3n jer\xe1rquica completa incluyendo carpetas de documentos de L\xednea Base"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"0.75rem",marginBottom:"1rem",padding:"0.75rem 1rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("span",{style:{fontWeight:"600",color:"#495057",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-search-plus",style:{marginRight:"8px"}}),"Zoom:"]}),(0,ze.jsx)("button",{onClick:()=>i(Math.max(25,a-10)),style:{width:"32px",height:"32px",border:"1px solid #dee2e6",borderRadius:"6px",background:"white",cursor:"pointer",fontSize:"16px",fontWeight:"bold",color:"#495057"},title:"Alejar (-10%)",children:"\u2212"}),(0,ze.jsx)("input",{type:"range",min:"25",max:"200",value:a,onChange:e=>i(parseInt(e.target.value)),style:{width:"120px",cursor:"pointer",accentColor:"#667eea"}}),(0,ze.jsx)("button",{onClick:()=>i(Math.min(200,a+10)),style:{width:"32px",height:"32px",border:"1px solid #dee2e6",borderRadius:"6px",background:"white",cursor:"pointer",fontSize:"16px",fontWeight:"bold",color:"#495057"},title:"Acercar (+10%)",children:"+"}),(0,ze.jsxs)("span",{style:{minWidth:"45px",textAlign:"center",fontWeight:"600",color:"#667eea",fontSize:"14px"},children:[a,"%"]}),(0,ze.jsx)("div",{style:{borderLeft:"1px solid #dee2e6",height:"24px",margin:"0 4px"}}),[30,50,70,100,150].map(e=>(0,ze.jsxs)("button",{onClick:()=>i(e),style:{padding:"6px 10px",border:"1px solid #dee2e6",borderRadius:"4px",background:a===e?"#667eea":"white",color:a===e?"white":"#495057",cursor:"pointer",fontSize:"12px",fontWeight:a===e?"600":"400"},children:[e,"%"]},e)),(0,ze.jsx)("div",{style:{borderLeft:"1px solid #dee2e6",height:"24px",margin:"0 4px"}}),(0,ze.jsxs)("button",{onClick:()=>{m({x:0,y:0})},style:{padding:"6px 12px",border:"1px solid #dee2e6",borderRadius:"6px",background:"white",cursor:"pointer",fontSize:"12px",color:"#495057"},title:"Centrar diagrama",children:[(0,ze.jsx)("i",{className:"fa fa-crosshairs",style:{marginRight:"6px"}}),"Centrar"]}),(0,ze.jsxs)("button",{onClick:()=>{i(70),m({x:0,y:0})},style:{padding:"6px 12px",border:"1px solid #17a2b8",borderRadius:"6px",background:"#17a2b8",cursor:"pointer",fontSize:"12px",color:"white"},title:"Resetear vista (70% + centrado)",children:[(0,ze.jsx)("i",{className:"fa fa-undo",style:{marginRight:"6px"}}),"Resetear"]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",marginBottom:"0.75rem",padding:"0.5rem 1rem",background:"#e7f3ff",borderRadius:"6px",fontSize:"12px",color:"#0d6efd"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-arrows",style:{marginRight:"6px"}})," ",(0,ze.jsx)("strong",{children:"Navegar:"})," Scroll horizontal y vertical"]}),(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-search-plus",style:{marginRight:"6px"}})," ",(0,ze.jsx)("strong",{children:"Zoom:"})," Usa los controles de arriba o Ctrl + Scroll"]})]}),(0,ze.jsxs)("div",{ref:v,onWheel:e=>{if(e.ctrlKey||e.metaKey){e.preventDefault();const t=e.deltaY>0?-10:10;i(e=>Math.min(200,Math.max(25,e+t)))}},onMouseDown:e=>{0===e.button&&(h(!0),b({x:e.clientX-g.x,y:e.clientY-g.y}),e.currentTarget.style.cursor="grabbing")},onMouseMove:e=>{f&&m({x:e.clientX-x.x,y:e.clientY-x.y})},onMouseUp:e=>{h(!1),e.currentTarget&&(e.currentTarget.style.cursor="grab")},onMouseLeave:()=>{h(!1)},style:{background:"#fafafa",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",overflow:"auto",height:"65vh",cursor:f?"grabbing":"grab",position:"relative",border:"2px solid #e9ecef"},children:[c?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",color:"#667eea"}}),(0,ze.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Cargando estructura completa..."}),p&&(0,ze.jsx)("p",{style:{marginTop:"0.5rem",color:"#999",fontSize:"13px"},children:p})]}):(0,ze.jsx)("div",{ref:y,style:{transform:"scale(".concat(a/100,")"),transformOrigin:"top left",transition:"transform 0.2s ease-out",padding:"2rem",minWidth:"fit-content"},children:(0,ze.jsx)("div",{id:"mermaid-diagram",className:"mermaid",style:{background:"white",padding:"1rem",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:_})}),(0,ze.jsxs)("div",{style:{position:"fixed",bottom:"80px",right:"30px",background:"rgba(102, 126, 234, 0.95)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"13px",fontWeight:"600",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",zIndex:1e3},children:[(0,ze.jsx)("i",{className:"fa fa-search",style:{marginRight:"6px"}}),a,"%"]})]}),(0,ze.jsxs)("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("h5",{style:{margin:"0 0 1rem 0",color:"#333",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"8px",color:"#17a2b8"}}),"Leyenda del Diagrama"]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.5rem",fontSize:"12px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#dc3545",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Riesgo Cr\xedtico (Nivel 1)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#ffc107",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Evento No Deseado"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#28a745",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Ctrl. Preventivo Supervisor"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#20c997",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Ctrl. Preventivo Trabajador"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#17a2b8",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Ctrl. Mitigador Supervisor"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#6f42c1",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Ctrl. Mitigador Trabajador"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#495057",display:"inline-block"}}),(0,ze.jsx)("span",{children:"Empresa (Nivel 2)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#fd7e14",display:"inline-block"}}),(0,ze.jsx)("span",{children:"\ud83d\udcc1 Carpetas Archivos (Pesta\xf1a Archivos)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#e83e8c",display:"inline-block"}}),(0,ze.jsx)("span",{children:"\ud83d\udccb L\xednea Base (Controles)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"3px",background:"#007bff",display:"inline-block"}}),(0,ze.jsx)("span",{children:"\ud83d\udcc1 Carpetas Docs LB (Pesta\xf1a Documentos)"})]})]})]})]})},Eh=e=>{var t,r,n,a,i;let{proyectoId:s,centroCostoId:l,carpetaId:c,user:d,sidebarCollapsed:p}=e;(0,o.useEffect)(()=>{d&&(console.log("\ud83d\udd0d [DEBUG] Usuario actual:",d),console.log("\ud83d\udd0d [DEBUG] Rol del usuario:",d.rol),console.log("\ud83d\udd0d [DEBUG] canEditFiles:",ja(d)),console.log("\ud83d\udd0d [DEBUG] canDeleteFiles:",_a(d)),console.log("\ud83d\udd0d [DEBUG] canCreateFolders:",va(d)))},[d]);const[u,f]=(0,o.useState)([]),[h,g]=(0,o.useState)(null),[m,x]=(0,o.useState)({}),[b,v]=(0,o.useState)(null),[y,j]=(0,o.useState)([]),[_,S]=(0,o.useState)([]),[w,k]=(0,o.useState)(!0),[C,E]=(0,o.useState)(!1),[T,R]=(0,o.useState)(null),[N,A]=(0,o.useState)(""),[z,I]=(0,o.useState)([]),[O,P]=(0,o.useState)(null),[D,L]=(0,o.useState)(null),[B,F]=(0,o.useState)(!1),[M,W]=(0,o.useState)([]),[U,H]=(0,o.useState)(null),[V,G]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=e=>{U&&("ArrowLeft"===e.key?(e.preventDefault(),H(e=>{if(!e)return null;let t=e.indiceActual-1;return t<0&&(t=e.imagenes.length-1),Ue(Ue({},e),{},{indiceActual:t})})):"ArrowRight"===e.key?(e.preventDefault(),H(e=>{if(!e)return null;let t=e.indiceActual+1;return t>=e.imagenes.length&&(t=0),Ue(Ue({},e),{},{indiceActual:t})})):"Escape"===e.key&&H(null))};if(U)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[U]);const[Y,$]=(0,o.useState)(!1),[q,X]=(0,o.useState)(null),[K,J]=(0,o.useState)(!1),[Q,Z]=(0,o.useState)(null),[ee,te]=(0,o.useState)([]),[re,ne]=(0,o.useState)("lista"),[oe,ae]=(0,o.useState)([]),[ie,se]=(0,o.useState)(null),[le,ce]=(0,o.useState)([]),[de,pe]=(0,o.useState)(!1),[ue,fe]=(0,o.useState)(null),[he,ge]=(0,o.useState)(""),[me,xe]=(0,o.useState)(""),[be,ve]=(0,o.useState)("#17a2b8"),[ye,je]=(0,o.useState)(null),[_e,Se]=(0,o.useState)(!1),[we,ke]=(0,o.useState)(""),[Ce,Ee]=(0,o.useState)(null);(0,o.useEffect)(()=>{const e=()=>{null!==Ce&&Ee(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[Ce]);const[Re,Ie]=(0,o.useState)("guia"),[Oe,Pe]=(0,o.useState)(null),[De,Le]=(0,o.useState)(!1),[Be,Fe]=(0,o.useState)(null),[Me,We]=(0,o.useState)(!1),[He,Ve]=(0,o.useState)(!0),[Ge,Ye]=(0,o.useState)(!0),[$e,qe]=(0,o.useState)(!1),[Xe,Ke]=(0,o.useState)(!1),[Je,Qe]=(0,o.useState)(!1),[Ze,et]=(0,o.useState)(!1),[tt,rt]=(0,o.useState)(!1),[nt,ot]=(0,o.useState)(!1),[at,it]=(0,o.useState)(!1),[st,lt]=(0,o.useState)(new Set),[ct,dt]=(0,o.useState)(new Set),[pt,ut]=(0,o.useState)(new Set),[ft,ht]=(0,o.useState)(new Set),[gt,mt]=(0,o.useState)(new Set),[xt,bt]=(0,o.useState)(new Set),[vt,yt]=(0,o.useState)({causas:!1,consecuencias:!1,controles_preventivos_criticos:!1,controles_preventivos_generales:!1,controles_mitigadores_criticos:!1,controles_mitigadores_generales:!1}),[jt,_t]=(0,o.useState)([]),[St,wt]=(0,o.useState)(!1),[kt,Ct]=(0,o.useState)(!1),[Et,Tt]=(0,o.useState)(new Set),[Rt,Nt]=(0,o.useState)(null),[At,zt]=(0,o.useState)({}),[It,Ot]=(0,o.useState)(null),[Pt,Dt]=(0,o.useState)("informacion"),[Lt,Bt]=(0,o.useState)([]),[Ft,Mt]=(0,o.useState)([]),[Wt,Ut]=(0,o.useState)(null),[Ht,Vt]=(0,o.useState)([]),[Gt,Yt]=(0,o.useState)(!1),[$t,qt]=(0,o.useState)(!1),[Xt,Kt]=(0,o.useState)(!1),[Jt,Qt]=(0,o.useState)(""),[Zt,er]=(0,o.useState)(null),[tr,rr]=(0,o.useState)(""),[nr,or]=(0,o.useState)(null),[ar,ir]=(0,o.useState)(""),[sr,lr]=(0,o.useState)([]),[cr,dr]=(0,o.useState)(!1),[pr,ur]=(0,o.useState)(!1),[fr,hr]=(0,o.useState)(new Set),[gr,mr]=(0,o.useState)(null),[xr,br]=(0,o.useState)(null),[vr,yr]=(0,o.useState)(null),[jr,_r]=(0,o.useState)("TODAS"),[Sr,wr]=(0,o.useState)({evento_no_deseado:!1,evento_riesgo:!1,supervisor_preventivo:!1,supervisor_mitigador:!1,trabajador_preventivo:!1,trabajador_mitigador:!1,informacion_riesgo:!1}),[kr,Cr]=(0,o.useState)([]),[Er,Tr]=(0,o.useState)(""),[Rr,Nr]=(0,o.useState)(null),[Ar,zr]=(0,o.useState)(""),[Ir,Or]=(0,o.useState)({}),[Pr,Dr]=(0,o.useState)([]),[Lr,Br]=(0,o.useState)(!1),[Fr,Mr]=(0,o.useState)({titulo:"",descripcion:"",asignados_a:[],fecha_vencimiento:"",prioridad:"media",recordatorio_en:""}),[Wr,Ur]=(0,o.useState)({}),[Hr,Vr]=(0,o.useState)({}),[Gr,Yr]=(0,o.useState)(null),[$r,qr]=(0,o.useState)({}),[Xr,Kr]=(0,o.useState)({}),[Jr,Qr]=(0,o.useState)(null),[Zr,en]=(0,o.useState)(!1),[tn,rn]=(0,o.useState)([]),[nn,on]=(0,o.useState)(!1),[an,sn]=(0,o.useState)(null),[ln,cn]=(0,o.useState)([]),dn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const n=Date.now()+Math.random(),o={id:n,mensaje:e,tipo:t,duracion:r};return cn(e=>[...e,o]),setTimeout(()=>{cn(e=>e.filter(e=>e.id!==n))},r),n};(0,o.useEffect)(()=>{if(D){const e=D.nombre_original.split(".").pop().toLowerCase(),t=D.tipo_mime||"";if("pdf"===e||t.includes("pdf")){let e;e="".concat(Te,"/view_pdf.php?id=").concat(D.id),X(e),console.log("Cargando PDF desde:",e),pn(e)}else X(null),W([]),$(!1),F(!1)}else J(!1),X(null)},[null===D||void 0===D?void 0:D.id,K]);const pn=e=>{if(!window.pdfjsLib)return F("PDF.js no est\xe1 cargado. Recarga la p\xe1gina."),void $(!1);$(!0),F(null),W([]),window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";window.pdfjsLib.getDocument({url:e,withCredentials:!1}).promise.then(e=>{const t=e.numPages,r=[];for(let n=1;n<=t;n++)r.push(e.getPage(n).then(e=>{const t=K?2:1.5,r=e.getViewport({scale:t}),o=document.createElement("canvas"),a=o.getContext("2d");o.height=r.height,o.width=r.width;const i={canvasContext:a,viewport:r};return e.render(i).promise.then(()=>({pageNum:n,width:o.width,height:o.height,canvasData:o}))}));return Promise.all(r)}).then(e=>{W(e),$(!1)}).catch(t=>{console.error("Error cargando PDF:",t),console.error("URL intentada:",e);let r="Error al cargar el PDF";t.message&&(r+=": "+t.message),t.details&&(r+=" ("+t.details+")"),F(r),$(!1)})},[un,fn]=(0,o.useState)([]),[hn,gn]=(0,o.useState)([]),[mn,xn]=(0,o.useState)({nombre:"",descripcion:"",color_primario:"",color_secundario:"",icono_url:""}),[bn,vn]=(0,o.useState)(null),[yn,jn]=(0,o.useState)([]),[_n,Sn]=(0,o.useState)(null),wn=yn.length>=3,kn=yn.length>=2&&!wn,Cn=wn?_h:kn?jh:yh,En=e=>{Fe(e),lt(new Set),dt(new Set),ut(new Set),ht(new Set),mt(new Set),bt(new Set)};(0,o.useEffect)(()=>{if(!h)return;if(wn)return void("archivos"!==Re&&Ie("archivos"));(kn?jh:yh).includes(Re)||Ie(kn?"bowtie":"guia")},[h,kn,wn,Re]),(0,o.useEffect)(()=>{so(),fo()},[s,l,h]),(0,o.useEffect)(()=>{const e=sessionStorage.getItem("navegarACarpeta");e&&(sessionStorage.removeItem("navegarACarpeta"),fetch("".concat(Te,"/archivos/carpetas.php?id=").concat(e).concat(d&&d.id?"&usuario_id=".concat(d.id):"")).then(e=>e.ok?e.json():null).then(e=>{if(e&&!e.error){const t=Array.isArray(e)?e[0]:e;if(t&&t.id){g(t);(async e=>{const t=[e];let r=e.carpeta_padre_id;for(;r;)try{const e=await fetch("".concat(Te,"/archivos/carpetas.php?id=").concat(r).concat(d&&d.id?"&usuario_id=".concat(d.id):""));if(!e.ok)break;{const n=await e.json(),o=Array.isArray(n)?n[0]:n;if(!o||!o.id)break;t.unshift(o),r=o.carpeta_padre_id}}catch(n){break}jn(t)})(t)}}}).catch(console.error))},[s,null===d||void 0===d?void 0:d.id]),(0,o.useEffect)(()=>{(async()=>{if(h&&h.id&&2===yn.length)try{const e=await fetch("".concat(Te,"/archivos/promedio_ponderacion.php?carpeta_id=").concat(h.id)),t=await e.json();t.success?v(t.promedio_general):v(null)}catch(e){console.error("Error cargando promedio de ponderaci\xf3n:",e),v(null)}else v(null)})()},[h,yn.length]),(0,o.useEffect)(()=>{(async()=>{if(h&&h.id&&2===yn.length)try{const e=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php?carpeta_id=").concat(h.id));if(e.ok){const t=await e.json();j(Array.isArray(t)?t:[])}else j([])}catch(e){console.error("Error cargando usuarios participantes:",e),j([])}else j([])})()},[h,yn.length]),(0,o.useEffect)(()=>{if("diagrama"===Re&&h&&"undefined"!==typeof window&&window.mermaid){const e=setTimeout(()=>{try{window.mermaid.run({querySelector:".mermaid"})}catch(Fh){console.log("Mermaid render:",Fh)}},100);return()=>clearTimeout(e)}},[Re,h]),(0,o.useEffect)(()=>{if(c&&d&&d.id){if(h&&h.id===parseInt(c))return;fetch("".concat(Te,"/archivos/carpetas.php?id=").concat(c).concat(d&&d.id?"&usuario_id=".concat(d.id):"")).then(e=>{if(!e.ok){if(403===e.status||404===e.status)return e.json().then(e=>{const t=e.error||"No tienes permiso para acceder a esta carpeta. Debe ser asignado por el super administrador.";return dn(t,"error"),null}).catch(()=>(dn("No tienes permiso para acceder a esta carpeta. Debe ser asignado por el super administrador.","error"),null));throw new Error("Error HTTP ".concat(e.status))}return e.json()}).then(e=>{if(!e||e.error){const t=(null===e||void 0===e?void 0:e.error)||"No tienes permiso para acceder a esta carpeta. Debe ser asignado por el super administrador.";return void dn(t,"error")}const t=Array.isArray(e)?e[0]:e;if(t&&t.id){const e=async e=>{const t=[e];let r=e.carpeta_padre_id;for(;r;)try{const e=await fetch("".concat(Te,"/archivos/carpetas.php?id=").concat(r).concat(d&&d.id?"&usuario_id=".concat(d.id):""));if(!e.ok){if(403===e.status){console.warn("No tiene acceso a la carpeta padre:",r);break}break}{const n=await e.json(),o=Array.isArray(n)?n[0]:n;if(!o||!o.id)break;t.unshift(o),r=o.carpeta_padre_id}}catch(n){console.error("Error cargando carpeta padre:",n);break}jn(t)};g(t),e(t)}else"trabajador"===d.rol&&alert("No tienes permiso para acceder a esta carpeta")}).catch(e=>{console.error("Error cargando carpeta:",e),d&&"trabajador"===d.rol&&alert("No tienes permiso para acceder a esta carpeta")})}else!c&&h&&(g(null),jn([]))},[c,null===d||void 0===d?void 0:d.id,null===d||void 0===d?void 0:d.rol,s]),(0,o.useEffect)(()=>{if(h){const e=sessionStorage.getItem("tareaIdToOpen"),t=sessionStorage.getItem("mensajeIdToOpen"),r=sessionStorage.getItem("abrirForoCarpeta"),n=sessionStorage.getItem("mostrarForo"),o=sessionStorage.getItem("lineaBaseId");e?(Ie("tareas"),sessionStorage.removeItem("tareaIdToOpen")):o?(Ie("linea_base"),Ot(parseInt(o)),G(!0),sessionStorage.removeItem("lineaBaseId"),sessionStorage.removeItem("mostrarForo"),sessionStorage.removeItem("mensajeIdToOpen")):t||n?(Ie("foro"),G(!0),sessionStorage.removeItem("mensajeIdToOpen"),sessionStorage.removeItem("mostrarForo")):r&&parseInt(r)===h.id?(Ie("foro"),G(!0),sessionStorage.removeItem("abrirForoCarpeta")):V||Ie("guia"),Pe(null),Fe(null),_t([]),lr([]),se(null),ce([]),ae([]),lo(h.id,"root"),co(h.id,null),ho(h.id),An(h.id),zn(h.id),In(h.id),On(h.id).then(()=>{setTimeout(()=>{Mn(h.id),Kn(h.id)},500)}),wr({evento_no_deseado:!1,evento_riesgo:!1,supervisor_preventivo:!1,supervisor_mitigador:!1,trabajador_preventivo:!1,trabajador_mitigador:!1,informacion_riesgo:!1}),Ur({}),Vr({}),Yr(null),qr({}),Or({})}else S([]),gn([]),Cr([]),Dr([]),Ur({}),Vr({}),Yr(null),qr({}),Or({})},[h]);(0,o.useMemo)(()=>{if(!Be||!Be.controles_preventivos)return null;const e=Be.controles_preventivos.map(e=>e.id||e.codigo||"").filter(Boolean);return"".concat(e.length,"-").concat(e.join(","))},[null===Be||void 0===Be?void 0:Be.controles_preventivos]);const Tn=(0,o.useMemo)(()=>{if(!Be||!Be.controles_mitigadores)return null;const e=Be.controles_mitigadores.map(e=>e.id||e.codigo||"").filter(Boolean);return"".concat(e.length,"-").concat(e.join(","))},[null===Be||void 0===Be?void 0:Be.controles_mitigadores]);(0,o.useEffect)(()=>{h&&h.id&&(Be&&Be.controles_mitigadores&&Be.controles_mitigadores.length,Kn(h.id))},[Tn,null===h||void 0===h?void 0:h.id]),(0,o.useEffect)(()=>{const e=sessionStorage.getItem("mensajeIdToOpen");if(e&&kr.length>0&&h){const t=parseInt(e);setTimeout(()=>{const e=document.getElementById("mensaje-".concat(t));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.transition="box-shadow 0.3s ease",e.style.boxShadow="0 0 20px rgba(23, 162, 184, 0.5)",setTimeout(()=>{e.style.boxShadow=""},2e3))},500),sessionStorage.removeItem("mensajeIdToOpen")}},[kr,h]),(0,o.useEffect)(()=>{const e=sessionStorage.getItem("tareaIdToOpen");if(e&&Pr.length>0&&h){const t=parseInt(e);Pr.find(e=>e.id===t)&&(Yr(t),Rn(t),setTimeout(()=>{const e=document.getElementById("tarea-".concat(t));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.transition="box-shadow 0.3s ease",e.style.boxShadow="0 0 20px rgba(10, 110, 189, 0.5)",setTimeout(()=>{e.style.boxShadow=""},2e3))},500)),sessionStorage.removeItem("tareaIdToOpen")}},[Pr,h]),(0,o.useEffect)(()=>{if(It&&jt.length>0&&h){const e=jt.findIndex(e=>parseInt(e.id)===parseInt(It));if(e>=0){const t=jt[e];setTimeout(()=>{Nt({item:t,index:e,tipo:"preventivo"}),Dt("foro"),Ie("linea_base")},500),Ot(null)}else{const e=sr.findIndex(e=>parseInt(e.id)===parseInt(It));if(e>=0){const t=sr[e];setTimeout(()=>{Nt({item:t,index:e,tipo:"mitigador"}),Dt("foro"),Ie("linea_base")},500),Ot(null)}else console.warn("No se encontr\xf3 el item de l\xednea base con ID:",It),Ot(null)}}},[jt,sr,It,h]),(0,o.useEffect)(()=>{if(Gr&&Pr.length>0){const e=Pr.find(e=>e.id===Gr);e&&e.comentarios&&Ur(t=>Ue(Ue({},t),{},{[Gr]:e.comentarios})),Rn(Gr)}},[Gr,Pr]);const Rn=async e=>{try{const t=await fetch("".concat(Te,"/archivos/carpeta_tarea_adjuntos.php?tarea_id=").concat(e));if(!t.ok)return console.error("Error cargando adjuntos:",t.status),void qr(t=>Ue(Ue({},t),{},{[e]:[]}));const r=await t.json();qr(t=>Ue(Ue({},t),{},{[e]:Array.isArray(r)?r:[]}))}catch(t){console.error("Error cargando adjuntos:",t),qr(t=>Ue(Ue({},t),{},{[e]:[]}))}},Nn=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const n=await fetch("".concat(Te,"/archivos/carpeta_tareas.php"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,estado_validacion:t,usuario_validador_id:d.id,motivo_rechazo:r})}),o=n.headers.get("content-type");let a;if(o&&o.includes("application/json"))a=await n.json();else{const e=await n.text();try{a=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!n.ok)throw new Error(a.error||"Error HTTP ".concat(n.status));a.success?(zn(h.id),"validada"===t?alert("Tarea validada correctamente"):alert('Tarea rechazada. Se ha vuelto a estado "En Progreso"')):a.error?alert("Error al validar tarea: "+a.error):alert("Error al validar tarea: Respuesta inesperada del servidor")}catch(n){console.error("Error validando tarea:",n),alert("Error al validar tarea: "+(n.message||"Error de conexi\xf3n"))}},An=async e=>{try{const t=await fetch("".concat(Te,"/archivos/carpeta_mensajes.php?carpeta_id=").concat(e).concat(d&&d.id?"&usuario_id=".concat(d.id):""));if(!t.ok){const e=await t.json().catch(()=>({error:"Error HTTP ".concat(t.status)}));return console.error("Error cargando mensajes del foro:",e.error||"HTTP ".concat(t.status)),void Cr([])}const r=await t.json();Cr(Array.isArray(r)?r:[])}catch(t){console.error("Error cargando mensajes del foro:",t),Cr([])}},zn=async e=>{try{const t=await fetch("".concat(Te,"/archivos/carpeta_tareas.php?carpeta_id=").concat(e).concat(d&&d.id?"&usuario_id=".concat(d.id):""));if(!t.ok){const e=await t.json().catch(()=>({error:"Error HTTP ".concat(t.status)}));return console.error("Error cargando tareas:",e.error||"HTTP ".concat(t.status)),void Dr([])}const r=await t.json();Dr(Array.isArray(r)?r:[])}catch(t){console.error("Error cargando tareas:",t),Dr([])}},In=async e=>{if(e)try{const t=await fetch("".concat(Te,"/archivos/carpetas.php?id=").concat(e));if(!t.ok)throw new Error("Error HTTP ".concat(t.status));const r=await t.json();if(r&&r.error)return void Pe(null);let n;if(n=!r||r.error||Array.isArray(r)?r&&!r.error&&Array.isArray(r)&&r.length>0?r[0]:{}:r,n.id&&parseInt(n.id)!==parseInt(e))return console.warn("ID de carpeta no coincide:",n.id,"vs",e),void Pe(null);let o={preventivos:[],mitigadores:[]},a={preventivos:[],mitigadores:[]};try{n.controles_supervisor&&(o="string"===typeof n.controles_supervisor?JSON.parse(n.controles_supervisor):n.controles_supervisor)}catch(Fh){console.error("Error parseando controles_supervisor:",Fh)}try{n.controles_trabajador&&(a="string"===typeof n.controles_trabajador?JSON.parse(n.controles_trabajador):n.controles_trabajador)}catch(Fh){console.error("Error parseando controles_trabajador:",Fh)}Pe({evento_no_deseado:n.evento_no_deseado||"",evento_riesgo:n.evento_riesgo||"",controles_supervisor:o,controles_trabajador:a,informacion_riesgo:n.informacion_riesgo||""})}catch(t){console.error("Error cargando informaci\xf3n de riesgo:",t),Pe({evento_no_deseado:"",evento_riesgo:"",controles_supervisor:{preventivos:[],mitigadores:[]},controles_trabajador:{preventivos:[],mitigadores:[]},informacion_riesgo:""})}else Pe(null)},On=async e=>{if(e){We(!0);try{const r=new URLSearchParams({carpeta_id:e});d&&d.id&&r.append("usuario_id",d.id);const n=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?").concat(r));if(!n.ok){if(404===n.status)return console.log("No hay an\xe1lisis Bowtie para esta carpeta, creando estructura vac\xeda"),Fe({evento_central:"",peligro:"",energia:"",evento_top:"",causas:[],consecuencias:[],controles_preventivos:[],controles_preventivos_generales:[],controles_mitigadores:[],controles_mitigadores_generales:[]}),void We(!1);throw new Error("Error HTTP ".concat(n.status))}const o=await n.json();if(o&&o.error)return console.error("Error en respuesta del servidor:",o.error),void(Be||Fe({evento_central:"",peligro:"",energia:"",evento_top:"",causas:[],consecuencias:[],controles_preventivos:[],controles_preventivos_generales:[],controles_mitigadores:[],controles_mitigadores_generales:[]}));const a={evento_central:"",peligro:"",energia:"",evento_top:"",causas:[],consecuencias:[],controles_preventivos:[],controles_preventivos_generales:[],controles_mitigadores:[],controles_mitigadores_generales:[]};if(o.bowtie_id){const e=(o.controles_preventivos||[]).map((e,t)=>Ue(Ue({},e),{},{codigo:e.codigo||"CCP".concat(t+1),descripcion:e.descripcion||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||"",causas_asociadas:(e.causas_asociadas||[]).map((e,t)=>({codigo:e.codigo||"CA".concat(e.id||t+1),id:e.id})),dimensiones:e.dimensiones||[]})),t=(o.controles_mitigadores||[]).map((e,t)=>Ue(Ue({},e),{},{codigo:e.codigo||"CCM".concat(t+1),descripcion:e.descripcion||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||"",consecuencias_asociadas:(e.consecuencias_asociadas||[]).map((e,t)=>({codigo:e.codigo||"CO".concat(e.id||t+1),id:e.id})),dimensiones:e.dimensiones||[]})),r=(o.causas||[]).map((t,r)=>Ue(Ue({},t),{},{codigo:t.codigo||"CA".concat(r+1),controles_preventivos:e.filter(e=>e.causa_id===t.id).map(e=>({descripcion:e.descripcion,id:e.id,codigo:e.codigo}))})),n=(o.consecuencias||[]).map((e,r)=>Ue(Ue({},e),{},{codigo:e.codigo||"CO".concat(r+1),evento_no_deseado:e.evento_no_deseado||null,categoria:e.categoria||null,controles_mitigadores:t.filter(t=>t.consecuencia_id===e.id).map(e=>({descripcion:e.descripcion,id:e.id,codigo:e.codigo}))})),a=Array.isArray(o.controles_preventivos_generales)?o.controles_preventivos_generales:[],i=Array.isArray(o.controles_mitigadores_generales)?o.controles_mitigadores_generales:[],s=a.reduce((e,t)=>{if(t.id){e.find(e=>e.id===t.id)||e.push(t)}else if(t.codigo){e.find(e=>e.codigo===t.codigo&&!e.id)||e.push(t)}else e.push(t);return e},[]).map((e,t)=>Ue(Ue({},e),{},{codigo:e.codigo||"CP".concat(t+1),nombre_control:e.nombre_control||e.descripcion||"",consecuencias:e.consecuencias||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||""})),l=i.map((e,t)=>Ue(Ue({},e),{},{codigo:e.codigo||"CM".concat(t+1),nombre_control:e.nombre_control||e.descripcion||"",consecuencias:e.consecuencias||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||""})),c=Ue(Ue({},o),{},{peligro:o.peligro||"",energia:o.energia||"",evento_top:o.evento_top||"",causas:r,consecuencias:n,controles_preventivos:e,controles_mitigadores:t,controles_preventivos_generales:s,controles_mitigadores_generales:l});En(c)}else{console.log("No hay bowtie_id en la respuesta, intentando clonar desde nivel superior si aplica");const e=2===yn.length&&(null===h||void 0===h?void 0:h.carpeta_padre_id);let r=null;if(e)try{const e=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?carpeta_id=").concat(h.carpeta_padre_id));if(e.ok){const t=await e.json();t&&t.bowtie_id&&(r=Fn(t))}}catch(t){console.error("Error clonando an\xe1lisis Bowtie del nivel superior:",t)}En(r||a)}}catch(t){console.error("Error cargando an\xe1lisis Bowtie:",t),Be||En({evento_central:"",peligro:"",energia:"",evento_top:"",causas:[],controles_preventivos:[],controles_preventivos_generales:[],consecuencias:[],controles_mitigadores:[],controles_mitigadores_generales:[]})}finally{We(!1)}}else Fe(null)},Pn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#0a6ebd";return(0,ze.jsx)("span",{style:{display:"inline-block",fontSize:"9px",fontWeight:"700",letterSpacing:"0.5px",color:t,background:"".concat(t,"1a"),border:"1px solid ".concat(t,"66"),padding:"1px 6px",borderRadius:"999px",marginBottom:"4px"},children:e})},Dn=e=>""===e?null:(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[Pn("DIMENSI\xd3N"),(0,ze.jsx)("div",{style:{fontWeight:600,fontSize:"11px",color:"#111827",lineHeight:"1.4",whiteSpace:"pre-line"},children:e||"Sin dimensi\xf3n definida"})]}),Ln=e=>""===e?null:(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[Pn("PREGUNTA","#ea580c"),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-line"},children:e||"Sin pregunta registrada"})]}),Bn=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>Ue(Ue({},e),{},{dimensiones:(e.dimensiones||[]).map(e=>Ue(Ue({},e),{},{preguntas:(e.preguntas||[]).map(e=>Ue(Ue({},e),{},{evidencia:""}))}))}))},Fn=e=>e?{evento_central:e.evento_central||"",peligro:e.peligro||"",energia:e.energia||"",evento_top:e.evento_top||"",causas:Array.isArray(e.causas)?e.causas.map(e=>Ue({},e)):[],consecuencias:Array.isArray(e.consecuencias)?e.consecuencias.map(e=>Ue({},e)):[],controles_preventivos:Bn(e.controles_preventivos||[]),controles_mitigadores:Bn(e.controles_mitigadores||[]),controles_preventivos_generales:Array.isArray(e.controles_preventivos_generales)?e.controles_preventivos_generales.map(e=>Ue({},e)):[],controles_mitigadores_generales:Array.isArray(e.controles_mitigadores_generales)?e.controles_mitigadores_generales.map(e=>Ue({},e)):[]}:null,Mn=async e=>{if(e)try{wt(!0);let o=[];console.log("[L\xednea Base] Iniciando carga, analisisBowtie existe?",!!Be);const a=h&&h.carpeta_padre_id;try{if(a)try{const e=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?carpeta_id=").concat(h.carpeta_padre_id)),t=await e.json();t&&t.controles_preventivos&&t.controles_preventivos.length>0&&(o=t.controles_preventivos,console.log("[L\xednea Base] Nivel 2: Usando controles del BOWTIE padre con evidencias:",o.length,"controles"))}catch(t){console.error("[L\xednea Base] Error al cargar BOWTIE padre:",t)}if(0===o.length){const t=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?carpeta_id=").concat(e)),r=await t.json();console.log("[L\xednea Base] Respuesta API completa:",r),console.log("[L\xednea Base] data.success:",r.success,"data.bowtie_id:",r.bowtie_id),console.log("[L\xednea Base] data.controles_preventivos:",r.controles_preventivos?r.controles_preventivos.length:"null/undefined"),r.controles_preventivos&&Array.isArray(r.controles_preventivos)&&r.controles_preventivos.length>0?(o=r.controles_preventivos,console.log("[L\xednea Base] Controles obtenidos desde API:",o.length)):r.success&&r.bowtie_id&&(o=r.controles_preventivos||[],console.log("[L\xednea Base] Controles desde API (con bowtie_id):",o.length))}0===o.length&&(Be&&Be.controles_preventivos&&Be.controles_preventivos.length>0?(o=Be.controles_preventivos,console.log("[L\xednea Base] Usando controles desde analisisBowtie (fallback):",o.length)):console.log("[L\xednea Base] No se encontraron controles ni en API ni en estado"))}catch(r){console.error("[L\xednea Base] Error al obtener desde API:",r),Be&&Be.controles_preventivos&&Be.controles_preventivos.length>0&&(o=Be.controles_preventivos,console.log("[L\xednea Base] Usando controles desde analisisBowtie (error en API):",o.length))}if(console.log("[L\xednea Base] Total controles encontrados:",o.length),o.length>0)try{const t=await fetch("".concat(Te,"/archivos/carpeta_linea_base.php?carpeta_id=").concat(e)),r=await t.json();if(r.success&&r.linea_base&&r.linea_base.length>0){const e=r.linea_base,t=[];o.forEach((r,n)=>{const o=r.dimensiones||[],a=r.codigo||"CCP".concat(n+1),i=r.descripcion||"";if(0===o.length){var s,l,c,d,p,u,f,h;const n=e.find(e=>e.control_preventivo_id===r.id&&!e.dimension);return void t.push({id:(null===n||void 0===n?void 0:n.id)||null,control_preventivo_id:r.id,codigo:a,control_critico_preventivo:i,dimension:"",pregunta:"",evidencia:"",verificador_responsable:n&&null!==(s=n.verificador_responsable)&&void 0!==s?s:"",fecha_verificacion:n&&null!==(l=n.fecha_verificacion)&&void 0!==l?l:"",implementado_estandar_desempeno:n&&null!==(c=n.implementado_estandar)&&void 0!==c?c:"",accion_a_ejecutar:n&&null!==(d=n.accion_ejecutar)&&void 0!==d?d:"",responsable_cierre_accion:n&&null!==(p=n.responsable_cierre)&&void 0!==p?p:"",fecha_cierre:n&&null!==(u=n.fecha_cierre)&&void 0!==u?u:"",criticidad:n&&n.criticidad||"",porcentaje_avance_implementacion_accion:n&&null!==(f=n.porcentaje_avance)&&void 0!==f?f:"",nombre_dueno_control_critico_tecnico:n&&null!==(h=n.nombre_dueno_control)&&void 0!==h?h:"",comentario_trabajador:(null===n||void 0===n?void 0:n.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===n||void 0===n?void 0:n.archivos_respaldo)?JSON.parse(n.archivos_respaldo)||[]:(null===n||void 0===n?void 0:n.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===n||void 0===n?void 0:n.conversacion_seguimiento)?JSON.parse(n.conversacion_seguimiento)||[]:(null===n||void 0===n?void 0:n.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===n||void 0===n?void 0:n.ultimo_usuario_edito)||"",estado_validacion:(null===n||void 0===n?void 0:n.estado_validacion)||null,comentario_validacion:(null===n||void 0===n?void 0:n.comentario_validacion)||"",usuario_validacion:(null===n||void 0===n?void 0:n.usuario_validacion)||"",fecha_validacion:(null===n||void 0===n?void 0:n.fecha_validacion)||"",ponderacion:void 0!==(null===n||void 0===n?void 0:n.ponderacion)?n.ponderacion:"validado"===(null===n||void 0===n?void 0:n.estado_validacion)?100:0})}o.forEach((n,o)=>{const s=n.preguntas||[],l=n.nombre||"";if(0===s.length){var c,d,p,u,f,h,g,m;const n=e.find(e=>e.control_preventivo_id===r.id&&e.dimension===l&&!e.pregunta);return void t.push({id:(null===n||void 0===n?void 0:n.id)||null,control_preventivo_id:r.id,codigo:a,control_critico_preventivo:0===o?i:"",dimension:l,pregunta:"",evidencia:"",verificador_responsable:n&&null!==(c=n.verificador_responsable)&&void 0!==c?c:"",fecha_verificacion:n&&null!==(d=n.fecha_verificacion)&&void 0!==d?d:"",implementado_estandar_desempeno:n&&null!==(p=n.implementado_estandar)&&void 0!==p?p:"",accion_a_ejecutar:n&&null!==(u=n.accion_ejecutar)&&void 0!==u?u:"",responsable_cierre_accion:n&&null!==(f=n.responsable_cierre)&&void 0!==f?f:"",fecha_cierre:n&&null!==(h=n.fecha_cierre)&&void 0!==h?h:"",criticidad:n&&n.criticidad||"",porcentaje_avance_implementacion_accion:n&&null!==(g=n.porcentaje_avance)&&void 0!==g?g:"",nombre_dueno_control_critico_tecnico:n&&null!==(m=n.nombre_dueno_control)&&void 0!==m?m:"",comentario_trabajador:(null===n||void 0===n?void 0:n.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===n||void 0===n?void 0:n.archivos_respaldo)?JSON.parse(n.archivos_respaldo)||[]:(null===n||void 0===n?void 0:n.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===n||void 0===n?void 0:n.conversacion_seguimiento)?JSON.parse(n.conversacion_seguimiento)||[]:(null===n||void 0===n?void 0:n.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===n||void 0===n?void 0:n.ultimo_usuario_edito)||"",estado_validacion:(null===n||void 0===n?void 0:n.estado_validacion)||null,comentario_validacion:(null===n||void 0===n?void 0:n.comentario_validacion)||"",usuario_validacion:(null===n||void 0===n?void 0:n.usuario_validacion)||"",fecha_validacion:(null===n||void 0===n?void 0:n.fecha_validacion)||"",ponderacion:void 0!==(null===n||void 0===n?void 0:n.ponderacion)?n.ponderacion:"validado"===(null===n||void 0===n?void 0:n.estado_validacion)?100:0})}s.forEach((n,s)=>{const c=n.evidencia||"",d=vh(c);(d.length>0?d:[""]).forEach((c,d)=>{var p,u,f,h,g,m,x,b;const v=0===o&&0===s&&0===d,y=0===s&&0===d,j=0===d,_=e.find(e=>e.control_preventivo_id===r.id&&e.dimension===l&&e.pregunta===n.texto&&e.evidencia===c);t.push({id:(null===_||void 0===_?void 0:_.id)||null,control_preventivo_id:r.id,codigo:a,control_critico_preventivo:v?i:"",dimension:l,pregunta:n.texto||"",evidencia:c,_esPrimeraFilaDimension:y,_esPrimeraFilaPregunta:j,verificador_responsable:_&&null!==(p=_.verificador_responsable)&&void 0!==p?p:"",fecha_verificacion:_&&null!==(u=_.fecha_verificacion)&&void 0!==u?u:"",implementado_estandar_desempeno:_&&null!==(f=_.implementado_estandar)&&void 0!==f?f:"",accion_a_ejecutar:_&&null!==(h=_.accion_ejecutar)&&void 0!==h?h:"",responsable_cierre_accion:_&&null!==(g=_.responsable_cierre)&&void 0!==g?g:"",fecha_cierre:_&&null!==(m=_.fecha_cierre)&&void 0!==m?m:"",criticidad:_&&_.criticidad||"",porcentaje_avance_implementacion_accion:_&&null!==(x=_.porcentaje_avance)&&void 0!==x?x:"",nombre_dueno_control_critico_tecnico:_&&null!==(b=_.nombre_dueno_control)&&void 0!==b?b:"",comentario_trabajador:(null===_||void 0===_?void 0:_.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===_||void 0===_?void 0:_.archivos_respaldo)?JSON.parse(_.archivos_respaldo)||[]:(null===_||void 0===_?void 0:_.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===_||void 0===_?void 0:_.conversacion_seguimiento)?JSON.parse(_.conversacion_seguimiento)||[]:(null===_||void 0===_?void 0:_.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===_||void 0===_?void 0:_.ultimo_usuario_edito)||"",estado_validacion:(null===_||void 0===_?void 0:_.estado_validacion)||null,comentario_validacion:(null===_||void 0===_?void 0:_.comentario_validacion)||"",usuario_validacion:(null===_||void 0===_?void 0:_.usuario_validacion)||"",fecha_validacion:(null===_||void 0===_?void 0:_.fecha_validacion)||"",ponderacion:void 0!==(null===_||void 0===_?void 0:_.ponderacion)?_.ponderacion:"validado"===(null===_||void 0===_?void 0:_.estado_validacion)?100:0})})})})}),console.log("[L\xednea Base] L\xednea base sincronizada con existente (por evidencia):",t.length,"elementos"),console.log("[L\xednea Base] Estableciendo estado con",t.length,"elementos"),_t(t),setTimeout(()=>{console.log("[L\xednea Base] Estado verificado despu\xe9s de setLineaBase:",t.length)},0)}else{const e=[];o.forEach((t,r)=>{const n=t.dimensiones||[],o=t.codigo||"CCP".concat(r+1),a=t.descripcion||"";0!==n.length?n.forEach((r,n)=>{const i=r.preguntas||[],s=r.nombre||"";0!==i.length?i.forEach((r,i)=>{const l=r.evidencia||"",c=vh(l);(c.length>0?c:[""]).forEach((l,c)=>{const d=0===n&&0===i&&0===c,p=0===i&&0===c,u=0===c;e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:d?a:"",dimension:s,pregunta:r.texto||"",evidencia:l,_esPrimeraFilaDimension:p,_esPrimeraFilaPregunta:u,verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})})}):e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:0===n?a:"",dimension:s,pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})}):e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:a,dimension:"",pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}),console.log("[L\xednea Base] L\xednea base creada desde controles preventivos (por evidencia):",e.length,"elementos"),console.log("[L\xednea Base] Estableciendo estado con",e.length,"elementos"),_t(e),setTimeout(()=>{console.log("[L\xednea Base] Estado verificado despu\xe9s de setLineaBase:",e.length)},0)}}catch(n){console.log("[L\xednea Base] No hay API de l\xednea base a\xfan, creando desde controles preventivos");const e=[];o.forEach((t,r)=>{const n=t.dimensiones||[],o=t.codigo||"CCP".concat(r+1),a=t.descripcion||"";0!==n.length?n.forEach((r,n)=>{const i=r.preguntas||[],s=r.nombre||"";0!==i.length?i.forEach((r,i)=>{const l=r.evidencia||"",c=vh(l);(c.length>0?c:[""]).forEach((l,c)=>{const d=0===n&&0===i&&0===c,p=0===i&&0===c,u=0===c;e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:d?a:"",dimension:s,pregunta:r.texto||"",evidencia:l,_esPrimeraFilaDimension:p,_esPrimeraFilaPregunta:u,verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})})}):e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:0===n?a:"",dimension:s,pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}):e.push({id:null,control_preventivo_id:t.id,codigo:o,control_critico_preventivo:a,dimension:"",pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}),console.log("[L\xednea Base] L\xednea base creada (catch, por evidencia):",e.length,"elementos"),console.log("[L\xednea Base] Estableciendo estado con",e.length,"elementos"),_t(e),setTimeout(()=>{console.log("[L\xednea Base] Estado verificado despu\xe9s de setLineaBase (catch):",e.length)},0)}else console.log("[L\xednea Base] No hay controles preventivos, limpiando l\xednea base"),_t([])}catch(n){console.error("[L\xednea Base] Error cargando l\xednea base:",n),_t([])}finally{wt(!1)}else _t([])},Wn=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e)try{Yt(!0);const r=null===t?"null":t,n=await fetch("".concat(Te,"/archivos/linea_base_carpetas.php?linea_base_id=").concat(e,"&carpeta_padre_id=").concat(r)),o=await n.json();o.success&&(Bt(o.carpetas||[]),Mt(o.archivos||[]),Vt(o.breadcrumbs||[]),Ut(t))}catch(r){console.error("Error cargando documentos:",r)}finally{Yt(!1)}},Un=async()=>{if(!$t)if(Jt.trim()){qt(!0);try{let e=At.id;if(console.log("[Crear Carpeta] formLineaBase.id:",e),console.log("[Crear Carpeta] formLineaBase:",At),!e){dn("Guardando l\xednea base primero...","info");const t="preventivo"===(null===Rt||void 0===Rt?void 0:Rt.tipo),r=t?jt:sr,n="".concat(Te,t?"/archivos/carpeta_linea_base.php":"/archivos/carpeta_linea_base_mitigadores.php");if(!h||!r||0===r.length)return dn("\u2717 No hay datos de l\xednea base para guardar. Cierre este modal y guarde la l\xednea base primero.","error"),void qt(!1);const o={carpeta_id:h.id,usuario_id:d.id,linea_base:r.map(e=>({id:e.id,control_preventivo_id:e.control_preventivo_id,control_mitigador_id:e.control_mitigador_id,codigo:e.codigo||"",control_critico_preventivo:e.control_critico_preventivo||"",control_critico_mitigador:e.control_critico_mitigador||"",dimension:e.dimension||"",pregunta:e.pregunta||"",evidencia:e.evidencia||"",verificador_responsable:e.verificador_responsable||"",fecha_verificacion:e.fecha_verificacion&&""!==e.fecha_verificacion.trim()?e.fecha_verificacion:null,implementado_estandar:e.implementado_estandar_desempeno||"",accion_ejecutar:e.accion_a_ejecutar||"",responsable_cierre:e.responsable_cierre_accion||"",fecha_cierre:e.fecha_cierre&&""!==e.fecha_cierre.trim()?e.fecha_cierre:null,criticidad:e.criticidad||"",porcentaje_avance:""!==e.porcentaje_avance_implementacion_accion&&null!=e.porcentaje_avance_implementacion_accion?parseFloat(e.porcentaje_avance_implementacion_accion):null,nombre_dueno_control:e.nombre_dueno_control_critico_tecnico||"",comentario_trabajador:e.comentario_trabajador||"",archivos_respaldo:JSON.stringify(e.archivos_respaldo||[]),conversacion_seguimiento:JSON.stringify(e.conversacion_seguimiento||[]),ultimo_usuario_edito:e.ultimo_usuario_edito||"",estado_validacion:e.estado_validacion||null,comentario_validacion:e.comentario_validacion||"",usuario_validacion:e.usuario_validacion||"",fecha_validacion:e.fecha_validacion&&""!==e.fecha_validacion.trim()?e.fecha_validacion:null,ponderacion:void 0!==e.ponderacion?e.ponderacion:"validado"===e.estado_validacion?100:0}))},a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),i=await a.json();if(console.log("[Crear Carpeta] Respuesta guardar l\xednea base:",i),!i.success)return dn("\u2717 Error al guardar l\xednea base: "+(i.error||"Error desconocido"),"error"),void qt(!1);const s=await fetch("".concat(n,"?carpeta_id=").concat(h.id)),l=await s.json();if(console.log("[Crear Carpeta] Datos actualizados:",l),!(l.success&&l.linea_base&&l.linea_base.length>0))return dn("\u2717 Error al obtener datos actualizados. Intente guardar la l\xednea base primero.","error"),void qt(!1);{const r=t?"control_preventivo_id":"control_mitigador_id",n=t?At.control_preventivo_id:At.control_mitigador_id,o=l.linea_base.find(e=>{const t=e[r]==n,o=e.dimension===At.dimension,a=e.pregunta===At.pregunta,i=e.evidencia===At.evidencia;return console.log("[Crear Carpeta] Comparando:",{controlId:"".concat(e[r]," == ").concat(n),matchControl:t,matchDimension:o,matchPregunta:a,matchEvidencia:i}),t&&o&&a&&i});if(!o||!o.id)return console.error("[Crear Carpeta] No se encontr\xf3 el item:",{buscando:{[r]:n,dimension:At.dimension,pregunta:At.pregunta,evidencia:At.evidencia},disponibles:l.linea_base.map(e=>{var t,n;return{id:e.id,[r]:e[r],dimension:e.dimension,pregunta:null===(t=e.pregunta)||void 0===t?void 0:t.substring(0,30),evidencia:null===(n=e.evidencia)||void 0===n?void 0:n.substring(0,30)}})}),dn("\u2717 No se pudo identificar el registro. Cierre el modal, guarde los cambios y vuelva a intentar.","error"),void qt(!1);e=o.id,zt(t=>Ue(Ue({},t),{},{id:e})),console.log("[Crear Carpeta] ID encontrado:",e)}}if(!e)return dn("\u2717 Error: No se pudo obtener el ID de la evidencia. Guarde la l\xednea base primero.","error"),void qt(!1);console.log("[Crear Carpeta] Creando carpeta con lineaBaseId:",e);const t=await fetch("".concat(Te,"/archivos/linea_base_carpetas.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({linea_base_id:e,carpeta_padre_id:Wt,nombre:Jt.trim(),usuario_id:null===d||void 0===d?void 0:d.id,usuario_nombre:(null===d||void 0===d?void 0:d.nombre)||(null===d||void 0===d?void 0:d.email)})}),r=await t.json();console.log("[Crear Carpeta] Respuesta crear carpeta:",r),r.success?(dn("\u2713 Carpeta creada exitosamente","success"),Qt(""),Kt(!1),Wn(e,Wt)):dn("\u2717 Error al crear carpeta: "+(r.error||"Error desconocido"),"error")}catch(e){console.error("[Crear Carpeta] Error:",e),dn("\u2717 Error al crear carpeta: "+e.message,"error")}finally{qt(!1)}}else dn("\u2717 Ingrese un nombre para la carpeta","error")},Hn=async()=>{if(Zt&&tr.trim())try{const e=await fetch("".concat(Te,"/archivos/linea_base_carpetas.php"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Zt.id,nombre:tr.trim()})}),t=await e.json();t.success?(dn("\u2713 Carpeta renombrada","success"),er(null),rr(""),Wn(At.id,Wt)):dn("\u2717 Error: "+t.error,"error")}catch(e){console.error("Error renombrando carpeta:",e),dn("\u2717 Error al renombrar carpeta","error")}},Vn=async()=>{if(!nr)return;if("eliminar2024"===ar)try{const e="carpeta"===nr.tipo?"".concat(Te,"/archivos/linea_base_carpetas.php"):"".concat(Te,"/archivos/linea_base_archivos.php"),t=await fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:nr.id})}),r=await t.json();r.success?(dn("\u2713 ".concat("carpeta"===nr.tipo?"Carpeta":"Archivo"," eliminado"),"success"),or(null),ir(""),Wn(At.id,Wt)):dn("\u2717 Error: "+r.error,"error")}catch(e){console.error("Error eliminando:",e),dn("\u2717 Error al eliminar","error")}else dn("\u2717 Clave incorrecta","error")},Gn=(e,t,r)=>{or({tipo:e,id:t,nombre:r}),ir("")},Yn=e=>{Ut(e),Wn(At.id,e)},$n=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},qn=e=>({pdf:"fa-file-pdf-o",doc:"fa-file-word-o",docx:"fa-file-word-o",xls:"fa-file-excel-o",xlsx:"fa-file-excel-o",ppt:"fa-file-powerpoint-o",pptx:"fa-file-powerpoint-o",jpg:"fa-file-image-o",jpeg:"fa-file-image-o",png:"fa-file-image-o",gif:"fa-file-image-o",webp:"fa-file-image-o",zip:"fa-file-archive-o",rar:"fa-file-archive-o",mp4:"fa-file-video-o",mp3:"fa-file-audio-o",txt:"fa-file-text-o",csv:"fa-file-text-o"}[null===e||void 0===e?void 0:e.toLowerCase()]||"fa-file-o"),Xn=async function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||jt;if(h&&e&&0!==e.length)try{Ct(!0);const r={carpeta_id:h.id,usuario_id:d.id,linea_base:e.map(e=>({id:e.id,control_preventivo_id:e.control_preventivo_id,codigo:e.codigo||"",control_critico_preventivo:e.control_critico_preventivo||"",dimension:e.dimension||"",pregunta:e.pregunta||"",evidencia:e.evidencia||"",verificador_responsable:e.verificador_responsable||"",fecha_verificacion:e.fecha_verificacion&&""!==e.fecha_verificacion.trim()?e.fecha_verificacion:null,implementado_estandar:e.implementado_estandar_desempeno||"",accion_ejecutar:e.accion_a_ejecutar||"",responsable_cierre:e.responsable_cierre_accion||"",fecha_cierre:e.fecha_cierre&&""!==e.fecha_cierre.trim()?e.fecha_cierre:null,criticidad:e.criticidad||"",porcentaje_avance:""!==e.porcentaje_avance_implementacion_accion&&null!=e.porcentaje_avance_implementacion_accion?parseFloat(e.porcentaje_avance_implementacion_accion):null,nombre_dueno_control:e.nombre_dueno_control_critico_tecnico||"",comentario_trabajador:e.comentario_trabajador||"",archivos_respaldo:JSON.stringify(e.archivos_respaldo||[]),conversacion_seguimiento:JSON.stringify(e.conversacion_seguimiento||[]),ultimo_usuario_edito:e.ultimo_usuario_edito||"",estado_validacion:e.estado_validacion||null,comentario_validacion:e.comentario_validacion||"",usuario_validacion:e.usuario_validacion||"",fecha_validacion:e.fecha_validacion&&""!==e.fecha_validacion.trim()?e.fecha_validacion:null,ponderacion:void 0!==e.ponderacion?e.ponderacion:"validado"===e.estado_validacion?100:0}))},n=await fetch("".concat(Te,"/archivos/carpeta_linea_base.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),o=await n.json();if(o.success){await Mn(h.id);try{const e=await fetch("".concat(Te,"/archivos/promedio_ponderacion.php?carpeta_id=").concat(h.id)),t=await e.json();t.success&&(v(t.promedio_general),x(e=>Ue(Ue({},e),{},{[h.id]:t.promedio_general})))}catch(t){console.error("Error recargando promedio:",t)}dn("\u2713 L\xednea base guardada correctamente","success")}else dn("\u2717 Error al guardar: "+(o.error||"Error desconocido"),"error",5e3)}catch(t){console.error("Error guardando l\xednea base:",t),dn("\u2717 Error al guardar la l\xednea base","error",5e3)}finally{Ct(!1)}},Kn=async e=>{if(e)try{dr(!0);let o=[];console.log("[L\xednea Base Mitigadores] Iniciando carga, analisisBowtie existe?",!!Be);const a=h&&h.carpeta_padre_id;try{if(a)try{const e=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?carpeta_id=").concat(h.carpeta_padre_id)),t=await e.json();t&&t.controles_mitigadores&&t.controles_mitigadores.length>0&&(o=t.controles_mitigadores,console.log("[L\xednea Base Mitigadores] Nivel 2: Usando controles del BOWTIE padre con evidencias:",o.length,"controles"))}catch(t){console.error("[L\xednea Base Mitigadores] Error al cargar BOWTIE padre:",t)}if(0===o.length){const t=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php?carpeta_id=").concat(e)),r=await t.json();console.log("[L\xednea Base Mitigadores] Respuesta API completa:",r),console.log("[L\xednea Base Mitigadores] data.success:",r.success,"data.bowtie_id:",r.bowtie_id),console.log("[L\xednea Base Mitigadores] data.controles_mitigadores:",r.controles_mitigadores?r.controles_mitigadores.length:"null/undefined"),r.controles_mitigadores&&Array.isArray(r.controles_mitigadores)&&r.controles_mitigadores.length>0?(o=r.controles_mitigadores,console.log("[L\xednea Base Mitigadores] Controles obtenidos desde API:",o.length)):r.success&&r.bowtie_id&&(o=r.controles_mitigadores||[],console.log("[L\xednea Base Mitigadores] Controles desde API (con bowtie_id):",o.length))}0===o.length&&(Be&&Be.controles_mitigadores&&Be.controles_mitigadores.length>0?(o=Be.controles_mitigadores,console.log("[L\xednea Base Mitigadores] Usando controles desde analisisBowtie (fallback):",o.length)):console.log("[L\xednea Base Mitigadores] No se encontraron controles ni en API ni en estado"))}catch(r){console.error("[L\xednea Base Mitigadores] Error al obtener desde API:",r),Be&&Be.controles_mitigadores&&Be.controles_mitigadores.length>0&&(o=Be.controles_mitigadores,console.log("[L\xednea Base Mitigadores] Usando controles desde analisisBowtie (error en API):",o.length))}if(console.log("[L\xednea Base Mitigadores] Total controles encontrados:",o.length),o.length>0)try{const t=await fetch("".concat(Te,"/archivos/carpeta_linea_base_mitigadores.php?carpeta_id=").concat(e)),r=await t.json();if(r.success&&r.linea_base&&r.linea_base.length>0){const e=r.linea_base,t=[];o.forEach((r,n)=>{const o=r.dimensiones||[],a=r.codigo||"CCM".concat(n+1),i=r.descripcion||"";if(0===o.length){var s,l,c,d,p,u,f,h;const n=e.find(e=>e.control_mitigador_id===r.id&&!e.dimension);return void t.push({id:(null===n||void 0===n?void 0:n.id)||null,control_mitigador_id:r.id,codigo:a,control_critico_mitigador:i,dimension:"",pregunta:"",evidencia:"",verificador_responsable:n&&null!==(s=n.verificador_responsable)&&void 0!==s?s:"",fecha_verificacion:n&&null!==(l=n.fecha_verificacion)&&void 0!==l?l:"",implementado_estandar_desempeno:n&&null!==(c=n.implementado_estandar)&&void 0!==c?c:"",accion_a_ejecutar:n&&null!==(d=n.accion_ejecutar)&&void 0!==d?d:"",responsable_cierre_accion:n&&null!==(p=n.responsable_cierre)&&void 0!==p?p:"",fecha_cierre:n&&null!==(u=n.fecha_cierre)&&void 0!==u?u:"",criticidad:n&&n.criticidad||"",porcentaje_avance_implementacion_accion:n&&null!==(f=n.porcentaje_avance)&&void 0!==f?f:"",nombre_dueno_control_critico_tecnico:n&&null!==(h=n.nombre_dueno_control)&&void 0!==h?h:"",comentario_trabajador:(null===n||void 0===n?void 0:n.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===n||void 0===n?void 0:n.archivos_respaldo)?JSON.parse(n.archivos_respaldo)||[]:(null===n||void 0===n?void 0:n.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===n||void 0===n?void 0:n.conversacion_seguimiento)?JSON.parse(n.conversacion_seguimiento)||[]:(null===n||void 0===n?void 0:n.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===n||void 0===n?void 0:n.ultimo_usuario_edito)||"",estado_validacion:(null===n||void 0===n?void 0:n.estado_validacion)||null,comentario_validacion:(null===n||void 0===n?void 0:n.comentario_validacion)||"",usuario_validacion:(null===n||void 0===n?void 0:n.usuario_validacion)||"",fecha_validacion:(null===n||void 0===n?void 0:n.fecha_validacion)||"",ponderacion:void 0!==(null===n||void 0===n?void 0:n.ponderacion)?n.ponderacion:"validado"===(null===n||void 0===n?void 0:n.estado_validacion)?100:0})}o.forEach((n,o)=>{const s=n.preguntas||[],l=n.nombre||"";if(0===s.length){var c,d,p,u,f,h,g,m;const n=e.find(e=>e.control_mitigador_id===r.id&&e.dimension===l&&!e.pregunta);return void t.push({id:(null===n||void 0===n?void 0:n.id)||null,control_mitigador_id:r.id,codigo:a,control_critico_mitigador:0===o?i:"",dimension:l,pregunta:"",evidencia:"",verificador_responsable:n&&null!==(c=n.verificador_responsable)&&void 0!==c?c:"",fecha_verificacion:n&&null!==(d=n.fecha_verificacion)&&void 0!==d?d:"",implementado_estandar_desempeno:n&&null!==(p=n.implementado_estandar)&&void 0!==p?p:"",accion_a_ejecutar:n&&null!==(u=n.accion_ejecutar)&&void 0!==u?u:"",responsable_cierre_accion:n&&null!==(f=n.responsable_cierre)&&void 0!==f?f:"",fecha_cierre:n&&null!==(h=n.fecha_cierre)&&void 0!==h?h:"",criticidad:n&&n.criticidad||"",porcentaje_avance_implementacion_accion:n&&null!==(g=n.porcentaje_avance)&&void 0!==g?g:"",nombre_dueno_control_critico_tecnico:n&&null!==(m=n.nombre_dueno_control)&&void 0!==m?m:"",comentario_trabajador:(null===n||void 0===n?void 0:n.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===n||void 0===n?void 0:n.archivos_respaldo)?JSON.parse(n.archivos_respaldo)||[]:(null===n||void 0===n?void 0:n.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===n||void 0===n?void 0:n.conversacion_seguimiento)?JSON.parse(n.conversacion_seguimiento)||[]:(null===n||void 0===n?void 0:n.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===n||void 0===n?void 0:n.ultimo_usuario_edito)||"",estado_validacion:(null===n||void 0===n?void 0:n.estado_validacion)||null,comentario_validacion:(null===n||void 0===n?void 0:n.comentario_validacion)||"",usuario_validacion:(null===n||void 0===n?void 0:n.usuario_validacion)||"",fecha_validacion:(null===n||void 0===n?void 0:n.fecha_validacion)||"",ponderacion:void 0!==(null===n||void 0===n?void 0:n.ponderacion)?n.ponderacion:"validado"===(null===n||void 0===n?void 0:n.estado_validacion)?100:0})}s.forEach((n,s)=>{const c=n.evidencia||"",d=vh(c);(d.length>0?d:[""]).forEach((c,d)=>{var p,u,f,h,g,m,x,b;const v=0===o&&0===s&&0===d,y=0===s&&0===d,j=0===d,_=e.find(e=>e.control_mitigador_id===r.id&&e.dimension===l&&e.pregunta===n.texto&&e.evidencia===c);t.push({id:(null===_||void 0===_?void 0:_.id)||null,control_mitigador_id:r.id,codigo:a,control_critico_mitigador:v?i:"",dimension:l,pregunta:n.texto||"",evidencia:c,_esPrimeraFilaDimension:y,_esPrimeraFilaPregunta:j,verificador_responsable:_&&null!==(p=_.verificador_responsable)&&void 0!==p?p:"",fecha_verificacion:_&&null!==(u=_.fecha_verificacion)&&void 0!==u?u:"",implementado_estandar_desempeno:_&&null!==(f=_.implementado_estandar)&&void 0!==f?f:"",accion_a_ejecutar:_&&null!==(h=_.accion_ejecutar)&&void 0!==h?h:"",responsable_cierre_accion:_&&null!==(g=_.responsable_cierre)&&void 0!==g?g:"",fecha_cierre:_&&null!==(m=_.fecha_cierre)&&void 0!==m?m:"",criticidad:_&&_.criticidad||"",porcentaje_avance_implementacion_accion:_&&null!==(x=_.porcentaje_avance)&&void 0!==x?x:"",nombre_dueno_control_critico_tecnico:_&&null!==(b=_.nombre_dueno_control)&&void 0!==b?b:"",comentario_trabajador:(null===_||void 0===_?void 0:_.comentario_trabajador)||"",archivos_respaldo:"string"===typeof(null===_||void 0===_?void 0:_.archivos_respaldo)?JSON.parse(_.archivos_respaldo)||[]:(null===_||void 0===_?void 0:_.archivos_respaldo)||[],conversacion_seguimiento:"string"===typeof(null===_||void 0===_?void 0:_.conversacion_seguimiento)?JSON.parse(_.conversacion_seguimiento)||[]:(null===_||void 0===_?void 0:_.conversacion_seguimiento)||[],ultimo_usuario_edito:(null===_||void 0===_?void 0:_.ultimo_usuario_edito)||"",estado_validacion:(null===_||void 0===_?void 0:_.estado_validacion)||null,comentario_validacion:(null===_||void 0===_?void 0:_.comentario_validacion)||"",usuario_validacion:(null===_||void 0===_?void 0:_.usuario_validacion)||"",fecha_validacion:(null===_||void 0===_?void 0:_.fecha_validacion)||"",ponderacion:void 0!==(null===_||void 0===_?void 0:_.ponderacion)?_.ponderacion:"validado"===(null===_||void 0===_?void 0:_.estado_validacion)?100:0})})})})}),lr(t)}else{const e=[];o.forEach((t,r)=>{const n=t.dimensiones||[],o=t.codigo||"CCM".concat(r+1),a=t.descripcion||"";0!==n.length?n.forEach((r,n)=>{const i=r.preguntas||[],s=r.nombre||"";0!==i.length?i.forEach((r,i)=>{const l=r.evidencia||"",c=vh(l);(c.length>0?c:[""]).forEach((l,c)=>{const d=0===n&&0===i&&0===c,p=0===i&&0===c,u=0===c;e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:d?a:"",dimension:s,pregunta:r.texto||"",evidencia:l,_esPrimeraFilaDimension:p,_esPrimeraFilaPregunta:u,verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})})}):e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:0===n?a:"",dimension:s,pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})}):e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:a,dimension:"",pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}),lr(e)}}catch(n){console.log("No hay API de l\xednea base mitigadores a\xfan, creando desde controles mitigadores");const e=[];o.forEach((t,r)=>{const n=t.dimensiones||[],o=t.codigo||"CCM".concat(r+1),a=t.descripcion||"";0!==n.length?n.forEach((r,n)=>{const i=r.preguntas||[],s=r.nombre||"";0!==i.length?i.forEach((r,i)=>{const l=r.evidencia||"",c=vh(l);(c.length>0?c:[""]).forEach((l,c)=>{const d=0===n&&0===i&&0===c,p=0===i&&0===c,u=0===c;e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:d?a:"",dimension:s,pregunta:r.texto||"",evidencia:l,_esPrimeraFilaDimension:p,_esPrimeraFilaPregunta:u,verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[],conversacion_seguimiento:[]})})}):e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:0===n?a:"",dimension:s,pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}):e.push({id:null,control_mitigador_id:t.id,codigo:o,control_critico_mitigador:a,dimension:"",pregunta:"",evidencia:"",verificador_responsable:"",fecha_verificacion:"",implementado_estandar_desempeno:"",accion_a_ejecutar:"",responsable_cierre_accion:"",fecha_cierre:"",criticidad:t.criticidad||"",porcentaje_avance_implementacion_accion:"",nombre_dueno_control_critico_tecnico:"",comentario_trabajador:"",archivos_respaldo:[]})}),lr(e)}else lr([])}catch(n){console.error("Error cargando l\xednea base mitigadores:",n),lr([])}finally{dr(!1)}else lr([])},Jn=async function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||sr;if(h&&e&&0!==e.length)try{ur(!0);const r={carpeta_id:h.id,usuario_id:d.id,linea_base:e.map(e=>({id:e.id,control_mitigador_id:e.control_mitigador_id,codigo:e.codigo||"",control_critico_mitigador:e.control_critico_mitigador||"",dimension:e.dimension||"",pregunta:e.pregunta||"",evidencia:e.evidencia||"",verificador_responsable:e.verificador_responsable||"",fecha_verificacion:e.fecha_verificacion&&""!==e.fecha_verificacion.trim()?e.fecha_verificacion:null,implementado_estandar:e.implementado_estandar_desempeno||"",accion_ejecutar:e.accion_a_ejecutar||"",responsable_cierre:e.responsable_cierre_accion||"",fecha_cierre:e.fecha_cierre&&""!==e.fecha_cierre.trim()?e.fecha_cierre:null,criticidad:e.criticidad||"",porcentaje_avance:""!==e.porcentaje_avance_implementacion_accion&&null!=e.porcentaje_avance_implementacion_accion?parseFloat(e.porcentaje_avance_implementacion_accion):null,nombre_dueno_control:e.nombre_dueno_control_critico_tecnico||"",comentario_trabajador:e.comentario_trabajador||"",archivos_respaldo:JSON.stringify(e.archivos_respaldo||[]),conversacion_seguimiento:JSON.stringify(e.conversacion_seguimiento||[]),ultimo_usuario_edito:e.ultimo_usuario_edito||"",estado_validacion:e.estado_validacion||null,comentario_validacion:e.comentario_validacion||"",usuario_validacion:e.usuario_validacion||"",fecha_validacion:e.fecha_validacion&&""!==e.fecha_validacion.trim()?e.fecha_validacion:null,ponderacion:void 0!==e.ponderacion?e.ponderacion:"validado"===e.estado_validacion?100:0}))},n=await fetch("".concat(Te,"/archivos/carpeta_linea_base_mitigadores.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),o=await n.json();if(o.success){await Kn(h.id);try{const e=await fetch("".concat(Te,"/archivos/promedio_ponderacion.php?carpeta_id=").concat(h.id)),t=await e.json();t.success&&(v(t.promedio_general),x(e=>Ue(Ue({},e),{},{[h.id]:t.promedio_general})))}catch(t){console.error("Error recargando promedio:",t)}dn("\u2713 L\xednea base mitigadores guardada correctamente","success")}else dn("\u2717 Error al guardar: "+(o.error||"Error desconocido"),"error",5e3)}catch(t){console.error("Error guardando l\xednea base mitigadores:",t),dn("\u2717 Error al guardar la l\xednea base mitigadores","error",5e3)}finally{ur(!1)}},Qn=async(e,t)=>{if(!h||!Be)return console.error("No hay carpeta actual o an\xe1lisis Bowtie"),!1;try{const n=(e,t)=>e&&Array.isArray(e)?e.map((e,r)=>{if("causas"===t)return{codigo:e.codigo||"CA".concat(r+1),descripcion:e.descripcion||""};if("consecuencias"===t)return{codigo:e.codigo||"CO".concat(r+1),descripcion:e.descripcion||"",evento_no_deseado:e.evento_no_deseado||null,categoria:e.categoria||null};if("controles_preventivos"===t){const t=(e.causas_asociadas||[]).map(e=>"string"===typeof e?{codigo:e}:{codigo:e.codigo||e});return{codigo:e.codigo||"CCP".concat(r+1),descripcion:e.descripcion||"",criticidad:e.criticidad||null,jerarquia:e.jerarquia||null,causas_asociadas:t,dimensiones:e.dimensiones||[]}}if("controles_mitigadores"===t){const t=(e.consecuencias_asociadas||[]).map(e=>"string"===typeof e?{codigo:e}:{codigo:e.codigo||e});return{codigo:e.codigo||"CCM".concat(r+1),descripcion:e.descripcion||"",criticidad:e.criticidad||null,jerarquia:e.jerarquia||null,consecuencias_asociadas:t,dimensiones:e.dimensiones||[]}}return"controles_preventivos_generales"===t?{codigo:e.codigo||"CP".concat(r+1),nombre_control:e.nombre_control||e.descripcion||"",consecuencias:e.consecuencias||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||""}:"controles_mitigadores_generales"===t?{codigo:e.codigo||"CM".concat(r+1),nombre_control:e.nombre_control||e.descripcion||"",consecuencias:e.consecuencias||"",criticidad:e.criticidad||"",jerarquia:e.jerarquia||""}:{codigo:e.codigo||null,descripcion:e.descripcion||""}}):[],o={carpeta_id:h.id,usuario_id:d.id,evento_central:Be.evento_central||"",peligro:Be.peligro||"",energia:Be.energia||"",evento_top:Be.evento_top||"",causas:n("causas"===e?t:Be.causas||[],"causas"),controles_preventivos:n("controles_preventivos"===e?t:Be.controles_preventivos||[],"controles_preventivos"),consecuencias:n("consecuencias"===e?t:Be.consecuencias||[],"consecuencias"),controles_mitigadores:n("controles_mitigadores"===e?t:Be.controles_mitigadores||[],"controles_mitigadores"),controles_preventivos_generales:n("controles_preventivos_generales"===e?t:Be.controles_preventivos_generales||[],"controles_preventivos_generales"),controles_mitigadores_generales:n("controles_mitigadores_generales"===e?t:Be.controles_mitigadores_generales||[],"controles_mitigadores_generales")};console.log("=== GUARDANDO ".concat(e.toUpperCase()," ===")),console.log("Datos completos a enviar:",o),console.log("Array de ".concat(e," que se enviar\xe1 (").concat(o[e].length," elementos):"),o[e]),o[e].forEach((t,r)=>{console.log("  ".concat(e,"[").concat(r,"]:"),{codigo:t.codigo,descripcion:t.descripcion?t.descripcion.substring(0,50)+"...":"(vac\xedo)",descripcion_completa:t.descripcion,todas_las_propiedades:Object.keys(t)})}),console.log("Estado actual de analisisBowtie.".concat(e," (").concat((Be[e]||[]).length," elementos):"),Be[e]||[]),console.log("Par\xe1metro datosSeccion recibido (".concat(t.length," elementos):"),t);const a=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!a.ok){const e=await a.text();throw console.error("Error HTTP:",a.status,e),new Error("Error HTTP ".concat(a.status,": ").concat(e.substring(0,200)))}const i=await a.json();if(console.log("Respuesta del servidor:",i),i.success){if(await new Promise(e=>setTimeout(e,500)),h&&h.id){console.log("Recargando an\xe1lisis Bowtie despu\xe9s de guardar...");try{await On(h.id),console.log("An\xe1lisis recargado exitosamente"),await new Promise(e=>setTimeout(e,300))}catch(r){console.error("Error al recargar an\xe1lisis despu\xe9s de guardar:",r)}}return!0}{const e=i.error||"Error desconocido";return console.error("Error del servidor:",e),alert("Error al guardar: "+e),!1}}catch(r){return console.error("Error guardando ".concat(e,":"),r),alert("Error al guardar ".concat(e,": ").concat(r.message||r)),!1}},Zn=async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");const e=(Be.controles_preventivos||[]).filter(e=>e.descripcion&&""!==e.descripcion.trim());if(0!==e.length){console.log("Estado actual de controles preventivos antes de guardar:",Be.controles_preventivos),et(!0);try{await Qn("controles_preventivos",e)?(console.log("Controles preventivos guardados exitosamente"),ut(new Set),alert("Controles preventivos guardados correctamente.")):(console.error("Error al guardar controles preventivos"),alert("Error al guardar los controles preventivos. Por favor, intente nuevamente."))}catch(t){console.error("Error en guardarControlesPreventivos:",t),alert("Error al guardar los controles preventivos. Por favor, intente nuevamente.")}finally{et(!1)}}else alert("Debe agregar al menos un control preventivo con descripci\xf3n antes de guardar.")},eo=async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");const e=(Be.controles_mitigadores||[]).filter(e=>e.descripcion&&""!==e.descripcion.trim());if(0!==e.length){console.log("Estado actual de controles mitigadores antes de guardar:",Be.controles_mitigadores),rt(!0);try{await Qn("controles_mitigadores",e)?(console.log("Controles mitigadores guardados exitosamente"),ht(new Set),alert("Controles mitigadores guardados correctamente.")):(console.error("Error al guardar controles mitigadores"),alert("Error al guardar los controles mitigadores. Por favor, intente nuevamente."))}catch(t){console.error("Error en guardarControlesMitigadores:",t),alert("Error al guardar los controles mitigadores. Por favor, intente nuevamente.")}finally{rt(!1)}}else alert("Debe agregar al menos un control mitigador con descripci\xf3n antes de guardar.")},to=async()=>{if(h&&Oe)try{const e=await fetch("".concat(Te,"/archivos/carpetas.php"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h.id,nombre:h.nombre,descripcion:h.descripcion,usuario_id:d.id,evento_no_deseado:Oe.evento_no_deseado,evento_riesgo:Oe.evento_riesgo,controles_supervisor:JSON.stringify(Oe.controles_supervisor),controles_trabajador:JSON.stringify(Oe.controles_trabajador),informacion_riesgo:Oe.informacion_riesgo})}),t=await e.json();t.success?(alert("Informaci\xf3n de riesgo cr\xedtico guardada correctamente"),Le(!1),In(h.id)):alert("Error al guardar: "+(t.error||"Error desconocido"))}catch(e){console.error("Error guardando informaci\xf3n de riesgo:",e),alert("Error al guardar la informaci\xf3n de riesgo cr\xedtico")}},ro=(e,t)=>{if(!Oe)return;const r=Ue({},Oe);r["controles_".concat(e)][t].push({numero:"",descripcion:"",pregunta:"",respuesta:""}),Pe(r)},no=(e,t,r)=>{if(!Oe)return;const n=Ue({},Oe);n["controles_".concat(e)][t].splice(r,1),Pe(n)},oo=(e,t,r,n,o)=>{if(!Oe)return;const a=Ue({},Oe);a["controles_".concat(e)][t][r][n]=o,Pe(a)},ao=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t?t.trim():Rr?Ar.trim():Er.trim();if(!r)return;let n=null;e?n="object"===typeof e?e.id||null:e:Rr&&(n="object"===typeof Rr&&null!==Rr?Rr.id||null:"number"===typeof Rr?Rr:null);const o="number"===typeof(null===h||void 0===h?void 0:h.id)?h.id:parseInt(null===h||void 0===h?void 0:h.id)||null,a="number"===typeof(null===d||void 0===d?void 0:d.id)?d.id:parseInt(null===d||void 0===d?void 0:d.id)||null;try{const e={carpeta_id:o,usuario_id:a,mensaje:r,mensaje_padre_id:n},t=await fetch("".concat(Te,"/archivos/carpeta_mensajes.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=t.headers.get("content-type");let s;if(i&&i.includes("application/json"))s=await t.json();else{const e=await t.text();try{s=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!t.ok)throw new Error(s.error||"Error HTTP ".concat(t.status));s.success?(Tr(""),Nr(null),zr(""),n&&Or(e=>{const t=Ue({},e);return delete t[n],t}),An(h.id),dn("\u2713 Mensaje publicado correctamente","success")):s.error?dn("\u2717 Error al crear mensaje: "+s.error,"error",5e3):dn("\u2717 Error al crear mensaje: Respuesta inesperada del servidor","error",5e3)}catch(i){console.error("Error creando mensaje:",i);const e=i.message||"Error de conexi\xf3n";e.includes("circular")||e.includes("Converting")?dn("\u2717 Error al crear mensaje: Error de formato. Por favor, intente nuevamente.","error",5e3):dn("\u2717 Error al crear mensaje: "+e,"error",5e3)}},io=async(e,t)=>{try{const r=Pr.find(t=>t.id===e);if(!r)return void alert("Tarea no encontrada");const n=await fetch("".concat(Te,"/archivos/carpeta_tareas.php"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,titulo:r.titulo,descripcion:r.descripcion||"",estado:t,usuario_id:d.id})}),o=n.headers.get("content-type");let a;if(o&&o.includes("application/json"))a=await n.json();else{const e=await n.text();try{a=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!n.ok)throw new Error(a.error||"Error HTTP ".concat(n.status));a.success?zn(h.id):a.error?alert("Error al actualizar tarea: "+a.error):alert("Error al actualizar tarea: Respuesta inesperada del servidor")}catch(r){console.error("Error actualizando tarea:",r),alert("Error al actualizar tarea: "+(r.message||"Error de conexi\xf3n"))}},so=async()=>{k(!0);try{const e=new URLSearchParams({proyecto_id:s,carpeta_padre_id:h?h.id:0});l&&e.append("centro_costo_id",l),d&&d.id&&e.append("usuario_id",d.id);const t=await fetch("".concat(Te,"/archivos/carpetas.php?").concat(e));if(!t.ok){if(403===t.status){const e=await t.json().catch(()=>({error:"No tiene acceso a esta carpeta"}));return console.warn("Acceso denegado:",e.error),f([]),void k(!1)}throw new Error("Error HTTP ".concat(t.status))}const r=await t.json(),n=Array.isArray(r)?r:[];f(n);const o={};0!==yn.length&&1!==yn.length||await Promise.all(n.map(async e=>{try{const t=await fetch("".concat(Te,"/archivos/promedio_ponderacion.php?carpeta_id=").concat(e.id)),r=await t.json();r.success&&(o[e.id]=r.promedio_general)}catch(t){console.error("Error cargando promedio para carpeta ".concat(e.id,":"),t)}})),x(o)}catch(e){console.error("Error cargando carpetas:",e),f([])}k(!1)},lo=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let r="".concat(Te,"/archivos/archivos.php?carpeta_id=").concat(e);null!==t&&(r+="&archivos_carpeta_id=".concat(null===t?"root":t)),d&&d.id&&(r+="&usuario_id=".concat(d.id));const n=await fetch(r),o=await n.json();S(Array.isArray(o)?o:[])}catch(r){console.error("Error cargando archivos:",r),S([])}},co=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let r="".concat(Te,"/archivos/archivos_carpetas.php?carpeta_id=").concat(e);r+=null===t?"&carpeta_padre_id=null":"&carpeta_padre_id=".concat(t);const n=await fetch(r),o=await n.json();ae(Array.isArray(o)?o:[])}catch(r){console.error("Error cargando carpetas de archivos:",r),ae([])}},po=async e=>{if(null===e)se(null),ce([]),co(h.id,null),lo(h.id,"root");else{se(e);const t=le.findIndex(t=>t.id===e.id);ce(t>=0?le.slice(0,t+1):[...le,e]),co(h.id,e.id),lo(h.id,e.id)}},uo=function(e,t,r,n,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return new Promise((i,s)=>{const l=new FormData;l.append("archivo",e),l.append("carpeta_id",t),l.append("usuario_id",r),a&&l.append("archivos_carpeta_id",a);const c=new XMLHttpRequest;c.upload.addEventListener("progress",e=>{if(e.lengthComputable){const t=Math.round(e.loaded/e.total*100);te(e=>{const r=[...e];return r[n]&&(r[n]=Ue(Ue({},r[n]),{},{progreso:t})),r}),Z(e=>{if(!e)return e;const r=Math.round((100*n+t)/o);return Ue(Ue({},e),{},{progresoGeneral:r})})}}),c.addEventListener("load",()=>{if(200===c.status)try{const e=JSON.parse(c.responseText);e.success?(te(e=>{const t=[...e];return t[n]&&(t[n]=Ue(Ue({},t[n]),{},{progreso:100,estado:"completado"})),t}),Z(e=>e?Ue(Ue({},e),{},{completados:e.completados+1}):e),i(e)):(te(t=>{const r=[...t];return r[n]&&(r[n]=Ue(Ue({},r[n]),{},{estado:"error",error:e.error||"Error desconocido"})),r}),s(new Error(e.error||"Error al subir archivo")))}catch(Fh){te(e=>{const t=[...e];return t[n]&&(t[n]=Ue(Ue({},t[n]),{},{estado:"error",error:"Error al procesar respuesta"})),t}),s(new Error("Error al procesar respuesta del servidor"))}else te(e=>{const t=[...e];return t[n]&&(t[n]=Ue(Ue({},t[n]),{},{estado:"error",error:"Error HTTP ".concat(c.status)})),t}),s(new Error("Error HTTP ".concat(c.status)))}),c.addEventListener("error",()=>{te(e=>{const t=[...e];return t[n]&&(t[n]=Ue(Ue({},t[n]),{},{estado:"error",error:"Error de conexi\xf3n"})),t}),s(new Error("Error de conexi\xf3n"))}),c.open("POST","".concat(Te,"/archivos/archivos.php")),c.send(l)})},fo=async()=>{try{const e=await fetch("".concat(Te,"/listar_usuarios.php"));if(e.ok){const t=await e.json();fn(Array.isArray(t)?t:[])}else fn([])}catch(e){console.error("Error cargando usuarios:",e),fn([])}},ho=async e=>{try{const t=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php?carpeta_id=").concat(e));if(!t.ok){const e=await t.json().catch(()=>({error:"Error HTTP ".concat(t.status)}));return console.error("Error cargando usuarios asignados:",e.error||"HTTP ".concat(t.status)),void gn([])}const r=await t.json();gn(Array.isArray(r)?r:[])}catch(t){console.error("Error cargando usuarios asignados:",t),gn([])}};(0,o.useEffect)(()=>{T&&T.id&&ho(T.id)},[T]);const go=()=>{h&&(en(!0),(async e=>{if(e){on(!0);try{const t=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php?carpeta_id=").concat(e));if(!t.ok){const e=await t.json().catch(()=>({error:"Error HTTP ".concat(t.status)}));return console.error("Error cargando participantes:",e.error||"HTTP ".concat(t.status)),rn([]),void on(!1)}const r=await t.json();rn(Array.isArray(r)?r:[])}catch(t){console.error("Error cargando participantes:",t),rn([])}finally{on(!1)}}})(h.id))},mo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(fh(e)){const r=t.filter(e=>fh(e)),n=r.findIndex(t=>t.id===e.id);r.length>1?H({imagenes:r,indiceActual:n>=0?n:0}):L(e)}else L(e)},xo=e=>{if(!U)return;const{imagenes:t,indiceActual:r}=U;let n=r+e;n<0&&(n=t.length-1),n>=t.length&&(n=0),H(Ue(Ue({},U),{},{indiceActual:n}))};return w?(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh",fontSize:"18px",color:"#17a2b8"},children:"Cargando carpetas..."}):(0,ze.jsxs)("div",{style:{padding:"2rem",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",background:"white",padding:"1.5rem",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[h?(()=>{xh(h.nombre,h.id,h.color_primario,h.color_secundario);return(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[h.icono_url?(0,ze.jsx)("img",{src:hh(h.icono_url),alt:h.nombre,style:{width:"48px",height:"48px",objectFit:"contain",flexShrink:0},onError:e=>{e.target.style.display="none";const t=e.target.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,ze.jsx)("i",{className:"fa ".concat(h.cantidad_archivos>0||h.cantidad_subcarpetas>0?"fa-folder-open":"fa-folder"),style:{display:h.icono_url?"none":"flex",fontSize:"48px",color:"#F2A900",flexShrink:0}}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{style:{margin:0,color:"#17a2b8",fontSize:"24px",display:"flex",alignItems:"center",gap:"10px"},children:h.nombre}),(0,ze.jsx)("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Informaci\xf3n del Riesgo Cr\xedtico"})]})]})})():(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:0,color:"#17a2b8",fontSize:"24px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{color:"#F2A900"}}),"Gesti\xf3n de Archivos"]}),(0,ze.jsx)("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Organiza y gestiona archivos por proyecto y centro de costo"})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[h&&(0,ze.jsxs)("button",{onClick:()=>{h&&go()},style:{background:"#0ba360",color:"white",border:"none",padding:"10px 18px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 6px rgba(11, 163, 96, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-users"})," Participantes"]}),va(d)&&(0,ze.jsxs)("button",{onClick:()=>E(!0),style:{background:"#17a2b8",color:"white",border:"none",padding:"10px 20px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Crear Carpeta"]})]})]}),yn.length>0&&(0,ze.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"10px",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",flexWrap:"wrap"},children:[(0,ze.jsxs)("button",{onClick:()=>{g(null),jn([])},style:{background:"none",border:"none",color:"#17a2b8",cursor:"pointer",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-home"})," Inicio"]}),yn.map((e,t)=>(0,ze.jsxs)(o.Fragment,{children:[(0,ze.jsx)("span",{style:{color:"#999"},children:"/"}),(0,ze.jsx)("button",{onClick:()=>{const r=yn.slice(0,t+1);jn(r),g(e)},style:{background:"none",border:"none",color:t===yn.length-1?"#17a2b8":"#FF8C00",cursor:"pointer",fontSize:"14px",fontWeight:t===yn.length-1?"bold":"normal"},children:e.nombre})]},"ruta-".concat(e.id,"-").concat(t)))]}),1===yn.length&&(0,ze.jsxs)("button",{onClick:()=>{const e="".concat(Te,"/archivos/descargar_rc.php?carpeta_id=").concat(h.id);window.open(e,"_blank")},style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(40, 167, 69, 0.3)",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(40, 167, 69, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(40, 167, 69, 0.3)"},title:"Descargar todos los archivos de este RC como ZIP",children:[(0,ze.jsx)("i",{className:"fa fa-download"}),"Descargar RC"]})]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:u.map((e,t)=>{const r=(e.cantidad_archivos||0)+(e.cantidad_subcarpetas||0)>0,n=xh(e.nombre,e.id,e.color_primario,e.color_secundario);return(0,ze.jsxs)("div",{onClick:()=>(e=>{G(!1),g(e),jn([...yn,e])})(e),style:{background:"#ffffff",borderRadius:"12px",padding:"0",boxShadow:"0 2px 6px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04)",transition:"all 0.25s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",border:"2px solid ".concat(r?n.primary+"30":"rgba(0,0,0,0.08)"),overflow:"hidden",position:"relative",display:"flex",flexDirection:"column"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 20px ".concat(n.primary,"30, 0 4px 8px rgba(0,0,0,0.12)"),e.currentTarget.style.borderColor=n.primary},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04)",e.currentTarget.style.borderColor=r?n.primary+"30":"rgba(0,0,0,0.08)"},children:[(0,ze.jsxs)("div",{style:{background:r?"linear-gradient(135deg, ".concat(n.primary," 0%, ").concat(n.secondary," 100%)"):"linear-gradient(135deg, #e8e8e8 0%, #f0f0f0 100%)",padding:"1.25rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",minHeight:"100px"},children:[(0,ze.jsx)("div",{style:{position:"absolute",top:"-30%",right:"-30%",width:"150%",height:"150%",background:r?"radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 60%)":"none",pointerEvents:"none"}}),(0,ze.jsxs)("div",{style:{fontSize:"56px",color:r?"#ffffff":"#999",display:"flex",alignItems:"center",justifyContent:"center",width:"80px",height:"80px",background:r?"rgba(255,255,255,0.2)":"rgba(255,255,255,0.6)",borderRadius:"16px",position:"relative",zIndex:1,boxShadow:r?"0 6px 20px rgba(0,0,0,0.2)":"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",backdropFilter:"blur(10px)",border:r?"2px solid rgba(255,255,255,0.3)":"none"},children:[e.icono_url?(0,ze.jsx)("img",{src:hh(e.icono_url),alt:e.nombre,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"},onError:t=>{console.error("Error cargando icono:",{icono_url:e.icono_url,url_intentada:t.target.src,api_base:Te,app_url:Ae,base_url:Ne,window_origin:window.location.origin,window_pathname:window.location.pathname}),t.target.style.display="none";const r=t.target.parentElement.querySelector("i.fa");r&&(r.style.display="flex")}}):null,(0,ze.jsx)("i",{className:"fa ".concat(r?"fa-folder-open":"fa-folder"),style:{display:e.icono_url?"none":"flex",fontSize:"48px"}})]})]}),(0,ze.jsxs)("div",{style:{padding:"0.875rem 1rem",background:"#ffffff",flex:1,display:"flex",flexDirection:"column",gap:"8px"},children:[(0,ze.jsx)("h3",{style:{margin:"0",color:"#17a2b8",fontSize:"13px",fontWeight:"700",lineHeight:"1.3",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",minHeight:"34px"},children:e.nombre}),e.descripcion&&(0,ze.jsx)("p",{style:{margin:"0",color:"#666",fontSize:"10px",lineHeight:"1.3",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginTop:"auto",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"#e3f2fd",color:"#FF8C00",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{fontSize:"9px"}}),(0,ze.jsx)("span",{children:e.cantidad_archivos||0})]}),(0,ze.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"#fff3e0",color:"#f57c00",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{fontSize:"9px"}}),(0,ze.jsx)("span",{children:e.cantidad_subcarpetas||0})]}),(0===yn.length||1===yn.length)&&void 0!==m[e.id]&&null!==m[e.id]&&(0,ze.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:m[e.id]>=80?"#e8f5e9":m[e.id]>=50?"#fff9c4":"#ffebee",color:m[e.id]>=80?"#2e7d32":m[e.id]>=50?"#f57f17":"#c62828",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{fontSize:"9px"}}),(0,ze.jsxs)("span",{children:[m[e.id].toFixed(1),"%"]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f8f9fa",borderTop:"1px solid #f0f0f0"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",color:"#666",flex:1,minWidth:0},children:[(0,ze.jsx)("div",{style:{width:"22px",height:"22px",borderRadius:"50%",background:"linear-gradient(135deg, ".concat(n.primary," 0%, ").concat(n.secondary," 100%)"),display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:"9px",fontWeight:"600",flexShrink:0},children:e.creador_nombre?e.creador_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.creador_nombre?e.creador_nombre.split(" ")[0]:"Usuario"})]}),(ja(d)||_a(d)||d&&"super_admin"===d.rol)&&(0,ze.jsxs)("div",{style:{position:"relative"},children:[(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),Ee(Ce===e.id?null:e.id)},style:{background:Ce===e.id?"#495057":"#6c757d",color:"white",border:"none",padding:"6px 10px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"28px",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.15)"},onMouseEnter:t=>{Ce!==e.id&&(t.currentTarget.style.background="#5a6268")},onMouseLeave:t=>{Ce!==e.id&&(t.currentTarget.style.background="#6c757d")},title:"Acciones",children:(0,ze.jsx)("i",{className:"fa fa-ellipsis-v"})}),Ce===e.id&&(0,ze.jsxs)("div",{style:{position:"absolute",bottom:"100%",right:0,marginBottom:"4px",background:"white",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.25)",border:"1px solid #e0e0e0",minWidth:"160px",zIndex:9999,overflow:"visible"},onClick:e=>e.stopPropagation(),children:[ja(d)&&(0,ze.jsxs)("button",{onClick:t=>{t.stopPropagation(),P(e),Ee(null)},style:{width:"100%",padding:"10px 14px",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"13px",color:"#333",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="#f0f7ff",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,ze.jsx)("i",{className:"fa fa-pencil",style:{color:"#17a2b8",width:"16px"}}),"Editar"]}),1===yn.length&&ja(d)&&(0,ze.jsxs)("button",{onClick:t=>{t.stopPropagation(),je(e),ke(e.nombre+" (Copia)"),Ee(null)},style:{width:"100%",padding:"10px 14px",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"13px",color:"#333",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="#f5f0ff",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,ze.jsx)("i",{className:"fa fa-copy",style:{color:"#6f42c1",width:"16px"}}),"Duplicar"]}),d&&"super_admin"===d.rol&&(0,ze.jsxs)("button",{onClick:t=>{t.stopPropagation(),R(e),(async()=>{try{const e=await fetch("".concat(Te,"/empresas/empresas.php"));if(e.ok){const t=await e.json();I(Array.isArray(t)?t:[])}else I([])}catch(e){console.error("Error cargando empresas:",e),I([])}})(),A(""),Ee(null)},style:{width:"100%",padding:"10px 14px",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"13px",color:"#333",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="#f0fff4",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#28a745",width:"16px"}}),"Asignar usuarios"]}),_a(d)&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{height:"1px",background:"#eee",margin:"4px 0"}}),(0,ze.jsxs)("button",{onClick:t=>{t.stopPropagation(),Ee(null),(async e=>{const r=u.find(t=>t.id===e),n=r?r.nombre:"esta carpeta",o='\xbfEst\xe1s seguro de eliminar la carpeta "'.concat(n,'"?\n\n')+"\u26a0\ufe0f ADVERTENCIA: Esta acci\xf3n eliminar\xe1 en cascada:\n\u2022 Todos los archivos dentro de la carpeta\n\u2022 Todas las subcarpetas y su contenido\n\u2022 Los archivos f\xedsicos del servidor\n\nEsta acci\xf3n NO se puede deshacer.";if(window.confirm(o))try{const r="".concat(Te,"/archivos/carpetas.php?id=").concat(e,"&usuario_id=").concat(d.id);console.log("Eliminando carpeta, URL:",r),console.log("API_BASE:",Te);const o=await fetch(r,{method:"DELETE",headers:{Accept:"application/json"}});console.log("Respuesta recibida:",o.status,o.statusText);const a=o.headers.get("content-type");let i;if(a&&a.includes("application/json"))i=await o.json();else{const e=await o.text();console.log("Respuesta no JSON:",e.substring(0,500));try{i=JSON.parse(e)}catch(t){throw new Error("Respuesta no v\xe1lida del servidor (HTTP "+o.status+"): "+e.substring(0,200))}}o.ok&&i.success?(Sn({nombre:n,archivos:i.archivos_eliminados||0,subcarpetas:i.subcarpetas_eliminadas||0}),h&&h.id===e&&(g(null),jn([])),so()):alert("Error al eliminar carpeta: "+(i.error||"Error desconocido"))}catch(a){console.error("Error eliminando carpeta:",a),console.error("URL intentada:","".concat(Te,"/archivos/carpetas.php?id=").concat(e,"&usuario_id=").concat(d.id)),alert("Error al eliminar carpeta: "+(a.message||"Error de conexi\xf3n")+"\n\nVerifica la consola del navegador (F12) para m\xe1s detalles.")}})(e.id)},style:{width:"100%",padding:"10px 14px",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontSize:"13px",color:"#dc3545",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="#fff0f0",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,ze.jsx)("i",{className:"fa fa-trash",style:{width:"16px"}}),"Eliminar"]})]})]})]})]})]},"carpeta-".concat(e.id,"-").concat(t))})}),h&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:0,boxShadow:"0 4px 6px rgba(0,0,0,0.1)",overflow:"hidden"},children:[(0,ze.jsx)("div",{style:{display:"flex",borderBottom:"2px solid #e9ecef",background:"#f8f9fa"},children:Cn.map(e=>(0,ze.jsxs)("button",{onClick:()=>{Ie(e),"linea_base"===e&&h&&h.id&&(console.log("[L\xednea Base] Pesta\xf1a activada, recargando datos..."),Mn(h.id),Kn(h.id))},style:{flex:1,padding:"1rem 1.5rem",border:"none",background:Re===e?"white":"transparent",color:Re===e?"#17a2b8":"#808080",fontWeight:Re===e?"600":"500",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease",borderBottom:Re===e?"3px solid #17a2b8":"3px solid transparent",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",textTransform:"capitalize"},onMouseEnter:t=>{Re!==e&&(t.target.style.background="#f0f0f0")},onMouseLeave:t=>{Re!==e&&(t.target.style.background="transparent")},children:[(0,ze.jsx)("i",{className:"fa fa-".concat("archivos"===e?"file":"riesgo"===e?"exclamation-triangle":"bowtie"===e?"project-diagram":"diagrama"===e?"sitemap":"linea_base"===e?"chart-line":"guia"===e?"book":"foro"===e?"comments":"tasks")}),"archivos"===e?"Archivos":"riesgo"===e?"Riesgo Cr\xedtico":"bowtie"===e?"BOWTIE":"diagrama"===e?"Diagrama":"linea_base"===e?"Linea Base":"guia"===e?"Gu\xeda Controles Cr\xedticos":"foro"===e?"Foro":"Tareas","tareas"===e&&Pr.length>0&&(0,ze.jsx)("span",{style:{background:"#dc3545",color:"white",borderRadius:"12px",padding:"2px 6px",fontSize:"11px",fontWeight:"600",marginLeft:"4px"},children:Pr.filter(e=>"completada"!==e.estado).length})]},e))}),(0,ze.jsxs)("div",{style:{padding:"1.5rem"},children:["bowtie"===Re&&!wn&&(0,ze.jsx)("div",{children:h?Me?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",color:"#17a2b8"}}),(0,ze.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Cargando an\xe1lisis Bowtie..."})]}):(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[!Sh(d,yn)&&(0,ze.jsxs)("div",{style:{background:"#fff3cd",border:"1px solid #ffc107",borderRadius:"6px",padding:"0.75rem 1rem",color:"#856404",fontSize:"13px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle"}),(0,ze.jsx)("span",{children:"admin"===(null===d||void 0===d?void 0:d.rol)&&2!==yn.length?"Los administradores solo pueden editar el an\xe1lisis Bowtie en carpetas de nivel 2.":"Solo super administradores pueden editar el an\xe1lisis Bowtie. Este an\xe1lisis est\xe1 asociado a la carpeta ".concat((null===h||void 0===h?void 0:h.nombre)||"",".")})]}),(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:"1rem",borderBottom:"2px solid #e9ecef"},children:[(0,ze.jsxs)("h2",{style:{margin:0,color:"#17a2b8",fontSize:"24px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-project-diagram",style:{marginRight:"10px"}}),"An\xe1lisis Bowtie - ",h.nombre]}),Sh(d,yn)&&Be&&(0,ze.jsxs)("button",{onClick:async()=>{if(h&&Be)try{qe(!0);const e={carpeta_id:h.id,usuario_id:d.id,evento_central:Be.evento_central||"",peligro:Be.peligro||"",energia:Be.energia||"",evento_top:Be.evento_top||"",causas:Be.causas||[],controles_preventivos:Be.controles_preventivos||[],consecuencias:Be.consecuencias||[],controles_mitigadores:Be.controles_mitigadores||[],controles_preventivos_generales:Be.controles_preventivos_generales||[],controles_mitigadores_generales:Be.controles_mitigadores_generales||[]},t=await fetch("".concat(Te,"/archivos/carpeta_bowtie.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();r.success?(h&&h.id&&await On(h.id),console.log("An\xe1lisis Bowtie guardado correctamente")):alert("Error al guardar: "+(r.error||"Error desconocido"))}catch(e){console.error("Error guardando an\xe1lisis Bowtie:",e),alert("Error al guardar el an\xe1lisis Bowtie")}finally{qe(!1)}},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-save"}),"Guardar An\xe1lisis"]})]}),He&&(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:Ge?"0":"1rem",paddingBottom:Ge?"0":"0.75rem",borderBottom:Ge?"none":"3px solid #17a2b8",cursor:"pointer"},onClick:()=>Ye(!Ge),children:[(0,ze.jsxs)("h3",{style:{margin:0,fontSize:"20px",fontWeight:"700",color:"#17a2b8",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-book",style:{fontSize:"22px"}}),"Gu\xeda para Aplicar el An\xe1lisis Bowtie"]}),(0,ze.jsx)("button",{onClick:e=>{e.stopPropagation(),Ye(!Ge)},style:{background:"transparent",border:"none",color:"#17a2b8",fontSize:"18px",cursor:"pointer",padding:"0.25rem 0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},title:Ge?"Expandir gu\xeda":"Minimizar gu\xeda",children:(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(Ge?"down":"up")})})]}),!Ge&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-question-circle",style:{color:"#17a2b8"}}),"\xbfQu\xe9 es el An\xe1lisis Bowtie?"]}),(0,ze.jsxs)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8",paddingLeft:"2rem"},children:[(0,ze.jsxs)("p",{style:{marginBottom:"0.75rem"},children:["El ",(0,ze.jsx)("strong",{children:"an\xe1lisis Bowtie"})," es una metodolog\xeda visual de gesti\xf3n de riesgos que permite identificar y evaluar de manera integral los riesgos cr\xedticos asociados a una actividad o proceso. Su nombre proviene de la forma de corbata (bowtie) que adopta el diagrama cuando se visualiza."]}),(0,ze.jsxs)("p",{style:{marginBottom:0},children:["Este m\xe9todo ayuda a comprender la relaci\xf3n entre las ",(0,ze.jsx)("strong",{children:"causas"})," que pueden generar un evento no deseado, los ",(0,ze.jsx)("strong",{children:"controles preventivos"})," que evitan que ocurra, las ",(0,ze.jsx)("strong",{children:"consecuencias"})," si el evento se materializa, y los ",(0,ze.jsx)("strong",{children:"controles mitigadores"})," que reducen el impacto."]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-sitemap",style:{color:"#17a2b8"}}),"Estructura del Diagrama Bowtie"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8",paddingLeft:"2rem"},children:(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"1px solid #dee2e6",marginBottom:"0.75rem"},children:(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%)",padding:"1rem",borderRadius:"6px",border:"2px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{fontWeight:"700",color:"#0c5460",marginBottom:"0.5rem",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-arrow-left",style:{marginRight:"6px"}}),"LADO IZQUIERDO"]}),(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"13px",color:"#0c5460",lineHeight:"1.8"},children:[(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Causas:"})," Factores o condiciones que pueden provocar el evento central"]}),(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Controles Preventivos:"})," Medidas que evitan que las causas generen el evento"]})]})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%)",padding:"1rem",borderRadius:"6px",border:"2px solid #dc3545",gridColumn:"span 2",textAlign:"center"},children:[(0,ze.jsxs)("div",{style:{fontWeight:"700",color:"#721c24",marginBottom:"0.5rem",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{marginRight:"6px"}}),"EVENTO CENTRAL"]}),(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#721c24"},children:"El peligro principal o evento no deseado que se quiere prevenir o mitigar"})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%)",padding:"1rem",borderRadius:"6px",border:"2px solid #FF8C00",marginTop:"1rem"},children:[(0,ze.jsxs)("div",{style:{fontWeight:"700",color:"#856404",marginBottom:"0.5rem",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-arrow-right",style:{marginRight:"6px"}}),"LADO DERECHO"]}),(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"13px",color:"#856404",lineHeight:"1.8"},children:[(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Consecuencias:"})," Impactos que resultan si el evento central ocurre"]}),(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Controles Mitigadores:"})," Medidas que reducen la severidad de las consecuencias"]})]})]})]})})})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-list-ol",style:{color:"#17a2b8"}}),"Pasos para Realizar el An\xe1lisis Bowtie"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8",paddingLeft:"2rem"},children:(0,ze.jsxs)("ol",{style:{margin:0,paddingLeft:"1.5rem"},children:[(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"Identificar el Evento Central:"})," Defina claramente el peligro principal o evento no deseado que se quiere analizar. Debe ser espec\xedfico y relacionado con el riesgo cr\xedtico de la carpeta."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"Identificar las Causas:"})," Liste todas las causas posibles que pueden provocar el evento central. Piense en factores humanos, t\xe9cnicos, organizacionales y ambientales."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"Definir Controles Preventivos:"})," Para cada causa, identifique los controles cr\xedticos preventivos que evitan que la causa genere el evento central. Estos controles deben ser espec\xedficos y verificables."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"Identificar las Consecuencias:"})," Determine las posibles consecuencias si el evento central ocurre. Considere impactos en personas, equipos, medio ambiente y operaciones."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"Definir Controles Mitigadores:"})," Para cada consecuencia, establezca los controles cr\xedticos mitigadores que reducen la severidad del impacto. Estos controles act\xfaan despu\xe9s de que el evento ocurre."]}),(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Revisar y Validar:"})," Revise el an\xe1lisis completo con el equipo de trabajo y valide que todos los controles est\xe1n correctamente identificados y son efectivos."]})]})})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{color:"#17a2b8"}}),"Mejores Pr\xe1cticas"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8",paddingLeft:"2rem"},children:(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[(0,ze.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,ze.jsx)("strong",{children:"Sea espec\xedfico:"})," Evite descripciones gen\xe9ricas. Cada causa, consecuencia y control debe ser claro y espec\xedfico."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,ze.jsx)("strong",{children:"Involucre al equipo:"})," El an\xe1lisis debe realizarse con la participaci\xf3n de trabajadores, supervisores y especialistas en seguridad."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,ze.jsx)("strong",{children:"Base en evidencia:"})," Utilice informaci\xf3n de incidentes previos, an\xe1lisis de riesgos y experiencia del equipo."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,ze.jsx)("strong",{children:"Revise regularmente:"})," El an\xe1lisis Bowtie debe actualizarse cuando cambien las condiciones de trabajo o se identifiquen nuevos riesgos."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,ze.jsx)("strong",{children:"Conecte con controles cr\xedticos:"}),' Los controles identificados en el Bowtie deben estar alineados con los controles cr\xedticos definidos en la pesta\xf1a "Riesgo Cr\xedtico".']}),(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"Documente claramente:"})," Aseg\xfarese de que las descripciones sean comprensibles para todos los niveles de la organizaci\xf3n."]})]})})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-lightbulb",style:{color:"#FF8C00"}}),"Ejemplo de Estructura"]}),(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"1px solid #dee2e6",fontSize:"13px",color:"#495057",lineHeight:"1.8"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{style:{color:"#dc3545"},children:"Evento Central:"}),' "Contacto con energ\xeda el\xe9ctrica durante trabajos en equipos energizados"']}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{style:{color:"#17a2b8"},children:"Causa:"}),' "Equipo energizado sin se\xf1alizaci\xf3n adecuada"',(0,ze.jsxs)("div",{style:{marginLeft:"1rem",marginTop:"0.25rem",fontSize:"12px"},children:[(0,ze.jsx)("strong",{children:"Control Preventivo:"}),' "Verificar se\xf1alizaci\xf3n de \xe1rea restringida antes de iniciar trabajo"']})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{style:{color:"#FF8C00"},children:"Consecuencia:"}),' "Lesi\xf3n grave o fatal por electrocuci\xf3n"',(0,ze.jsxs)("div",{style:{marginLeft:"1rem",marginTop:"0.25rem",fontSize:"12px"},children:[(0,ze.jsx)("strong",{children:"Control Mitigador:"}),' "Equipo de respuesta a emergencias disponible y entrenado"']})]})]})]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.75rem",marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"0.75rem",borderRadius:"6px",border:"1px solid #17a2b8"},children:[(0,ze.jsx)("div",{style:{color:"#17a2b8",fontSize:"11px",fontWeight:"600",marginBottom:"0.4rem",textTransform:"uppercase"},children:"Peligro"}),Sh(d,yn)&&Be?(0,ze.jsx)("textarea",{value:Be.peligro||"",onChange:e=>Fe(Ue(Ue({},Be),{},{peligro:e.target.value})),placeholder:"Ingrese el peligro identificado...",style:{width:"100%",minHeight:"50px",maxHeight:"100px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"13px",color:"#212529",background:"#f8f9fa",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#495057",minHeight:"30px",padding:"0.4rem",lineHeight:"1.5"},children:(null===Be||void 0===Be?void 0:Be.peligro)||"No especificado"})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"0.75rem",borderRadius:"6px",border:"1px solid #17a2b8"},children:[(0,ze.jsx)("div",{style:{color:"#17a2b8",fontSize:"11px",fontWeight:"600",marginBottom:"0.4rem",textTransform:"uppercase"},children:"Energ\xeda(s)"}),Sh(d,yn)&&Be?(0,ze.jsx)("textarea",{value:Be.energia||"",onChange:e=>Fe(Ue(Ue({},Be),{},{energia:e.target.value})),placeholder:"Ingrese la(s) energ\xeda(s) asociada(s)...",style:{width:"100%",minHeight:"50px",maxHeight:"100px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"13px",color:"#212529",background:"#f8f9fa",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#495057",minHeight:"30px",padding:"0.4rem",lineHeight:"1.5"},children:(null===Be||void 0===Be?void 0:Be.energia)||"No especificado"})]}),(0,ze.jsxs)("div",{style:{background:"#dc3545",padding:"0.75rem",borderRadius:"6px",border:"2px solid #dc3545"},children:[(0,ze.jsx)("div",{style:{color:"white",fontSize:"11px",fontWeight:"600",marginBottom:"0.4rem",textTransform:"uppercase",textAlign:"center"},children:"Evento Top"}),Sh(d,yn)&&Be?(0,ze.jsx)("textarea",{value:Be.evento_top||"",onChange:e=>Fe(Ue(Ue({},Be),{},{evento_top:e.target.value})),placeholder:"Ingrese el Evento Top...",style:{width:"100%",minHeight:"50px",maxHeight:"100px",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.3)",fontSize:"13px",fontWeight:"500",color:"#212529",background:"white",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{color:"white",fontSize:"13px",fontWeight:"600",minHeight:"30px",padding:"0.4rem",textAlign:"center",lineHeight:"1.5"},children:(null===Be||void 0===Be?void 0:Be.evento_top)||"No especificado"})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginTop:"1rem"},children:[(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #17a2b8"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#17a2b8",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-arrow-left",style:{marginRight:"8px"}}),"Causas"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{causas:!e.causas})),style:{background:"transparent",border:"none",color:"#17a2b8",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.causas?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.causas?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.causas&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #17a2b8"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:101},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Causas"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#17a2b8",width:"50px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100}})]})}),(0,ze.jsx)("tbody",{children:(()=>{const e=(null===Be||void 0===Be?void 0:Be.causas)||[];return e.length>0?e.map((e,t)=>{const r=e.codigo||"CA".concat(t+1),n=!!e.id,o=st.has(e.id)||!n,a=Sh(d,yn)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=e.target.value.toUpperCase().trim();if(""===r||r.match(/^CA\d+$/)){const e=[...Be.causas];e[t]=Ue(Ue({},e[t]),{},{codigo:r}),Fe(Ue(Ue({},Be),{},{causas:e}))}},onBlur:e=>{const r=e.target.value.toUpperCase().trim();if(r&&r.match(/^CA\d+$/)){const e=Be.causas.map((e,r)=>r!==t?e.codigo:null).filter(e=>e&&e.match(/^CA\d+$/i));if(e.includes(r)){const n=e.map(e=>{const t=e.match(/^CA(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let o=1;for(;n.includes(o);)o++;const a="CA".concat(o),i=[...Be.causas];i[t]=Ue(Ue({},i[t]),{},{codigo:a}),Fe(Ue(Ue({},Be),{},{causas:i})),alert("El c\xf3digo ".concat(r," ya est\xe1 en uso. Se asign\xf3 ").concat(a," autom\xe1ticamente."))}}},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.descripcion||"",onChange:e=>{const r=[...Be.causas];r[t]=Ue(Ue({},r[t]),{},{descripcion:e.target.value}),Fe(Ue(Ue({},Be),{},{causas:r}))},placeholder:"Descripci\xf3n de la causa...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.descripcion||"Sin descripci\xf3n"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsx)("button",{onClick:()=>{lt(t=>new Set([...t,e.id]))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.4rem 0.6rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px",marginRight:"0.25rem"},title:"Editar causa",children:(0,ze.jsx)("i",{className:"fa fa-edit"})}):null,(0,ze.jsx)("button",{onClick:()=>{if(n&&o)lt(t=>{const r=new Set(t);return r.delete(e.id),r}),h&&h.id&&On(h.id);else{const e=Be.causas.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{causas:e}))}},style:{background:o?"#6c757d":"#dc3545",color:"white",border:"none",padding:"0.4rem 0.6rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},title:o?"Cancelar edici\xf3n":"Eliminar causa",children:(0,ze.jsx)("i",{className:"fa ".concat(o?"fa-times":"fa-trash")})})]})]},"causa-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:Sh(d,yn)&&Be?3:2,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"13px"},children:["No hay causas registradas. ",Sh(d,yn)&&Be&&'Haz clic en "Agregar Causa" para comenzar.']})})})()})]})}),(null===Be||void 0===Be?void 0:Be.causas)&&Be.causas.length>0&&Be.causas.some(e=>e.controles_preventivos&&e.controles_preventivos.length>0)&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#17a2b8",marginBottom:"0.5rem"},children:"Controles Preventivos por Causa:"}),Be.causas.map((e,t)=>e.controles_preventivos&&e.controles_preventivos.length>0&&(0,ze.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"12px",color:"#495057"},children:[(0,ze.jsxs)("strong",{children:[e.codigo||"CA".concat(t+1),":"]})," ",e.controles_preventivos.map(e=>e.descripcion).join(", ")]},t))]}),Sh(d,yn)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=(Be.causas||[]).map(e=>e.codigo).filter(e=>e&&e.match(/^CA\d+$/i)).map(e=>{const t=e.match(/^CA(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let t=1;for(;e.includes(t);)t++;const r="CA".concat(t),n=[...Be.causas||[],{codigo:r,descripcion:"",controles_preventivos:[]}];Fe(Ue(Ue({},Be),{},{causas:n}))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Causa"]}),(0,ze.jsxs)("button",{onClick:async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");if(0!==(Be.causas||[]).filter(e=>e.descripcion&&e.descripcion.trim().length>0).length){console.log("Estado actual de causas antes de guardar:",Be.causas),Ke(!0);try{const e=(Be.causas||[]).filter(e=>e.descripcion&&e.descripcion.trim().length>0);await Qn("causas",e)?(console.log("Causas guardadas exitosamente"),lt(new Set),alert("Causas guardadas correctamente.")):(console.error("Error al guardar causas"),alert("Error al guardar las causas. Por favor, intente nuevamente."))}catch(e){console.error("Excepci\xf3n al guardar causas:",e),alert("Error al guardar las causas: "+(e.message||e))}finally{Ke(!1)}}else alert("Debe agregar al menos una causa con descripci\xf3n antes de guardar.")},disabled:Xe,style:{background:Xe?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:Xe?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:Xe?.7:1},title:"Guardar cambios de Causas",children:[(0,ze.jsx)("i",{className:"fa ".concat(Xe?"fa-spinner fa-spin":"fa-save")})," ",Xe?"Guardando...":"Guardar Causas"]})]})]})]})}),(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #FF8C00",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#FF8C00",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-arrow-right",style:{marginRight:"8px"}}),"Consecuencias"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{consecuencias:!e.consecuencias})),style:{background:"transparent",border:"none",color:"#FF8C00",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.consecuencias?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.consecuencias?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.consecuencias&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:101},children:"N\xb0"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Evento no deseado"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Consecuencia"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Categor\xeda"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#FF8C00",width:"50px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100}})]})}),(0,ze.jsx)("tbody",{children:null!==Be&&void 0!==Be&&Be.consecuencias&&Be.consecuencias.length>0?Be.consecuencias.map((e,t)=>{const r=e.codigo||"CO".concat(t+1),n=!!e.id,o=ct&&ct.has(e.id)||!n,a=Sh(d,yn)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=e.target.value.toUpperCase().trim();if(""===r||r.match(/^CO\d+$/)){const e=[...Be.consecuencias];e[t]=Ue(Ue({},e[t]),{},{codigo:r}),Fe(Ue(Ue({},Be),{},{consecuencias:e}))}},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.evento_no_deseado||"",onChange:e=>{const r=[...Be.consecuencias];r[t]=Ue(Ue({},r[t]),{},{evento_no_deseado:e.target.value}),Fe(Ue(Ue({},Be),{},{consecuencias:r}))},placeholder:"Evento no deseado...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.evento_no_deseado||"Sin evento no deseado"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.descripcion||"",onChange:e=>{const r=[...Be.consecuencias];r[t]=Ue(Ue({},r[t]),{},{descripcion:e.target.value}),Fe(Ue(Ue({},Be),{},{consecuencias:r}))},placeholder:"Descripci\xf3n de la consecuencia...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.descripcion||"Sin descripci\xf3n"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.categoria||"",onChange:e=>{const r=[...Be.consecuencias];r[t]=Ue(Ue({},r[t]),{},{categoria:e.target.value}),Fe(Ue(Ue({},Be),{},{consecuencias:r}))},placeholder:"Ej: SSO",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.categoria||"Sin categor\xeda"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsx)("button",{onClick:()=>{ct||dt(new Set),dt(t=>new Set(t).add(e.id))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Editar consecuencia",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}):o?(0,ze.jsx)("button",{onClick:()=>{ct&&(dt(t=>{const r=new Set(t);return r.delete(e.id),r}),On(h.id))},style:{background:"#6c757d",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Cancelar edici\xf3n",children:(0,ze.jsx)("i",{className:"fa fa-times"})}):null,n&&!o?(0,ze.jsx)("button",{onClick:()=>{const e=Be.consecuencias.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{consecuencias:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar consecuencia",children:(0,ze.jsx)("i",{className:"fa fa-trash"})}):n?null:(0,ze.jsx)("button",{onClick:()=>{const e=Be.consecuencias.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{consecuencias:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar consecuencia",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},"consecuencia-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:Sh(d,yn)&&Be?5:4,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"12px"},children:["No hay consecuencias registradas. ",Sh(d,yn)&&Be&&'Haz clic en "Agregar Consecuencia" para comenzar.']})})})]})}),(null===Be||void 0===Be?void 0:Be.consecuencias)&&Be.consecuencias.length>0&&Be.consecuencias.some(e=>e.controles_mitigadores&&e.controles_mitigadores.length>0)&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#FF8C00",marginBottom:"0.5rem"},children:"Controles Mitigadores por Consecuencia:"}),Be.consecuencias.map((e,t)=>e.controles_mitigadores&&e.controles_mitigadores.length>0&&(0,ze.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"12px",color:"#495057"},children:[(0,ze.jsxs)("strong",{children:[e.codigo||"CO".concat(t+1),":"]})," ",e.controles_mitigadores.map(e=>e.descripcion).join(", ")]},t))]}),Sh(d,yn)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=(Be.consecuencias||[]).map(e=>e.codigo).filter(e=>e&&e.match(/^CO\d+$/i)).map(e=>{const t=e.match(/^CO(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let t=1;for(;e.includes(t);)t++;const r="CO".concat(t),n=[...Be.consecuencias||[],{codigo:r,descripcion:"",evento_no_deseado:"",categoria:"",controles_mitigadores:[]}];Fe(Ue(Ue({},Be),{},{consecuencias:n}))},style:{background:"#FF8C00",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Consecuencia"]}),(0,ze.jsxs)("button",{onClick:async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");const e=(Be.consecuencias||[]).filter(e=>e.descripcion&&""!==e.descripcion.trim());if(0!==e.length){console.log("Estado actual de consecuencias antes de guardar:",Be.consecuencias),Qe(!0);try{await Qn("consecuencias",e)?(console.log("Consecuencias guardadas exitosamente"),dt(new Set),alert("Consecuencias guardadas correctamente.")):(console.error("Error al guardar consecuencias"),alert("Error al guardar las consecuencias. Por favor, intente nuevamente."))}catch(t){console.error("Error en guardarConsecuencias:",t),alert("Error al guardar las consecuencias. Por favor, intente nuevamente.")}finally{Qe(!1)}}else alert("Debe agregar al menos una consecuencia con descripci\xf3n antes de guardar.")},disabled:Je,style:{background:Je?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:Je?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:Je?.7:1},title:"Guardar cambios de Consecuencias",children:[(0,ze.jsx)("i",{className:"fa ".concat(Je?"fa-spinner fa-spin":"fa-save")})," ",Je?"Guardando...":"Guardar Consecuencias"]})]})]})]})})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginTop:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #28a745",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #28a745"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#28a745",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-shield-alt",style:{marginRight:"8px"}}),"Controles Cr\xedticos Preventivos"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{controles_preventivos_criticos:!e.controles_preventivos_criticos})),style:{background:"transparent",border:"none",color:"#28a745",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.controles_preventivos_criticos?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.controles_preventivos_criticos?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.controles_preventivos_criticos&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #28a745"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:101},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#28a745",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Controles Cr\xedticos Preventivos"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"150px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Causas"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Jerarqu\xeda"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#28a745",width:"50px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100}})]})}),(0,ze.jsx)("tbody",{children:null!==Be&&void 0!==Be&&Be.controles_preventivos&&Be.controles_preventivos.length>0?Be.controles_preventivos.map((e,t)=>{const r=e.codigo||"CCP".concat(t+1),n=!!e.id,o=pt.has(e.id)||!n,a=Sh(d,yn)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=[...Be.controles_preventivos];r[t]=Ue(Ue({},r[t]),{},{codigo:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos:r}))},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.descripcion||"",onChange:e=>{const r=[...Be.controles_preventivos];r[t]=Ue(Ue({},r[t]),{},{descripcion:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos:r}))},placeholder:"Descripci\xf3n del control preventivo...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.descripcion||"Sin descripci\xf3n"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:(e.causas_asociadas||[]).map(e=>e.codigo||"CA".concat(e.index+1)).join(" - ")||"",onChange:e=>{const r=e.target.value.split("-").map(e=>e.trim()).filter(e=>e).map(e=>{const t=Be.causas.findIndex(t=>(t.codigo||"CA".concat(Be.causas.indexOf(t)+1))===e);return t>=0?{codigo:e,index:t}:{codigo:e}}),n=[...Be.controles_preventivos];n[t]=Ue(Ue({},n[t]),{},{causas_asociadas:r}),Fe(Ue(Ue({},Be),{},{controles_preventivos:n}))},placeholder:"CA1 - CA2 - CA3...",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:(e.causas_asociadas||[]).map(e=>e.codigo||"CA".concat(e.index+1)).join(" - ")||"Sin asociar"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.criticidad||"",onChange:e=>{const r=[...Be.controles_preventivos];r[t]=Ue(Ue({},r[t]),{},{criticidad:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos:r}))},placeholder:"Ej: Cr\xedtico, No cr\xedtico",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.criticidad||""})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.jerarquia||"",onChange:e=>{const r=[...Be.controles_preventivos];r[t]=Ue(Ue({},r[t]),{},{jerarquia:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos:r}))},placeholder:"Ej: Aislamiento, Administrativo",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.jerarquia||"Sin jerarqu\xeda"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>{yr({control:e,tipo:"preventivo"})},style:{background:"#ffc107",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Ver dimensiones, preguntas y evidencias",children:(0,ze.jsx)("i",{className:"fa fa-search"})}),(0,ze.jsx)("button",{onClick:()=>{mr({controlId:e.id,controlIndex:t,control:e,tipo:"preventivo"})},style:{background:"#6f42c1",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Gestionar dimensiones, preguntas y evidencias",children:(0,ze.jsx)("i",{className:"fa fa-list-ul"})}),(0,ze.jsx)("button",{onClick:()=>{pt||ut(new Set),ut(t=>new Set(t).add(e.id))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Editar control",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})})]}):o?(0,ze.jsx)("button",{onClick:()=>{pt&&(ut(t=>{const r=new Set(t);return r.delete(e.id),r}),On(h.id))},style:{background:"#6c757d",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Cancelar edici\xf3n",children:(0,ze.jsx)("i",{className:"fa fa-times"})}):null,n&&!o?(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_preventivos.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_preventivos:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})}):n?null:(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_preventivos.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_preventivos:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},"control-preventivo-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:Sh(d,yn)&&Be?6:5,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"12px"},children:["No hay controles preventivos registrados. ",Sh(d,yn)&&Be&&'Haz clic en "Agregar Control" para comenzar.']})})})]})}),Sh(d,yn)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=(Be.controles_preventivos||[]).map(e=>e.codigo).filter(e=>e&&e.match(/^CCP\d+$/i)).map(e=>{const t=e.match(/^CCP(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let t=1;for(;e.includes(t);)t++;const r="CCP".concat(t),n=[...Be.controles_preventivos||[],{codigo:r,descripcion:"",criticidad:"",jerarquia:"",causas_asociadas:[]}];Fe(Ue(Ue({},Be),{},{controles_preventivos:n}))},style:{background:"#28a745",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control"]}),(0,ze.jsxs)("button",{onClick:Zn,disabled:Ze,style:{background:Ze?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:Ze?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:Ze?.7:1},title:"Guardar cambios de Controles Preventivos",children:[(0,ze.jsx)("i",{className:"fa ".concat(Ze?"fa-spinner fa-spin":"fa-save")})," ",Ze?"Guardando...":"Guardar Controles Preventivos"]})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #0d6efd",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #0d6efd"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#0d6efd",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-clipboard-list",style:{marginRight:"8px"}}),"CONTROLES PREVENTIVOS"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{controles_preventivos_generales:!e.controles_preventivos_generales})),style:{background:"transparent",border:"none",color:"#0d6efd",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.controles_preventivos_generales?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.controles_preventivos_generales?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.controles_preventivos_generales&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #0d6efd"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#0d6efd",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:101},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#0d6efd",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Nombre Control"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#0d6efd",width:"200px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Consecuencias"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#0d6efd",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#0d6efd",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Jerarqu\xeda"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#0d6efd",width:"50px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100}})]})}),(0,ze.jsx)("tbody",{children:null!==Be&&void 0!==Be&&Be.controles_preventivos_generales&&Be.controles_preventivos_generales.length>0?Be.controles_preventivos_generales.map((e,t)=>{const r=e.codigo||"CP".concat(t+1),n=!!e.id,o=gt.has(e.id)||!n,a=Sh(d,yn)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=e.target.value.trim();if((Be.controles_preventivos_generales||[]).some((e,n)=>n!==t&&e.codigo&&e.codigo.trim().toUpperCase()===r.toUpperCase())&&""!==r)return void alert('El c\xf3digo "'.concat(r,'" ya existe. Los c\xf3digos deben ser \xfanicos.'));const n=[...Be.controles_preventivos_generales];n[t]=Ue(Ue({},n[t]),{},{codigo:r}),Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:n}))},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.nombre_control||"",onChange:e=>{const r=[...Be.controles_preventivos_generales];r[t]=Ue(Ue({},r[t]),{},{nombre_control:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:r}))},placeholder:"Nombre o descripci\xf3n del control preventivo...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.nombre_control||"Sin nombre"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.consecuencias||"",onChange:e=>{const r=[...Be.controles_preventivos_generales];r[t]=Ue(Ue({},r[t]),{},{consecuencias:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:r}))},placeholder:"Consecuencias asociadas...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",whiteSpace:"pre-line"},children:e.consecuencias||"Sin consecuencias registradas"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.criticidad||"",onChange:e=>{const r=[...Be.controles_preventivos_generales];r[t]=Ue(Ue({},r[t]),{},{criticidad:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:r}))},placeholder:"Ej: Cr\xedtico, Medio...",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.criticidad||"Sin criticidad"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.jerarquia||"",onChange:e=>{const r=[...Be.controles_preventivos_generales];r[t]=Ue(Ue({},r[t]),{},{jerarquia:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:r}))},placeholder:"Ej: Aislamiento, Administrativo",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.jerarquia||"Sin jerarqu\xeda"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsx)("button",{onClick:()=>{gt||mt(new Set),mt(t=>new Set(t).add(e.id))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Editar control",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}):o?(0,ze.jsx)("button",{onClick:()=>{gt&&(mt(t=>{const r=new Set(t);return r.delete(e.id),r}),On(h.id))},style:{background:"#6c757d",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Cancelar edici\xf3n",children:(0,ze.jsx)("i",{className:"fa fa-times"})}):null,(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_preventivos_generales.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},"control-preventivo-general-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:Sh(d,yn)&&Be?6:5,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"12px"},children:["No hay controles preventivos generales registrados. ",Sh(d,yn)&&Be&&'Haz clic en "Agregar Control" para comenzar.']})})})]})}),Sh(d,yn)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=Be.controles_preventivos_generales||[],t=e.map(e=>e.codigo).filter(e=>e&&""!==e.trim()),r=t.filter(e=>e.match(/^CP\d+$/i)).map(e=>{const t=e.match(/^CP(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let n=1;for(;r.includes(n);)n++;const o="CP".concat(n);if(t.includes(o))return void alert("El c\xf3digo ".concat(o," ya existe. Por favor, elimine los duplicados primero."));const a=[...e,{codigo:o,nombre_control:"",consecuencias:"",criticidad:"",jerarquia:""}];Fe(Ue(Ue({},Be),{},{controles_preventivos_generales:a}))},style:{background:"#0d6efd",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control"]}),(0,ze.jsxs)("button",{onClick:async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");const e=(Be.controles_preventivos_generales||[]).filter(e=>e.nombre_control&&""!==e.nombre_control.trim());if(0!==e.length){ot(!0);try{await Qn("controles_preventivos_generales",e)?(mt(new Set),alert("Controles preventivos generales guardados correctamente.")):alert("Error al guardar los controles preventivos generales. Por favor, intente nuevamente.")}catch(t){console.error("Error en guardarControlesPreventivosGenerales:",t),alert("Error al guardar los controles preventivos generales. Por favor, intente nuevamente.")}finally{ot(!1)}}else alert("Debe agregar al menos un control preventivo general con nombre antes de guardar.")},disabled:nt,style:{background:nt?"#6c757d":"#0d6efd",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:nt?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:nt?.7:1},title:"Guardar cambios de Controles Preventivos",children:[(0,ze.jsx)("i",{className:"fa ".concat(nt?"fa-spinner fa-spin":"fa-save")})," ",nt?"Guardando...":"Guardar Controles Preventivos"]})]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #FF8C00",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#FF8C00",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-shield-alt",style:{marginRight:"8px"}}),"Controles Cr\xedticos Mitigadores"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{controles_mitigadores_criticos:!e.controles_mitigadores_criticos})),style:{background:"transparent",border:"none",color:"#FF8C00",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.controles_mitigadores_criticos?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.controles_mitigadores_criticos?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.controles_mitigadores_criticos&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:101},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Controles Cr\xedticos Mitigadores"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"150px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Consecuencias"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100},children:"Jerarqu\xeda"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#FF8C00",width:"50px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100}})]})}),(0,ze.jsx)("tbody",{children:null!==Be&&void 0!==Be&&Be.controles_mitigadores&&Be.controles_mitigadores.length>0?Be.controles_mitigadores.map((e,t)=>{const r=e.codigo||"CCM".concat(t+1),n=!!e.id,o=ft.has(e.id)||!n,a=ja(d)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=[...Be.controles_mitigadores];r[t]=Ue(Ue({},r[t]),{},{codigo:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores:r}))},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.descripcion||"",onChange:e=>{const r=[...Be.controles_mitigadores];r[t]=Ue(Ue({},r[t]),{},{descripcion:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores:r}))},placeholder:"Descripci\xf3n del control mitigador...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.descripcion||"Sin descripci\xf3n"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:(e.consecuencias_asociadas||[]).map(e=>e.codigo||"CO".concat(e.index+1)).join(" - ")||"",onChange:e=>{const r=e.target.value.split("-").map(e=>e.trim()).filter(e=>e).map(e=>{const t=Be.consecuencias.findIndex(t=>(t.codigo||"CO".concat(Be.consecuencias.indexOf(t)+1))===e);return t>=0?{codigo:e,index:t}:{codigo:e}}),n=[...Be.controles_mitigadores];n[t]=Ue(Ue({},n[t]),{},{consecuencias_asociadas:r}),Fe(Ue(Ue({},Be),{},{controles_mitigadores:n}))},placeholder:"CO1 - CO2 - CO3...",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:(e.consecuencias_asociadas||[]).map(e=>e.codigo||"CO".concat(e.index+1)).join(" - ")||"Sin asociar"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.criticidad||"",onChange:e=>{const r=[...Be.controles_mitigadores];r[t]=Ue(Ue({},r[t]),{},{criticidad:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores:r}))},placeholder:"Ej: Cr\xedtico, No cr\xedtico",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.criticidad||"Sin criticidad"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.jerarquia||"",onChange:e=>{const r=[...Be.controles_mitigadores];r[t]=Ue(Ue({},r[t]),{},{jerarquia:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores:r}))},placeholder:"Ej: Aislamiento, Administrativo",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.jerarquia||"Sin jerarqu\xeda"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>{yr({control:e,tipo:"mitigador"})},style:{background:"#ffc107",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Ver dimensiones, preguntas y evidencias",children:(0,ze.jsx)("i",{className:"fa fa-search"})}),(0,ze.jsx)("button",{onClick:()=>{br({controlId:e.id,controlIndex:t,control:e,tipo:"mitigador"})},style:{background:"#6f42c1",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Gestionar dimensiones, preguntas y evidencias",children:(0,ze.jsx)("i",{className:"fa fa-list-ul"})}),(0,ze.jsx)("button",{onClick:()=>{ft||ht(new Set),ht(t=>new Set(t).add(e.id))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Editar control",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})})]}):o?(0,ze.jsx)("button",{onClick:()=>{ft&&(ht(t=>{const r=new Set(t);return r.delete(e.id),r}),On(h.id))},style:{background:"#6c757d",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Cancelar edici\xf3n",children:(0,ze.jsx)("i",{className:"fa fa-times"})}):null,n&&!o?(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_mitigadores.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_mitigadores:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})}):n?null:(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_mitigadores.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_mitigadores:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},"control-mitigador-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:Sh(d,yn)&&Be?6:5,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"12px"},children:["No hay controles mitigadores registrados. ",Sh(d,yn)&&Be&&'Haz clic en "Agregar Control" para comenzar.']})})})]})}),ja(d)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=(Be.controles_mitigadores||[]).map(e=>e.codigo).filter(e=>e&&e.match(/^CCM\d+$/i)).map(e=>{const t=e.match(/^CCM(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let t=1;for(;e.includes(t);)t++;const r="CCM".concat(t),n=[...Be.controles_mitigadores||[],{codigo:r,descripcion:"",criticidad:"",jerarquia:"",consecuencias_asociadas:[]}];Fe(Ue(Ue({},Be),{},{controles_mitigadores:n}))},style:{background:"#FF8C00",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control"]}),(0,ze.jsxs)("button",{onClick:eo,disabled:tt,style:{background:tt?"#6c757d":"#FF8C00",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:tt?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:tt?.7:1},title:"Guardar cambios de Controles Mitigadores",children:[(0,ze.jsx)("i",{className:"fa ".concat(tt?"fa-spinner fa-spin":"fa-save")})," ",tt?"Guardando...":"Guardar Controles Mitigadores"]})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #6610f2",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid #6610f2"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#6610f2",fontSize:"18px",fontWeight:"700"},children:[(0,ze.jsx)("i",{className:"fa fa-clipboard-check",style:{marginRight:"8px"}}),"CONTROLES MITIGADORES"]}),(0,ze.jsx)("button",{onClick:()=>yt(e=>Ue(Ue({},e),{},{controles_mitigadores_generales:!e.controles_mitigadores_generales})),style:{background:"transparent",border:"none",color:"#6610f2",cursor:"pointer",fontSize:"16px",padding:"0.25rem 0.5rem"},title:vt.controles_mitigadores_generales?"Expandir tabla":"Minimizar tabla",children:(0,ze.jsx)("i",{className:"fa ".concat(vt.controles_mitigadores_generales?"fa-chevron-down":"fa-chevron-up")})})]}),!vt.controles_mitigadores_generales&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{overflowX:"auto"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #6610f2"},children:[(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#6610f2",width:"80px"},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#6610f2"},children:"Nombre Control"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#6610f2",width:"200px"},children:"Consecuencias"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#6610f2",width:"120px"},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"left",fontWeight:"700",color:"#6610f2",width:"120px"},children:"Jerarqu\xeda"}),Sh(d,yn)&&Be&&(0,ze.jsx)("th",{style:{padding:"0.4rem 0.5rem",textAlign:"center",fontWeight:"700",color:"#6610f2",width:"50px"}})]})}),(0,ze.jsx)("tbody",{children:null!==Be&&void 0!==Be&&Be.controles_mitigadores_generales&&Be.controles_mitigadores_generales.length>0?Be.controles_mitigadores_generales.map((e,t)=>{const r=e.codigo||"CM".concat(t+1),n=!!e.id,o=xt.has(e.id)||!n,a=Sh(d,yn)&&Be;return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6",lineHeight:"1.3"},children:[(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:r,onChange:e=>{const r=[...Be.controles_mitigadores_generales];r[t]=Ue(Ue({},r[t]),{},{codigo:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:r}))},style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",fontWeight:"600"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#495057"},children:r})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.nombre_control||"",onChange:e=>{const r=[...Be.controles_mitigadores_generales];r[t]=Ue(Ue({},r[t]),{},{nombre_control:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:r}))},placeholder:"Nombre o descripci\xf3n del control mitigador...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",lineHeight:"1.4"},children:e.nombre_control||"Sin nombre"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("textarea",{value:e.consecuencias||"",onChange:e=>{const r=[...Be.controles_mitigadores_generales];r[t]=Ue(Ue({},r[t]),{},{consecuencias:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:r}))},placeholder:"Consecuencias asociadas...",style:{width:"100%",minHeight:"35px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px",lineHeight:"1.4",resize:"vertical",fontFamily:"inherit"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",whiteSpace:"pre-line"},children:e.consecuencias||"Sin consecuencias registradas"})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.criticidad||"",onChange:e=>{const r=[...Be.controles_mitigadores_generales];r[t]=Ue(Ue({},r[t]),{},{criticidad:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:r}))},placeholder:"Ej: Cr\xedtico, Medio...",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.criticidad||""})}),(0,ze.jsx)("td",{style:{padding:"0.35rem 0.5rem",verticalAlign:"top"},children:a&&o?(0,ze.jsx)("input",{type:"text",value:e.jerarquia||"",onChange:e=>{const r=[...Be.controles_mitigadores_generales];r[t]=Ue(Ue({},r[t]),{},{jerarquia:e.target.value}),Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:r}))},placeholder:"Jerarqu\xeda del control...",style:{width:"100%",padding:"0.25rem 0.4rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"12px"}}):(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057"},children:e.jerarquia||"Sin jerarqu\xeda"})}),a&&(0,ze.jsxs)("td",{style:{padding:"0.35rem 0.5rem",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"top"},children:[n&&!o?(0,ze.jsx)("button",{onClick:()=>{xt||bt(new Set),bt(t=>new Set(t).add(e.id))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Editar control",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}):o?(0,ze.jsx)("button",{onClick:()=>{xt&&(bt(t=>{const r=new Set(t);return r.delete(e.id),r}),On(h.id))},style:{background:"#6c757d",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",marginRight:"0.25rem"},title:"Cancelar edici\xf3n",children:(0,ze.jsx)("i",{className:"fa fa-times"})}):null,(0,ze.jsx)("button",{onClick:()=>{const e=Be.controles_mitigadores_generales.filter((e,r)=>r!==t);Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.35rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},"control-mitigador-general-".concat(e.id||"temp-".concat(t),"-").concat(t))}):(0,ze.jsx)("tr",{children:(0,ze.jsxs)("td",{colSpan:ja(d)&&Be?6:5,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"12px"},children:["No hay controles mitigadores generales registrados. ",ja(d)&&Be&&'Haz clic en "Agregar Control" para comenzar.']})})})]})}),Sh(d,yn)&&Be&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=Be.controles_mitigadores_generales||[],t=e.map(e=>e.codigo).filter(e=>e&&e.match(/^CM\d+$/i)).map(e=>{const t=e.match(/^CM(\d+)$/i);return t?parseInt(t[1]):0}).filter(e=>e>0);let r=1;for(;t.includes(r);)r++;const n="CM".concat(r),o=[...e,{codigo:n,nombre_control:"",consecuencias:"",criticidad:"",jerarquia:""}];Fe(Ue(Ue({},Be),{},{controles_mitigadores_generales:o}))},style:{background:"#6610f2",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control"]}),(0,ze.jsxs)("button",{onClick:async()=>{if(!h||!Be)return void console.error("No se puede guardar: carpetaActual o analisisBowtie es null");const e=(Be.controles_mitigadores_generales||[]).filter(e=>e.nombre_control&&""!==e.nombre_control.trim());if(0!==e.length){it(!0);try{await Qn("controles_mitigadores_generales",e)?(bt(new Set),alert("Controles mitigadores generales guardados correctamente.")):alert("Error al guardar los controles mitigadores generales. Por favor, intente nuevamente.")}catch(t){console.error("Error en guardarControlesMitigadoresGenerales:",t),alert("Error al guardar los controles mitigadores generales. Por favor, intente nuevamente.")}finally{it(!1)}}else alert("Debe agregar al menos un control mitigador general con nombre antes de guardar.")},disabled:at,style:{background:at?"#6c757d":"#6610f2",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:at?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:at?.7:1},title:"Guardar cambios de Controles Mitigadores",children:[(0,ze.jsx)("i",{className:"fa ".concat(at?"fa-spinner fa-spin":"fa-save")})," ",at?"Guardando...":"Guardar Controles Mitigadores"]})]})]})]})]})]})]}):(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-project-diagram",style:{fontSize:"3rem",marginBottom:"1rem"}}),(0,ze.jsx)("p",{children:"Selecciona una carpeta para ver su an\xe1lisis Bowtie"})]})}),"diagrama"===Re&&!wn&&1===yn.length&&(0,ze.jsx)(Ch,{carpetaActual:h,carpetas:u,API_BASE:Te}),("archivos"===Re||wn)&&(0,ze.jsxs)(ze.Fragment,{children:[(1===yn.length||2===yn.length)&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"1rem",padding:"10px 15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e0e0e0",flexWrap:"wrap"},children:[(0,ze.jsxs)("button",{onClick:()=>po(null),style:{background:null===ie?"#17a2b8":"transparent",color:null===ie?"white":"#17a2b8",border:"none",padding:"4px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-home"})," Ra\xedz"]}),le.map((e,t)=>(0,ze.jsxs)(o.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-chevron-right",style:{color:"#999",fontSize:"10px"}}),(0,ze.jsxs)("button",{onClick:()=>po(e),style:{background:(null===ie||void 0===ie?void 0:ie.id)===e.id?"#17a2b8":"transparent",color:(null===ie||void 0===ie?void 0:ie.id)===e.id?"white":"#17a2b8",border:"none",padding:"4px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:"500"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"4px"}}),e.nombre]})]},e.id))]}),(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",flexWrap:"wrap",gap:"10px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,ze.jsx)("h2",{style:{margin:0,color:"#17a2b8"},children:ie?"\ud83d\udcc1 ".concat(ie.nombre):'Archivos en "'.concat(h.nombre,'"')}),(0,ze.jsxs)("button",{onClick:go,style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(10, 110, 189, 0.2)"},onMouseEnter:e=>{e.currentTarget.style.background="#085a9d",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(10, 110, 189, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="#17a2b8",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(10, 110, 189, 0.2)"},title:"Ver participantes de la carpeta",children:[(0,ze.jsx)("i",{className:"fa fa-users"}),"Participantes"]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",background:"#f1f3f4",padding:"4px",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[(0,ze.jsx)("span",{style:{fontSize:"12px",color:"#666",marginRight:"8px",fontWeight:"500"},children:"Vista:"}),[{id:"lista",icono:"fa-list",titulo:"Lista"},{id:"detalles",icono:"fa-th-list",titulo:"Detalles"},{id:"iconos_medianos",icono:"fa-th",titulo:"Iconos medianos"},{id:"iconos_grandes",icono:"fa-th-large",titulo:"Iconos grandes"}].map(e=>(0,ze.jsx)("button",{onClick:()=>ne(e.id),title:e.titulo,style:{background:re===e.id?"#17a2b8":"transparent",color:re===e.id?"white":"#666",border:"none",padding:"6px 10px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:t=>{re!==e.id&&(t.currentTarget.style.background="#e8e8e8")},onMouseLeave:t=>{re!==e.id&&(t.currentTarget.style.background="transparent")},children:(0,ze.jsx)("i",{className:"fa ".concat(e.icono)})},e.id))]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(1===yn.length||2===yn.length)&&ya(d)&&(0,ze.jsxs)("button",{onClick:()=>pe(!0),style:{background:"#6c757d",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-plus"})," Nueva Carpeta"]}),ya(d)&&(0,ze.jsxs)("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.multiple=!0,e.onchange=async e=>{const t=Array.from(e.target.files);if(0===t.length)return;te(t.map(e=>({nombre:e.name,progreso:0,estado:"subiendo"}))),Z({visible:!0,total:t.length,completados:0,progresoGeneral:0});const r=ie?ie.id:null;for(let o=0;o<t.length;o++){const e=t[o];try{await uo(e,h.id,d.id,o,t.length,r),await new Promise(e=>setTimeout(e,200))}catch(n){console.error("Error subiendo archivo ".concat(e.name,":"),n)}}setTimeout(()=>{lo(h.id,r||"root")},1e3)},e.click()},style:{background:"#28a745",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-upload"})," Subir Archivos"]})]})]}),(1===yn.length||2===yn.length)&&oe.length>0&&(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,ze.jsxs)("h4",{style:{color:"#495057",marginBottom:"0.75rem",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"8px",color:"#ffc107"}}),"Carpetas (",oe.length,")"]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:oe.map(e=>(0,ze.jsxs)("div",{onClick:()=>po(e),style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"10px",padding:"15px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",position:"relative"},onMouseEnter:t=>{t.currentTarget.style.borderColor=e.color||"#17a2b8",t.currentTarget.style.boxShadow="0 4px 12px ".concat(e.color||"#17a2b8","40"),t.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e0e0e0",e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="translateY(0)"},children:[_a(d)&&(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{if(confirm('\xbfEst\xe1s seguro de eliminar la carpeta "'.concat(t,'"?\n\nEsto eliminar\xe1 tambi\xe9n todas las subcarpetas y archivos dentro.')))try{const t=await fetch("".concat(Te,"/archivos/archivos_carpetas.php?id=").concat(e),{method:"DELETE"}),r=await t.json();r.success?(co(h.id,ie?ie.id:null),lo(h.id,ie?ie.id:"root")):alert(r.error||"Error al eliminar la carpeta")}catch(r){console.error("Error eliminando carpeta de archivos:",r),alert("Error al eliminar la carpeta")}})(e.id,e.nombre)},style:{position:"absolute",top:"5px",right:"5px",background:"transparent",border:"none",color:"#dc3545",cursor:"pointer",padding:"4px",borderRadius:"4px",opacity:.6},onMouseEnter:e=>e.currentTarget.style.opacity=1,onMouseLeave:e=>e.currentTarget.style.opacity=.6,title:"Eliminar carpeta",children:(0,ze.jsx)("i",{className:"fa fa-trash"})}),(0,ze.jsx)("i",{className:"fa fa-folder",style:{fontSize:"40px",color:e.color||"#ffc107"}}),(0,ze.jsx)("span",{style:{fontWeight:"600",fontSize:"13px",color:"#333",textAlign:"center",wordBreak:"break-word"},children:e.nombre}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"10px",fontSize:"11px",color:"#666"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-file"})," ",e.cantidad_archivos||0]}),(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-folder"})," ",e.cantidad_subcarpetas||0]})]})]},e.id))})]}),0===_.length&&0===oe.length?(0,ze.jsxs)("div",{style:{color:"#999",textAlign:"center",padding:"2rem"},children:[(0,ze.jsx)("p",{style:{margin:0},children:"No hay archivos ni carpetas aqu\xed"}),ya(d)&&(0,ze.jsx)("div",{style:{marginTop:"10px"},children:1===yn.length||2===yn.length?"Crea una carpeta o sube archivos directamente.":'Haz clic en "Subir Archivos" para agregar archivos a esta carpeta.'})]}):0===_.length&&oe.length>0?(0,ze.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"13px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"6px"}}),"No hay archivos sueltos en esta ubicaci\xf3n. Los archivos est\xe1n dentro de las carpetas."]})}):(0,ze.jsxs)(ze.Fragment,{children:["lista"===re&&(0,ze.jsx)("div",{style:{display:"grid",gap:"10px"},children:_.map(e=>{const t=qn(e.nombre_original,e.tipo_mime);return(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e0e0e0",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#e8f4f8",e.currentTarget.style.borderColor="#17a2b8"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.borderColor="#e0e0e0"},children:[(0,ze.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:t.icono,style:{fontSize:"24px",color:t.color}}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{fontWeight:"bold",color:"#17a2b8"},children:e.nombre_original}),(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user"})," ",e.subido_por_nombre]}),(0,ze.jsxs)("span",{style:{marginLeft:"15px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar"})," ",uh(e.subido_en)]}),e.tama\u00f1o&&(0,ze.jsxs)("span",{style:{marginLeft:"15px"},children:[(0,ze.jsx)("i",{className:"fa fa-hdd"})," ",(e.tama\u00f1o/1024).toFixed(2)," KB"]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[Sa(d)&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>mo(e),style:{background:"#28a745",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px"},title:fh(e)?"Ver en galer\xeda":"Previsualizar",children:(0,ze.jsx)("i",{className:fh(e)?"fa fa-images":"fa fa-eye"})}),(0,ze.jsx)("button",{onClick:()=>window.open("".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=descargar"),"_blank"),style:{background:"#17a2b8",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px"},title:"Descargar",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]}),_a(d)&&(0,ze.jsx)("button",{onClick:async()=>{if(window.confirm('\xbfEliminar "'.concat(e.nombre_original,'"?')))try{const t=await fetch("".concat(Te,"/archivos/archivos.php?id=").concat(e.id,"&usuario_id=").concat(d.id),{method:"DELETE"}),r=await t.json();r.success?lo(h.id,ie?ie.id:"root"):alert("Error: "+r.error)}catch(Fh){alert("Error: "+Fh.message)}},style:{background:"#dc3545",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px"},title:"Eliminar",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id)})}),"detalles"===re&&(0,ze.jsx)("div",{style:{overflowX:"auto",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{style:{background:"#f1f3f4",borderBottom:"2px solid #e0e0e0"},children:[(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Nombre"}),(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Tipo"}),(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Tama\xf1o"}),(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Fecha"}),(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Subido por"}),(0,ze.jsx)("th",{style:{padding:"12px 15px",textAlign:"center",fontWeight:"600",color:"#333"},children:"Acciones"})]})}),(0,ze.jsx)("tbody",{children:_.map((e,t)=>{const r=qn(e.nombre_original,e.tipo_mime),n=e.nombre_original.split(".").pop().toUpperCase();return(0,ze.jsxs)("tr",{style:{borderBottom:"1px solid #e8e8e8",background:t%2===0?"white":"#fafafa"},onMouseEnter:e=>e.currentTarget.style.background="#e8f4f8",onMouseLeave:e=>e.currentTarget.style.background=t%2===0?"white":"#fafafa",children:[(0,ze.jsx)("td",{style:{padding:"10px 15px"},children:(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:r.icono,style:{fontSize:"18px",color:r.color}}),(0,ze.jsx)("span",{style:{fontWeight:"500",color:"#17a2b8"},children:e.nombre_original})]})}),(0,ze.jsx)("td",{style:{padding:"10px 15px",color:"#666"},children:n}),(0,ze.jsx)("td",{style:{padding:"10px 15px",color:"#666"},children:e.tama\u00f1o?"".concat((e.tama\u00f1o/1024).toFixed(2)," KB"):"-"}),(0,ze.jsx)("td",{style:{padding:"10px 15px",color:"#666"},children:uh(e.subido_en)}),(0,ze.jsx)("td",{style:{padding:"10px 15px",color:"#666"},children:e.subido_por_nombre}),(0,ze.jsx)("td",{style:{padding:"10px 15px",textAlign:"center"},children:(0,ze.jsxs)("div",{style:{display:"flex",gap:"5px",justifyContent:"center"},children:[Sa(d)&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>mo(e),style:{background:"#28a745",color:"white",border:"none",padding:"6px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:fh(e)?"Ver en galer\xeda":"Ver",children:(0,ze.jsx)("i",{className:fh(e)?"fa fa-images":"fa fa-eye"})}),(0,ze.jsx)("button",{onClick:()=>window.open("".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=descargar"),"_blank"),style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Descargar",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]}),_a(d)&&(0,ze.jsx)("button",{onClick:async()=>{if(window.confirm('\xbfEliminar "'.concat(e.nombre_original,'"?')))try{const t=await fetch("".concat(Te,"/archivos/archivos.php?id=").concat(e.id,"&usuario_id=").concat(d.id),{method:"DELETE"}),r=await t.json();r.success?lo(h.id,ie?ie.id:"root"):alert("Error: "+r.error)}catch(Fh){alert("Error: "+Fh.message)}},style:{background:"#dc3545",color:"white",border:"none",padding:"6px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},title:"Eliminar",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})})]},e.id)})})]})}),"iconos_medianos"===re&&(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"15px"},children:_.map(e=>{const t=qn(e.nombre_original,e.tipo_mime);return(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"10px",padding:"15px",border:"1px solid #e0e0e0",textAlign:"center",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-3px)",e.currentTarget.style.boxShadow="0 6px 15px rgba(0,0,0,0.1)",e.currentTarget.style.borderColor="#17a2b8"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="#e0e0e0"},onClick:()=>Sa(d)&&L(e),children:[(0,ze.jsx)("div",{style:{width:"50px",height:"50px",margin:"0 auto 10px",display:"flex",alignItems:"center",justifyContent:"center",background:"".concat(t.color,"15"),borderRadius:"10px"},children:(0,ze.jsx)("i",{className:t.icono,style:{fontSize:"28px",color:t.color}})}),(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"500",color:"#333",wordBreak:"break-word",lineHeight:"1.3",maxHeight:"35px",overflow:"hidden",textOverflow:"ellipsis"},title:e.nombre_original,children:e.nombre_original}),(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#999",marginTop:"5px"},children:e.tama\u00f1o?"".concat((e.tama\u00f1o/1024).toFixed(1)," KB"):""}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"3px",justifyContent:"center",marginTop:"8px"},children:[Sa(d)&&(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),window.open("".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=descargar"),"_blank")},style:{background:"#17a2b8",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},title:"Descargar",children:(0,ze.jsx)("i",{className:"fa fa-download"})}),_a(d)&&(0,ze.jsx)("button",{onClick:async t=>{if(t.stopPropagation(),window.confirm('\xbfEliminar "'.concat(e.nombre_original,'"?')))try{const t=await fetch("".concat(Te,"/archivos/archivos.php?id=").concat(e.id,"&usuario_id=").concat(d.id),{method:"DELETE"});(await t.json()).success&&lo(h.id,ie?ie.id:"root")}catch(r){alert("Error")}},style:{background:"#dc3545",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},title:"Eliminar",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id)})}),"iconos_grandes"===re&&(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"20px"},children:_.map(e=>{const t=qn(e.nombre_original,e.tipo_mime);return(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"20px",border:"2px solid #e0e0e0",textAlign:"center",cursor:"pointer",transition:"all 0.25s ease",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px) scale(1.02)",e.currentTarget.style.boxShadow="0 10px 25px rgba(0,0,0,0.12)",e.currentTarget.style.borderColor="#17a2b8"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="#e0e0e0"},onClick:()=>Sa(d)&&L(e),children:[(0,ze.jsx)("div",{style:{width:"80px",height:"80px",margin:"0 auto 15px",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, ".concat(t.color,"20 0%, ").concat(t.color,"10 100%)"),borderRadius:"16px",boxShadow:"0 4px 12px ".concat(t.color,"20")},children:(0,ze.jsx)("i",{className:t.icono,style:{fontSize:"42px",color:t.color}})}),(0,ze.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",color:"#333",wordBreak:"break-word",lineHeight:"1.4",maxHeight:"40px",overflow:"hidden",textOverflow:"ellipsis",marginBottom:"5px"},title:e.nombre_original,children:e.nombre_original}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#888"},children:e.tama\u00f1o?"".concat((e.tama\u00f1o/1024).toFixed(1)," KB"):""}),(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#aaa",marginTop:"3px"},children:e.subido_por_nombre}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"6px",justifyContent:"center",marginTop:"12px"},children:[Sa(d)&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),mo(e)},style:{background:"#28a745",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:"500"},title:fh(e)?"Ver en galer\xeda":"Ver",children:(0,ze.jsx)("i",{className:fh(e)?"fa fa-images":"fa fa-eye"})}),(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),window.open("".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=descargar"),"_blank")},style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:"500"},title:"Descargar",children:(0,ze.jsx)("i",{className:"fa fa-download"})})]}),_a(d)&&(0,ze.jsx)("button",{onClick:async t=>{if(t.stopPropagation(),window.confirm('\xbfEliminar "'.concat(e.nombre_original,'"?')))try{const t=await fetch("".concat(Te,"/archivos/archivos.php?id=").concat(e.id,"&usuario_id=").concat(d.id),{method:"DELETE"});(await t.json()).success&&lo(h.id,ie?ie.id:"root")}catch(r){alert("Error")}},style:{background:"#dc3545",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:"500"},title:"Eliminar",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id)})})]})]}),"linea_base"===Re&&!wn&&(0,ze.jsx)("div",{children:h?St?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",color:"#17a2b8"}}),(0,ze.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Cargando l\xednea base..."})]}):(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"1rem",borderBottom:"2px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#17a2b8",fontSize:"18px",fontWeight:"700",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-chart-line"}),"L\xednea Base - ",h.nombre]}),2===yn.length&&null!==b&&void 0!==b&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",color:"#666"},children:[(0,ze.jsx)("span",{style:{fontWeight:"600"},children:"Promedio de Ponderaci\xf3n:"}),(0,ze.jsxs)("span",{style:{background:b>=80?"#e8f5e9":b>=50?"#fff9c4":"#ffebee",color:b>=80?"#2e7d32":b>=50?"#f57f17":"#c62828",padding:"4px 12px",borderRadius:"20px",fontWeight:"700",fontSize:"15px"},children:["number"===typeof b?b.toFixed(1):"0.0","%"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{if(jt&&0!==jt.length)try{const e=jt.map(e=>({"C\xf3digo":e.codigo||"","Controles Cr\xedticos Preventivos":e.control_critico_preventivo||"","Dimensi\xf3n":e.dimension||"",Pregunta:e.pregunta||"",Evidencia:e.evidencia||"","Verificador Responsable":e.verificador_responsable||"","Fecha Verificaci\xf3n":e.fecha_verificacion||"","Implementado Est\xe1ndar de Desempe\xf1o (SI / NO / NA)":e.implementado_estandar_desempeno||"","Acci\xf3n a Ejecutar":e.accion_a_ejecutar||"","Responsable Cierre de Acci\xf3n":e.responsable_cierre_accion||"","Fecha de Cierre":e.fecha_cierre||"",Criticidad:e.criticidad||"","% Avance Implementaci\xf3n Acci\xf3n":e.porcentaje_avance_implementacion_accion||"","Nombre Due\xf1o Control Cr\xedtico T\xe9cnico (CODELCO VP)":e.nombre_dueno_control_critico_tecnico||"","\xdaltimo Usuario que Edit\xf3":gh(e.ultimo_usuario_edito)})),t=ph.book_new(),r=ph.json_to_sheet(e),n=[{wch:12},{wch:40},{wch:15},{wch:30},{wch:30},{wch:25},{wch:18},{wch:35},{wch:30},{wch:25},{wch:18},{wch:12},{wch:20},{wch:40},{wch:30}];r["!cols"]=n,ph.book_append_sheet(t,r,"L\xednea Base Preventivos");const o=(null===h||void 0===h?void 0:h.nombre)||"Carpeta",a=(new Date).toISOString().split("T")[0];Zf(t,"Linea_Base_Preventivos_".concat(o,"_").concat(a,".xlsx")),alert("Archivo Excel exportado correctamente")}catch(e){console.error("Error exportando a Excel:",e),alert("Error al exportar a Excel: "+e.message)}else alert("No hay datos para exportar")},style:{background:"#1d6f42",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},title:"Exportar a Excel",children:[(0,ze.jsx)("i",{className:"fa fa-file-excel"})," Exportar Excel"]}),ja(d)&&(0,ze.jsxs)("button",{onClick:Xn,disabled:kt,style:{background:kt?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:kt?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:kt?.7:1},title:"Guardar l\xednea base",children:[(0,ze.jsx)("i",{className:"fa ".concat(kt?"fa-spinner fa-spin":"fa-save")})," ",kt?"Guardando...":"Guardar L\xednea Base"]})]})]}),(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(()=>{const e=1===yn.length,t=jt&&jt.length>0?(()=>{const e={},t={};return jt.forEach((e,r)=>{const n=e.codigo||"";t[n]||(t[n]=[]),t[n].push(r)}),Object.keys(t).forEach(r=>{const n=t[r];n.forEach((t,r)=>{e[t]=0===r?n.length:0})}),e})():{},r=(()=>{const e={};if(!jt||0===jt.length)return e;let t=0;for(;t<jt.length;){const r=jt[t].dimension||"",n=jt[t].pregunta||"",o=jt[t].codigo||"";let a=1,i=t+1;for(;i<jt.length&&(jt[i].dimension||"")===r&&(jt[i].pregunta||"")===n&&(jt[i].codigo||"")===o;)a++,i++;e[t]=a;for(let s=t+1;s<i;s++)e[s]=0;t=i}return e})(),n=e?"700px":"1600px";return(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",minWidth:n,tableLayout:"auto"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #17a2b8"},children:[(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",minWidth:"70px",position:"sticky",left:0,top:0,background:"#f8f9fa",zIndex:101,fontSize:"10px"},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",minWidth:"180px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Control Preventivo"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",minWidth:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Dimensi\xf3n"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",minWidth:"200px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Pregunta"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",minWidth:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Evidencia"}),!e&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Verificador"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"85px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"F. Verif."}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Impl. Est\xe1ndar"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Acci\xf3n"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Resp. Cierre"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"85px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"F. Cierre"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"70px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"60px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"% Avance"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Due\xf1o Control"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"150px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Comentarios Contratista"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#6f42c1",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"Respaldos"}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#17a2b8",width:"90px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"Validaci\xf3n"}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#17a2b8",width:"70px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Pond."}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#17a2b8",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"\xdalt. Editor"}),ja(d)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#17a2b8",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Acciones"})]})]})}),(0,ze.jsx)("tbody",{children:jt&&jt.length>0?jt.map((e,n)=>{const o=Et.has(e.id||"temp-".concat(n)),a=wh(d,yn),i=1===yn.length,s="con_observaciones"===e.estado_validacion;return(0,ze.jsxs)("tr",{id:"linea-base-row-".concat(e.id),style:{borderBottom:"1px solid #dee2e6",backgroundColor:s?"#fff3cd":"transparent",borderLeft:s?"4px solid #ffc107":"none"},children:[(0,ze.jsx)("td",{style:{padding:"0.4rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",position:"sticky",left:0,zIndex:5},children:(0,ze.jsx)("div",{children:e.codigo||""})}),0!==t[n]&&(0,ze.jsx)("td",{rowSpan:t[n]||1,style:{padding:"0.5rem",verticalAlign:"top",background:"#fff",borderRight:"1px solid #e9ecef",minWidth:"180px"},children:(0,ze.jsx)("div",{style:{fontSize:"11px",lineHeight:"1.5",color:"#495057"},children:e.control_critico_preventivo||""})}),0!==r[n]&&(0,ze.jsx)("td",{rowSpan:r[n]||1,style:{padding:"0.5rem",verticalAlign:"middle",minWidth:"120px",borderRight:"1px solid #e9ecef",background:r[n]>1?"#f8fafc":"transparent"},children:Dn(e.dimension)}),0!==r[n]&&(0,ze.jsx)("td",{rowSpan:r[n]||1,style:{padding:"0.5rem",verticalAlign:"middle",minWidth:"200px",borderRight:"1px solid #e9ecef",background:r[n]>1?"#f8fafc":"transparent"},children:Ln(e.pregunta)}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"evidencia")&&o?(0,ze.jsx)("textarea",{value:e.evidencia||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{evidencia:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px",minHeight:"60px",resize:"vertical"},placeholder:"Ingrese las evidencias (puede separar m\xfaltiples evidencias con Enter o punto y coma)"}):(0,ze.jsx)("div",{style:{fontSize:"11px",color:e.evidencia?"#111827":"#9ca3af",fontStyle:e.evidencia?"normal":"italic",padding:"0.25rem",background:i?"transparent":"#f8fafc",borderRadius:"4px"},children:e.evidencia||"Sin evidencia"})}),!i&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"verificador_responsable")&&o?(0,ze.jsxs)("select",{value:e.verificador_responsable||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{verificador_responsable:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.verificador_responsable||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"fecha_verificacion")&&o?(0,ze.jsx)("input",{type:"date",value:e.fecha_verificacion||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{fecha_verificacion:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.fecha_verificacion||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"implementado_estandar")&&o?(0,ze.jsxs)("select",{value:e.implementado_estandar_desempeno||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{implementado_estandar_desempeno:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),(0,ze.jsx)("option",{value:"SI",children:"SI"}),(0,ze.jsx)("option",{value:"NO",children:"NO"}),(0,ze.jsx)("option",{value:"NA",children:"NA"})]}):(0,ze.jsx)("div",{children:e.implementado_estandar_desempeno||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"accion_ejecutar")&&o?(0,ze.jsx)("textarea",{value:e.accion_a_ejecutar||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{accion_a_ejecutar:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",minHeight:"50px",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px",resize:"vertical"}}):(0,ze.jsx)("div",{style:{fontSize:"11px",lineHeight:"1.4"},children:e.accion_a_ejecutar||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"responsable_cierre")&&o?(0,ze.jsxs)("select",{value:e.responsable_cierre_accion||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{responsable_cierre_accion:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.responsable_cierre_accion||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"fecha_cierre")&&o?(0,ze.jsx)("input",{type:"date",value:e.fecha_cierre||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{fecha_cierre:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.fecha_cierre||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"criticidad")&&o?(0,ze.jsxs)("select",{value:e.criticidad||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{criticidad:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),(0,ze.jsx)("option",{value:"Alta",children:"Alta"}),(0,ze.jsx)("option",{value:"Media",children:"Media"}),(0,ze.jsx)("option",{value:"Baja",children:"Baja"})]}):(0,ze.jsx)("div",{children:e.criticidad||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"porcentaje_avance")&&o?(0,ze.jsx)("input",{type:"number",min:"0",max:"100",value:e.porcentaje_avance_implementacion_accion||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{porcentaje_avance_implementacion_accion:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.porcentaje_avance_implementacion_accion?"".concat(e.porcentaje_avance_implementacion_accion,"%"):""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"nombre_dueno_control")&&o?(0,ze.jsxs)("select",{value:e.nombre_dueno_control_critico_tecnico||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{nombre_dueno_control_critico_tecnico:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.nombre_dueno_control_critico_tecnico||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"comentario_trabajador")&&o?(0,ze.jsx)("textarea",{value:e.comentario_trabajador||"",onChange:e=>{const t=[...jt];t[n]=Ue(Ue({},t[n]),{},{comentario_trabajador:e.target.value,ultimo_usuario_edito:mh(d)}),_t(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #28a745",fontSize:"10px",minHeight:"50px",resize:"vertical"},placeholder:"Comentario del trabajador..."}):(0,ze.jsx)("div",{style:{fontSize:"10px"},children:(()=>{const t=e.conversacion_seguimiento||[];var r,n;return t.length>0?(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,ze.jsxs)("span",{style:{color:"#28a745",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-comments"})," ",t.length," mensaje(s)"]}),(0,ze.jsxs)("span",{style:{color:"#6c757d",fontSize:"9px",fontStyle:"italic"},children:["\xdaltimo: ",(null===(r=t[t.length-1])||void 0===r||null===(n=r.usuario_nombre)||void 0===n?void 0:n.split(" ")[0])||"Usuario"]})]}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"Sin mensajes"})})()})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:(0,ze.jsx)("div",{style:{fontSize:"10px"},children:(()=>{const t=(e.conversacion_seguimiento||[]).reduce((e,t)=>{var r;return e+((null===(r=t.archivos)||void 0===r?void 0:r.length)||0)},0);return t>0?(0,ze.jsxs)("span",{style:{color:"#6f42c1",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-paperclip"})," ",t," archivo(s)"]}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"-"})})()})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:wh(d,yn)?(0,ze.jsx)("button",{onClick:()=>{sn({itemIndex:n,tipo:"preventivo",item:e})},style:{background:"validado"===e.estado_validacion?"#28a745":"con_observaciones"===e.estado_validacion?"#ffc107":"#6c757d",color:"white",border:"none",padding:"0.35rem 0.6rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",minWidth:"100px"},title:"validado"===e.estado_validacion?"Validado":"con_observaciones"===e.estado_validacion?"Con Observaciones - Click para ver":"Agregar Validaci\xf3n/Observaciones",children:"validado"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Validado"]}):"con_observaciones"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"})," Observaciones"]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-comment"})," Validar"]})}):(0,ze.jsx)("div",{style:{background:"validado"===e.estado_validacion?"#28a745":"con_observaciones"===e.estado_validacion?"#ffc107":"#6c757d",color:"white",border:"none",padding:"0.35rem 0.6rem",borderRadius:"4px",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",minWidth:"100px",cursor:"not-allowed",opacity:.7},title:"Solo puede validar en nivel 2",children:"validado"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Validado"]}):"con_observaciones"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"})," Observaciones"]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-comment"})," Validar"]})})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:(0,ze.jsx)("div",{style:{fontSize:"13px",fontWeight:"700",color:"validado"===e.estado_validacion?"#28a745":"#6c757d",padding:"0.35rem 0.6rem",borderRadius:"4px",background:"validado"===e.estado_validacion?"#d4edda":"#e9ecef",display:"inline-block"},children:"validado"===e.estado_validacion?"100%":"0%"})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",fontSize:"10px",color:"#6c757d"},children:gh(e.ultimo_usuario_edito)}),a&&(0,ze.jsx)("td",{style:{padding:"0.4rem",textAlign:"center",whiteSpace:"nowrap"},children:o?o?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:async()=>{try{await Xn(),Tt(t=>{const r=new Set(t);return r.delete(e.id||"temp-".concat(n)),r})}catch(t){console.error("Error al guardar:",t)}},disabled:kt,style:{background:kt?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:kt?"not-allowed":"pointer",fontSize:"12px",marginRight:"0.2rem"},title:"Guardar",children:(0,ze.jsx)("i",{className:"fa ".concat(kt?"fa-spinner fa-spin":"fa-save")})}),(0,ze.jsx)("button",{onClick:()=>{Tt(t=>{const r=new Set(t);return r.delete(e.id||"temp-".concat(n)),r}),Mn(h.id)},style:{background:"#6c757d",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},title:"Cancelar",children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}):null:(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>{Bt([]),Mt([]),Vt([]),Ut(null),zt(Ue({},e)),Dt("informacion"),Nt({item:e,index:n,tipo:"preventivo"})},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px",marginRight:"0.2rem"},title:"Editar",children:(0,ze.jsx)("i",{className:"fa fa-edit"})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("button",{onClick:async()=>{if(window.confirm("\xbfEst\xe1 seguro que desea eliminar este registro de la base de datos? Esta acci\xf3n no se puede deshacer."))if(e.id)try{const t=await fetch("".concat(Te,"/archivos/carpeta_linea_base.php"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,carpeta_id:h.id})}),r=await t.json();r.success?(await Mn(h.id),dn("\u2713 Registro eliminado correctamente","success")):dn("\u2717 Error al eliminar: "+(r.error||"Error desconocido"),"error",5e3)}catch(t){console.error("Error eliminando registro:",t),dn("\u2717 Error al eliminar el registro","error",5e3)}else{const e=jt.filter((e,t)=>t!==n);_t(e)}},style:{background:"#dc3545",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},title:"Eliminar registro",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})})]})]},"linea-base-".concat(e.id||"temp-"+n,"-").concat(n))}):(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:e?5:ja(d)?"super_admin"===d.rol||"admin"===d.rol?17:15:"super_admin"===d.rol||"admin"===d.rol?16:14,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"13px"},children:"No hay controles preventivos en BOWTIE. Primero debes agregar controles cr\xedticos preventivos en la pesta\xf1a BOWTIE."})})})]})})()})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #FF8C00",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",marginTop:"2rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",paddingBottom:"1rem",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#FF8C00",fontSize:"18px",fontWeight:"700",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-shield-alt"}),"L\xednea Base - Controles Cr\xedticos Mitigadores"]}),2===yn.length&&null!==b&&void 0!==b&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",color:"#666"},children:[(0,ze.jsx)("span",{style:{fontWeight:"600"},children:"Promedio de Ponderaci\xf3n:"}),(0,ze.jsxs)("span",{style:{background:b>=80?"#e8f5e9":b>=50?"#fff9c4":"#ffebee",color:b>=80?"#2e7d32":b>=50?"#f57f17":"#c62828",padding:"4px 12px",borderRadius:"20px",fontWeight:"700",fontSize:"15px"},children:["number"===typeof b?b.toFixed(1):"0.0","%"]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,ze.jsxs)("button",{onClick:()=>{if(sr&&0!==sr.length)try{const e=sr.map(e=>({"C\xf3digo":e.codigo||"","Controles Cr\xedticos Mitigadores":e.control_critico_mitigador||"","Dimensi\xf3n":e.dimension||"",Pregunta:e.pregunta||"",Evidencia:e.evidencia||"","Verificador Responsable":e.verificador_responsable||"","Fecha Verificaci\xf3n":e.fecha_verificacion||"","Implementado Est\xe1ndar de Desempe\xf1o (SI / NO / NA)":e.implementado_estandar_desempeno||"","Acci\xf3n a Ejecutar":e.accion_a_ejecutar||"","Responsable Cierre de Acci\xf3n":e.responsable_cierre_accion||"","Fecha de Cierre":e.fecha_cierre||"",Criticidad:e.criticidad||"","% Avance Implementaci\xf3n Acci\xf3n":e.porcentaje_avance_implementacion_accion||"","Nombre Due\xf1o Control Cr\xedtico T\xe9cnico (CODELCO VP)":e.nombre_dueno_control_critico_tecnico||"","\xdaltimo Usuario que Edit\xf3":gh(e.ultimo_usuario_edito)})),t=ph.book_new(),r=ph.json_to_sheet(e),n=[{wch:12},{wch:40},{wch:15},{wch:30},{wch:30},{wch:25},{wch:18},{wch:35},{wch:30},{wch:25},{wch:18},{wch:12},{wch:20},{wch:40},{wch:30}];r["!cols"]=n,ph.book_append_sheet(t,r,"L\xednea Base Mitigadores");const o=(null===h||void 0===h?void 0:h.nombre)||"Carpeta",a=(new Date).toISOString().split("T")[0];Zf(t,"Linea_Base_Mitigadores_".concat(o,"_").concat(a,".xlsx")),alert("Archivo Excel exportado correctamente")}catch(e){console.error("Error exportando a Excel:",e),alert("Error al exportar a Excel: "+e.message)}else alert("No hay datos para exportar")},style:{background:"#1d6f42",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},title:"Exportar a Excel",children:[(0,ze.jsx)("i",{className:"fa fa-file-excel"})," Exportar Excel"]}),ja(d)&&(0,ze.jsxs)("button",{onClick:Jn,disabled:pr,style:{background:pr?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.5rem 1.5rem",borderRadius:"6px",cursor:pr?"not-allowed":"pointer",fontSize:"13px",fontWeight:"600",opacity:pr?.7:1},title:"Guardar l\xednea base mitigadores",children:[(0,ze.jsx)("i",{className:"fa ".concat(pr?"fa-spinner fa-spin":"fa-save")})," ",pr?"Guardando...":"Guardar L\xednea Base Mitigadores"]})]})]}),(0,ze.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"calc(100vh - 300px)"},children:(()=>{const e=1===yn.length,t=sr&&sr.length>0?(()=>{const e={},t={};return sr.forEach((e,r)=>{const n=e.codigo||"";t[n]||(t[n]=[]),t[n].push(r)}),Object.keys(t).forEach(r=>{const n=t[r];n.forEach((t,r)=>{e[t]=0===r?n.length:0})}),e})():{},r=(()=>{const e={};if(!sr||0===sr.length)return e;let t=0;for(;t<sr.length;){const r=sr[t].dimension||"",n=sr[t].pregunta||"",o=sr[t].codigo||"";let a=1,i=t+1;for(;i<sr.length&&(sr[i].dimension||"")===r&&(sr[i].pregunta||"")===n&&(sr[i].codigo||"")===o;)a++,i++;e[t]=a;for(let s=t+1;s<i;s++)e[s]=0;t=i}return e})(),n=e?"700px":"1600px";return(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",minWidth:n,tableLayout:"auto"},children:[(0,ze.jsx)("thead",{style:{position:"sticky",top:0,zIndex:100},children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #FF8C00"},children:[(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",minWidth:"70px",position:"sticky",left:0,top:0,background:"#f8f9fa",zIndex:101,fontSize:"10px"},children:"C\xf3digo"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",minWidth:"180px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Control Mitigador"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",minWidth:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Dimensi\xf3n"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",minWidth:"200px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Pregunta"}),(0,ze.jsx)("th",{style:{padding:"0.5rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",minWidth:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"10px"},children:"Evidencia"}),!e&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Verificador"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"85px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"F. Verif."}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Impl. Est\xe1ndar"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Acci\xf3n"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Resp. Cierre"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"85px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"F. Cierre"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"70px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Criticidad"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"60px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"% Avance"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"120px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Due\xf1o Control"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#28a745",width:"150px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px",lineHeight:"1.2"},children:"Comentarios Contratista"}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#6f42c1",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"Respaldos"}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#FF8C00",width:"90px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"Validaci\xf3n"}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#FF8C00",width:"70px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Pond."}),(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"left",fontWeight:"700",color:"#FF8C00",width:"100px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"8px"},children:"\xdalt. Editor"}),ja(d)&&(0,ze.jsx)("th",{style:{padding:"0.35rem",textAlign:"center",fontWeight:"700",color:"#FF8C00",width:"80px",position:"sticky",top:0,background:"#f8f9fa",zIndex:100,fontSize:"9px"},children:"Acciones"})]})]})}),(0,ze.jsx)("tbody",{children:sr&&sr.length>0?sr.map((e,n)=>{const o=fr.has(e.id||"temp-".concat(n)),a=wh(d,yn),i=1===yn.length,s="con_observaciones"===e.estado_validacion;return(0,ze.jsxs)("tr",{id:"linea-base-row-".concat(e.id),style:{borderBottom:"1px solid #dee2e6",backgroundColor:s?"#fff3cd":"transparent",borderLeft:s?"4px solid #ffc107":"none"},children:[(0,ze.jsx)("td",{style:{padding:"0.4rem",background:"#f8f9fa",fontWeight:"600",color:"#495057",position:"sticky",left:0,zIndex:5},children:(0,ze.jsx)("div",{children:e.codigo||""})}),0!==t[n]&&(0,ze.jsx)("td",{rowSpan:t[n]||1,style:{padding:"0.5rem",verticalAlign:"top",background:"#fff",borderRight:"1px solid #e9ecef",minWidth:"180px"},children:(0,ze.jsx)("div",{style:{fontSize:"11px",lineHeight:"1.5",color:"#495057"},children:e.control_critico_mitigador||""})}),0!==r[n]&&(0,ze.jsx)("td",{rowSpan:r[n]||1,style:{padding:"0.5rem",verticalAlign:"middle",minWidth:"120px",borderRight:"1px solid #e9ecef",background:r[n]>1?"#fff8f0":"transparent"},children:Dn(e.dimension)}),0!==r[n]&&(0,ze.jsx)("td",{rowSpan:r[n]||1,style:{padding:"0.5rem",verticalAlign:"middle",minWidth:"200px",borderRight:"1px solid #e9ecef",background:r[n]>1?"#fff8f0":"transparent"},children:Ln(e.pregunta)}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"evidencia")&&o?(0,ze.jsx)("textarea",{value:e.evidencia||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{evidencia:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px",minHeight:"60px",resize:"vertical"},placeholder:"Ingrese las evidencias (puede separar m\xfaltiples evidencias con Enter o punto y coma)"}):(0,ze.jsx)("div",{style:{fontSize:"11px",color:e.evidencia?"#111827":"#9ca3af",fontStyle:e.evidencia?"normal":"italic",padding:"0.25rem",background:i?"transparent":"#f8fafc",borderRadius:"4px"},children:e.evidencia||"Sin evidencia"})}),!i&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"verificador_responsable")&&o?(0,ze.jsxs)("select",{value:e.verificador_responsable||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{verificador_responsable:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.verificador_responsable||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"fecha_verificacion")&&o?(0,ze.jsx)("input",{type:"date",value:e.fecha_verificacion||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{fecha_verificacion:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.fecha_verificacion||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"implementado_estandar")&&o?(0,ze.jsxs)("select",{value:e.implementado_estandar_desempeno||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{implementado_estandar_desempeno:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),(0,ze.jsx)("option",{value:"SI",children:"SI"}),(0,ze.jsx)("option",{value:"NO",children:"NO"}),(0,ze.jsx)("option",{value:"NA",children:"NA"})]}):(0,ze.jsx)("div",{children:e.implementado_estandar_desempeno||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"accion_ejecutar")&&o?(0,ze.jsx)("textarea",{value:e.accion_a_ejecutar||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{accion_a_ejecutar:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",minHeight:"50px",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px",resize:"vertical"}}):(0,ze.jsx)("div",{style:{fontSize:"11px",lineHeight:"1.4"},children:e.accion_a_ejecutar||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"responsable_cierre")&&o?(0,ze.jsxs)("select",{value:e.responsable_cierre_accion||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{responsable_cierre_accion:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.responsable_cierre_accion||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"fecha_cierre")&&o?(0,ze.jsx)("input",{type:"date",value:e.fecha_cierre||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{fecha_cierre:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.fecha_cierre||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"criticidad")&&o?(0,ze.jsxs)("select",{value:e.criticidad||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{criticidad:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),(0,ze.jsx)("option",{value:"Alta",children:"Alta"}),(0,ze.jsx)("option",{value:"Media",children:"Media"}),(0,ze.jsx)("option",{value:"Baja",children:"Baja"})]}):(0,ze.jsx)("div",{children:e.criticidad||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"porcentaje_avance")&&o?(0,ze.jsx)("input",{type:"number",min:"0",max:"100",value:e.porcentaje_avance_implementacion_accion||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{porcentaje_avance_implementacion_accion:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"}}):(0,ze.jsx)("div",{children:e.porcentaje_avance_implementacion_accion?"".concat(e.porcentaje_avance_implementacion_accion,"%"):""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"nombre_dueno_control")&&o?(0,ze.jsxs)("select",{value:e.nombre_dueno_control_critico_tecnico||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{nombre_dueno_control_critico_tecnico:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"11px"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar"}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]}):(0,ze.jsx)("div",{children:e.nombre_dueno_control_critico_tecnico||""})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top"},children:kh(d,yn,"comentario_trabajador")&&o?(0,ze.jsx)("textarea",{value:e.comentario_trabajador||"",onChange:e=>{const t=[...sr];t[n]=Ue(Ue({},t[n]),{},{comentario_trabajador:e.target.value,ultimo_usuario_edito:mh(d)}),lr(t)},style:{width:"100%",padding:"0.25rem",borderRadius:"4px",border:"1px solid #28a745",fontSize:"10px",minHeight:"50px",resize:"vertical"},placeholder:"Comentario del trabajador..."}):(0,ze.jsx)("div",{style:{fontSize:"10px"},children:(()=>{const t=e.conversacion_seguimiento||[];var r,n;return t.length>0?(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,ze.jsxs)("span",{style:{color:"#28a745",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-comments"})," ",t.length," mensaje(s)"]}),(0,ze.jsxs)("span",{style:{color:"#6c757d",fontSize:"9px",fontStyle:"italic"},children:["\xdaltimo: ",(null===(r=t[t.length-1])||void 0===r||null===(n=r.usuario_nombre)||void 0===n?void 0:n.split(" ")[0])||"Usuario"]})]}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"Sin mensajes"})})()})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:(0,ze.jsx)("div",{style:{fontSize:"10px"},children:(()=>{const t=(e.conversacion_seguimiento||[]).reduce((e,t)=>{var r;return e+((null===(r=t.archivos)||void 0===r?void 0:r.length)||0)},0);return t>0?(0,ze.jsxs)("span",{style:{color:"#6f42c1",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-paperclip"})," ",t," archivo(s)"]}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"-"})})()})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:wh(d,yn)?(0,ze.jsx)("button",{onClick:()=>{sn({itemIndex:n,tipo:"mitigador",item:e})},style:{background:"validado"===e.estado_validacion?"#28a745":"con_observaciones"===e.estado_validacion?"#ffc107":"#6c757d",color:"white",border:"none",padding:"0.35rem 0.6rem",borderRadius:"4px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",minWidth:"100px"},title:"validado"===e.estado_validacion?"Validado":"con_observaciones"===e.estado_validacion?"Con Observaciones - Click para ver":"Agregar Validaci\xf3n/Observaciones",children:"validado"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Validado"]}):"con_observaciones"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"})," Observaciones"]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-comment"})," Validar"]})}):(0,ze.jsx)("div",{style:{background:"validado"===e.estado_validacion?"#28a745":"con_observaciones"===e.estado_validacion?"#ffc107":"#6c757d",color:"white",border:"none",padding:"0.35rem 0.6rem",borderRadius:"4px",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",minWidth:"100px",cursor:"not-allowed",opacity:.7},title:"Solo puede validar en nivel 2",children:"validado"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Validado"]}):"con_observaciones"===e.estado_validacion?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"})," Observaciones"]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-comment"})," Validar"]})})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",textAlign:"center"},children:(0,ze.jsx)("div",{style:{fontSize:"13px",fontWeight:"700",color:"validado"===e.estado_validacion?"#28a745":"#6c757d",padding:"0.35rem 0.6rem",borderRadius:"4px",background:"validado"===e.estado_validacion?"#d4edda":"#e9ecef",display:"inline-block"},children:"validado"===e.estado_validacion?"100%":"0%"})}),(0,ze.jsx)("td",{style:{padding:"0.4rem",verticalAlign:"top",fontSize:"10px",color:"#6c757d"},children:gh(e.ultimo_usuario_edito)}),a&&(0,ze.jsx)("td",{style:{padding:"0.4rem",textAlign:"center",whiteSpace:"nowrap"},children:o?o?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:async()=>{try{await Jn(),hr(t=>{const r=new Set(t);return r.delete(e.id||"temp-".concat(n)),r})}catch(t){console.error("Error al guardar:",t)}},disabled:pr,style:{background:pr?"#6c757d":"#28a745",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:pr?"not-allowed":"pointer",fontSize:"12px",marginRight:"0.2rem"},title:"Guardar",children:(0,ze.jsx)("i",{className:"fa ".concat(pr?"fa-spinner fa-spin":"fa-save")})}),(0,ze.jsx)("button",{onClick:()=>{hr(t=>{const r=new Set(t);return r.delete(e.id||"temp-".concat(n)),r}),Kn(h.id)},style:{background:"#6c757d",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},title:"Cancelar",children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}):null:(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>{Bt([]),Mt([]),Vt([]),Ut(null),zt(Ue({},e)),Dt("informacion"),Nt({item:e,index:n,tipo:"mitigador"})},style:{background:"#FF8C00",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px",marginRight:"0.2rem"},title:"Editar",children:(0,ze.jsx)("i",{className:"fa fa-edit"})}),("super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("button",{onClick:async()=>{if(window.confirm("\xbfEst\xe1 seguro que desea eliminar este registro de la base de datos? Esta acci\xf3n no se puede deshacer."))if(e.id)try{const t=await fetch("".concat(Te,"/archivos/carpeta_linea_base_mitigadores.php"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,carpeta_id:h.id})}),r=await t.json();r.success?(await Kn(h.id),alert("Registro eliminado correctamente")):alert("Error al eliminar: "+(r.error||"Error desconocido"))}catch(t){console.error("Error eliminando registro:",t),alert("Error al eliminar el registro")}else{const e=sr.filter((e,t)=>t!==n);lr(e)}},style:{background:"#dc3545",color:"white",border:"none",padding:"0.3rem 0.45rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},title:"Eliminar registro",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})})]})]},"linea-base-mitigador-".concat(e.id||"temp-"+n,"-").concat(n))}):(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:e?5:ja(d)?"super_admin"===d.rol||"admin"===d.rol?17:15:"super_admin"===d.rol||"admin"===d.rol?16:14,style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"13px"},children:"No hay controles mitigadores en BOWTIE. Primero debes agregar controles cr\xedticos mitigadores en la pesta\xf1a BOWTIE."})})})]})})()})]})]}):(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-chart-line",style:{fontSize:"3rem",marginBottom:"1rem"}}),(0,ze.jsx)("p",{children:"Selecciona una carpeta para ver su l\xednea base"})]})}),vr&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"2rem"},onClick:e=>{e.target===e.currentTarget&&yr(null)},children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"2rem",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.3)",width:"1000px"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid #ffc107"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#ffc107",fontSize:"20px",fontWeight:"700",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-search"}),"Ver Dimensiones, Preguntas y Evidencias - ",(null===(t=vr.control)||void 0===t?void 0:t.codigo)||"Control"]}),(0,ze.jsxs)("button",{onClick:()=>yr(null),style:{background:"#dc3545",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-times"})," Cerrar"]})]}),null!==(r=vr.control)&&void 0!==r&&r.dimensiones&&vr.control.dimensiones.length>0?(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:vr.control.dimensiones.map((e,t)=>(0,ze.jsxs)("div",{style:{border:"2px solid #ffc107",borderRadius:"8px",padding:"1.5rem",background:"#fffbf0"},children:[(0,ze.jsx)("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid #ffc107"},children:(0,ze.jsxs)("h4",{style:{margin:0,color:"#ffc107",fontSize:"16px",fontWeight:"700",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-layer-group"}),"Dimensi\xf3n: ",e.nombre||"Sin nombre"]})}),e.preguntas&&e.preguntas.length>0?(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:e.preguntas.map((e,r)=>(0,ze.jsxs)("div",{style:{border:"1px solid #dee2e6",borderRadius:"6px",padding:"1rem",background:"white"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#6c757d",marginBottom:"0.5rem"},children:["Pregunta ",r+1,":"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.6",padding:"0.75rem",background:"#f8f9fa",borderRadius:"4px",border:"1px solid #e9ecef"},children:e.texto||"Sin pregunta definida"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#6c757d",marginBottom:"0.5rem"},children:"Evidencia:"}),(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#495057",lineHeight:"1.6",padding:"0.75rem",background:"#f8f9fa",borderRadius:"4px",border:"1px solid #e9ecef",whiteSpace:"pre-wrap"},children:e.evidencia||"Sin evidencia definida"})]})]},"ver-pregunta-".concat(t,"-").concat(r)))}):(0,ze.jsx)("div",{style:{padding:"1rem",textAlign:"center",color:"#6c757d",fontSize:"13px",fontStyle:"italic"},children:"No hay preguntas definidas para esta dimensi\xf3n"})]},"ver-dimension-".concat(t)))}):(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{fontSize:"2rem",marginBottom:"1rem",color:"#ffc107"}}),(0,ze.jsx)("p",{children:"No hay dimensiones definidas para este control."}),(0,ze.jsx)("p",{style:{fontSize:"12px",marginTop:"0.5rem"},children:"Use el bot\xf3n de gesti\xf3n (\xedcono de lista) para agregar dimensiones, preguntas y evidencias."})]})]})}),(gr||xr)&&((e,t)=>{const r=gr||xr,n="preventivo"===r.tipo?null===Be||void 0===Be||null===(e=Be.controles_preventivos)||void 0===e?void 0:e[r.controlIndex]:null===Be||void 0===Be||null===(t=Be.controles_mitigadores)||void 0===t?void 0:t[r.controlIndex],o=(null===n||void 0===n?void 0:n.dimensiones)||[],a=e=>{if(!e)return"";const t=e.toString().trim().toUpperCase();return"DISENO"===t?"DISE\xd1O":"IMPLEMENTACION"===t?"IMPLEMENTACI\xd3N":"ENTRENAMIENTO"===t?"ENTRENAMIENTO":t},i=o.map((e,t)=>({dimension:e,index:t})).filter(e=>{let{dimension:t}=e;const r=a(t.nombre);return"TODAS"===jr||("OTRAS"===jr?"DISE\xd1O"!==r&&"IMPLEMENTACI\xd3N"!==r&&"ENTRENAMIENTO"!==r:r===jr)}),s=e=>{const t="OTRAS"===e?"":e,a={id:null,nombre:t,preguntas:[]},i="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores];i[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:[...o,a]}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:i})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:i})),_r(t||"OTRAS")},l="TODAS"===jr?"A\xfan no se han registrado dimensiones para este control.":"No hay dimensiones registradas para el filtro seleccionado (".concat(jr.toLowerCase(),").");return(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"2rem"},onClick:e=>{e.target===e.currentTarget&&(mr(null),br(null),_r("TODAS"))},children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"2rem",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.3)",width:"1200px"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid #17a2b8"},children:[(0,ze.jsxs)("h3",{style:{margin:0,color:"#17a2b8",fontSize:"20px",fontWeight:"700",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-list-ul"}),"Gestionar Dimensiones, Preguntas y Evidencias - ",(null===n||void 0===n?void 0:n.codigo)||"Control"]}),(0,ze.jsxs)("button",{onClick:()=>{mr(null),br(null),_r("TODAS")},style:{background:"#dc3545",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-times"})," Cerrar"]})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,ze.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",marginBottom:"1rem"},children:[{valor:"TODAS",etiqueta:"Todas"},{valor:"DISE\xd1O",etiqueta:"Dise\xf1o"},{valor:"IMPLEMENTACI\xd3N",etiqueta:"Implementaci\xf3n"},{valor:"ENTRENAMIENTO",etiqueta:"Entrenamiento"},{valor:"OTRAS",etiqueta:"Sin tipo"}].map(e=>(0,ze.jsx)("button",{onClick:()=>_r(e.valor),style:{padding:"0.5rem 1rem",borderRadius:"6px",border:"2px solid #17a2b8",background:jr===e.valor?"#17a2b8":"#f8f9fa",color:jr===e.valor?"white":"#495057",cursor:"pointer",fontSize:"13px",fontWeight:jr===e.valor?700:500},children:e.etiqueta},e.valor))}),(0,ze.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:[(0,ze.jsxs)("button",{onClick:()=>s("DISE\xd1O"),style:{background:"#28a745",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Dimensi\xf3n - Dise\xf1o"]}),(0,ze.jsxs)("button",{onClick:()=>s("IMPLEMENTACI\xd3N"),style:{background:"#17a2b8",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Dimensi\xf3n - Implementaci\xf3n"]}),(0,ze.jsxs)("button",{onClick:()=>s("ENTRENAMIENTO"),style:{background:"#ffc107",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Dimensi\xf3n - Entrenamiento"]})]})]}),(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:i.length>0?i.map(e=>{let{dimension:t,index:i}=e;return((e,t)=>(0,ze.jsxs)("div",{style:{border:"2px solid #17a2b8",borderRadius:"8px",padding:"1.5rem",background:"#f8f9fa"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,ze.jsxs)("select",{value:a(e.nombre)||"",onChange:i=>{const s="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],l=[...o];l[t]=Ue(Ue({},e),{},{nombre:a(i.target.value)}),s[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:l}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:s})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:s}))},style:{flex:1,padding:"0.5rem",borderRadius:"6px",border:"2px solid #17a2b8",fontSize:"14px",fontWeight:"600",marginRight:"1rem",background:"white",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar dimensi\xf3n"}),(0,ze.jsx)("option",{value:"DISE\xd1O",children:"DISE\xd1O"}),(0,ze.jsx)("option",{value:"IMPLEMENTACI\xd3N",children:"IMPLEMENTACI\xd3N"}),(0,ze.jsx)("option",{value:"ENTRENAMIENTO",children:"ENTRENAMIENTO"})]}),(0,ze.jsxs)("button",{onClick:()=>{const e="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],a=o.filter((e,r)=>r!==t);e[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:a}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:e})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:e}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:[(0,ze.jsx)("i",{className:"fa fa-trash"})," Eliminar"]})]}),(0,ze.jsx)("div",{style:{marginBottom:"1rem"},children:(0,ze.jsxs)("button",{onClick:()=>{const a="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],i=[...o];i[t]=Ue(Ue({},e),{},{preguntas:[...e.preguntas||[],{id:null,texto:"",evidencia:""}]}),a[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:i}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:a})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:a}))},style:{background:"#17a2b8",color:"white",border:"none",padding:"0.4rem 0.8rem",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Pregunta"]})}),(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:(e.preguntas||[]).map((a,i)=>(0,ze.jsxs)("div",{style:{border:"1px solid #dee2e6",borderRadius:"6px",padding:"1rem",background:"white"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057"},children:"Pregunta:"}),(0,ze.jsx)("textarea",{value:a.texto||"",onChange:s=>{const l="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],c=[...o],d=[...e.preguntas||[]];d[i]=Ue(Ue({},a),{},{texto:s.target.value}),c[t]=Ue(Ue({},e),{},{preguntas:d}),l[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:c}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:l})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:l}))},placeholder:"Escriba la pregunta aqu\xed...",style:{width:"100%",minHeight:"60px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"13px",resize:"vertical"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057"},children:"Evidencia:"}),(0,ze.jsx)("textarea",{value:a.evidencia||"",onChange:s=>{const l="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],c=[...o],d=[...e.preguntas||[]];d[i]=Ue(Ue({},a),{},{evidencia:s.target.value}),c[t]=Ue(Ue({},e),{},{preguntas:d}),l[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:c}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:l})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:l}))},placeholder:"Detalle la evidencia asociada...",style:{width:"100%",minHeight:"60px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"13px",resize:"vertical"}})]}),(0,ze.jsx)("div",{style:{textAlign:"right",marginTop:"0.75rem"},children:(0,ze.jsxs)("button",{onClick:()=>{const a="preventivo"===r.tipo?[...Be.controles_preventivos]:[...Be.controles_mitigadores],s=[...o],l=(e.preguntas||[]).filter((e,t)=>t!==i);s[t]=Ue(Ue({},e),{},{preguntas:l}),a[r.controlIndex]=Ue(Ue({},n),{},{dimensiones:s}),"preventivo"===r.tipo?Fe(Ue(Ue({},Be),{},{controles_preventivos:a})):Fe(Ue(Ue({},Be),{},{controles_mitigadores:a}))},style:{background:"#dc3545",color:"white",border:"none",padding:"0.4rem 0.8rem",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:[(0,ze.jsx)("i",{className:"fa fa-trash"})," Eliminar Pregunta"]})})]},"pregunta-".concat(t,"-").concat(i)))})]},"dimension-".concat(t)))(t,i)}):(0,ze.jsx)("div",{style:{padding:"1.25rem",border:"1px dashed #ced4da",borderRadius:"6px",textAlign:"center",color:"#6c757d",fontSize:"13px"},children:l})}),(0,ze.jsxs)("div",{style:{marginTop:"2rem",paddingTop:"1rem",borderTop:"2px solid #dee2e6",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[(0,ze.jsx)("button",{onClick:()=>{mr(null),br(null)},style:{background:"#6c757d",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{"preventivo"===r.tipo?await Zn():await eo(),mr(null),br(null)},style:{background:"#28a745",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-save"})," Guardar Cambios"]})]})]})})})(),"guia"===Re&&!wn&&(0,ze.jsx)("div",{children:(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1.5rem",fontSize:"20px",fontWeight:"700",color:"#17a2b8",display:"flex",alignItems:"center",gap:"12px",paddingBottom:"0.75rem",borderBottom:"3px solid #17a2b8"},children:[(0,ze.jsx)("div",{style:{width:"4px",height:"40px",background:"#17a2b8",borderRadius:"2px"}}),"\xbfCU\xc1NDO Y D\xd3NDE DEBEMOS UTILIZAR ESTOS CONTROLES?"]}),(0,ze.jsxs)("div",{style:{position:"relative",paddingLeft:"2rem"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"24px",top:"0",bottom:"0",width:"2px",background:"#17a2b8",opacity:"0.3"}}),(0,ze.jsxs)("div",{style:{marginBottom:"2rem",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"-2rem",top:"0",width:"48px",height:"48px",borderRadius:"50%",border:"3px solid #17a2b8",background:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:(0,ze.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"6px",background:"#17a2b8",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"700",fontSize:"14px"},children:"ART"})}),(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem 1rem 1rem 3rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#495057",lineHeight:"1.7"},children:["Durante la elaboraci\xf3n del ",(0,ze.jsx)("strong",{children:"An\xe1lisis del Riesgo del Trabajo (ART)"}),", al momento de identificar los Riesgos Cr\xedticos y sus controles respectivos, asociados a las tareas a ejecutar (Rutinarias, No Rutinarias, Cr\xedticas y Emergencias)."]})})]}),(0,ze.jsxs)("div",{style:{marginBottom:"2rem",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"-2rem",top:"0",width:"48px",height:"48px",borderRadius:"50%",border:"3px solid #17a2b8",background:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:(0,ze.jsx)("i",{className:"fa fa-search",style:{fontSize:"20px",color:"#17a2b8"}})}),(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem 1rem 1rem 3rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#495057",lineHeight:"1.7"},children:["Como elemento de soporte para los procesos de ",(0,ze.jsx)("strong",{children:"investigaci\xf3n de Eventos Significativos"}),"."]})})]}),(0,ze.jsxs)("div",{style:{marginBottom:"2rem",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"-2rem",top:"0",width:"48px",height:"48px",borderRadius:"50%",border:"3px solid #17a2b8",background:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:(0,ze.jsx)("i",{className:"fa fa-comments",style:{fontSize:"20px",color:"#17a2b8"}})}),(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem 1rem 1rem 3rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#495057",lineHeight:"1.7"},children:["Apoyo para reforzar los Controles Cr\xedticos durante las ",(0,ze.jsx)("strong",{children:"charlas de seguridad de inicio de turno"})," u otras."]})})]}),(0,ze.jsxs)("div",{style:{marginBottom:"2rem",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"-2rem",top:"0",width:"48px",height:"48px",borderRadius:"50%",border:"3px solid #17a2b8",background:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:(0,ze.jsx)("i",{className:"fa fa-graduation-cap",style:{fontSize:"20px",color:"#17a2b8"}})}),(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem 1rem 1rem 3rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#495057",lineHeight:"1.7"},children:["Contenido para actividades de ",(0,ze.jsx)("strong",{children:"capacitaci\xf3n y entrenamiento SSO"}),"."]})})]}),(0,ze.jsxs)("div",{style:{position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"-2rem",top:"0",width:"48px",height:"48px",borderRadius:"50%",border:"3px solid #17a2b8",background:"white",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:(0,ze.jsx)("i",{className:"fa fa-cogs",style:{fontSize:"20px",color:"#17a2b8"}})}),(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem 1rem 1rem 3rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#495057",lineHeight:"1.7"},children:["Complemento para la elaboraci\xf3n de ",(0,ze.jsx)("strong",{children:"est\xe1ndares de proceso, procedimientos y/o instructivos de trabajo"}),"."]})})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #dc3545",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"20px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"12px",paddingBottom:"0.75rem",borderBottom:"3px solid #0a3265"},children:[(0,ze.jsx)("div",{style:{width:"4px",height:"40px",background:"#0a3265",borderRadius:"2px"}}),"PREGUNTAS TRANSVERSALES PARA TODOS LOS RIESGOS"]}),(0,ze.jsxs)("div",{style:{background:"#dc3545",color:"white",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1.5rem",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{fontSize:"16px"}}),"Las siguientes preguntas son transversales. Responda siempre, independiente del Riesgo Cr\xedtico al que est\xe9 expuesto."]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"#0a3265",borderRadius:"8px",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"#0a3265",color:"white",padding:"1rem",display:"flex",alignItems:"center",gap:"10px",fontWeight:"700",fontSize:"16px"},children:[(0,ze.jsx)("i",{className:"fa fa-clipboard",style:{fontSize:"18px"}}),"SUPERVISOR(A)"]}),(0,ze.jsx)("div",{style:{background:"white",padding:"1rem"},children:(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfEl trabajo que asignar\xe9 cuenta con un est\xe1ndar, procedimiento y/o Instructivo espec\xedfico?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfEl personal que asignar\xe9 para realizar el trabajo, cuenta con las capacitaciones, certificaciones, competencias, salud compatible y/o acreditaciones requeridas?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfDurante la planificaci\xf3n del trabajo, me aseguro de solicitar los permisos para ingresar a las \xe1reas, intervenir equipos y/o interactuar con energ\xedas?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfVerifiqu\xe9 que el personal cuenta con los elementos requeridos para realizar la segregaci\xf3n y se\xf1alizaci\xf3n del \xe1rea de trabajo, seg\xfan dise\xf1o?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfEl personal que asignar\xe9 para realizar el trabajo conoce el protocolo de emergencia del \xe1rea?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfEl personal a mi cargo cuenta con sistema de comunicaci\xf3n de acuerdo al protocolo de emergencia del \xe1rea?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfEl personal que asignar\xe9 para realizar el trabajo, cuenta con los EPPs definidos en el procedimiento de trabajo?"})})]})})]}),(0,ze.jsxs)("div",{style:{background:"#0a3265",borderRadius:"8px",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"#0a3265",color:"white",padding:"1rem",display:"flex",alignItems:"center",gap:"10px",fontWeight:"700",fontSize:"16px"},children:[(0,ze.jsx)("i",{className:"fa fa-cogs",style:{fontSize:"18px"}}),"TRABAJADOR(A)"]}),(0,ze.jsx)("div",{style:{background:"white",padding:"1rem"},children:(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfConozco el est\xe1ndar, procedimiento y/o Instructivo espec\xedfico del trabajo que ejecutar\xe9?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfCuento con las competencias y salud compatible para ejecutar el trabajo?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfCuento con la autorizaci\xf3n para ingresar al \xe1rea a ejecutar el trabajo?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfSegregu\xe9 y se\xf1alic\xe9 el \xe1rea de trabajo con los elementos seg\xfan dise\xf1o?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfConozco y estoy entrenado en el procedimiento de emergencia del \xe1rea de trabajo?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfConozco el n\xfamero de tel\xe9fono o frecuencia radial para dar aviso en caso de emergencia, seg\xfan protocolo del \xe1rea?"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,ze.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#495057",lineHeight:"1.6",fontWeight:"500"},children:"\xbfUso los EPPs definidos para el trabajo y se encuentran en buenas condiciones?"})})]})})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #FF8C00",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"18px",fontWeight:"700",color:"#FF8C00",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-question-circle",style:{color:"#FF8C00"}}),"\xbfQu\xe9 son los Controles Cr\xedticos?"]}),(0,ze.jsxs)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8"},children:[(0,ze.jsxs)("p",{style:{marginBottom:"1rem"},children:["Los ",(0,ze.jsx)("strong",{children:"Controles Cr\xedticos"})," son medidas de seguridad espec\xedficas y esenciales que deben estar presentes y funcionando correctamente para prevenir o mitigar eventos no deseados que puedan resultar en lesiones graves, fatalidades o da\xf1os significativos."]}),(0,ze.jsx)("p",{style:{marginBottom:"1rem"},children:"Estos controles son identificados mediante un an\xe1lisis de riesgo que considera la probabilidad y severidad de los eventos peligrosos asociados a cada actividad o proceso."})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"18px",fontWeight:"700",color:"#17a2b8",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-shield-alt",style:{color:"#17a2b8"}}),"Tipos de Controles Cr\xedticos"]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%)",padding:"1rem",borderRadius:"6px",border:"2px solid #17a2b8"},children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#0c5460",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{color:"#17a2b8"}}),"Control Preventivo"]}),(0,ze.jsxs)("p",{style:{margin:0,fontSize:"13px",color:"#0c5460",lineHeight:"1.6"},children:["Medidas implementadas ",(0,ze.jsx)("strong",{children:"antes"})," de iniciar la actividad para prevenir que ocurra el evento no deseado. Estos controles eliminan o reducen la probabilidad de que el riesgo se materialice."]})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%)",padding:"1rem",borderRadius:"6px",border:"2px solid #8B4513"},children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"16px",fontWeight:"700",color:"#8B4513",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{color:"#8B4513"}}),"Control Mitigador"]}),(0,ze.jsxs)("p",{style:{margin:0,fontSize:"13px",color:"#8B4513",lineHeight:"1.6"},children:["Medidas implementadas para ",(0,ze.jsx)("strong",{children:"reducir las consecuencias"})," si el evento no deseado ocurre. Estos controles minimizan el impacto y la severidad del evento."]})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #808080",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"18px",fontWeight:"700",color:"#808080",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{color:"#808080"}}),"Roles y Responsabilidades"]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"2px solid #FF8C00"},children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"15px",fontWeight:"700",color:"#FF8C00",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-user-tie",style:{fontSize:"18px"}}),"Supervisor"]}),(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"13px",color:"#495057",lineHeight:"1.8"},children:[(0,ze.jsx)("li",{children:"Verificar que los controles preventivos est\xe9n implementados antes de autorizar el inicio de la actividad"}),(0,ze.jsx)("li",{children:"Supervisar el cumplimiento de los controles durante la ejecuci\xf3n del trabajo"}),(0,ze.jsx)("li",{children:"Validar la efectividad de los controles mitigadores"}),(0,ze.jsx)("li",{children:"Detener la actividad si alg\xfan control cr\xedtico est\xe1 ausente o fallido"}),(0,ze.jsx)("li",{children:"Documentar y reportar desviaciones en los controles"})]})]}),(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"2px solid #8B4513"},children:[(0,ze.jsxs)("h4",{style:{margin:0,marginBottom:"0.75rem",fontSize:"15px",fontWeight:"700",color:"#8B4513",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-hard-hat",style:{fontSize:"18px"}}),"Trabajador"]}),(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"13px",color:"#495057",lineHeight:"1.8"},children:[(0,ze.jsx)("li",{children:"Conocer y comprender los controles cr\xedticos de su actividad"}),(0,ze.jsx)("li",{children:"Verificar la presencia y funcionamiento de los controles antes de iniciar"}),(0,ze.jsx)("li",{children:"Aplicar correctamente los controles preventivos y mitigadores"}),(0,ze.jsx)("li",{children:"Detener el trabajo si identifica que un control cr\xedtico est\xe1 ausente o fallido"}),(0,ze.jsx)("li",{children:"Notificar inmediatamente al supervisor sobre cualquier desviaci\xf3n"})]})]})]})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%)",padding:"1.5rem",borderRadius:"8px",border:"2px solid #8B4513",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"18px",fontWeight:"700",color:"#8B4513",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-circle",style:{fontSize:"20px"}}),"Procedimiento cuando un Control Cr\xedtico est\xe1 Ausente o Fallido"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#8B4513",lineHeight:"1.8"},children:(0,ze.jsxs)("ol",{style:{margin:0,paddingLeft:"1.5rem"},children:[(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"DETENER LA ACTIVIDAD"})," inmediatamente. No continuar trabajando sin el control cr\xedtico."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"APLICAR TARJETA VERDE"})," para indicar que la actividad est\xe1 detenida por una desviaci\xf3n en los controles cr\xedticos."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"NOTIFICAR AL SUPERVISOR"})," de manera inmediata sobre la situaci\xf3n identificada."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"EVALUAR LA DESVIACI\xd3N"})," junto con el supervisor para determinar las acciones correctivas necesarias."]}),(0,ze.jsxs)("li",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsx)("strong",{children:"NORMALIZAR EL CONTROL"})," ausente o fallido antes de reanudar la actividad."]}),(0,ze.jsxs)("li",{children:[(0,ze.jsx)("strong",{children:"DOCUMENTAR"})," la desviaci\xf3n, las acciones tomadas y la verificaci\xf3n del control antes de continuar."]})]})})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"2px solid #17a2b8",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("h3",{style:{margin:0,marginBottom:"1rem",fontSize:"18px",fontWeight:"700",color:"#17a2b8",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-clipboard-check",style:{color:"#17a2b8"}}),"Preguntas de Verificaci\xf3n"]}),(0,ze.jsxs)("div",{style:{fontSize:"14px",color:"#495057",lineHeight:"1.8"},children:[(0,ze.jsxs)("p",{style:{marginBottom:"1rem"},children:["Cada control cr\xedtico tiene asociadas ",(0,ze.jsx)("strong",{children:"preguntas de verificaci\xf3n"})," que deben ser respondidas antes y durante la ejecuci\xf3n del trabajo. Estas preguntas ayudan a:"]}),(0,ze.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[(0,ze.jsx)("li",{children:"Confirmar que el control est\xe1 presente y funcionando correctamente"}),(0,ze.jsx)("li",{children:"Validar que se cumplen los requisitos espec\xedficos del control"}),(0,ze.jsx)("li",{children:"Identificar cualquier desviaci\xf3n o condici\xf3n insegura"}),(0,ze.jsx)("li",{children:"Documentar la verificaci\xf3n del control"})]}),(0,ze.jsxs)("p",{style:{marginTop:"1rem",marginBottom:0,fontStyle:"italic",color:"#6c757d"},children:[(0,ze.jsx)("strong",{children:"Importante:"})," Si la respuesta a cualquier pregunta de verificaci\xf3n es negativa o no se puede confirmar, el control se considera ausente o fallido y se debe seguir el procedimiento de acci\xf3n descrito anteriormente."]})]})]})]})}),"riesgo"===Re&&!wn&&(0,ze.jsx)("div",{children:Oe?(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[!ja(d)&&(0,ze.jsxs)("div",{style:{background:"#fff3cd",border:"1px solid #ffc107",borderRadius:"6px",padding:"0.5rem 0.75rem",color:"#856404",fontSize:"12px",display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle"}),(0,ze.jsxs)("span",{children:["Solo administradores pueden editar la informaci\xf3n de riesgo cr\xedtico. Esta informaci\xf3n est\xe1 asociada a la carpeta ",(0,ze.jsx)("strong",{children:h.nombre}),"."]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%)",padding:"0.75rem 1rem",borderRadius:"6px",border:"1px solid #ffc107"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.375rem"},children:[(0,ze.jsx)("div",{style:{fontWeight:"700",color:"#856404",fontSize:"11px",textTransform:"uppercase"},children:"EVENTO NO DESEADO:"}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{Sr.evento_no_deseado?(to(),wr(Ue(Ue({},Sr),{},{evento_no_deseado:!1}))):wr(Ue(Ue({},Sr),{},{evento_no_deseado:!0}))},style:{background:Sr.evento_no_deseado?"#28a745":"#ffc107",color:Sr.evento_no_deseado?"white":"#856404",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(Sr.evento_no_deseado?"save":"edit")}),Sr.evento_no_deseado?"Guardar":"Editar"]})]}),Sr.evento_no_deseado?(0,ze.jsx)("textarea",{value:Oe.evento_no_deseado,onChange:e=>Pe(Ue(Ue({},Oe),{},{evento_no_deseado:e.target.value})),style:{width:"100%",minHeight:"50px",padding:"0.5rem",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"13px",fontFamily:"inherit",resize:"vertical"},placeholder:"Ej: CONTACTO CON ENERG\xcdA EL\xc9CTRICA"}):(0,ze.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#856404"},children:Oe.evento_no_deseado||"No especificado"})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%)",padding:"0.75rem 1rem",borderRadius:"6px",border:"1px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.375rem"},children:[(0,ze.jsx)("div",{style:{fontWeight:"700",color:"#0c5460",fontSize:"11px",textTransform:"uppercase"},children:"EVENTO DE RIESGO:"}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{Sr.evento_riesgo?(to(),wr(Ue(Ue({},Sr),{},{evento_riesgo:!1}))):wr(Ue(Ue({},Sr),{},{evento_riesgo:!0}))},style:{background:Sr.evento_riesgo?"#28a745":"#17a2b8",color:(Sr.evento_riesgo,"white"),border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(Sr.evento_riesgo?"save":"edit")}),Sr.evento_riesgo?"Guardar":"Editar"]})]}),Sr.evento_riesgo?(0,ze.jsx)("textarea",{value:Oe.evento_riesgo,onChange:e=>Pe(Ue(Ue({},Oe),{},{evento_riesgo:e.target.value})),style:{width:"100%",minHeight:"50px",padding:"0.5rem",border:"1px solid #17a2b8",borderRadius:"4px",fontSize:"13px",fontFamily:"inherit",resize:"vertical"},placeholder:"Ej: INTERACCI\xd3N CON ENERG\xcdA EL\xc9CTRICA"}):(0,ze.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#0c5460"},children:Oe.evento_riesgo||"No especificado"})]})]}),(()=>{const e=(e,t,r)=>{var n,o,a,i;return(0,ze.jsxs)("div",{style:{background:"#ffffff",padding:"0",borderRadius:"8px",border:"1px solid ".concat(r),boxShadow:"0 2px 6px rgba(0,0,0,0.1)",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"#495057",color:"white",padding:"0.625rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"2px solid ".concat(r)},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat("supervisor"===e?"user-tie":"hard-hat"),style:{fontSize:"16px"}}),(0,ze.jsx)("span",{style:{fontWeight:"700",fontSize:"14px",letterSpacing:"0.3px"},children:t.toUpperCase()})]}),(0,ze.jsx)("i",{className:"fa fa-clipboard-check",style:{fontSize:"14px",opacity:"0.8"}})]}),(0,ze.jsxs)("div",{style:{padding:"1rem"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.25rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",padding:"0.5rem 0.75rem",borderRadius:"4px",fontWeight:"700",fontSize:"12px",color:"white"},children:"CONTROL PREVENTIVO"}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{const t="".concat(e,"_preventivo");Sr[t]?(to(),wr(Ue(Ue({},Sr),{},{[t]:!1}))):wr(Ue(Ue({},Sr),{},{[t]:!0}))},style:{background:Sr["".concat(e,"_preventivo")]?"#28a745":"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(Sr["".concat(e,"_preventivo")]?"save":"edit")}),Sr["".concat(e,"_preventivo")]?"Guardar":"Editar"]})]}),(0,ze.jsxs)("div",{style:{border:"1px solid #dee2e6",borderRadius:"4px",overflow:"hidden",marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 1fr",background:"#17a2b8",borderBottom:"1px solid #138496",fontWeight:"700",fontSize:"12px",color:"white"},children:[(0,ze.jsx)("div",{style:{padding:"0.5rem",textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.3)"},children:"N\xb0"}),(0,ze.jsx)("div",{style:{padding:"0.5rem",borderRight:"1px solid rgba(255,255,255,0.3)"},children:"CONTROL PREVENTIVO"}),(0,ze.jsx)("div",{style:{padding:"0.5rem"},children:"PREGUNTAS"})]}),(null===(n=Oe["controles_".concat(e)])||void 0===n||null===(o=n.preventivos)||void 0===o?void 0:o.length)>0?Oe["controles_".concat(e)].preventivos.map((t,r)=>(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 1fr",borderBottom:r<Oe["controles_".concat(e)].preventivos.length-1?"1px solid #dee2e6":"none",background:r%2===0?"#ffffff":"#f8f9fa",transition:"background 0.2s"},onMouseEnter:t=>{Sr["".concat(e,"_preventivo")]||(t.currentTarget.style.background="#e7f3ff")},onMouseLeave:t=>{Sr["".concat(e,"_preventivo")]||(t.currentTarget.style.background=r%2===0?"#ffffff":"#f8f9fa")},children:[(0,ze.jsx)("div",{style:{padding:"0.75rem 0.5rem",textAlign:"center",borderRight:"1px solid #dee2e6",display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",fontWeight:"700",color:"#17a2b8",fontSize:"14px"},children:Sr["".concat(e,"_preventivo")]?(0,ze.jsx)("input",{type:"text",value:t.numero||"",onChange:t=>oo(e,"preventivos",r,"numero",t.target.value),style:{width:"100%",padding:"4px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"12px",textAlign:"center",fontWeight:"700"},placeholder:"01"}):t.numero||"0".concat(r+1)}),(0,ze.jsx)("div",{style:{padding:"0.75rem",borderRight:"1px solid #dee2e6",display:"flex",alignItems:"center"},children:Sr["".concat(e,"_preventivo")]?(0,ze.jsx)("textarea",{value:t.descripcion||"",onChange:t=>oo(e,"preventivos",r,"descripcion",t.target.value),style:{width:"100%",minHeight:"50px",padding:"6px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"},placeholder:"Ej: Identificaci\xf3n y corte efectivo de todas las fuentes de energ\xeda."}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#212529",lineHeight:"1.5",width:"100%",fontWeight:"500"},children:t.descripcion||"Sin descripci\xf3n"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",display:"flex",alignItems:"center"},children:Sr["".concat(e,"_preventivo")]?(0,ze.jsxs)("div",{style:{width:"100%",display:"flex",gap:"6px",alignItems:"flex-start"},children:[(0,ze.jsx)("textarea",{value:t.pregunta||"",onChange:t=>oo(e,"preventivos",r,"pregunta",t.target.value),style:{width:"100%",minHeight:"50px",padding:"6px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"},placeholder:"Ej: El\xe9ctrico: \xbfLa identificaci\xf3n y se\xf1alizaci\xf3n de los puntos para el corte de energ\xeda se encuentran definidos en el procedimiento y/o mapa de energ\xedas?"}),(0,ze.jsx)("button",{onClick:()=>no(e,"preventivos",r),style:{background:"#dc3545",color:"white",border:"none",padding:"6px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"11px",flexShrink:0,height:"fit-content"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#212529",lineHeight:"1.5",width:"100%"},children:t.pregunta||"Sin pregunta"})})]},"preventivo-".concat(r))):(0,ze.jsx)("div",{style:{padding:"1.5rem",textAlign:"center",color:"#6c757d",fontSize:"13px",gridColumn:"1 / -1"},children:"No hay controles preventivos registrados"})]}),Sr["".concat(e,"_preventivo")]&&(0,ze.jsxs)("button",{onClick:()=>ro(e,"preventivos"),style:{background:"#17a2b8",color:"white",border:"none",padding:"8px 16px",borderRadius:"5px",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseEnter:e=>{e.currentTarget.style.background="#138496",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="#17a2b8",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control Preventivo"]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",padding:"0.5rem 0.75rem",borderRadius:"4px",fontWeight:"700",fontSize:"12px",color:"#856404"},children:"CONTROL MITIGADOR"}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{const t="".concat(e,"_mitigador");Sr[t]?(to(),wr(Ue(Ue({},Sr),{},{[t]:!1}))):wr(Ue(Ue({},Sr),{},{[t]:!0}))},style:{background:Sr["".concat(e,"_mitigador")]?"#28a745":"#ffc107",color:Sr["".concat(e,"_mitigador")]?"white":"#856404",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(Sr["".concat(e,"_mitigador")]?"save":"edit")}),Sr["".concat(e,"_mitigador")]?"Guardar":"Editar"]})]}),(0,ze.jsxs)("div",{style:{border:"1px solid #dee2e6",borderRadius:"4px",overflow:"hidden",marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 1fr",background:"#ffc107",borderBottom:"1px solid #ff9800",fontWeight:"700",fontSize:"12px",color:"#856404"},children:[(0,ze.jsx)("div",{style:{padding:"0.5rem",textAlign:"center",borderRight:"1px solid rgba(133,100,4,0.3)"},children:"N\xb0"}),(0,ze.jsx)("div",{style:{padding:"0.5rem",borderRight:"1px solid rgba(133,100,4,0.3)"},children:"CONTROL MITIGADOR"}),(0,ze.jsx)("div",{style:{padding:"0.5rem"},children:"PREGUNTAS"})]}),(null===(a=Oe["controles_".concat(e)])||void 0===a||null===(i=a.mitigadores)||void 0===i?void 0:i.length)>0?Oe["controles_".concat(e)].mitigadores.map((t,r)=>(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 1fr",borderBottom:r<Oe["controles_".concat(e)].mitigadores.length-1?"1px solid #dee2e6":"none",background:r%2===0?"#ffffff":"#f8f9fa",transition:"background 0.2s"},onMouseEnter:t=>{Sr["".concat(e,"_mitigador")]||(t.currentTarget.style.background="#fff8e1")},onMouseLeave:t=>{Sr["".concat(e,"_mitigador")]||(t.currentTarget.style.background=r%2===0?"#ffffff":"#f8f9fa")},children:[(0,ze.jsx)("div",{style:{padding:"0.75rem 0.5rem",textAlign:"center",borderRight:"1px solid #dee2e6",display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",fontWeight:"700",color:"#17a2b8",fontSize:"14px"},children:Sr["".concat(e,"_mitigador")]?(0,ze.jsx)("input",{type:"text",value:t.numero||"",onChange:t=>oo(e,"mitigadores",r,"numero",t.target.value),style:{width:"100%",padding:"4px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"12px",textAlign:"center",fontWeight:"700"},placeholder:"05"}):t.numero||"0".concat(r+1)}),(0,ze.jsx)("div",{style:{padding:"0.75rem",borderRight:"1px solid #dee2e6",display:"flex",alignItems:"center"},children:Sr["".concat(e,"_mitigador")]?(0,ze.jsx)("textarea",{value:t.descripcion||"",onChange:t=>oo(e,"mitigadores",r,"descripcion",t.target.value),style:{width:"100%",minHeight:"50px",padding:"6px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"},placeholder:"Ej: Protecciones en sistemas el\xe9ctricos de baja, media y alta tensi\xf3n"}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#212529",lineHeight:"1.5",width:"100%",fontWeight:"500"},children:t.descripcion||"Sin descripci\xf3n"})}),(0,ze.jsx)("div",{style:{padding:"0.75rem",display:"flex",alignItems:"center"},children:Sr["".concat(e,"_mitigador")]?(0,ze.jsxs)("div",{style:{width:"100%",display:"flex",gap:"6px",alignItems:"flex-start"},children:[(0,ze.jsx)("textarea",{value:t.pregunta||"",onChange:t=>oo(e,"mitigadores",r,"pregunta",t.target.value),style:{width:"100%",minHeight:"50px",padding:"6px",border:"1px solid #ced4da",borderRadius:"4px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"},placeholder:"Ej: El\xe9ctrico: \xbfLas protecciones el\xe9ctricas de los equipos a intervenir se encuentran con sus mantenciones al d\xeda?"}),(0,ze.jsx)("button",{onClick:()=>no(e,"mitigadores",r),style:{background:"#dc3545",color:"white",border:"none",padding:"6px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"11px",flexShrink:0,height:"fit-content"},title:"Eliminar control",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#212529",lineHeight:"1.5",width:"100%"},children:t.pregunta||"Sin pregunta"})})]},"mitigador-".concat(r))):(0,ze.jsx)("div",{style:{padding:"1.5rem",textAlign:"center",color:"#6c757d",fontSize:"13px",gridColumn:"1 / -1"},children:"No hay controles mitigadores registrados"})]}),Sr["".concat(e,"_mitigador")]&&(0,ze.jsxs)("button",{onClick:()=>ro(e,"mitigadores"),style:{background:"#ffc107",color:"#856404",border:"none",padding:"8px 16px",borderRadius:"5px",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseEnter:e=>{e.currentTarget.style.background="#ff9800",e.currentTarget.style.color="white",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="#ffc107",e.currentTarget.style.color="#856404",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"})," Agregar Control Mitigador"]})]})]})]},e)};return(0,ze.jsxs)(ze.Fragment,{children:[e("supervisor","Supervisor","#17a2b8"),e("trabajador","Trabajador","#28a745")]})})(),(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.75rem 1rem",borderRadius:"6px",border:"1px solid #dee2e6"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,ze.jsxs)("div",{style:{fontWeight:"700",color:"#495057",fontSize:"13px"},children:[(0,ze.jsx)("i",{className:"fa fa-robot",style:{marginRight:"6px"}}),"Informaci\xf3n para Chatbot (Texto completo del riesgo cr\xedtico)"]}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{Sr.informacion_riesgo?(to(),wr(Ue(Ue({},Sr),{},{informacion_riesgo:!1}))):wr(Ue(Ue({},Sr),{},{informacion_riesgo:!0}))},style:{background:Sr.informacion_riesgo?"#28a745":"#6c757d",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(Sr.informacion_riesgo?"save":"edit")}),Sr.informacion_riesgo?"Guardar":"Editar"]})]}),Sr.informacion_riesgo?(0,ze.jsx)("textarea",{value:Oe.informacion_riesgo,onChange:e=>Pe(Ue(Ue({},Oe),{},{informacion_riesgo:e.target.value})),style:{width:"100%",minHeight:"150px",padding:"0.625rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"13px",fontFamily:"inherit",resize:"vertical"},placeholder:"Ingrese toda la informaci\xf3n del riesgo cr\xedtico en formato texto plano. Esta informaci\xf3n ser\xe1 utilizada por el chatbot para responder preguntas sobre este riesgo cr\xedtico."}):(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#495057",whiteSpace:"pre-wrap",lineHeight:"1.5"},children:Oe.informacion_riesgo||"No hay informaci\xf3n disponible para el chatbot"})]}),(0,ze.jsxs)("div",{style:{background:"#f8d7da",padding:"0.75rem 1rem",borderRadius:"6px",border:"1px solid #dc3545",color:"#721c24"},children:[(0,ze.jsxs)("div",{style:{fontWeight:"700",marginBottom:"0.375rem",fontSize:"13px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-circle",style:{marginRight:"6px"}}),"IMPORTANTE"]}),(0,ze.jsx)("div",{style:{fontSize:"12px",lineHeight:"1.4"},children:"Si un Control Cr\xedtico no est\xe1 presente, detenga la actividad. Luego, aplique tarjeta verde y notifique al supervisor para evaluar la desviaci\xf3n y juntos normalizar el control ausente o fallido."})]})]}):(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{fontSize:"3rem",marginBottom:"1rem",color:"#ffc107"}}),(0,ze.jsx)("p",{children:"No hay informaci\xf3n de riesgo cr\xedtico disponible para esta carpeta."}),ja(d)&&(0,ze.jsxs)("button",{onClick:()=>{Pe({evento_no_deseado:"",evento_riesgo:"",controles_supervisor:{preventivos:[],mitigadores:[]},controles_trabajador:{preventivos:[],mitigadores:[]},informacion_riesgo:""}),wr({evento_no_deseado:!0,evento_riesgo:!1,supervisor_preventivo:!1,supervisor_mitigador:!1,trabajador_preventivo:!1,trabajador_mitigador:!1,informacion_riesgo:!1})},style:{background:"#17a2b8",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600",marginTop:"1rem"},children:[(0,ze.jsx)("i",{className:"fa fa-plus",style:{marginRight:"8px"}}),"Agregar Informaci\xf3n de Riesgo Cr\xedtico"]})]})}),"foro"===Re&&!wn&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,ze.jsxs)("h2",{style:{margin:0,color:"#17a2b8"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{marginRight:"8px"}}),'Foro de "',h.nombre,'"']}),(0,ze.jsxs)("button",{onClick:go,style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(10, 110, 189, 0.2)"},onMouseEnter:e=>{e.currentTarget.style.background="#085a9d",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(10, 110, 189, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="#17a2b8",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(10, 110, 189, 0.2)"},title:"Ver participantes de la carpeta",children:[(0,ze.jsx)("i",{className:"fa fa-users"}),"Participantes"]})]})}),(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",border:"2px solid #e9ecef"},children:[Rr&&(0,ze.jsxs)("div",{style:{background:"#e7f3ff",padding:"0.75rem",borderRadius:"6px",marginBottom:"0.75rem",borderLeft:"4px solid #17a2b8",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Respondiendo a:"}),(0,ze.jsxs)("div",{style:{fontSize:"13px",color:"#17a2b8",fontWeight:"500"},children:[Rr.usuario_nombre,": ",Rr.mensaje.substring(0,50),"..."]})]}),(0,ze.jsx)("button",{onClick:()=>{Nr(null),zr("")},style:{background:"none",border:"none",color:"#dc3545",cursor:"pointer",fontSize:"18px",padding:"0 8px"},children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsx)("textarea",{value:Rr?Ar:Er,onChange:e=>Rr?zr(e.target.value):Tr(e.target.value),placeholder:Rr?"Escribe tu respuesta...":"Escribe un mensaje en el foro...",style:{width:"100%",padding:"10px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",minHeight:"80px",resize:"vertical",fontFamily:"inherit",marginBottom:"0.75rem"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"}}),(0,ze.jsxs)("button",{onClick:ao,disabled:Rr?!Ar.trim():!Er.trim(),style:{background:Rr?Ar.trim()?"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)":"#ccc":Er.trim()?"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)":"#ccc",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:(Rr?Ar.trim():Er.trim())?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-paper-plane"}),Rr?"Enviar Respuesta":"Publicar Mensaje"]})]}),0===kr.length?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{fontSize:"3rem",marginBottom:"1rem",opacity:.3}}),(0,ze.jsx)("p",{style:{fontSize:"16px",margin:0},children:"No hay mensajes en el foro a\xfan."}),(0,ze.jsx)("p",{style:{fontSize:"14px",marginTop:"0.5rem"},children:"S\xe9 el primero en iniciar una conversaci\xf3n."})]}):(0,ze.jsx)("div",{style:{display:"grid",gap:"1rem"},children:kr.map(e=>{var t,r,n;return(0,ze.jsxs)("div",{id:"mensaje-".concat(e.id),style:{background:"#ffffff",border:"2px solid #e9ecef",borderRadius:"8px",padding:"1rem",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#17a2b8",e.currentTarget.style.boxShadow="0 2px 8px rgba(10, 110, 189, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e9ecef",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontWeight:"600",fontSize:"14px"},children:e.usuario_nombre?e.usuario_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"14px"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:uh(e.creado_en)})]})]}),(0,ze.jsxs)("button",{onClick:()=>{Or(t=>Ue(Ue({},t),{},{[e.id]:void 0!==t[e.id]?void 0:""})),Nr(e)},style:{background:void 0!==Ir[e.id]?"#17a2b8":"none",border:"1px solid #17a2b8",color:void 0!==Ir[e.id]?"white":"#17a2b8",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:t=>{void 0===Ir[e.id]&&(t.target.style.background="#17a2b8",t.target.style.color="white")},onMouseLeave:t=>{void 0===Ir[e.id]&&(t.target.style.background="none",t.target.style.color="#17a2b8")},children:[(0,ze.jsx)("i",{className:"fa fa-reply",style:{marginRight:"4px"}}),void 0!==Ir[e.id]?"Ocultar respuesta":"Responder"]})]}),(0,ze.jsx)("div",{style:{color:"#212529",fontSize:"14px",lineHeight:"1.6",whiteSpace:"pre-wrap",marginBottom:e.respuestas&&e.respuestas.length>0?"1rem":"0"},children:e.mensaje}),void 0!==Ir[e.id]&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px",border:"2px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.75rem"},children:[(0,ze.jsx)("i",{className:"fa fa-reply",style:{color:"#17a2b8"}}),(0,ze.jsxs)("span",{style:{fontSize:"13px",color:"#17a2b8",fontWeight:"600"},children:["Respondiendo a ",e.usuario_nombre||"Usuario"]})]}),(0,ze.jsx)("textarea",{value:Ir[e.id]||"",onChange:t=>{Or(r=>Ue(Ue({},r),{},{[e.id]:t.target.value}))},placeholder:"Escribe tu respuesta...",style:{width:"100%",padding:"10px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",minHeight:"80px",resize:"vertical",fontFamily:"inherit",marginBottom:"0.75rem"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"}}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{Or(t=>{const r=Ue({},t);return delete r[e.id],r})},style:{padding:"8px 16px",borderRadius:"6px",border:"2px solid #6c757d",background:"white",color:"#6c757d",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:()=>{var t;const r=null===(t=Ir[e.id])||void 0===t?void 0:t.trim();r&&ao(e.id,r)},disabled:!(null!==(t=Ir[e.id])&&void 0!==t&&t.trim()),style:{padding:"8px 16px",borderRadius:"6px",border:"none",background:null!==(r=Ir[e.id])&&void 0!==r&&r.trim()?"linear-gradient(135deg, #17a2b8 0%, #8B4513 100%)":"#ccc",color:"white",cursor:null!==(n=Ir[e.id])&&void 0!==n&&n.trim()?"pointer":"not-allowed",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-paper-plane"}),"Enviar Respuesta"]})]})]}),e.respuestas&&e.respuestas.length>0&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"0.75rem",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-reply",style:{marginRight:"4px"}}),e.respuestas.length," ",1===e.respuestas.length?"respuesta":"respuestas"]}),e.respuestas.map(e=>(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.75rem",borderRadius:"6px",marginBottom:"0.5rem",borderLeft:"3px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontWeight:"600",fontSize:"12px"},children:e.usuario_nombre?e.usuario_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"13px"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#666"},children:uh(e.creado_en)})]})]}),(0,ze.jsx)("div",{style:{color:"#495057",fontSize:"13px",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:e.mensaje})]},e.id))]})]},e.id)})})]}),"tareas"===Re&&!wn&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,ze.jsxs)("h2",{style:{margin:0,color:"#17a2b8"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{marginRight:"8px"}}),"Tareas y Recordatorios"]}),(0,ze.jsxs)("button",{onClick:go,style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(10, 110, 189, 0.2)"},onMouseEnter:e=>{e.currentTarget.style.background="#085a9d",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(10, 110, 189, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="#17a2b8",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(10, 110, 189, 0.2)"},title:"Ver participantes de la carpeta",children:[(0,ze.jsx)("i",{className:"fa fa-users"}),"Participantes"]})]}),(0,ze.jsxs)("button",{onClick:()=>Br(!0),style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",border:"none",padding:"10px 18px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 6px rgba(40, 167, 69, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus"}),"Nueva Tarea"]})]}),0===Pr.length?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{fontSize:"3rem",marginBottom:"1rem",opacity:.3}}),(0,ze.jsx)("p",{style:{fontSize:"16px",margin:0},children:"No hay tareas asignadas a\xfan."}),(0,ze.jsx)("p",{style:{fontSize:"14px",marginTop:"0.5rem"},children:"Crea una nueva tarea para comenzar a organizar el trabajo."})]}):(0,ze.jsx)("div",{style:{display:"grid",gap:"1rem"},children:Pr.map(e=>{var t,r,n,o;const a={urgente:{bg:"#dc3545",color:"#fff"},alta:{bg:"#fd7e14",color:"#fff"},media:{bg:"#ffc107",color:"#000"},baja:{bg:"#6c757d",color:"#fff"}},i={pendiente:{bg:"#6c757d",color:"#fff"},en_progreso:{bg:"#17a2b8",color:"#fff"},completada:{bg:"#28a745",color:"#fff"},cancelada:{bg:"#dc3545",color:"#fff"}},s=a[e.prioridad]||a.media,l=i[e.estado]||i.pendiente;return(0,ze.jsxs)("div",{id:"tarea-".concat(e.id),style:{background:"completada"===e.estado&&"validada"===e.estado_validacion?"#f8f9fa":"completada"===e.estado&&"pendiente"===e.estado_validacion?"#fff3cd":"#ffffff",border:"completada"===e.estado&&"pendiente"===e.estado_validacion?"2px solid #ffc107":"2px solid #e9ecef",borderRadius:"8px",padding:"1rem",opacity:"completada"===e.estado&&"validada"===e.estado_validacion?.7:1,transition:"all 0.2s ease",boxShadow:"completada"===e.estado&&"pendiente"===e.estado_validacion?"0 2px 8px rgba(255, 193, 7, 0.3)":"none"},onMouseEnter:t=>{"completada"===e.estado&&"pendiente"!==e.estado_validacion||(t.currentTarget.style.borderColor="completada"===e.estado&&"pendiente"===e.estado_validacion?"#ffc107":"#17a2b8",t.currentTarget.style.boxShadow="completada"===e.estado&&"pendiente"===e.estado_validacion?"0 2px 8px rgba(255, 193, 7, 0.4)":"0 2px 8px rgba(10, 110, 189, 0.1)")},onMouseLeave:t=>{t.currentTarget.style.borderColor="completada"===e.estado&&"pendiente"===e.estado_validacion?"#ffc107":"#e9ecef",t.currentTarget.style.boxShadow="completada"===e.estado&&"pendiente"===e.estado_validacion?"0 2px 8px rgba(255, 193, 7, 0.3)":"none"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"0.5rem",flexWrap:"wrap"},children:[(0,ze.jsx)("h3",{style:{margin:0,color:"#17a2b8",fontSize:"16px",fontWeight:"600"},children:e.titulo}),(0,ze.jsx)("span",{style:{background:s.bg,color:s.color,padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},children:e.prioridad}),(0,ze.jsx)("span",{style:{background:l.bg,color:l.color,padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},children:"en_progreso"===e.estado?"En Progreso":"completada"===e.estado?"Completada":"cancelada"===e.estado?"Cancelada":"Pendiente"})]}),e.descripcion&&(0,ze.jsx)("div",{style:{color:"#495057",fontSize:"14px",marginBottom:"0.75rem",lineHeight:"1.5"},children:e.descripcion}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap",fontSize:"12px",color:"#666"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{marginRight:"4px"}}),"Creada por: ",e.creador_nombre||"Usuario"]}),e.asignados&&e.asignados.length>0&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user-check",style:{marginRight:"4px"}}),"Asignada a:"]}),e.asignados.map((t,r)=>(0,ze.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px"},children:[t.usuario_nombre,e.creado_por===d.id&&(0,ze.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas quitar a este usuario de la tarea?"))try{const r=await fetch("".concat(Te,"/archivos/carpeta_tarea_asignaciones.php?tarea_id=").concat(e,"&usuario_id=").concat(t,"&usuario_quita_id=").concat(d.id),{method:"DELETE"}),n=await r.json();r.ok&&n.success?(zn(h.id),alert("Usuario removido de la tarea correctamente")):alert("Error al quitar usuario: "+(n.error||"Error desconocido"))}catch(r){console.error("Error quitando usuario:",r),alert("Error al quitar usuario: "+(r.message||"Error de conexi\xf3n"))}})(e.id,t.usuario_id),style:{background:"none",border:"none",color:"#dc3545",cursor:"pointer",padding:"2px 4px",fontSize:"10px",borderRadius:"3px"},title:"Quitar usuario de la tarea",children:(0,ze.jsx)("i",{className:"fa fa-times"})}),r<e.asignados.length-1&&","]},t.usuario_id)),e.creado_por===d.id&&(0,ze.jsxs)("button",{onClick:()=>Qr(e.id),style:{background:"#17a2b8",color:"white",border:"none",padding:"2px 6px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",fontWeight:"500",marginLeft:"4px"},title:"Invitar usuario a la tarea",children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{marginRight:"2px"}}),"Invitar"]})]}),(!e.asignados||0===e.asignados.length)&&e.asignado_nombre&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user-check",style:{marginRight:"4px"}}),"Asignada a: ",e.asignado_nombre]}),e.creado_por===d.id&&(0,ze.jsxs)("button",{onClick:()=>Qr(e.id),style:{background:"#17a2b8",color:"white",border:"none",padding:"2px 6px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",fontWeight:"500"},title:"Invitar usuario a la tarea",children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{marginRight:"2px"}}),"Invitar"]})]}),(!e.asignados||0===e.asignados.length)&&!e.asignado_nombre&&e.creado_por===d.id&&(0,ze.jsxs)("button",{onClick:()=>Qr(e.id),style:{background:"#17a2b8",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"500"},title:"Invitar usuario a la tarea",children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{marginRight:"4px"}}),"Invitar usuario"]}),e.fecha_vencimiento&&(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-calendar-times",style:{marginRight:"4px"}}),"Vence: ",uh(e.fecha_vencimiento)]}),e.recordatorio_en&&(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-bell",style:{marginRight:"4px"}}),"Recordatorio: ",uh(e.recordatorio_en)]}),"completada"===e.estado&&e.estado_validacion&&(0,ze.jsxs)("span",{style:{background:"validada"===e.estado_validacion?"#28a745":"rechazada"===e.estado_validacion?"#dc3545":"#ffc107",color:"#fff",padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat("validada"===e.estado_validacion?"check-circle":"rechazada"===e.estado_validacion?"times-circle":"clock"),style:{marginRight:"4px"}}),"validada"===e.estado_validacion?"Validada":"rechazada"===e.estado_validacion?"Rechazada":"Pendiente Validaci\xf3n"]}),"completada"===e.estado&&"validada"===e.estado_validacion&&e.validador_nombre&&(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{marginRight:"4px",color:"#28a745"}}),"Validada por: ",e.validador_nombre," ",e.validada_en&&"(".concat(uh(e.validada_en),")")]}),e.motivo_rechazo&&(0,ze.jsxs)("div",{style:{marginTop:"0.5rem",padding:"0.5rem",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"12px",color:"#856404"},children:[(0,ze.jsx)("strong",{children:"Motivo de rechazo:"})," ",e.motivo_rechazo]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"6px",flexDirection:"column"},children:["completada"!==e.estado&&"cancelada"!==e.estado&&(e.asignados&&e.asignados.some(e=>e.usuario_id===d.id)||!e.asignados&&e.asignado_a===d.id||"super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsxs)(ze.Fragment,{children:["pendiente"===e.estado&&(0,ze.jsx)("button",{onClick:()=>io(e.id,"en_progreso"),style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"Iniciar"}),"en_progreso"===e.estado&&(0,ze.jsx)("button",{onClick:()=>io(e.id,"completada"),style:{background:"#28a745",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"Completar"})]}),"completada"===e.estado&&"pendiente"===e.estado_validacion&&(e.creado_por===d.id||"super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsxs)("div",{style:{display:"flex",gap:"6px",flexDirection:"column"},children:[(0,ze.jsxs)("button",{onClick:()=>Nn(e.id,"validada"),style:{background:"#28a745",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:[(0,ze.jsx)("i",{className:"fa fa-check",style:{marginRight:"4px"}}),"Validar"]}),(0,ze.jsxs)("button",{onClick:()=>{const t=window.prompt("Motivo del rechazo (opcional):","");null!==t&&Nn(e.id,"rechazada",t)},style:{background:"#dc3545",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"4px"}}),"Rechazar"]})]})]})]}),(0,ze.jsxs)("div",{style:{marginTop:"1rem",borderTop:"1px solid #e9ecef",paddingTop:"1rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{fontSize:"13px",color:"#666",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{marginRight:"6px"}}),e.cantidad_comentarios||0," ",1===e.cantidad_comentarios?"comentario":"comentarios"]}),(0,ze.jsx)("button",{onClick:()=>Yr(Gr===e.id?null:e.id),style:{background:"none",border:"1px solid #17a2b8",color:"#17a2b8",padding:"4px 10px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:Gr===e.id?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-chevron-up",style:{marginRight:"4px"}}),"Ocultar"]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-chevron-down",style:{marginRight:"4px"}}),"Ver comentarios"]})})]}),Gr===e.id&&(0,ze.jsxs)("div",{children:[e.comentarios&&e.comentarios.length>0&&(0,ze.jsx)("div",{style:{marginBottom:"1rem",maxHeight:"300px",overflowY:"auto"},children:e.comentarios.map(e=>(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.75rem",borderRadius:"6px",marginBottom:"0.5rem",borderLeft:"3px solid #17a2b8"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontWeight:"600",fontSize:"12px"},children:e.usuario_nombre?e.usuario_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"13px"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#666"},children:uh(e.creado_en)})]})]}),(0,ze.jsx)("div",{style:{color:"#212529",fontSize:"13px",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:e.comentario})]},e.id))}),(e.creado_por===d.id||e.asignados&&e.asignados.some(e=>e.usuario_id===d.id)||!e.asignados&&e.asignado_a===d.id||"super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("textarea",{placeholder:"Escribe un comentario sobre el progreso de esta tarea...",value:Hr[e.id]||"",onChange:t=>Vr(r=>Ue(Ue({},r),{},{[e.id]:t.target.value})),style:{width:"100%",minHeight:"80px",padding:"10px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical",boxSizing:"border-box",marginBottom:"0.5rem"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"}}),(0,ze.jsxs)("button",{onClick:()=>(async e=>{var t;const r=null===(t=Hr[e])||void 0===t?void 0:t.trim();if(r)try{const t=await fetch("".concat(Te,"/archivos/carpeta_tarea_comentarios.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tarea_id:e,usuario_id:d.id,comentario:r})}),n=t.headers.get("content-type");let o;if(n&&n.includes("application/json"))o=await t.json();else{const e=await t.text();try{o=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!t.ok)throw new Error(o.error||"Error HTTP ".concat(t.status));o.success&&o.comentario?(Ur(t=>Ue(Ue({},t),{},{[e]:[...t[e]||[],o.comentario]})),Vr(t=>Ue(Ue({},t),{},{[e]:""})),zn(h.id)):o.error?alert("Error al crear comentario: "+o.error):alert("Error al crear comentario: Respuesta inesperada del servidor")}catch(n){console.error("Error creando comentario:",n),alert("Error al crear comentario: "+(n.message||"Error de conexi\xf3n"))}})(e.id),disabled:!(null!==(t=Hr[e.id])&&void 0!==t&&t.trim()),style:{background:null!==(r=Hr[e.id])&&void 0!==r&&r.trim()?"#17a2b8":"#ccc",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:null!==(n=Hr[e.id])&&void 0!==n&&n.trim()?"pointer":"not-allowed",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-paper-plane",style:{marginRight:"6px"}}),"Agregar comentario"]})]}),(0,ze.jsxs)("div",{style:{marginTop:"1.5rem",borderTop:"1px solid #e9ecef",paddingTop:"1rem"},children:[(0,ze.jsxs)("div",{style:{fontSize:"13px",color:"#666",fontWeight:"600",marginBottom:"0.75rem"},children:[(0,ze.jsx)("i",{className:"fa fa-paperclip",style:{marginRight:"6px"}}),"Archivos adjuntos (",(null===(o=$r[e.id])||void 0===o?void 0:o.length)||0,")"]}),$r[e.id]&&$r[e.id].length>0&&(0,ze.jsx)("div",{style:{marginBottom:"1rem"},children:$r[e.id].map(t=>(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.75rem",borderRadius:"6px",marginBottom:"0.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#17a2b8",fontSize:"16px"}}),(0,ze.jsx)("span",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"13px"},children:t.nombre_original})]}),(0,ze.jsxs)("div",{style:{fontSize:"11px",color:"#666",marginLeft:"24px"},children:["Subido por ",t.usuario_nombre||"Usuario"," \u2022 ",uh(t.creado_en),t.tamano&&(0,ze.jsxs)("span",{children:[" \u2022 ",(t.tamano/1024).toFixed(2)," KB"]})]}),t.descripcion&&(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#495057",marginTop:"4px",marginLeft:"24px"},children:t.descripcion})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"6px"},children:[(0,ze.jsx)("button",{onClick:()=>(e=>{let t=e.ruta_archivo;t.startsWith("http")||(t=window.location.origin+(t.startsWith("/")?"":"/")+t);window.open(t,"_blank")})(t),style:{background:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},title:"Descargar archivo",children:(0,ze.jsx)("i",{className:"fa fa-download"})}),(t.usuario_id===d.id||"super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar este archivo adjunto?"))try{const r=await fetch("".concat(Te,"/archivos/carpeta_tarea_adjuntos.php?id=").concat(e,"&usuario_id=").concat(d.id),{method:"DELETE"}),n=await r.json();r.ok&&n.success?(qr(r=>Ue(Ue({},r),{},{[t]:(r[t]||[]).filter(t=>t.id!==e)})),alert("Archivo eliminado correctamente")):alert("Error al eliminar archivo: "+(n.error||"Error desconocido"))}catch(r){console.error("Error eliminando adjunto:",r),alert("Error al eliminar archivo: "+(r.message||"Error de conexi\xf3n"))}})(t.id,e.id),style:{background:"#dc3545",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},title:"Eliminar archivo",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},t.id))}),(e.creado_por===d.id||e.asignados&&e.asignados.some(e=>e.usuario_id===d.id)||!e.asignados&&e.asignado_a===d.id||"super_admin"===d.rol||"admin"===d.rol)&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("input",{type:"file",id:"adjunto-".concat(e.id),style:{display:"none"},onChange:t=>{const r=t.target.files[0];if(r){const n=window.prompt("Descripci\xf3n del archivo (opcional):","");!async function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(r){Kr(t=>Ue(Ue({},t),{},{[e]:!0}));try{const o=new FormData;o.append("archivo",r),o.append("tarea_id",e),o.append("usuario_id",d.id),n&&o.append("descripcion",n);const a=await fetch("".concat(Te,"/archivos/carpeta_tarea_adjuntos.php"),{method:"POST",body:o}),i=a.headers.get("content-type");let s;if(i&&i.includes("application/json"))s=await a.json();else{const e=await a.text();try{s=JSON.parse(e)}catch(t){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!a.ok)throw new Error(s.error||"Error HTTP ".concat(a.status));s.success&&s.adjunto?(qr(t=>Ue(Ue({},t),{},{[e]:[...t[e]||[],s.adjunto]})),alert("Archivo adjuntado correctamente")):s.error?alert("Error al adjuntar archivo: "+s.error):alert("Error al adjuntar archivo: Respuesta inesperada del servidor")}catch(o){console.error("Error subiendo adjunto:",o),alert("Error al adjuntar archivo: "+(o.message||"Error de conexi\xf3n"))}finally{Kr(t=>Ue(Ue({},t),{},{[e]:!1}))}}}(e.id,r,n||""),t.target.value=""}}}),(0,ze.jsx)("button",{onClick:()=>document.getElementById("adjunto-".concat(e.id)).click(),disabled:Xr[e.id],style:{background:Xr[e.id]?"#ccc":"#28a745",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:Xr[e.id]?"not-allowed":"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",width:"100%"},children:Xr[e.id]?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{marginRight:"6px"}}),"Subiendo..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-paperclip",style:{marginRight:"6px"}}),"Adjuntar archivo"]})})]})]})]})]})]},e.id)})})]})]})]}),C&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"550px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(10, 110, 189, 0.3)"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-plus",style:{fontSize:"1.1rem"}}),"Crear Nueva Carpeta"]})}),(0,ze.jsxs)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:["Nombre ",(0,ze.jsx)("span",{style:{color:"#dc3545"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:mn.nombre,onChange:e=>xn(Ue(Ue({},mn),{},{nombre:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",transition:"all 0.2s ease",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},placeholder:"Nombre de la carpeta",autoFocus:!0})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:mn.descripcion,onChange:e=>xn(Ue(Ue({},mn),{},{descripcion:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",minHeight:"70px",resize:"vertical",transition:"all 0.2s ease",boxSizing:"border-box",fontFamily:"inherit"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},placeholder:"Descripci\xf3n de la carpeta (opcional)"})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-image",style:{marginRight:"6px"}}),"Icono de la Carpeta ",(0,ze.jsx)("span",{style:{fontWeight:"400",fontSize:"0.75rem",color:"#666"},children:"(Opcional)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[(0,ze.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(t.size>2097152)return alert("El icono no debe superar los 2MB"),void(e.target.value="");const r=new FileReader;r.onloadend=()=>{vn(r.result)},r.readAsDataURL(t),xn(Ue(Ue({},mn),{},{icono_file:t}))}},style:{display:"none"},id:"icono-input-crear"}),(0,ze.jsxs)("label",{htmlFor:"icono-input-crear",style:{padding:"8px 16px",border:"2px dashed #17a2b8",borderRadius:"6px",background:"#f0f7ff",color:"#17a2b8",cursor:"pointer",fontSize:"13px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="#e0f0ff",e.target.style.borderColor="#8B4513"},onMouseLeave:e=>{e.target.style.background="#f0f7ff",e.target.style.borderColor="#17a2b8"},children:[(0,ze.jsx)("i",{className:"fa fa-upload"}),bn?"Cambiar Icono":"Seleccionar Icono"]}),bn&&(0,ze.jsxs)("div",{style:{position:"relative"},children:[(0,ze.jsx)("img",{src:bn,alt:"Preview",style:{width:"48px",height:"48px",objectFit:"contain",borderRadius:"6px",border:"2px solid #17a2b8",background:"white",padding:"4px"}}),(0,ze.jsx)("button",{onClick:()=>{vn(null),xn(Ue(Ue({},mn),{},{icono_file:null})),document.getElementById("icono-input-crear").value=""},style:{position:"absolute",top:"-8px",right:"-8px",width:"20px",height:"20px",borderRadius:"50%",background:"#dc3545",color:"white",border:"none",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"\xd7"})]})]}),(0,ze.jsx)("p",{style:{margin:"6px 0 0 0",fontSize:"11px",color:"#666"},children:"Formatos soportados: PNG, JPG, SVG. Tama\xf1o m\xe1ximo: 2MB. Recomendado: 64x64px o 128x128px"})]}),d&&"super_admin"===d.rol&&(0,ze.jsxs)("div",{style:{marginBottom:"1rem",padding:"1rem",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderRadius:"8px",border:"2px solid #e0e0e0",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"10px",fontWeight:"600",color:"#17a2b8",fontSize:"0.9rem"},children:[(0,ze.jsx)("i",{className:"fa fa-palette",style:{marginRight:"8px",fontSize:"0.95rem"}}),"Colores Personalizados ",(0,ze.jsx)("span",{style:{fontWeight:"400",fontSize:"0.8rem",color:"#666",marginLeft:"5px"},children:"(Opcional)"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"10px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontSize:"0.8rem",color:"#666",fontWeight:"500"},children:"Color Primario"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,ze.jsx)("input",{type:"color",value:mn.color_primario||"#F2A900",onChange:e=>{const t=e.target.value;xn(Ue(Ue({},mn),{},{color_primario:t,color_secundario:mn.color_secundario||bh(t)}))},style:{width:"45px",height:"38px",border:"2px solid #ddd",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,ze.jsx)("input",{type:"text",value:mn.color_primario||"",onChange:e=>{const t=e.target.value;(/^#[0-9A-Fa-f]{6}$/.test(t)||""===t)&&xn(Ue(Ue({},mn),{},{color_primario:t,color_secundario:mn.color_secundario||(t?bh(t):"")}))},placeholder:"#F2A900",style:{flex:1,padding:"8px 10px",border:"2px solid #ddd",borderRadius:"6px",fontSize:"12px",fontFamily:"monospace",transition:"all 0.2s ease"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#ddd",e.target.style.boxShadow="none"}})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontSize:"0.8rem",color:"#666",fontWeight:"500"},children:"Color Secundario"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,ze.jsx)("input",{type:"color",value:mn.color_secundario||"#FFC947",onChange:e=>xn(Ue(Ue({},mn),{},{color_secundario:e.target.value})),style:{width:"45px",height:"38px",border:"2px solid #ddd",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,ze.jsx)("input",{type:"text",value:mn.color_secundario||"",onChange:e=>{const t=e.target.value;(/^#[0-9A-Fa-f]{6}$/.test(t)||""===t)&&xn(Ue(Ue({},mn),{},{color_secundario:t}))},placeholder:"#FFC947",style:{flex:1,padding:"8px 10px",border:"2px solid #ddd",borderRadius:"6px",fontSize:"12px",fontFamily:"monospace",transition:"all 0.2s ease"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#ddd",e.target.style.boxShadow="none"}})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"10px",paddingTop:"10px",borderTop:"2px solid #e0e0e0"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=xh(mn.nombre||"Carpeta",Date.now());xn(Ue(Ue({},mn),{},{color_primario:e.primary,color_secundario:e.secondary}))},style:{padding:"6px 12px",border:"2px solid #17a2b8",borderRadius:"6px",background:"white",color:"#17a2b8",cursor:"pointer",fontSize:"12px",fontWeight:"600",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"5px"},onMouseEnter:e=>{e.target.style.background="#17a2b8",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(10, 110, 189, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#17a2b8",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},title:"Usar color autom\xe1tico basado en el nombre",children:[(0,ze.jsx)("i",{className:"fa fa-magic"}),"Auto"]}),(0,ze.jsxs)("button",{onClick:()=>xn(Ue(Ue({},mn),{},{color_primario:"",color_secundario:""})),style:{padding:"6px 12px",border:"2px solid #dc3545",borderRadius:"6px",background:"white",color:"#dc3545",cursor:"pointer",fontSize:"12px",fontWeight:"600",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"5px"},onMouseEnter:e=>{e.target.style.background="#dc3545",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(220, 53, 69, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#dc3545",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},title:"Limpiar colores personalizados",children:[(0,ze.jsx)("i",{className:"fa fa-eraser"}),"Limpiar"]})]}),mn.color_primario&&mn.color_secundario&&(0,ze.jsxs)("div",{style:{marginTop:"10px",padding:"10px",background:"linear-gradient(135deg, ".concat(mn.color_primario," 0%, ").concat(mn.color_secundario," 100%)"),borderRadius:"6px",textAlign:"center",color:"#ffffff",fontSize:"12px",fontWeight:"600",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",textTransform:"uppercase",letterSpacing:"1px"},children:[(0,ze.jsx)("i",{className:"fa fa-eye",style:{marginRight:"6px"}}),"Vista Previa"]})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{E(!1),xn({nombre:"",descripcion:"",color_primario:"",color_secundario:"",icono_url:""}),vn(null)},style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{if(mn.nombre.trim())try{let e=null;if(mn.icono_file){const t=new FormData;t.append("icono",mn.icono_file),t.append("usuario_id",d.id);const r=await fetch("".concat(Te,"/archivos/subir_icono_carpeta.php"),{method:"POST",body:t}),n=await r.json();if(!n.success)return void alert("Error al subir el icono: "+(n.error||"Error desconocido"));e=n.icono_url}else if(mn.icono_url&&mn.icono_url.trim()){let t=mn.icono_url.trim();t.startsWith("@")&&(t=t.substring(1)),e=t.startsWith("/")||t.startsWith("http")?t:"/img/iconos/"+t}const t=await fetch("".concat(Te,"/archivos/carpetas.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:mn.nombre,descripcion:mn.descripcion,proyecto_id:s,centro_costo_id:l||null,carpeta_padre_id:h?h.id:null,creado_por:d.id,color_primario:"super_admin"===d.rol&&mn.color_primario||null,color_secundario:"super_admin"===d.rol&&mn.color_secundario||null,icono_url:e})}),r=t.headers.get("content-type");let n;const o=await t.text();if(console.log("Respuesta del servidor (primeros 500 caracteres):",o.substring(0,500)),r&&r.includes("application/json"))try{n=JSON.parse(o)}catch(Fh){throw console.error("Error parseando JSON:",Fh),console.error("Texto recibido:",o),new Error("El servidor devolvi\xf3 una respuesta que no es JSON v\xe1lido. Respuesta: "+o.substring(0,200))}else try{n=JSON.parse(o)}catch(Fh){throw console.error("Respuesta no JSON del servidor:",o.substring(0,500)),new Error("El servidor devolvi\xf3 una respuesta no v\xe1lida. Verifica que las tablas de base de datos est\xe9n creadas ejecutando: api/database/crear_tablas_carpetas_archivos.sql. Respuesta: "+o.substring(0,200))}if(n.success)E(!1),xn({nombre:"",descripcion:"",color_primario:"",color_secundario:"",icono_url:""}),vn(null),so();else{const e=n.error||"Error desconocido";console.error("Error del servidor:",e),alert("Error al crear carpeta: "+e)}}catch(e){console.error("Error creando carpeta:",e),alert("Error al crear carpeta: "+(e.message||"Error de conexi\xf3n"))}else alert("El nombre de la carpeta es requerido")},style:{padding:"10px 18px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #17a2b8 0%, #8B4513 100%)",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"13px",boxShadow:"0 4px 12px rgba(10, 110, 189, 0.3)",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #8B4513 0%, #17a2b8 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(10, 110, 189, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #17a2b8 0%, #8B4513 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus",style:{marginRight:"6px"}}),"Crear Carpeta"]})]})]})}),ye&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.5)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"500px",boxShadow:"0 20px 60px rgba(111, 66, 193, 0.3)",border:"2px solid #6f42c1",overflow:"hidden",animation:"slideUp 0.3s ease-out"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #6f42c1 0%, #9b59b6 100%)",padding:"1rem 1.5rem",color:"white"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-copy"}),"Duplicar Carpeta"]})}),(0,ze.jsxs)("div",{style:{padding:"1.25rem"},children:[(0,ze.jsx)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"8px",marginBottom:"1rem",border:"1px solid #e9ecef"},children:(0,ze.jsxs)("p",{style:{margin:0,color:"#495057",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#6f42c1",marginRight:"8px"}}),(0,ze.jsx)("strong",{children:"Carpeta original:"})," ",ye.nombre]})}),(0,ze.jsx)("div",{style:{background:"#e8f4fd",padding:"0.85rem 1rem",borderRadius:"8px",marginBottom:"1rem",border:"1px solid #bee5eb"},children:(0,ze.jsxs)("p",{style:{margin:0,color:"#0c5460",fontSize:"13px",lineHeight:"1.5"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"8px",color:"#17a2b8"}}),(0,ze.jsx)("strong",{children:"Informaci\xf3n:"})," Esta acci\xf3n crear\xe1 una copia de la estructura organizacional, incluyendo carpetas y subcarpetas. Los archivos adjuntos y datos de formularios no ser\xe1n incluidos."]})}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#495057",fontSize:"0.85rem"},children:"Nombre de la nueva carpeta"}),(0,ze.jsx)("input",{type:"text",value:we,onChange:e=>ke(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"},placeholder:"Nombre de la copia",autoFocus:!0})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e9ecef",background:"#f8f9fa",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{je(null),ke("")},disabled:_e,style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:_e?"not-allowed":"pointer",fontWeight:"600",fontSize:"13px",opacity:_e?.6:1},children:"Cancelar"}),(0,ze.jsx)("button",{onClick:async()=>{if(ye&&d){Se(!0);try{const e=await fetch("".concat(Te,"/archivos/duplicar_carpeta.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({carpeta_id:ye.id,usuario_id:d.id,nuevo_nombre:we||null})}),t=await e.json();t.success?(alert('Duplicaci\xf3n completada con \xe9xito\n\n\ud83d\udcc1 Nueva carpeta: "'.concat(t.nuevo_nombre,'"\n\ud83d\udcc2 Subcarpetas incluidas: ').concat(t.subcarpetas_duplicadas,"\n\n\u2139\ufe0f La estructura de carpetas ha sido copiada.\nLos archivos y datos de formularios no se incluyen en la duplicaci\xf3n.")),je(null),ke(""),so()):alert("No se pudo completar la duplicaci\xf3n.\n\nMotivo: "+(t.error||"Error desconocido"))}catch(e){console.error("Error duplicando carpeta:",e),alert("No se pudo completar la duplicaci\xf3n.\n\nError de conexi\xf3n: "+e.message)}finally{Se(!1)}}},disabled:_e||!we.trim(),style:{padding:"10px 18px",border:"none",borderRadius:"6px",background:_e?"#adb5bd":"linear-gradient(135deg, #6f42c1 0%, #9b59b6 100%)",color:"white",cursor:_e||!we.trim()?"not-allowed":"pointer",fontWeight:"600",fontSize:"13px",display:"flex",alignItems:"center",gap:"6px"},children:_e?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin"}),"Duplicando..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-copy"}),"Duplicar Carpeta"]})})]})]})}),de&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"450px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",padding:"1rem 1.5rem",color:"white"},children:[(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-plus"}),"Nueva Carpeta de Archivos"]}),(0,ze.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"12px",opacity:.9},children:ie?"Dentro de: ".concat(ie.nombre):"En: ".concat((null===h||void 0===h?void 0:h.nombre)||"Ra\xedz")})]}),(0,ze.jsxs)("div",{style:{padding:"1.25rem"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#495057",fontSize:"0.85rem"},children:["Nombre ",(0,ze.jsx)("span",{style:{color:"#dc3545"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:he,onChange:e=>ge(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"},placeholder:"Nombre de la carpeta",autoFocus:!0})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#495057",fontSize:"0.85rem"},children:["Descripci\xf3n ",(0,ze.jsx)("span",{style:{fontWeight:"400",color:"#999"},children:"(opcional)"})]}),(0,ze.jsx)("textarea",{value:me,onChange:e=>xe(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",minHeight:"60px",resize:"vertical",boxSizing:"border-box",fontFamily:"inherit"},placeholder:"Descripci\xf3n de la carpeta"})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#495057",fontSize:"0.85rem"},children:"Color"}),(0,ze.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:["#ffc107","#17a2b8","#28a745","#dc3545","#6c757d","#007bff","#6f42c1","#fd7e14"].map(e=>(0,ze.jsx)("button",{onClick:()=>ve(e),style:{width:"32px",height:"32px",borderRadius:"6px",background:e,border:be===e?"3px solid #333":"2px solid transparent",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)"},e))})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e9ecef",background:"#f8f9fa",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{pe(!1),ge(""),xe(""),ve("#17a2b8")},style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{if(he.trim())try{const e=await fetch("".concat(Te,"/archivos/archivos_carpetas.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:he.trim(),descripcion:me.trim(),carpeta_id:h.id,carpeta_padre_id:ie?ie.id:null,creado_por:d.id,color:be})}),t=await e.json();t.success?(pe(!1),ge(""),xe(""),ve("#17a2b8"),co(h.id,ie?ie.id:null)):alert(t.error||"Error al crear la carpeta")}catch(e){console.error("Error creando carpeta de archivos:",e),alert("Error al crear la carpeta")}else alert("El nombre de la carpeta es requerido")},style:{padding:"10px 18px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"13px"},children:[(0,ze.jsx)("i",{className:"fa fa-plus",style:{marginRight:"6px"}}),"Crear Carpeta"]})]})]})}),O&&(0,ze.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:[(0,ze.jsx)("style",{children:"\n            @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n            }\n            @keyframes slideUp {\n              from { \n                opacity: 0;\n                transform: translateY(20px) scale(0.95);\n              }\n              to { \n                opacity: 1;\n                transform: translateY(0) scale(1);\n              }\n            }\n          "}),(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"550px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(10, 110, 189, 0.3)"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{fontSize:"1.1rem"}}),"Editar Carpeta"]})}),(0,ze.jsxs)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:["Nombre ",(0,ze.jsx)("span",{style:{color:"#dc3545"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:O.nombre,onChange:e=>P(Ue(Ue({},O),{},{nombre:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",transition:"all 0.2s ease",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},autoFocus:!0})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:O.descripcion||"",onChange:e=>P(Ue(Ue({},O),{},{descripcion:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",minHeight:"70px",resize:"vertical",transition:"all 0.2s ease",boxSizing:"border-box",fontFamily:"inherit"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},placeholder:"Agrega una descripci\xf3n opcional para esta carpeta..."})]}),d&&"super_admin"===d.rol&&(0,ze.jsxs)("div",{style:{marginBottom:"1rem",padding:"1rem",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderRadius:"8px",border:"2px solid #e0e0e0",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"10px",fontWeight:"600",color:"#17a2b8",fontSize:"0.9rem"},children:[(0,ze.jsx)("i",{className:"fa fa-palette",style:{marginRight:"8px",fontSize:"0.95rem"}}),"Colores Personalizados ",(0,ze.jsx)("span",{style:{fontWeight:"400",fontSize:"0.8rem",color:"#666",marginLeft:"5px"},children:"(Opcional)"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"10px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontSize:"0.8rem",color:"#666",fontWeight:"500"},children:"Color Primario"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,ze.jsx)("input",{type:"color",value:O.color_primario||"#F2A900",onChange:e=>{const t=e.target.value;P(Ue(Ue({},O),{},{color_primario:t,color_secundario:O.color_secundario||bh(t)}))},style:{width:"45px",height:"38px",border:"2px solid #ddd",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,ze.jsx)("input",{type:"text",value:O.color_primario||"",onChange:e=>{const t=e.target.value;(/^#[0-9A-Fa-f]{6}$/.test(t)||""===t)&&P(Ue(Ue({},O),{},{color_primario:t,color_secundario:O.color_secundario||(t?bh(t):"")}))},placeholder:"#F2A900",style:{flex:1,padding:"8px 10px",border:"2px solid #ddd",borderRadius:"6px",fontSize:"12px",fontFamily:"monospace",transition:"all 0.2s ease"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#ddd",e.target.style.boxShadow="none"}})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontSize:"0.8rem",color:"#666",fontWeight:"500"},children:"Color Secundario"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,ze.jsx)("input",{type:"color",value:O.color_secundario||"#FFC947",onChange:e=>P(Ue(Ue({},O),{},{color_secundario:e.target.value})),style:{width:"45px",height:"38px",border:"2px solid #ddd",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,ze.jsx)("input",{type:"text",value:O.color_secundario||"",onChange:e=>{const t=e.target.value;(/^#[0-9A-Fa-f]{6}$/.test(t)||""===t)&&P(Ue(Ue({},O),{},{color_secundario:t}))},placeholder:"#FFC947",style:{flex:1,padding:"8px 10px",border:"2px solid #ddd",borderRadius:"6px",fontSize:"12px",fontFamily:"monospace",transition:"all 0.2s ease"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#ddd",e.target.style.boxShadow="none"}})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"10px",paddingTop:"10px",borderTop:"2px solid #e0e0e0"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e=xh(O.nombre||"Carpeta",O.id);P(Ue(Ue({},O),{},{color_primario:e.primary,color_secundario:e.secondary}))},style:{padding:"6px 12px",border:"2px solid #17a2b8",borderRadius:"6px",background:"white",color:"#17a2b8",cursor:"pointer",fontSize:"12px",fontWeight:"600",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"5px"},onMouseEnter:e=>{e.target.style.background="#17a2b8",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(10, 110, 189, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#17a2b8",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},title:"Usar color autom\xe1tico basado en el nombre",children:[(0,ze.jsx)("i",{className:"fa fa-magic"}),"Auto"]}),(0,ze.jsxs)("button",{onClick:()=>P(Ue(Ue({},O),{},{color_primario:"",color_secundario:""})),style:{padding:"6px 12px",border:"2px solid #dc3545",borderRadius:"6px",background:"white",color:"#dc3545",cursor:"pointer",fontSize:"12px",fontWeight:"600",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"5px"},onMouseEnter:e=>{e.target.style.background="#dc3545",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(220, 53, 69, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#dc3545",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},title:"Limpiar colores personalizados",children:[(0,ze.jsx)("i",{className:"fa fa-eraser"}),"Limpiar"]})]}),O.color_primario&&O.color_secundario&&(0,ze.jsxs)("div",{style:{marginTop:"10px",padding:"10px",background:"linear-gradient(135deg, ".concat(O.color_primario," 0%, ").concat(O.color_secundario," 100%)"),borderRadius:"6px",textAlign:"center",color:"#ffffff",fontSize:"12px",fontWeight:"600",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",textTransform:"uppercase",letterSpacing:"1px"},children:[(0,ze.jsx)("i",{className:"fa fa-eye",style:{marginRight:"6px"}}),"Vista Previa"]})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>P(null),style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{if(O&&O.nombre.trim())try{const e=await fetch("".concat(Te,"/archivos/carpetas.php"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O.id,nombre:O.nombre,descripcion:O.descripcion,usuario_id:d.id,color_primario:"super_admin"===d.rol&&O.color_primario||null,color_secundario:"super_admin"===d.rol&&O.color_secundario||null})}),t=await e.json();t.success?(P(null),so(),h&&h.id===O.id&&g(Ue(Ue({},h),{},{nombre:O.nombre,descripcion:O.descripcion}))):alert("Error al editar carpeta: "+(t.error||"Error desconocido"))}catch(e){console.error("Error editando carpeta:",e),alert("Error al editar carpeta")}else alert("El nombre de la carpeta es requerido")},style:{padding:"10px 18px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #17a2b8 0%, #8B4513 100%)",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"13px",boxShadow:"0 4px 12px rgba(10, 110, 189, 0.3)",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #8B4513 0%, #17a2b8 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(10, 110, 189, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #17a2b8 0%, #8B4513 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-save",style:{marginRight:"6px"}}),"Guardar Cambios"]})]})]})]}),Jr&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease"},onClick:()=>Qr(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"0",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"hidden",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.2)",animation:"slideUp 0.3s ease",display:"flex",flexDirection:"column"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #17a2b8 100%)",padding:"1rem 1.5rem",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{marginRight:"8px"}}),"Invitar Usuario a la Tarea"]}),(0,ze.jsx)("button",{onClick:()=>Qr(null),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"white",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.2)"},children:"\xd7"})]}),(0,ze.jsx)("div",{style:{padding:"1.5rem",overflowY:"auto",flex:1},children:hn&&hn.length>0?(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{style:{marginBottom:"1rem",color:"#666",fontSize:"14px"},children:"Selecciona un usuario de la carpeta para invitarlo a esta tarea:"}),(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:hn.filter(e=>{const t=Pr.find(e=>e.id===Jr);return!t||(!t.asignados||!t.asignados.some(t=>t.usuario_id===e.usuario_id))&&!(!t.asignados&&t.asignado_a===e.usuario_id)}).map(e=>(0,ze.jsxs)("button",{onClick:()=>(async(e,t)=>{try{const r=await fetch("".concat(Te,"/archivos/carpeta_tarea_asignaciones.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tarea_id:e,usuario_id:t,usuario_invitador_id:d.id})}),n=r.headers.get("content-type");let o;if(n&&n.includes("application/json"))o=await r.json();else{const e=await r.text();try{o=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!r.ok)throw new Error(o.error||"Error HTTP ".concat(r.status));o.success?(Qr(null),zn(h.id),alert("Usuario invitado a la tarea correctamente")):o.error?alert("Error al invitar usuario: "+o.error):alert("Error al invitar usuario: Respuesta inesperada del servidor")}catch(r){console.error("Error invitando usuario:",r),alert("Error al invitar usuario: "+(r.message||"Error de conexi\xf3n"))}})(Jr,e.usuario_id),style:{padding:"12px",border:"2px solid #e9ecef",borderRadius:"8px",background:"white",cursor:"pointer",textAlign:"left",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"12px"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#17a2b8",e.currentTarget.style.background="#f0f7ff",e.currentTarget.style.transform="translateX(4px)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e9ecef",e.currentTarget.style.background="white",e.currentTarget.style.transform="translateX(0)"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #17a2b8 0%, #17a2b8 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"16px"},children:e.usuario_nombre?e.usuario_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"14px"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:e.usuario_email||""})]}),(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{color:"#17a2b8",fontSize:"18px"}})]},e.usuario_id))}),0===hn.filter(e=>{const t=Pr.find(e=>e.id===Jr);return!!t&&((!t.asignados||!t.asignados.some(t=>t.usuario_id===e.usuario_id))&&!(!t.asignados&&t.asignado_a===e.usuario_id))}).length&&(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{fontSize:"2rem",marginBottom:"0.5rem"}}),(0,ze.jsx)("p",{style:{margin:0},children:"Todos los usuarios de la carpeta ya est\xe1n asignados a esta tarea."})]})]}):(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{fontSize:"2rem",marginBottom:"0.5rem"}}),(0,ze.jsx)("p",{style:{margin:0},children:"No hay usuarios asignados a esta carpeta."}),(0,ze.jsx)("p",{style:{marginTop:"0.5rem",fontSize:"13px"},children:'Primero debes asignar usuarios a la carpeta desde "Asignar Usuarios".'})]})}),(0,ze.jsx)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",justifyContent:"flex-end"},children:(0,ze.jsx)("button",{onClick:()=>Qr(null),style:{padding:"10px 20px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d"},children:"Cerrar"})})]})}),T&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"650px",maxHeight:"85vh",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",display:"flex",flexDirection:"column"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(10, 110, 189, 0.3)"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{fontSize:"1.1rem"}}),'Asignar Usuarios a "',T.nombre,'"']})}),(0,ze.jsxs)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,ze.jsxs)("h3",{style:{fontSize:"0.95rem",marginBottom:"10px",color:"#17a2b8",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-user-check",style:{fontSize:"0.9rem"}}),"Usuarios Asignados"]}),0===hn.length?(0,ze.jsxs)("div",{style:{padding:"1.5rem",textAlign:"center",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderRadius:"8px",border:"2px dashed #dee2e6"},children:[(0,ze.jsx)("i",{className:"fa fa-user-times",style:{fontSize:"2rem",color:"#adb5bd",marginBottom:"8px"}}),(0,ze.jsx)("p",{style:{color:"#6c757d",fontSize:"13px",margin:0,fontWeight:"500"},children:"No hay usuarios asignados"})]}):(0,ze.jsx)("div",{style:{display:"grid",gap:"10px"},children:hn.map(e=>(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",borderRadius:"8px",border:"2px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#17a2b8",e.currentTarget.style.boxShadow="0 4px 12px rgba(10, 110, 189, 0.15)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e9ecef",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.05)",e.currentTarget.style.transform="translateY(0)"},children:[(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("div",{style:{fontWeight:"600",fontSize:"14px",color:"#212529",marginBottom:"4px"},children:e.usuario_nombre}),(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-envelope",style:{marginRight:"4px",fontSize:"0.85rem"}}),e.usuario_email]}),(0,ze.jsxs)("div",{style:{fontSize:"11px",color:"#495057",marginBottom:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-user-tag",style:{marginRight:"4px",fontSize:"0.85rem"}}),e.usuario_rol]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginTop:"6px",paddingTop:"6px",borderTop:"1px solid #e9ecef"},children:[(0,ze.jsxs)("span",{style:{fontSize:"10px",padding:"3px 6px",borderRadius:"4px",background:e.puede_ver?"#d4edda":"#f8d7da",color:e.puede_ver?"#155724":"#721c24",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(e.puede_ver?"check":"times"),style:{marginRight:"2px",fontSize:"0.75rem"}}),"Ver"]}),(0,ze.jsxs)("span",{style:{fontSize:"10px",padding:"3px 6px",borderRadius:"4px",background:e.puede_subir?"#d4edda":"#f8d7da",color:e.puede_subir?"#155724":"#721c24",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(e.puede_subir?"check":"times"),style:{marginRight:"2px",fontSize:"0.75rem"}}),"Subir"]}),(0,ze.jsxs)("span",{style:{fontSize:"10px",padding:"3px 6px",borderRadius:"4px",background:e.puede_editar?"#d4edda":"#f8d7da",color:e.puede_editar?"#155724":"#721c24",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(e.puede_editar?"check":"times"),style:{marginRight:"2px",fontSize:"0.75rem"}}),"Editar"]}),(0,ze.jsxs)("span",{style:{fontSize:"10px",padding:"3px 6px",borderRadius:"4px",background:e.puede_eliminar?"#d4edda":"#f8d7da",color:e.puede_eliminar?"#155724":"#721c24",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-".concat(e.puede_eliminar?"check":"times"),style:{marginRight:"2px",fontSize:"0.75rem"}}),"Eliminar"]})]})]}),(0,ze.jsxs)("button",{onClick:()=>(async e=>{try{const t=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php?carpeta_id=").concat(T.id,"&usuario_id=").concat(e,"&quita_por=").concat(d.id),{method:"DELETE"}),r=t.headers.get("content-type");let n;if(r&&r.includes("application/json"))n=await t.json();else{const e=await t.text();try{n=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!t.ok)throw new Error(n.error||"Error HTTP ".concat(t.status));n.success?ho(T.id):n.error?alert("Error al quitar usuario: "+n.error):alert("Error al quitar usuario: Respuesta inesperada del servidor")}catch(t){console.error("Error quitando usuario:",t),alert("Error al quitar usuario: "+(t.message||"Error de conexi\xf3n"))}})(e.usuario_id),style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"600",boxShadow:"0 2px 6px rgba(220, 53, 69, 0.3)",transition:"all 0.2s ease",marginLeft:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #c82333 0%, #dc3545 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 10px rgba(220, 53, 69, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #dc3545 0%, #c82333 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 6px rgba(220, 53, 69, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"4px"}}),"Quitar"]})]},e.usuario_id))})]}),(0,ze.jsxs)("div",{style:{padding:"1rem",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[(0,ze.jsxs)("h3",{style:{fontSize:"0.95rem",marginBottom:"10px",color:"#17a2b8",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{fontSize:"0.9rem"}}),"Agregar Usuario"]}),(0,ze.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.8rem",color:"#6c757d",fontWeight:"600",display:"block",marginBottom:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{marginRight:"4px"}}),"Filtrar por Empresa Contratista"]}),(0,ze.jsxs)("select",{value:N,onChange:e=>A(e.target.value),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",background:"white",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"",children:"Todas las empresas"}),z.map(e=>(0,ze.jsx)("option",{value:e.empresa_id,children:e.nombre},e.empresa_id))]})]}),(0,ze.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.8rem",color:"#6c757d",fontWeight:"600",display:"block",marginBottom:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{marginRight:"4px"}}),"Seleccionar Trabajador"]}),(0,ze.jsxs)("select",{id:"select-usuario-asignar",style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",background:"white",transition:"all 0.2s ease",boxSizing:"border-box",cursor:"pointer"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},children:[(0,ze.jsx)("option",{value:"",children:"Selecciona un usuario"}),un.filter(e=>!hn.find(t=>t.usuario_id===e.id)&&((!d||"admin"!==d.rol||"trabajador"===e.rol)&&(!N||String(e.empresa_id)===String(N)))).map(e=>{const t=z.find(t=>String(t.empresa_id)===String(e.empresa_id)),r=t?t.nombre:e.empresa_nombre||"";return(0,ze.jsxs)("option",{value:e.id,children:[e.nombre," (",e.email,") - ",e.rol,r?" - ".concat(r):""]},e.id)})]})]}),(0,ze.jsxs)("div",{style:{marginBottom:"12px",padding:"10px 12px",background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"6px",border:"1px solid #90caf9",fontSize:"12px",color:"#1565c0"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"6px"}}),"Los permisos se asignan autom\xe1ticamente seg\xfan el rol del usuario."]}),(0,ze.jsxs)("button",{onClick:()=>{const e=document.getElementById("select-usuario-asignar"),t=e.value;if(!t)return void alert("Selecciona un usuario");const r=un.find(e=>e.id==t);let n={ver:!0,subir:!1,editar:!1,eliminar:!1};if(r)switch(r.rol){case"super_admin":n={ver:!0,subir:!0,editar:!0,eliminar:!0};break;case"admin":case"supervisor":n={ver:!0,subir:!0,editar:!0,eliminar:!1};break;default:n={ver:!0,subir:!0,editar:!1,eliminar:!1}}(async(e,t)=>{try{const r=await fetch("".concat(Te,"/archivos/carpeta_usuarios.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({carpeta_id:T.id,usuario_id:e,puede_ver:t.ver?1:0,puede_subir:t.subir?1:0,puede_editar:t.editar?1:0,puede_eliminar:t.eliminar?1:0,asignado_por:d.id})}),n=r.headers.get("content-type");let o;if(n&&n.includes("application/json"))o=await r.json();else{const e=await r.text();try{o=JSON.parse(e)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+e.substring(0,200))}}if(!r.ok)throw new Error(o.error||"Error HTTP ".concat(r.status));o.success?ho(T.id):o.error?alert("Error al asignar usuario: "+o.error):alert("Error al asignar usuario: Respuesta inesperada del servidor")}catch(r){console.error("Error asignando usuario:",r),alert("Error al asignar usuario: "+(r.message||"Error de conexi\xf3n"))}})(parseInt(t),n),e.value="",A("")},style:{width:"100%",padding:"10px 18px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"13px",boxShadow:"0 4px 12px rgba(40, 167, 69, 0.3)",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #20c997 0%, #28a745 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(40, 167, 69, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #28a745 0%, #20c997 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(40, 167, 69, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-user-plus",style:{marginRight:"6px"}}),"Asignar Usuario"]})]})]}),(0,ze.jsx)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",justifyContent:"flex-end"},children:(0,ze.jsxs)("button",{onClick:()=>R(null),style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"6px"}}),"Cerrar"]})})]})}),Lr&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},children:(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"550px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(40, 167, 69, 0.3)"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{fontSize:"1.1rem"}}),"Nueva Tarea"]})}),(0,ze.jsxs)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:["T\xedtulo ",(0,ze.jsx)("span",{style:{color:"#dc3545"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:Fr.titulo,onChange:e=>Mr(Ue(Ue({},Fr),{},{titulo:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",transition:"all 0.2s ease",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},placeholder:"T\xedtulo de la tarea",autoFocus:!0})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Descripci\xf3n"}),(0,ze.jsx)("textarea",{value:Fr.descripcion,onChange:e=>Mr(Ue(Ue({},Fr),{},{descripcion:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",minHeight:"70px",resize:"vertical",transition:"all 0.2s ease",boxSizing:"border-box",fontFamily:"inherit"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},placeholder:"Descripci\xf3n de la tarea (opcional)"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Asignar a"}),(0,ze.jsx)("div",{style:{maxHeight:"150px",overflowY:"auto",border:"2px solid #e0e0e0",borderRadius:"6px",padding:"8px",background:"white"},children:0===hn.length?(0,ze.jsx)("div",{style:{padding:"8px",color:"#999",fontSize:"14px",textAlign:"center"},children:"No hay usuarios asignados a esta carpeta"}):hn.map(e=>{var t;return(0,ze.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"6px 8px",borderRadius:"4px",cursor:"pointer",transition:"background 0.2s ease",marginBottom:"4px"},onMouseEnter:e=>e.currentTarget.style.background="#f0f0f0",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,ze.jsx)("input",{type:"checkbox",checked:(null===(t=Fr.asignados_a)||void 0===t?void 0:t.includes(e.usuario_id))||!1,onChange:t=>{const r=Fr.asignados_a||[];t.target.checked?Mr(Ue(Ue({},Fr),{},{asignados_a:[...r,e.usuario_id]})):Mr(Ue(Ue({},Fr),{},{asignados_a:r.filter(t=>t!==e.usuario_id)}))},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px"}}),(0,ze.jsxs)("span",{style:{fontSize:"14px",color:"#333"},children:[e.usuario_nombre," (",e.usuario_email,")"]})]},e.usuario_id)})}),Fr.asignados_a&&Fr.asignados_a.length>0&&(0,ze.jsxs)("div",{style:{marginTop:"6px",fontSize:"12px",color:"#17a2b8"},children:[Fr.asignados_a.length," ",1===Fr.asignados_a.length?"usuario seleccionado":"usuarios seleccionados"]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Prioridad"}),(0,ze.jsxs)("select",{value:Fr.prioridad,onChange:e=>Mr(Ue(Ue({},Fr),{},{prioridad:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",background:"white",transition:"all 0.2s ease",boxSizing:"border-box",cursor:"pointer"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"},children:[(0,ze.jsx)("option",{value:"baja",children:"Baja"}),(0,ze.jsx)("option",{value:"media",children:"Media"}),(0,ze.jsx)("option",{value:"alta",children:"Alta"}),(0,ze.jsx)("option",{value:"urgente",children:"Urgente"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Fecha de Vencimiento"}),(0,ze.jsx)("input",{type:"datetime-local",value:Fr.fecha_vencimiento,onChange:e=>Mr(Ue(Ue({},Fr),{},{fecha_vencimiento:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",transition:"all 0.2s ease",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"600",color:"#17a2b8",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Recordatorio"}),(0,ze.jsx)("input",{type:"datetime-local",value:Fr.recordatorio_en,onChange:e=>Mr(Ue(Ue({},Fr),{},{recordatorio_en:e.target.value})),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",transition:"all 0.2s ease",boxSizing:"border-box"},onFocus:e=>{e.target.style.borderColor="#17a2b8",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e0e0e0",e.target.style.boxShadow="none"}})]})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{Br(!1),Mr({titulo:"",descripcion:"",asignado_a:null,fecha_vencimiento:"",prioridad:"media",recordatorio_en:""})},style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{if(Fr.titulo.trim())try{const e=await fetch("".concat(Te,"/archivos/carpeta_tareas.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({carpeta_id:h.id,titulo:Fr.titulo,descripcion:Fr.descripcion||"",creado_por:d.id,asignados_a:Fr.asignados_a||[],fecha_vencimiento:Fr.fecha_vencimiento||null,prioridad:Fr.prioridad,recordatorio_en:Fr.recordatorio_en||null})}),t=e.headers.get("content-type");let r;if(t&&t.includes("application/json"))r=await e.json();else{const t=await e.text();try{r=JSON.parse(t)}catch(Fh){throw new Error("Respuesta no v\xe1lida del servidor: "+t.substring(0,200))}}if(!e.ok)throw new Error(r.error||"Error HTTP ".concat(e.status));r.success?(Br(!1),Mr({titulo:"",descripcion:"",asignados_a:[],fecha_vencimiento:"",prioridad:"media",recordatorio_en:""}),zn(h.id)):r.error?alert("Error al crear tarea: "+r.error):alert("Error al crear tarea: Respuesta inesperada del servidor")}catch(e){console.error("Error creando tarea:",e),alert("Error al crear tarea: "+(e.message||"Error de conexi\xf3n"))}else alert("El t\xedtulo es requerido")},style:{padding:"10px 18px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",cursor:"pointer",fontWeight:"600",fontSize:"13px",boxShadow:"0 4px 12px rgba(40, 167, 69, 0.3)",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #20c997 0%, #28a745 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(40, 167, 69, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #28a745 0%, #20c997 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(40, 167, 69, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-plus",style:{marginRight:"6px"}}),"Crear Tarea"]})]})]})}),Q&&Q.visible&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10001},children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"25px",minWidth:"400px",maxWidth:"600px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)"},children:[(0,ze.jsxs)("h3",{style:{marginTop:0,marginBottom:"20px",color:"#17a2b8"},children:["Subiendo archivos (",Q.completados,"/",Q.total,")"]}),(0,ze.jsx)("div",{style:{width:"100%",height:"25px",background:"#e0e0e0",borderRadius:"12px",overflow:"hidden",marginBottom:"20px"},children:(0,ze.jsxs)("div",{style:{width:"".concat(Q.progresoGeneral||0,"%"),height:"100%",background:"#28a745",transition:"width 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px",fontWeight:"bold"},children:[Q.progresoGeneral||0,"%"]})}),(0,ze.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:ee.map((e,t)=>(0,ze.jsxs)("div",{style:{marginBottom:"15px",padding:"10px",background:"#f8f9fa",borderRadius:"8px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[(0,ze.jsx)("span",{style:{fontSize:"14px",fontWeight:"bold",color:"#17a2b8"},children:e.nombre}),(0,ze.jsx)("span",{style:{fontSize:"12px",color:"completado"===e.estado?"#28a745":"error"===e.estado?"#dc3545":"#666"},children:"completado"===e.estado?"\u2713 Completado":"error"===e.estado?"\u2717 Error":"Subiendo..."})]}),"subiendo"===e.estado&&(0,ze.jsx)("div",{style:{width:"100%",height:"8px",background:"#e0e0e0",borderRadius:"4px",overflow:"hidden"},children:(0,ze.jsx)("div",{style:{width:"".concat(e.progreso,"%"),height:"100%",background:"#17a2b8",transition:"width 0.3s ease"}})}),"error"===e.estado&&e.error&&(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#dc3545",marginTop:"5px"},children:e.error})]},t))}),Q.completados===Q.total&&(0,ze.jsx)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:(0,ze.jsx)("button",{onClick:()=>{Z(null),te([]),lo(h.id,ie?ie.id:"root")},style:{padding:"10px 20px",border:"none",borderRadius:"5px",background:"#17a2b8",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cerrar"})})]})}),D&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:K?"rgba(0,0,0,0.95)":"rgba(0,0,0,0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,padding:K?"0":"20px",transition:"all 0.3s ease"},onClick:()=>{K||L(null)},children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:K?"0":"12px",padding:K?"0":"20px",maxWidth:K?"100%":"90%",maxHeight:K?"100vh":"90%",width:"100%",height:K?"100vh":"auto",display:"flex",flexDirection:"column",boxShadow:K?"none":"0 10px 40px rgba(0,0,0,0.3)",transition:"all 0.3s ease"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",borderBottom:"1px solid #e0e0e0",paddingBottom:"15px"},children:[(0,ze.jsx)("h2",{style:{margin:0,color:"#17a2b8",fontSize:"18px"},children:D.nombre_original}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,ze.jsxs)("button",{onClick:()=>J(!K),style:{background:K?"#6c757d":"#28a745",color:"white",border:"none",padding:"8px 15px",borderRadius:"5px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease"},title:K?"Restaurar tama\xf1o":"Maximizar",children:[(0,ze.jsx)("i",{className:"fa ".concat(K?"fa-compress":"fa-expand")}),K?"Restaurar":"Maximizar"]}),(0,ze.jsxs)("button",{onClick:()=>{const e="".concat(Te,"/descargar_archivo.php?id=").concat(D.id,"&accion=descargar");window.open(e,"_blank")},style:{background:"#17a2b8",color:"white",border:"none",padding:"8px 15px",borderRadius:"5px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px"},title:"Descargar archivo",children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsxs)("button",{onClick:()=>{L(null),J(!1)},style:{background:"#dc3545",color:"white",border:"none",padding:"8px 15px",borderRadius:"5px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-times"})," Cerrar"]})]})]}),(0,ze.jsx)("div",{style:{flex:1,overflow:"auto",display:"flex",justifyContent:"center",alignItems:"flex-start",minHeight:K?"calc(100vh - 120px)":"400px",height:K?"calc(100vh - 120px)":"auto",background:"#f8f9fa",borderRadius:K?"0":"8px",padding:K?"10px":"20px",transition:"all 0.3s ease"},children:(()=>{const e=D.nombre_original.split(".").pop().toLowerCase(),t=D.tipo_mime||"",r="".concat(Te,"/descargar_archivo.php?id=").concat(D.id,"&accion=ver"),n=encodeURIComponent(r);if("pdf"===e||t.includes("pdf"))return(0,ze.jsxs)("div",{style:{width:"100%",height:K?"calc(100vh - 120px)":"600px",minHeight:K?"calc(100vh - 120px)":"600px",display:"flex",flexDirection:"column"},children:[Y&&(0,ze.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",borderRadius:"8px"},children:(0,ze.jsxs)("div",{style:{textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"48px",color:"#17a2b8",marginBottom:"15px"}}),(0,ze.jsx)("p",{style:{color:"#666"},children:"Cargando PDF..."})]})}),B&&(0,ze.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff3cd",borderRadius:"8px",padding:"20px"},children:(0,ze.jsxs)("div",{style:{textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{fontSize:"48px",color:"#856404",marginBottom:"15px"}}),(0,ze.jsx)("p",{style:{color:"#856404",marginBottom:"15px"},children:B}),(0,ze.jsx)("button",{onClick:()=>q&&window.open(q,"_blank"),disabled:!q,style:{padding:"10px 20px",background:q?"#17a2b8":"#9abec6",color:"white",border:"none",borderRadius:"5px",cursor:q?"pointer":"not-allowed"},children:"Abrir en nueva ventana"})]})}),!Y&&!B&&M.length>0&&(0,ze.jsx)("div",{style:{width:"100%",height:K?"100%":"auto",maxHeight:K?"100%":"600px",overflowY:"auto",background:"#525252",borderRadius:K?"0":"8px",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",gap:K?"20px":"15px"},children:M.map(e=>{let{canvasData:t,pageNum:r,width:n,height:a}=e;const i=e=>{let{canvas:t,pageNum:r,width:n,height:a}=e;const i=o.useRef(null);return o.useEffect(()=>{if(i.current&&t){i.current.innerHTML="";const e=document.createElement("canvas");e.width=t.width,e.height=t.height;e.getContext("2d").drawImage(t,0,0),i.current.appendChild(e)}return()=>{i.current&&(i.current.innerHTML="")}},[t]),(0,ze.jsx)("div",{ref:i,style:{background:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",marginBottom:"15px",display:"inline-block"}})};return(0,ze.jsx)(i,{canvas:t,pageNum:r,width:n,height:a},r)})}),!Y&&!B&&M.length>0&&(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#999",textAlign:"center",marginTop:"8px",padding:"5px",background:"#f8f9fa",borderRadius:"4px"},children:(0,ze.jsxs)("div",{style:{marginBottom:"3px"},children:[M.length," ",1===M.length?"p\xe1gina":"p\xe1ginas"]})})]});if(["doc","docx"].includes(e)||t.includes("word")||t.includes("document")){const e=r.includes("localhost")||r.includes("127.0.0.1");return(0,ze.jsxs)("div",{style:{width:"100%",height:"600px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,ze.jsxs)("div",{style:{padding:"10px",background:e?"#fff3cd":"#e3f2fd",borderRadius:"5px",fontSize:"14px",color:e?"#856404":"#FF8C00"},children:[(0,ze.jsx)("i",{className:"fa fa-file-word",style:{marginRight:"8px"}}),e?'Los visores externos no funcionan con localhost. Usa "Descargar" para abrir el archivo.':"Previsualizando documento Word usando visor embebido"]}),!e&&(0,ze.jsx)("iframe",{src:"https://view.officeapps.live.com/op/embed.aspx?src=".concat(n),style:{width:"100%",flex:1,border:"none",borderRadius:"8px",minHeight:"500px"},title:D.nombre_original}),e&&(0,ze.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",borderRadius:"8px"},children:(0,ze.jsxs)("div",{style:{textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-file-word",style:{fontSize:"64px",color:"#FF8C00",marginBottom:"20px"}}),(0,ze.jsx)("div",{style:{fontSize:"16px",color:"#666",marginBottom:"10px"},children:D.nombre_original}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#999"},children:'Haz clic en "Descargar" para abrir el archivo'})]})}),(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#666",textAlign:"center"},children:'Si el documento no se muestra, haz clic en "Descargar" para abrirlo en tu aplicaci\xf3n'})]})}if(["ppt","pptx"].includes(e)||t.includes("presentation")||t.includes("powerpoint")){const e=r.includes("localhost")||r.includes("127.0.0.1");return(0,ze.jsxs)("div",{style:{width:"100%",height:"600px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,ze.jsxs)("div",{style:{padding:"10px",background:e?"#fff3cd":"#fff3e0",borderRadius:"5px",fontSize:"14px",color:e?"#856404":"#e65100"},children:[(0,ze.jsx)("i",{className:"fa fa-file-powerpoint",style:{marginRight:"8px"}}),e?'Los visores externos no funcionan con localhost. Usa "Descargar" para abrir el archivo.':"Previsualizando presentaci\xf3n PowerPoint usando visor embebido"]}),!e&&(0,ze.jsx)("iframe",{src:"https://view.officeapps.live.com/op/embed.aspx?src=".concat(n),style:{width:"100%",flex:1,border:"none",borderRadius:"8px",minHeight:"500px"},title:D.nombre_original}),e&&(0,ze.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",borderRadius:"8px"},children:(0,ze.jsxs)("div",{style:{textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-file-powerpoint",style:{fontSize:"64px",color:"#e65100",marginBottom:"20px"}}),(0,ze.jsx)("div",{style:{fontSize:"16px",color:"#666",marginBottom:"10px"},children:D.nombre_original}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#999"},children:'Haz clic en "Descargar" para abrir el archivo'})]})}),(0,ze.jsx)("div",{style:{fontSize:"12px",color:"#666",textAlign:"center"},children:'Si la presentaci\xf3n no se muestra, haz clic en "Descargar" para abrirla en tu aplicaci\xf3n'})]})}return["jpg","jpeg","png","gif","bmp","webp","svg"].includes(e)||t.startsWith("image/")?(0,ze.jsx)("img",{src:r,alt:D.nombre_original,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"8px"},onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div style="text-align: center; color: #666;">No se puede previsualizar este tipo de imagen</div>'}}):["txt","csv","log","json","xml","html","css","js"].includes(e)||t.startsWith("text/")?(0,ze.jsx)("iframe",{src:r,style:{width:"100%",height:"600px",border:"none",borderRadius:"8px",background:"white"},title:D.nombre_original}):["mp4","webm","ogg","avi","mov"].includes(e)||t.startsWith("video/")?(0,ze.jsxs)("video",{controls:!0,style:{maxWidth:"100%",maxHeight:"600px",borderRadius:"8px"},children:[(0,ze.jsx)("source",{src:r,type:t}),"Tu navegador no soporta la reproducci\xf3n de video."]}):["mp3","wav","ogg","m4a"].includes(e)||t.startsWith("audio/")?(0,ze.jsx)("div",{style:{textAlign:"center",width:"100%"},children:(0,ze.jsxs)("audio",{controls:!0,style:{width:"100%",maxWidth:"500px"},children:[(0,ze.jsx)("source",{src:r,type:t}),"Tu navegador no soporta la reproducci\xf3n de audio."]})}):(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{fontSize:"64px",color:"#17a2b8",marginBottom:"20px"}}),(0,ze.jsx)("div",{style:{fontSize:"18px",marginBottom:"10px",color:"#17a2b8"},children:"No se puede previsualizar este tipo de archivo"}),(0,ze.jsxs)("div",{style:{fontSize:"14px",marginBottom:"20px"},children:["Tipo: ",t||e.toUpperCase()]}),(0,ze.jsxs)("button",{onClick:()=>{window.open(r,"_blank")},style:{background:"#17a2b8",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar para abrir"]})]})})()}),(0,ze.jsx)("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid #e0e0e0",fontSize:"12px",color:"#666",display:"flex",justifyContent:"space-between"},children:(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user"})," ",D.subido_por_nombre]}),(0,ze.jsxs)("span",{style:{marginLeft:"15px"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar"})," ",uh(D.subido_en)]}),D.tama\u00f1o&&(0,ze.jsxs)("span",{style:{marginLeft:"15px"},children:[(0,ze.jsx)("i",{className:"fa fa-hdd"})," ",(D.tama\u00f1o/1024).toFixed(2)," KB"]})]})})]})}),U&&(0,ze.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.95)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:2e3,animation:"fadeIn 0.2s ease-out"},onClick:e=>{e.target===e.currentTarget&&H(null)},children:[(0,ze.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,padding:"15px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(to bottom, rgba(0,0,0,0.7), transparent)",zIndex:10},children:[(0,ze.jsxs)("div",{style:{color:"white",fontSize:"16px",fontWeight:"500"},children:[(0,ze.jsx)("i",{className:"fa fa-images",style:{marginRight:"10px",color:"#17a2b8"}}),null===(n=U.imagenes[U.indiceActual])||void 0===n?void 0:n.nombre_original]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[(0,ze.jsxs)("span",{style:{color:"white",background:"rgba(23, 162, 184, 0.8)",padding:"5px 15px",borderRadius:"20px",fontSize:"14px",fontWeight:"600"},children:[U.indiceActual+1," de ",U.imagenes.length]}),(0,ze.jsxs)("button",{onClick:()=>{const e=U.imagenes[U.indiceActual];window.open("".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=descargar"),"_blank")},style:{background:"#17a2b8",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-download"})," Descargar"]}),(0,ze.jsx)("button",{onClick:()=>H(null),style:{background:"rgba(255,255,255,0.2)",color:"white",border:"none",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.3)",onMouseLeave:e=>e.currentTarget.style.background="rgba(255,255,255,0.2)",title:"Cerrar",children:"\xd7"})]})]}),(0,ze.jsx)("button",{onClick:()=>xo(-1),style:{position:"absolute",left:"20px",top:"50%",transform:"translateY(-50%)",background:"rgba(255,255,255,0.15)",color:"white",border:"none",width:"60px",height:"60px",borderRadius:"50%",cursor:"pointer",fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",zIndex:10},onMouseEnter:e=>{e.currentTarget.style.background="rgba(23, 162, 184, 0.8)",e.currentTarget.style.transform="translateY(-50%) scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.15)",e.currentTarget.style.transform="translateY(-50%)"},title:"Imagen anterior",children:(0,ze.jsx)("i",{className:"fa fa-chevron-left"})}),(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"85vw",maxHeight:"80vh",padding:"60px 80px"},children:(0,ze.jsx)("img",{src:"".concat(Te,"/descargar_archivo.php?id=").concat(null===(a=U.imagenes[U.indiceActual])||void 0===a?void 0:a.id,"&accion=ver"),alt:null===(i=U.imagenes[U.indiceActual])||void 0===i?void 0:i.nombre_original,style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain",borderRadius:"8px",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"}})}),(0,ze.jsx)("button",{onClick:()=>xo(1),style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",background:"rgba(255,255,255,0.15)",color:"white",border:"none",width:"60px",height:"60px",borderRadius:"50%",cursor:"pointer",fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",zIndex:10},onMouseEnter:e=>{e.currentTarget.style.background="rgba(23, 162, 184, 0.8)",e.currentTarget.style.transform="translateY(-50%) scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.15)",e.currentTarget.style.transform="translateY(-50%)"},title:"Imagen siguiente",children:(0,ze.jsx)("i",{className:"fa fa-chevron-right"})}),(0,ze.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"15px 20px",background:"linear-gradient(to top, rgba(0,0,0,0.7), transparent)",display:"flex",justifyContent:"center",gap:"8px",overflowX:"auto",maxWidth:"100%"},children:U.imagenes.map((e,t)=>(0,ze.jsx)("div",{onClick:()=>H(Ue(Ue({},U),{},{indiceActual:t})),style:{width:"60px",height:"60px",borderRadius:"6px",overflow:"hidden",cursor:"pointer",border:t===U.indiceActual?"3px solid #17a2b8":"3px solid transparent",opacity:t===U.indiceActual?1:.6,transition:"all 0.2s",flexShrink:0},onMouseEnter:e=>{t!==U.indiceActual&&(e.currentTarget.style.opacity="0.9",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{t!==U.indiceActual&&(e.currentTarget.style.opacity="0.6",e.currentTarget.style.transform="scale(1)")},children:(0,ze.jsx)("img",{src:"".concat(Te,"/descargar_archivo.php?id=").concat(e.id,"&accion=ver"),alt:e.nombre_original,style:{width:"100%",height:"100%",objectFit:"cover"}})},e.id))}),(0,ze.jsxs)("div",{style:{position:"absolute",bottom:"90px",left:"50%",transform:"translateX(-50%)",color:"rgba(255,255,255,0.5)",fontSize:"12px",display:"flex",gap:"20px"},children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("kbd",{style:{background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:"4px"},children:"\u2190"})," Anterior"]}),(0,ze.jsxs)("span",{children:[(0,ze.jsx)("kbd",{style:{background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:"4px"},children:"\u2192"})," Siguiente"]}),(0,ze.jsxs)("span",{children:[(0,ze.jsx)("kbd",{style:{background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:"4px"},children:"Esc"})," Cerrar"]})]})]}),Zr&&h&&(0,ze.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:e=>{e.target===e.currentTarget&&en(!1)},children:[(0,ze.jsx)("style",{children:"\n            @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n            }\n            @keyframes slideUp {\n              from { \n                opacity: 0;\n                transform: translateY(20px) scale(0.95);\n              }\n              to { \n                opacity: 1;\n                transform: translateY(0) scale(1);\n              }\n            }\n          "}),(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"600px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",maxHeight:"85vh",display:"flex",flexDirection:"column"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(10, 110, 189, 0.3)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{fontSize:"1.1rem"}}),'Participantes de "',h.nombre,'"']}),(0,ze.jsx)("button",{onClick:()=>en(!1),style:{background:"transparent",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Cerrar",children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsx)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:nn?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",marginBottom:"1rem",color:"#17a2b8"}}),(0,ze.jsx)("div",{children:"Cargando participantes..."})]}):0===tn.length?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{fontSize:"3rem",marginBottom:"1rem",color:"#ccc"}}),(0,ze.jsx)("div",{style:{fontSize:"1rem",fontWeight:"500",color:"#999"},children:"No hay participantes asignados a esta carpeta"})]}):(0,ze.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:tn.map(e=>(0,ze.jsxs)("div",{style:{padding:"1rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e0e0e0",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#e9ecef",e.currentTarget.style.borderColor="#17a2b8",e.currentTarget.style.boxShadow="0 2px 8px rgba(10, 110, 189, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.borderColor="#e0e0e0",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,ze.jsx)("div",{style:{width:"45px",height:"45px",borderRadius:"50%",background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.2rem",fontWeight:"600",flexShrink:0,boxShadow:"0 2px 8px rgba(10, 110, 189, 0.3)"},children:e.usuario_nombre?e.usuario_nombre.charAt(0).toUpperCase():"U"}),(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsx)("div",{style:{fontWeight:"600",color:"#17a2b8",fontSize:"15px",marginBottom:"4px"},children:e.usuario_nombre||"Usuario sin nombre"}),(0,ze.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"2px"},children:[(0,ze.jsx)("i",{className:"fa fa-envelope",style:{marginRight:"6px",color:"#17a2b8"}}),e.usuario_email||"Sin email"]}),(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#999",display:"flex",alignItems:"center",gap:"8px",marginTop:"6px",flexWrap:"wrap"},children:[(0,ze.jsxs)("span",{style:{padding:"3px 8px",borderRadius:"12px",background:"#e9ecef",color:"#495057",fontSize:"11px",fontWeight:"500"},children:[(0,ze.jsx)("i",{className:"fa fa-user-tag",style:{marginRight:"4px"}}),e.usuario_rol||"Sin rol"]}),e.asignador_nombre&&(0,ze.jsxs)("span",{style:{fontSize:"11px",color:"#6c757d"},children:["Asignado por: ",e.asignador_nombre]})]})]})]}),(0,ze.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.puede_ver&&(0,ze.jsxs)("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"#d4edda",color:"#155724",fontSize:"11px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-eye"}),"Ver"]}),e.puede_subir&&(0,ze.jsxs)("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"#d1ecf1",color:"#0c5460",fontSize:"11px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-upload"}),"Subir"]}),e.puede_editar&&(0,ze.jsxs)("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"#fff3cd",color:"#856404",fontSize:"11px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-edit"}),"Editar"]}),e.puede_eliminar&&(0,ze.jsxs)("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"#f8d7da",color:"#721c24",fontSize:"11px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-trash"}),"Eliminar"]})]})]},e.id))})}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsx)("div",{style:{fontSize:"13px",color:"#666",fontWeight:"500"},children:tn.length>0&&(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{marginRight:"6px",color:"#17a2b8"}}),tn.length," ",1===tn.length?"participante":"participantes"]})}),(0,ze.jsxs)("button",{onClick:()=>en(!1),style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontWeight:"600",fontSize:"13px",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"6px"}}),"Cerrar"]})]})]})]}),an&&(0,ze.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(10, 50, 101, 0.4)",backdropFilter:"blur(4px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:e=>{e.target===e.currentTarget&&sn(null)},children:[(0,ze.jsx)("style",{children:"\n            @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n            }\n            @keyframes slideUp {\n              from { \n                opacity: 0;\n                transform: translateY(20px) scale(0.95);\n              }\n              to { \n                opacity: 1;\n                transform: translateY(0) scale(1);\n              }\n            }\n          "}),(0,ze.jsxs)("div",{style:{background:"white",padding:0,borderRadius:"16px",width:"90%",maxWidth:"500px",boxShadow:"0 20px 60px rgba(10, 50, 101, 0.3)",border:"2px solid #17a2b8",overflow:"hidden",animation:"slideUp 0.3s ease-out",maxHeight:"85vh",display:"flex",flexDirection:"column"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #FF8C00 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 10px rgba(10, 110, 189, 0.3)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{fontSize:"1.1rem"}}),"Validaci\xf3n/Observaciones"]}),(0,ze.jsx)("button",{onClick:()=>sn(null),style:{background:"transparent",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},title:"Cerrar",children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsxs)("div",{style:{padding:"1.5rem",overflowY:"auto",flex:1},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057",fontSize:"14px"},children:"Estado:"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,ze.jsxs)("button",{onClick:()=>{const e="validado"===("preventivo"===an.tipo?jt[an.itemIndex]:sr[an.itemIndex]).estado_validacion?null:"validado",t="validado"===e?100:0;if("preventivo"===an.tipo){const r=[...jt];r[an.itemIndex]=Ue(Ue({},r[an.itemIndex]),{},{estado_validacion:e,comentario_validacion:null===e?"":r[an.itemIndex].comentario_validacion||"",usuario_validacion:e?mh(d):"",fecha_validacion:e?(new Date).toISOString().slice(0,19).replace("T"," "):"",ponderacion:t}),_t(r),sn(Ue(Ue({},an),{},{item:r[an.itemIndex]}))}else{const r=[...sr];r[an.itemIndex]=Ue(Ue({},r[an.itemIndex]),{},{estado_validacion:e,comentario_validacion:null===e?"":r[an.itemIndex].comentario_validacion||"",usuario_validacion:e?mh(d):"",fecha_validacion:e?(new Date).toISOString().slice(0,19).replace("T"," "):"",ponderacion:t}),lr(r),sn(Ue(Ue({},an),{},{item:r[an.itemIndex]}))}},style:{flex:1,padding:"0.75rem",border:"2px solid",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",transition:"all 0.2s ease",background:"validado"===an.item.estado_validacion?"#28a745":"white",color:"validado"===an.item.estado_validacion?"white":"#28a745",borderColor:"#28a745"},onMouseEnter:e=>{"validado"!==an.item.estado_validacion&&(e.currentTarget.style.background="#d4edda")},onMouseLeave:e=>{"validado"!==an.item.estado_validacion&&(e.currentTarget.style.background="white")},children:[(0,ze.jsx)("i",{className:"fa fa-".concat("validado"===an.item.estado_validacion?"check-circle":"circle")}),"Validado"]}),(0,ze.jsxs)("button",{onClick:()=>{const e="con_observaciones"===("preventivo"===an.tipo?jt[an.itemIndex]:sr[an.itemIndex]).estado_validacion?null:"con_observaciones";if("preventivo"===an.tipo){const t=[...jt];t[an.itemIndex]=Ue(Ue({},t[an.itemIndex]),{},{estado_validacion:e,comentario_validacion:null===e?"":t[an.itemIndex].comentario_validacion||"",usuario_validacion:e?mh(d):"",fecha_validacion:e?(new Date).toISOString().slice(0,19).replace("T"," "):"",ponderacion:0}),_t(t),sn(Ue(Ue({},an),{},{item:t[an.itemIndex]}))}else{const t=[...sr];t[an.itemIndex]=Ue(Ue({},t[an.itemIndex]),{},{estado_validacion:e,comentario_validacion:null===e?"":t[an.itemIndex].comentario_validacion||"",usuario_validacion:e?mh(d):"",fecha_validacion:e?(new Date).toISOString().slice(0,19).replace("T"," "):"",ponderacion:0}),lr(t),sn(Ue(Ue({},an),{},{item:t[an.itemIndex]}))}},style:{flex:1,padding:"0.75rem",border:"2px solid",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",transition:"all 0.2s ease",background:"con_observaciones"===an.item.estado_validacion?"#ffc107":"white",color:"con_observaciones"===an.item.estado_validacion?"#856404":"#ffc107",borderColor:"#ffc107"},onMouseEnter:e=>{"con_observaciones"!==an.item.estado_validacion&&(e.currentTarget.style.background="#fff3cd")},onMouseLeave:e=>{"con_observaciones"!==an.item.estado_validacion&&(e.currentTarget.style.background="white")},children:[(0,ze.jsx)("i",{className:"fa fa-".concat("con_observaciones"===an.item.estado_validacion?"exclamation-triangle":"exclamation-circle")}),"Con Observaciones"]})]})]}),"con_observaciones"===an.item.estado_validacion&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057",fontSize:"14px"},children:"Comentarios de Observaciones:"}),(0,ze.jsx)("textarea",{value:an.item.comentario_validacion||"",onChange:e=>{if("preventivo"===an.tipo){const t=[...jt];t[an.itemIndex]=Ue(Ue({},t[an.itemIndex]),{},{comentario_validacion:e.target.value}),_t(t),sn(Ue(Ue({},an),{},{item:t[an.itemIndex]}))}else{const t=[...sr];t[an.itemIndex]=Ue(Ue({},t[an.itemIndex]),{},{comentario_validacion:e.target.value}),lr(t),sn(Ue(Ue({},an),{},{item:t[an.itemIndex]}))}},placeholder:"Ingrese los comentarios de las observaciones...",style:{width:"100%",minHeight:"120px",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ced4da",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),"con_observaciones"===an.item.estado_validacion&&an.item.comentario_validacion&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#fff3cd",borderRadius:"8px",border:"1px solid #ffc107"},children:[(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#856404",fontWeight:"600",marginBottom:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"0.5rem"}}),"Comentarios Actuales:"]}),(0,ze.jsx)("div",{style:{fontSize:"14px",color:"#856404",whiteSpace:"pre-wrap"},children:an.item.comentario_validacion}),an.item.usuario_validacion&&(0,ze.jsxs)("div",{style:{fontSize:"11px",color:"#856404",marginTop:"0.5rem",fontStyle:"italic"},children:["Por: ",an.item.usuario_validacion.split("|")[0]," - ",an.item.fecha_validacion?new Date(an.item.fecha_validacion).toLocaleString("es-CL"):""]})]})]}),(0,ze.jsx)("div",{style:{padding:"1rem 1.5rem",borderTop:"2px solid #e9ecef",background:"#f8f9fa",display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:(0,ze.jsxs)("button",{onClick:()=>sn(null),style:{padding:"10px 18px",border:"2px solid #6c757d",borderRadius:"6px",background:"white",color:"#6c757d",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="#6c757d",e.target.style.color="white",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 8px rgba(108, 117, 125, 0.3)"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.color="#6c757d",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"6px"}}),"Cerrar"]})})]})]}),_n&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.4)",backdropFilter:"blur(2px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:2e3,animation:"fadeIn 0.2s ease-out"},onClick:()=>Sn(null),children:(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"0",maxWidth:"420px",width:"90%",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.15)",overflow:"hidden",animation:"slideUp 0.3s ease-out",border:"1px solid #e5e7eb"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",padding:"1.25rem 1.5rem",display:"flex",alignItems:"center",gap:"12px",color:"white"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",background:"rgba(255, 255, 255, 0.25)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{color:"white"}})}),(0,ze.jsxs)("div",{style:{flex:1},children:[(0,ze.jsx)("h3",{style:{margin:"0",fontSize:"16px",fontWeight:"600",lineHeight:"1.3"},children:"Carpeta eliminada exitosamente"}),(0,ze.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"13px",opacity:.95,fontWeight:"400"},children:_n.nombre})]})]}),(0,ze.jsxs)("div",{style:{padding:"1.25rem 1.5rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",justifyContent:"center"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"0.5rem 1rem",background:"#eff6ff",borderRadius:"8px",border:"1px solid #bfdbfe"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#3b82f6",fontSize:"14px"}}),(0,ze.jsxs)("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1e40af"},children:[_n.archivos," archivo",1!==_n.archivos?"s":""]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"0.5rem 1rem",background:"#fff7ed",borderRadius:"8px",border:"1px solid #fed7aa"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#f59e0b",fontSize:"14px"}}),(0,ze.jsxs)("span",{style:{fontSize:"14px",fontWeight:"600",color:"#92400e"},children:[_n.subcarpetas," subcarpeta",1!==_n.subcarpetas?"s":""]})]})]}),(0,ze.jsxs)("button",{onClick:()=>Sn(null),style:{width:"100%",padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseEnter:e=>{e.currentTarget.style.background="#059669",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="#10b981",e.currentTarget.style.transform="translateY(0)"},children:[(0,ze.jsx)("i",{className:"fa fa-check",style:{fontSize:"12px"}}),"Aceptar"]})]})]})}),(0,ze.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",gap:"10px",pointerEvents:"none"},children:ln.map(e=>{const t={success:{bg:"#10b981",icon:"fa-check-circle",border:"#059669"},error:{bg:"#ef4444",icon:"fa-exclamation-circle",border:"#dc2626"},warning:{bg:"#f59e0b",icon:"fa-exclamation-triangle",border:"#d97706"},info:{bg:"#3b82f6",icon:"fa-info-circle",border:"#2563eb"}},r=t[e.tipo]||t.success;return(0,ze.jsxs)("div",{style:{background:r.bg,color:"white",padding:"14px 18px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)",minWidth:"300px",maxWidth:"450px",display:"flex",alignItems:"center",gap:"12px",pointerEvents:"auto",animation:"slideInRight 0.3s ease-out",borderLeft:"4px solid ".concat(r.border),fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"},onMouseEnter:e=>{e.currentTarget.style.transform="translateX(-4px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)"},children:[(0,ze.jsx)("i",{className:"fa ".concat(r.icon),style:{fontSize:"20px",flexShrink:0,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.2))"}}),(0,ze.jsx)("div",{style:{flex:1,fontSize:"14px",fontWeight:"500",lineHeight:"1.4",wordBreak:"break-word"},children:e.mensaje}),(0,ze.jsx)("button",{onClick:()=>cn(t=>t.filter(t=>t.id!==e.id)),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"white",borderRadius:"4px",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s ease",fontSize:"12px"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="scale(1)"},children:(0,ze.jsx)("i",{className:"fa fa-times"})})]},e.id)})}),Rt&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(4px)"},onClick:()=>Nt(null),children:(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"16px",width:"700px",maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 25px 80px rgba(0, 0, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",padding:"1rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",color:"#fff"},children:[(0,ze.jsx)("div",{style:{width:"42px",height:"42px",background:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.1rem"},children:(0,ze.jsx)("i",{className:"fa fa-edit"})}),(0,ze.jsxs)("h3",{style:{margin:0,fontSize:"1.15rem",fontWeight:600,flex:1,color:"#fff"},children:["Editar Control ","mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo)?"Mitigador":"Preventivo"," - L\xednea Base"]}),(0,ze.jsx)("button",{onClick:()=>Nt(null),style:{width:"32px",height:"32px",border:"none",background:"rgba(255, 255, 255, 0.15)",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"14px"},children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsxs)("div",{style:{display:"flex",borderBottom:"2px solid #e9ecef",background:"#f8f9fa"},children:[(0,ze.jsxs)("button",{onClick:()=>Dt("informacion"),style:{flex:1,padding:"0.65rem 0.5rem",border:"none",background:"informacion"===Pt?"#fff":"transparent",borderBottom:"informacion"===Pt?"3px solid #17a2b8":"3px solid transparent",cursor:"pointer",fontSize:"0.8rem",fontWeight:"informacion"===Pt?600:400,color:"informacion"===Pt?"#17a2b8":"#6c757d",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle"}),"Informaci\xf3n"]}),(0,ze.jsxs)("button",{onClick:()=>Dt("foro"),style:{flex:1,padding:"0.65rem 0.5rem",border:"none",background:"foro"===Pt?"#fff":"transparent",borderBottom:"foro"===Pt?"3px solid #17a2b8":"3px solid transparent",cursor:"pointer",fontSize:"0.8rem",fontWeight:"foro"===Pt?600:400,color:"foro"===Pt?"#17a2b8":"#6c757d",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-comments"}),"Foro"]}),(0,ze.jsxs)("button",{onClick:async()=>{if(Dt("documentos"),At.id)Wn(At.id,null);else{dn("\u26a0\ufe0f Guardando l\xednea base para habilitar documentos...","info");try{const e="preventivo"===(null===Rt||void 0===Rt?void 0:Rt.tipo),t=e?jt:sr,r="".concat(Te,e?"/archivos/carpeta_linea_base.php":"/archivos/carpeta_linea_base_mitigadores.php");if(h&&t&&t.length>0){const n={carpeta_id:h.id,usuario_id:d.id,linea_base:t.map(e=>({id:e.id,control_preventivo_id:e.control_preventivo_id,control_mitigador_id:e.control_mitigador_id,codigo:e.codigo||"",control_critico_preventivo:e.control_critico_preventivo||"",control_critico_mitigador:e.control_critico_mitigador||"",dimension:e.dimension||"",pregunta:e.pregunta||"",evidencia:e.evidencia||"",verificador_responsable:e.verificador_responsable||"",fecha_verificacion:e.fecha_verificacion&&""!==e.fecha_verificacion.trim()?e.fecha_verificacion:null,implementado_estandar:e.implementado_estandar_desempeno||"",accion_ejecutar:e.accion_a_ejecutar||"",responsable_cierre:e.responsable_cierre_accion||"",fecha_cierre:e.fecha_cierre&&""!==e.fecha_cierre.trim()?e.fecha_cierre:null,criticidad:e.criticidad||"",porcentaje_avance:""!==e.porcentaje_avance_implementacion_accion&&null!=e.porcentaje_avance_implementacion_accion?parseFloat(e.porcentaje_avance_implementacion_accion):null,nombre_dueno_control:e.nombre_dueno_control_critico_tecnico||"",comentario_trabajador:e.comentario_trabajador||"",archivos_respaldo:JSON.stringify(e.archivos_respaldo||[]),conversacion_seguimiento:JSON.stringify(e.conversacion_seguimiento||[]),ultimo_usuario_edito:e.ultimo_usuario_edito||"",estado_validacion:e.estado_validacion||null,comentario_validacion:e.comentario_validacion||"",usuario_validacion:e.usuario_validacion||"",fecha_validacion:e.fecha_validacion&&""!==e.fecha_validacion.trim()?e.fecha_validacion:null,ponderacion:void 0!==e.ponderacion?e.ponderacion:"validado"===e.estado_validacion?100:0}))},o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if((await o.json()).success){const t=await fetch("".concat(r,"?carpeta_id=").concat(h.id)),n=await t.json();if(n.success&&n.linea_base){const t=e?"control_preventivo_id":"control_mitigador_id",r=e?At.control_preventivo_id:At.control_mitigador_id,o=n.linea_base.find(e=>e[t]==r&&e.dimension===At.dimension&&e.pregunta===At.pregunta&&e.evidencia===At.evidencia);o&&o.id&&(zt(e=>Ue(Ue({},e),{},{id:o.id})),Wn(o.id,null),dn("\u2713 L\xednea base guardada. Ahora puede crear carpetas.","success"))}}}}catch(e){console.error("Error guardando l\xednea base:",e),dn("\u2717 Error al guardar. Intente de nuevo.","error")}}},style:{flex:1,padding:"0.65rem 0.5rem",border:"none",background:"documentos"===Pt?"#fff":"transparent",borderBottom:"documentos"===Pt?"3px solid #17a2b8":"3px solid transparent",cursor:"pointer",fontSize:"0.8rem",fontWeight:"documentos"===Pt?600:400,color:"documentos"===Pt?"#17a2b8":"#6c757d",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",transition:"all 0.2s ease"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open"}),"Documentos"]})]}),(0,ze.jsxs)("div",{style:{padding:"1.5rem",overflowY:"auto",flex:1},children:["informacion"===Pt&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",padding:"1rem",borderRadius:"10px",marginBottom:"1.25rem",border:"1px solid #dee2e6"},children:[(0,ze.jsx)("div",{style:{display:"inline-block",background:"#17a2b8",color:"#fff",padding:"0.25rem 0.6rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:700,marginBottom:"0.75rem"},children:At.codigo}),(0,ze.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{fontSize:"0.65rem",color:"#6c757d",textTransform:"uppercase",marginBottom:"0.2rem",fontWeight:600,letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-shield-alt",style:{marginRight:"0.3rem",color:"mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo)?"#FF8C00":"#28a745"}}),"Control Cr\xedtico ","mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo)?"Mitigador":"Preventivo"]}),(0,ze.jsx)("div",{style:{fontSize:"0.8rem",color:"#495057",lineHeight:"1.4",background:"#fff",padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid #e9ecef"},children:(()=>{const e="mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo);let t=e?At.control_critico_mitigador||At.control_critico:At.control_critico_preventivo||At.control_critico;if(!t){const r=e?At.control_mitigador_id:At.control_preventivo_id,n=e?null===Be||void 0===Be?void 0:Be.controles_mitigadores:null===Be||void 0===Be?void 0:Be.controles_preventivos;if(r&&n){const e=n.find(e=>e.id===r);e&&(t=e.descripcion||e.nombre||"")}}if(!t){const r=e?At.control_mitigador_id:At.control_preventivo_id,n=e?"control_critico_mitigador":"control_critico_preventivo",o=e?"control_mitigador_id":"control_preventivo_id",a=(e?sr:jt).find(e=>e[o]===r&&e[n]);a&&(t=a[n])}return t||"Sin informaci\xf3n"})()})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{fontSize:"0.65rem",color:"#6c757d",textTransform:"uppercase",marginBottom:"0.2rem",fontWeight:600,letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-cube",style:{marginRight:"0.3rem",color:"#6f42c1"}}),"Dimensi\xf3n"]}),(0,ze.jsx)("div",{style:{fontSize:"0.75rem",color:"#495057",lineHeight:"1.4",background:"#fff",padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid #e9ecef",minHeight:"2.5rem"},children:At.dimension||"Sin dimensi\xf3n"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{style:{fontSize:"0.65rem",color:"#6c757d",textTransform:"uppercase",marginBottom:"0.2rem",fontWeight:600,letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-question-circle",style:{marginRight:"0.3rem",color:"#ea580c"}}),"Pregunta"]}),(0,ze.jsx)("div",{style:{fontSize:"0.75rem",color:"#495057",lineHeight:"1.4",background:"#fff",padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid #e9ecef",minHeight:"2.5rem"},children:At.pregunta||"Sin pregunta"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[kh(d,yn,"verificador_responsable")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Verificador Responsable"]}),(0,ze.jsxs)("select",{value:At.verificador_responsable||"",onChange:e=>zt(Ue(Ue({},At),{},{verificador_responsable:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]})]}),kh(d,yn,"fecha_verificacion")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Fecha Verificaci\xf3n"]}),(0,ze.jsx)("input",{type:"date",value:At.fecha_verificacion||"",onChange:e=>zt(Ue(Ue({},At),{},{fecha_verificacion:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"}})]}),kh(d,yn,"implementado_estandar")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-check-circle",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Implementado s/Est\xe1ndar"]}),(0,ze.jsxs)("select",{value:At.implementado_estandar_desempeno||"",onChange:e=>zt(Ue(Ue({},At),{},{implementado_estandar_desempeno:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),(0,ze.jsx)("option",{value:"SI",children:"SI"}),(0,ze.jsx)("option",{value:"NO",children:"NO"}),(0,ze.jsx)("option",{value:"NA",children:"NA"})]})]}),kh(d,yn,"criticidad")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Criticidad"]}),(0,ze.jsxs)("select",{value:At.criticidad||"",onChange:e=>zt(Ue(Ue({},At),{},{criticidad:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),(0,ze.jsx)("option",{value:"Alta",children:"Alta"}),(0,ze.jsx)("option",{value:"Media",children:"Media"}),(0,ze.jsx)("option",{value:"Baja",children:"Baja"})]})]}),kh(d,yn,"responsable_cierre")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-user-check",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Responsable Cierre"]}),(0,ze.jsxs)("select",{value:At.responsable_cierre_accion||"",onChange:e=>zt(Ue(Ue({},At),{},{responsable_cierre_accion:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"},children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),y.map(e=>(0,ze.jsx)("option",{value:e.usuario_nombre||e.usuario_email,children:e.usuario_nombre||e.usuario_email},e.usuario_id))]})]}),kh(d,yn,"fecha_cierre")&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-calendar-check",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Fecha Cierre"]}),(0,ze.jsx)("input",{type:"date",value:At.fecha_cierre||"",onChange:e=>zt(Ue(Ue({},At),{},{fecha_cierre:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"}})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"% Avance Implementaci\xf3n"]}),(0,ze.jsx)("input",{type:"number",min:"0",max:"100",value:At.porcentaje_avance_implementacion_accion||"",onChange:e=>zt(Ue(Ue({},At),{},{porcentaje_avance_implementacion_accion:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc"},placeholder:"0-100"})]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#6c757d",marginRight:"0.35rem"}}),"Evidencia (Solo lectura)"]}),(0,ze.jsx)("div",{style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#e9ecef",color:"#495057",minHeight:"2.5rem"},children:At.evidencia||"Sin evidencia"})]})]}),kh(d,yn,"accion_ejecutar")&&(0,ze.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#495057",textTransform:"uppercase"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{color:"#17a2b8",marginRight:"0.35rem"}}),"Acci\xf3n a Ejecutar"]}),(0,ze.jsx)("textarea",{value:At.accion_a_ejecutar||"",onChange:e=>zt(Ue(Ue({},At),{},{accion_a_ejecutar:e.target.value})),style:{padding:"0.65rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",background:"#f8fafc",minHeight:"80px",resize:"vertical"},placeholder:"Describe la acci\xf3n a ejecutar..."})]})]}),"foro"===Pt&&(0,ze.jsx)(ze.Fragment,{children:(0,ze.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"#17a2b8",textTransform:"uppercase",display:"flex",alignItems:"center",gap:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{color:"#17a2b8"}}),"Foro de Seguimiento",(()=>{const e=At.conversacion_seguimiento||[];return e.length>0?(0,ze.jsxs)("span",{style:{background:"#17a2b8",color:"#fff",padding:"0.1rem 0.4rem",borderRadius:"10px",fontSize:"0.65rem"},children:[e.length," mensaje(s)"]}):null})()]}),(0,ze.jsx)("div",{style:{border:"1px solid #e2e8f0",borderRadius:"8px",maxHeight:"300px",overflowY:"auto",background:"#f8f9fa"},children:At.conversacion_seguimiento&&0!==At.conversacion_seguimiento.length?(0,ze.jsx)("div",{style:{padding:"0.75rem"},children:At.conversacion_seguimiento.map((e,t)=>{var r,n;return(0,ze.jsxs)("div",{style:{background:e.usuario_id===(null===d||void 0===d?void 0:d.id)?"#d4edda":"#fff",border:"1px solid #e9ecef",borderRadius:"8px",padding:"0.75rem",marginBottom:"0.5rem",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"trabajador"===e.usuario_rol?"#28a745":"admin"===e.usuario_rol?"#17a2b8":"#6f42c1",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"0.7rem",fontWeight:600},children:(null===(r=e.usuario_nombre)||void 0===r||null===(n=r.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{fontWeight:600,fontSize:"0.8rem",color:"#333"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"0.65rem",color:"#6c757d"},children:"trabajador"===e.usuario_rol?"\ud83d\udc77 Trabajador":"admin"===e.usuario_rol?"\ud83d\udc54 Admin":"\u2b50 Super Admin"})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("div",{style:{fontSize:"0.65rem",color:"#6c757d"},children:e.fecha?new Date(e.fecha).toLocaleString("es-CL"):""}),(()=>{if(!d)return!1;const t=d.rol,r=e.usuario_rol,n=e.usuario_id===d.id;return"trabajador"===t?n:"admin"===t?n||"trabajador"===r:"super_admin"===t&&(n||"super_admin"!==r)})()?(0,ze.jsx)("button",{onClick:()=>{if(window.confirm("\xbfEst\xe1s seguro de eliminar este mensaje?")){const e=At.conversacion_seguimiento.filter((e,r)=>r!==t);zt(Ue(Ue({},At),{},{conversacion_seguimiento:e})),dn("\u2713 Mensaje eliminado","success")}},style:{background:"transparent",border:"none",color:"#dc3545",cursor:"pointer",padding:"0.2rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",display:"flex",alignItems:"center",gap:"0.2rem"},title:"Eliminar mensaje",children:(0,ze.jsx)("i",{className:"fa fa-trash"})}):null]})]}),(0,ze.jsx)("div",{style:{fontSize:"0.85rem",color:"#333",lineHeight:"1.4",whiteSpace:"pre-wrap"},children:e.texto}),e.archivos&&e.archivos.length>0&&(0,ze.jsxs)("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{fontSize:"0.7rem",color:"#6c757d",marginBottom:"0.25rem"},children:[(0,ze.jsx)("i",{className:"fa fa-paperclip"})," Archivos adjuntos:"]}),(0,ze.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.35rem"},children:e.archivos.map((e,t)=>{var r,n,o;return(0,ze.jsxs)("a",{href:"".concat(Te.replace("/api",""),"/").concat(e.ruta),target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",background:"#e9ecef",borderRadius:"4px",fontSize:"0.7rem",color:"#495057",textDecoration:"none"},children:[null!==(r=e.tipo)&&void 0!==r&&r.includes("image")?(0,ze.jsx)("i",{className:"fa fa-image",style:{color:"#28a745"}}):null!==(n=e.tipo)&&void 0!==n&&n.includes("pdf")?(0,ze.jsx)("i",{className:"fa fa-file-pdf",style:{color:"#dc3545"}}):(0,ze.jsx)("i",{className:"fa fa-file",style:{color:"#17a2b8"}}),(null===(o=e.nombre)||void 0===o?void 0:o.length)>20?e.nombre.substring(0,17)+"...":e.nombre]},t)})})]})]},t)})}):(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6c757d",fontStyle:"italic"},children:[(0,ze.jsx)("i",{className:"fa fa-comment-slash",style:{fontSize:"1.5rem",marginBottom:"0.5rem",display:"block"}}),"No hay mensajes a\xfan. S\xe9 el primero en comentar."]})}),(0,ze.jsxs)("div",{style:{background:"#fff",border:"2px solid #17a2b8",borderRadius:"8px",padding:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{fontSize:"0.7rem",color:"#17a2b8",fontWeight:600,marginBottom:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-plus-circle"})," Nuevo mensaje"]}),(0,ze.jsx)("textarea",{id:"nuevo-mensaje-foro",placeholder:"Escribe tu comentario aqu\xed...",style:{width:"100%",padding:"0.5rem",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"0.85rem",background:"#f8fafc",minHeight:"60px",resize:"vertical",marginBottom:"0.5rem"}}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,ze.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.35rem 0.75rem",background:"#6f42c1",color:"#fff",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:[(0,ze.jsx)("i",{className:"fa fa-paperclip"})," Adjuntar archivos",(0,ze.jsx)("input",{type:"file",id:"archivos-nuevo-mensaje",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:e=>{const t=document.getElementById("lista-archivos-nuevos"),r=Array.from(e.target.files);t&&(t.innerHTML=r.map(e=>'<span style="background:#e9ecef;padding:2px 6px;border-radius:3px;font-size:11px;margin-right:4px;">'.concat(e.name,"</span>")).join(""))}})]}),(0,ze.jsx)("div",{id:"lista-archivos-nuevos",style:{fontSize:"0.75rem",color:"#6c757d"}})]}),(0,ze.jsxs)("button",{type:"button",onClick:async()=>{var e,t;const r=document.getElementById("nuevo-mensaje-foro"),n=document.getElementById("archivos-nuevo-mensaje"),o=null===r||void 0===r||null===(e=r.value)||void 0===e?void 0:e.trim();if(!o)return void dn("Escribe un mensaje antes de enviar","warning");let a=[];if((null===n||void 0===n||null===(t=n.files)||void 0===t?void 0:t.length)>0){const e=new FormData;Array.from(n.files).forEach(t=>e.append("archivos[]",t)),e.append("carpeta_id",null===h||void 0===h?void 0:h.id),e.append("tipo","foro_linea_base"),e.append("item_id",At.id||"nuevo");try{const t=await fetch("".concat(Te,"/archivos/subir_respaldo.php"),{method:"POST",body:e}),r=await t.json();r.success&&r.archivos&&(a=r.archivos)}catch(c){console.error("Error subiendo archivos:",c)}}const i={id:Date.now(),usuario_id:null===d||void 0===d?void 0:d.id,usuario_nombre:(null===d||void 0===d?void 0:d.nombre)||(null===d||void 0===d?void 0:d.email)||"Usuario",usuario_rol:(null===d||void 0===d?void 0:d.rol)||"usuario",texto:o,archivos:a,fecha:(new Date).toISOString()},s=At.conversacion_seguimiento||[],l=Ue(Ue({},At),{},{conversacion_seguimiento:[...s,i]});zt(l);try{if("mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo)){const e=[...sr];e[Rt.index]=Ue(Ue(Ue({},e[Rt.index]),l),{},{ultimo_usuario_edito:mh(d)}),lr(e),await Jn(e)}else{const e=[...jt];e[Rt.index]=Ue(Ue(Ue({},e[Rt.index]),l),{},{ultimo_usuario_edito:mh(d)}),_t(e),await Xn(e)}dn("\u2713 Mensaje guardado correctamente","success")}catch(c){console.error("Error al guardar mensaje:",c),dn("\u2717 Error al guardar mensaje","error")}r.value="",n.value="",document.getElementById("lista-archivos-nuevos").innerHTML=""},style:{background:"#17a2b8",color:"#fff",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-paper-plane"})," Enviar mensaje"]})]})]})}),"documentos"===Pt&&(0,ze.jsxs)("div",{style:{minHeight:"400px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("button",{onClick:()=>Yn(null),style:{background:null===Wt?"#17a2b8":"#e9ecef",color:null===Wt?"#fff":"#495057",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",fontWeight:500,display:"flex",alignItems:"center",gap:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-home"})," Ra\xedz"]}),Ht.map((e,t)=>(0,ze.jsxs)(o.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-chevron-right",style:{color:"#adb5bd",fontSize:"0.7rem"}}),(0,ze.jsx)("button",{onClick:()=>Yn(e.id),style:{background:t===Ht.length-1?"#17a2b8":"#e9ecef",color:t===Ht.length-1?"#fff":"#495057",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",fontWeight:500},children:e.nombre})]},e.id))]}),("super_admin"===(null===d||void 0===d?void 0:d.rol)||"admin"===(null===d||void 0===d?void 0:d.rol))&&(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,ze.jsxs)("button",{onClick:()=>Kt(!0),style:{background:"#28a745",color:"#fff",border:"none",padding:"0.5rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-plus"})," Nueva Carpeta"]}),(0,ze.jsxs)("label",{style:{background:"#17a2b8",color:"#fff",border:"none",padding:"0.5rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-upload"})," Subir Archivo",(0,ze.jsx)("input",{type:"file",multiple:!0,style:{display:"none"},onChange:e=>(async e=>{if(!e||0===e.length)return void dn("\u2717 Seleccione al menos un archivo","error");let t=At.id;if(!t)try{dn("Guardando l\xednea base...","info");const e="preventivo"===(null===Rt||void 0===Rt?void 0:Rt.tipo),r=e?jt:sr,n="".concat(Te,e?"/archivos/carpeta_linea_base.php":"/archivos/carpeta_linea_base_mitigadores.php");if(!h||!r||0===r.length)return void dn("\u2717 No hay datos de l\xednea base para guardar","error");const o={carpeta_id:h.id,usuario_id:d.id,linea_base:r.map(e=>({id:e.id,control_preventivo_id:e.control_preventivo_id,control_mitigador_id:e.control_mitigador_id,codigo:e.codigo||"",control_critico_preventivo:e.control_critico_preventivo||"",control_critico_mitigador:e.control_critico_mitigador||"",dimension:e.dimension||"",pregunta:e.pregunta||"",evidencia:e.evidencia||"",verificador_responsable:e.verificador_responsable||"",fecha_verificacion:e.fecha_verificacion&&""!==e.fecha_verificacion.trim()?e.fecha_verificacion:null,implementado_estandar:e.implementado_estandar_desempeno||"",accion_ejecutar:e.accion_a_ejecutar||"",responsable_cierre:e.responsable_cierre_accion||"",fecha_cierre:e.fecha_cierre&&""!==e.fecha_cierre.trim()?e.fecha_cierre:null,criticidad:e.criticidad||"",porcentaje_avance:""!==e.porcentaje_avance_implementacion_accion&&null!=e.porcentaje_avance_implementacion_accion?parseFloat(e.porcentaje_avance_implementacion_accion):null,nombre_dueno_control:e.nombre_dueno_control_critico_tecnico||"",comentario_trabajador:e.comentario_trabajador||"",archivos_respaldo:JSON.stringify(e.archivos_respaldo||[]),conversacion_seguimiento:JSON.stringify(e.conversacion_seguimiento||[]),ultimo_usuario_edito:e.ultimo_usuario_edito||"",estado_validacion:e.estado_validacion||null,comentario_validacion:e.comentario_validacion||"",usuario_validacion:e.usuario_validacion||"",fecha_validacion:e.fecha_validacion&&""!==e.fecha_validacion.trim()?e.fecha_validacion:null,ponderacion:void 0!==e.ponderacion?e.ponderacion:"validado"===e.estado_validacion?100:0}))},a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),i=await a.json();if(!i.success)return void dn("\u2717 Error al guardar l\xednea base: "+(i.error||"Error desconocido"),"error");const s=await fetch("".concat(n,"?carpeta_id=").concat(h.id)),l=await s.json();if(!l.success||!l.linea_base)return void dn("\u2717 Error al obtener datos actualizados","error");{const r=l.linea_base.find(t=>(e?t.control_preventivo_id===At.control_preventivo_id:t.control_mitigador_id===At.control_mitigador_id)&&t.dimension===At.dimension&&t.pregunta===At.pregunta&&t.evidencia===At.evidencia);if(!r||!r.id)return void dn("\u2717 No se pudo obtener el ID del registro. Por favor, guarde los cambios primero.","error");t=r.id,zt(e=>Ue(Ue({},e),{},{id:t}))}}catch(o){return console.error("Error guardando l\xednea base:",o),void dn("\u2717 Error al guardar la l\xednea base","error")}const r=new FormData;Array.from(e).forEach(e=>r.append("archivos[]",e)),r.append("linea_base_id",t),r.append("carpeta_id",Wt||""),r.append("usuario_id",null===d||void 0===d?void 0:d.id),r.append("usuario_nombre",(null===d||void 0===d?void 0:d.nombre)||(null===d||void 0===d?void 0:d.email));try{Yt(!0);const e=await fetch("".concat(Te,"/archivos/linea_base_archivos.php"),{method:"POST",body:r}),o=await e.json();var n;o.success?(dn("\u2713 ".concat(o.archivos.length," archivo(s) subido(s)"),"success"),Wn(t,Wt)):dn("\u2717 Error: "+(o.error||(null===(n=o.errores)||void 0===n?void 0:n.join(", "))),"error")}catch(o){console.error("Error subiendo archivos:",o),dn("\u2717 Error al subir archivos","error")}finally{Yt(!1)}})(e.target.files)})]})]})]}),Gt&&(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem"}}),(0,ze.jsx)("p",{style:{marginTop:"0.5rem"},children:"Cargando..."})]}),!Gt&&(0,ze.jsxs)("div",{children:[Lt.length>0&&(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,ze.jsxs)("h4",{style:{fontSize:"0.85rem",color:"#6c757d",marginBottom:"0.75rem",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"0.5rem",color:"#ffc107"}}),"Carpetas (",Lt.length,")"]}),(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"0.75rem"},children:Lt.map(e=>(0,ze.jsxs)("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:"10px",padding:"1rem",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},onClick:()=>Yn(e.id),onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="translateY(0)"},children:[(0,ze.jsx)("div",{style:{fontSize:"2.5rem",color:e.color||"#ffc107",marginBottom:"0.5rem",textAlign:"center"},children:(0,ze.jsx)("i",{className:"fa fa-folder"})}),(0,ze.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:600,color:"#343a40",textAlign:"center",wordBreak:"break-word"},children:e.nombre}),("super_admin"===(null===d||void 0===d?void 0:d.rol)||"admin"===(null===d||void 0===d?void 0:d.rol))&&(0,ze.jsxs)("div",{style:{position:"absolute",top:"5px",right:"5px",display:"flex",gap:"4px"},children:[(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),er({id:e.id,nombre:e.nombre}),rr(e.nombre)},style:{background:"#17a2b8",color:"#fff",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"0.65rem",display:"flex",alignItems:"center",justifyContent:"center",opacity:.9},title:"Renombrar carpeta",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}),(0,ze.jsx)("button",{onClick:t=>{t.stopPropagation(),Gn("carpeta",e.id,e.nombre)},style:{background:"#dc3545",color:"#fff",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"0.65rem",display:"flex",alignItems:"center",justifyContent:"center",opacity:.9},title:"Eliminar carpeta",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id))})]}),Ft.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{style:{fontSize:"0.85rem",color:"#6c757d",marginBottom:"0.75rem",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-file",style:{marginRight:"0.5rem",color:"#17a2b8"}}),"Archivos (",Ft.length,")"]}),(0,ze.jsxs)("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 100px 90px 80px 70px",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"#f8f9fa",borderBottom:"1px solid #e2e8f0",fontSize:"0.7rem",fontWeight:600,color:"#6c757d",textTransform:"uppercase"},children:[(0,ze.jsx)("div",{}),(0,ze.jsx)("div",{children:"Nombre"}),(0,ze.jsx)("div",{children:"Tipo"}),(0,ze.jsx)("div",{children:"Tama\xf1o"}),(0,ze.jsx)("div",{children:"Fecha"}),(0,ze.jsx)("div",{style:{textAlign:"center"},children:"Acciones"})]}),Ft.map(e=>{var t,r;const n=qn(e.nombre_original,e.tipo_mime),o={pdf:{nombre:"PDF",color:"#dc3545"},doc:{nombre:"Word",color:"#2b579a"},docx:{nombre:"Word",color:"#2b579a"},xls:{nombre:"Excel",color:"#217346"},xlsx:{nombre:"Excel",color:"#217346"},ppt:{nombre:"PowerPoint",color:"#d24726"},pptx:{nombre:"PowerPoint",color:"#d24726"},jpg:{nombre:"Imagen",color:"#6f42c1"},jpeg:{nombre:"Imagen",color:"#6f42c1"},png:{nombre:"Imagen",color:"#6f42c1"},gif:{nombre:"Imagen",color:"#6f42c1"},webp:{nombre:"Imagen",color:"#6f42c1"},zip:{nombre:"ZIP",color:"#ffc107"},rar:{nombre:"RAR",color:"#ffc107"},mp4:{nombre:"Video",color:"#17a2b8"},mp3:{nombre:"Audio",color:"#fd7e14"},txt:{nombre:"Texto",color:"#6c757d"},csv:{nombre:"CSV",color:"#28a745"}}[null===(t=e.extension)||void 0===t?void 0:t.toLowerCase()]||{nombre:(null===(r=e.extension)||void 0===r?void 0:r.toUpperCase())||"Archivo",color:"#6c757d"};return(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 100px 90px 80px 70px",gap:"0.5rem",padding:"0.6rem 0.75rem",borderBottom:"1px solid #f1f3f4",alignItems:"center",transition:"background 0.15s ease"},onMouseEnter:e=>e.currentTarget.style.background="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.background="#fff",children:[(0,ze.jsx)("div",{style:{fontSize:"1.4rem",color:n.color,textAlign:"center"},children:(0,ze.jsx)("i",{className:n.icono})}),(0,ze.jsx)("div",{style:{overflow:"hidden"},children:(0,ze.jsx)("a",{href:"".concat(Te,"/archivos/descargar_linea_base.php?id=").concat(e.id,"&accion=ver"),target:"_blank",rel:"noopener noreferrer",style:{fontSize:"0.8rem",fontWeight:500,color:"#343a40",textDecoration:"none",display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:e.nombre_original,children:e.nombre_original})}),(0,ze.jsx)("div",{children:(0,ze.jsx)("span",{style:{background:o.color+"20",color:o.color,padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:600},children:o.nombre})}),(0,ze.jsx)("div",{style:{fontSize:"0.75rem",color:"#6c757d"},children:$n(e.tamano_bytes)}),(0,ze.jsx)("div",{style:{fontSize:"0.7rem",color:"#adb5bd"},children:e.subido_en?new Date(e.subido_en).toLocaleDateString("es-CL"):"-"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.3rem",justifyContent:"center"},children:[(0,ze.jsx)("a",{href:"".concat(Te,"/archivos/descargar_linea_base.php?id=").concat(e.id,"&accion=ver"),target:"_blank",rel:"noopener noreferrer",style:{background:"#17a2b8",color:"#fff",border:"none",padding:"0.3rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textDecoration:"none"},title:"Ver archivo",children:(0,ze.jsx)("i",{className:"fa fa-eye"})}),("super_admin"===(null===d||void 0===d?void 0:d.rol)||"admin"===(null===d||void 0===d?void 0:d.rol))&&(0,ze.jsx)("button",{onClick:()=>Gn("archivo",e.id,e.nombre_original),style:{background:"#dc3545",color:"#fff",border:"none",padding:"0.3rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.65rem"},title:"Eliminar",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id)})]})]}),0===Lt.length&&0===Ft.length&&(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#adb5bd",background:"#f8f9fa",borderRadius:"12px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{fontSize:"3rem",marginBottom:"1rem"}}),(0,ze.jsx)("p",{style:{fontSize:"1rem",margin:0},children:"Esta carpeta est\xe1 vac\xeda"}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:"super_admin"===(null===d||void 0===d?void 0:d.rol)||"admin"===(null===d||void 0===d?void 0:d.rol)?"Crea una carpeta o sube archivos para comenzar":"No hay documentos disponibles"})]})]}),Xt&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:()=>Kt(!1),children:(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",padding:"1.5rem",width:"350px",maxWidth:"90vw"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("h4",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"#343a40"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-plus",style:{marginRight:"0.5rem",color:"#28a745"}}),"Nueva Carpeta"]}),(0,ze.jsx)("input",{type:"text",value:Jt,onChange:e=>Qt(e.target.value),placeholder:"Nombre de la carpeta...",style:{width:"100%",padding:"0.75rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.95rem",marginBottom:"1rem"},autoFocus:!0,onKeyPress:e=>"Enter"===e.key&&Un()}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>Kt(!1),style:{padding:"0.6rem 1rem",border:"1.5px solid #e2e8f0",background:"#fff",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem"},children:"Cancelar"}),(0,ze.jsx)("button",{onClick:Un,disabled:!Jt.trim()||$t,style:{padding:"0.6rem 1rem",border:"none",background:Jt.trim()&&!$t?"#28a745":"#ccc",color:"#fff",borderRadius:"6px",cursor:Jt.trim()&&!$t?"pointer":"not-allowed",fontSize:"0.85rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.4rem"},children:$t?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin"}),"Creando..."]}):"Crear"})]})]})}),Zt&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:()=>er(null),children:(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",padding:"1.5rem",width:"350px",maxWidth:"90vw"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("h4",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"#343a40"},children:[(0,ze.jsx)("i",{className:"fa fa-pencil",style:{marginRight:"0.5rem",color:"#17a2b8"}}),"Renombrar Carpeta"]}),(0,ze.jsx)("input",{type:"text",value:tr,onChange:e=>rr(e.target.value),placeholder:"Nuevo nombre...",style:{width:"100%",padding:"0.75rem",border:"1.5px solid #e2e8f0",borderRadius:"8px",fontSize:"0.95rem",marginBottom:"1rem"},autoFocus:!0,onKeyPress:e=>"Enter"===e.key&&Hn()}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>er(null),style:{padding:"0.6rem 1rem",border:"1.5px solid #e2e8f0",background:"#fff",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem"},children:"Cancelar"}),(0,ze.jsx)("button",{onClick:Hn,disabled:!tr.trim(),style:{padding:"0.6rem 1rem",border:"none",background:tr.trim()?"#17a2b8":"#ccc",color:"#fff",borderRadius:"6px",cursor:tr.trim()?"pointer":"not-allowed",fontSize:"0.85rem",fontWeight:600},children:"Guardar"})]})]})}),nr&&(0,ze.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:()=>or(null),children:(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",padding:"1.5rem",width:"380px",maxWidth:"90vw",border:"3px solid #dc3545"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("h4",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"#dc3545"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{marginRight:"0.5rem"}}),"Confirmar Eliminaci\xf3n"]}),(0,ze.jsxs)("p",{style:{fontSize:"0.9rem",color:"#495057",marginBottom:"1rem"},children:["\xbfEst\xe1s seguro de eliminar ","carpeta"===nr.tipo?"la carpeta":"el archivo",":",(0,ze.jsxs)("strong",{style:{display:"block",marginTop:"0.5rem",color:"#343a40"},children:['"',nr.nombre,'"']}),"carpeta"===nr.tipo&&(0,ze.jsx)("span",{style:{fontSize:"0.8rem",color:"#dc3545",display:"block",marginTop:"0.5rem"},children:"\u26a0\ufe0f Se eliminar\xe1n tambi\xe9n todas las subcarpetas y archivos"})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("label",{style:{fontSize:"0.8rem",fontWeight:600,color:"#495057",display:"block",marginBottom:"0.35rem"},children:[(0,ze.jsx)("i",{className:"fa fa-lock",style:{marginRight:"0.35rem"}}),"Ingresa la clave de seguridad:"]}),(0,ze.jsx)("input",{type:"password",value:ar,onChange:e=>ir(e.target.value),placeholder:"Clave secreta...",style:{width:"100%",padding:"0.75rem",border:"1.5px solid #dc3545",borderRadius:"8px",fontSize:"0.95rem"},autoFocus:!0,onKeyPress:e=>"Enter"===e.key&&Vn()})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,ze.jsx)("button",{onClick:()=>{or(null),ir("")},style:{padding:"0.6rem 1rem",border:"1.5px solid #e2e8f0",background:"#fff",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:Vn,disabled:!ar,style:{padding:"0.6rem 1rem",border:"none",background:ar?"#dc3545":"#ccc",color:"#fff",borderRadius:"6px",cursor:ar?"pointer":"not-allowed",fontSize:"0.85rem",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-trash",style:{marginRight:"0.35rem"}}),"Eliminar"]})]})]})})]})]}),(0,ze.jsxs)("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e2e8f0",display:"flex",gap:"0.75rem",justifyContent:"flex-end",background:"#f8f9fa"},children:[(0,ze.jsx)("button",{onClick:()=>Nt(null),style:{padding:"0.7rem 1.5rem",border:"1.5px solid #e2e8f0",background:"#fff",borderRadius:"8px",fontSize:"0.9rem",fontWeight:600,color:"#64748b",cursor:"pointer"},children:"Cancelar"}),(0,ze.jsxs)("button",{onClick:async()=>{try{if("mitigador"===(null===Rt||void 0===Rt?void 0:Rt.tipo)){const e=[...sr];e[Rt.index]=Ue(Ue(Ue({},e[Rt.index]),At),{},{ultimo_usuario_edito:mh(d)}),lr(e),await Jn(e)}else{const e=[...jt];e[Rt.index]=Ue(Ue(Ue({},e[Rt.index]),At),{},{ultimo_usuario_edito:mh(d)}),_t(e),await Xn(e)}Nt(null),dn("\u2713 Cambios guardados correctamente","success")}catch(e){console.error("Error al guardar:",e),dn("\u2717 Error al guardar cambios","error")}},disabled:kt||pr,style:{padding:"0.7rem 1.5rem",border:"none",background:kt?"#6c757d":"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",borderRadius:"8px",fontSize:"0.9rem",fontWeight:700,color:"#fff",cursor:kt?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem",boxShadow:"0 4px 12px rgba(23, 162, 184, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa ".concat(kt?"fa-spinner fa-spin":"fa-save")}),kt?"Guardando...":"Guardar Cambios"]})]})]})}),(0,ze.jsx)("style",{children:"\n        @keyframes slideInRight {\n          from {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n      "})]})},Th=e=>{let{proyectoId:t,user:r,sidebarCollapsed:n,onNavigateToCarpeta:a}=e;const[i,s]=(0,o.useState)([]),[l,c]=(0,o.useState)([]),[d,p]=(0,o.useState)(!0),[u,f]=(0,o.useState)(null),[h,g]=(0,o.useState)(null),[m,x]=(0,o.useState)(1),[b,v]=(0,o.useState)(0),[y,j]=(0,o.useState)(0),_=(0,o.useRef)(null),S=(0,o.useRef)(null);(0,o.useEffect)(()=>{t&&(w(),k())},[t]);const w=async()=>{try{p(!0);const n=await fetch("".concat(Te,"/archivos/carpetas.php?proyecto_id=").concat(t,"&todas=1&usuario_id=").concat(r.id)),o=await n.json();if(!Array.isArray(o))return s([]),void p(!1);const a=[];for(const t of o)try{const e=await fetch("".concat(Te,"/archivos/carpeta_tareas.php?carpeta_id=").concat(t.id,"&usuario_id=").concat(r.id)),n=await e.json();Array.isArray(n)&&n.forEach(e=>{a.push(Ue(Ue({},e),{},{carpeta_nombre:t.nombre,carpeta_id:t.id}))})}catch(e){console.error("Error cargando tareas de carpeta ".concat(t.id,":"),e)}if(s(a),a.length>0){const e=a.map(e=>[e.fecha_vencimiento?new Date(e.fecha_vencimiento):null,e.recordatorio_en?new Date(e.recordatorio_en):null,e.creado_en?new Date(e.creado_en):null]).flat().filter(e=>null!==e);if(e.length>0){const t=new Date(Math.min(...e.map(e=>e.getTime()))),r=new Date(Math.max(...e.map(e=>e.getTime())));t.setDate(t.getDate()-7),r.setDate(r.getDate()+7),f(t),g(r)}}p(!1)}catch(e){console.error("Error cargando tareas:",e),s([]),p(!1)}},k=async()=>{try{const e=await fetch("".concat(Te,"/archivos/carpetas.php?proyecto_id=").concat(t,"&todas=1&usuario_id=").concat(r.id)),n=await e.json();c(Array.isArray(n)?n:[])}catch(e){console.error("Error cargando carpetas:",e),c([])}},C=e=>{if(!e)return"";return new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},E=e=>{if(!e)return"";return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},T=e=>{if(!u||!h||!e)return 0;const t=new Date(e),r=Math.ceil((h-u)/864e5);return Math.ceil((t-u)/864e5)/r*(100*r*m)},R={};return i.forEach(e=>{const t=e.carpeta_id||"sin_carpeta";R[t]||(R[t]={carpeta:l.find(e=>e.id===t)||{nombre:"Sin Carpeta",id:t},tareas:[]}),R[t].tareas.push(e)}),d?(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",color:"#0a6ebd"}}),(0,ze.jsx)("p",{children:"Cargando tareas del proyecto..."})]}):(0,ze.jsxs)("div",{style:{padding:"1.5rem",background:"#f8f9fa",minHeight:"100vh",marginTop:"51px"},children:[(0,ze.jsxs)("div",{style:{background:"white",padding:"1.5rem",borderRadius:"8px",marginBottom:"1.5rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h1",{style:{margin:0,color:"#0a3265",fontSize:"24px",fontWeight:"600"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{marginRight:"10px"}}),"Control de Tareas - Diagrama Gantt"]}),(0,ze.jsx)("p",{style:{margin:"0.5rem 0 0 0",color:"#666",fontSize:"14px"},children:"Visualizaci\xf3n tipo Primavera P6 de todas las tareas del proyecto"})]}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,ze.jsx)("label",{style:{fontSize:"14px",color:"#666",marginRight:"8px"},children:"Zoom:"}),(0,ze.jsxs)("select",{value:m,onChange:e=>x(parseFloat(e.target.value)),style:{padding:"6px 12px",borderRadius:"6px",border:"2px solid #e9ecef",fontSize:"14px",cursor:"pointer"},children:[(0,ze.jsx)("option",{value:"0.5",children:"50%"}),(0,ze.jsx)("option",{value:"1",children:"100%"}),(0,ze.jsx)("option",{value:"1.5",children:"150%"}),(0,ze.jsx)("option",{value:"2",children:"200%"})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden"},children:[(0,ze.jsx)("div",{ref:S,style:{position:"sticky",top:0,zIndex:10,background:"#0a3265",color:"white",padding:"1rem",overflowX:"auto",borderBottom:"2px solid #F2A900"},children:u&&h&&(()=>{const e=[],t=new Date(u);for(;t<=h;)e.push(new Date(t)),t.setDate(t.getDate()+1);return(0,ze.jsx)("div",{style:{display:"flex",minWidth:"".concat(100*e.length*m,"px")},children:e.map((e,t)=>(0,ze.jsxs)("div",{style:{minWidth:"".concat(100*m,"px"),textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.2)",padding:"4px"},children:[(0,ze.jsx)("div",{style:{fontSize:"11px",fontWeight:"600"},children:e.toLocaleDateString("es-ES",{day:"2-digit",month:"short"})}),(0,ze.jsx)("div",{style:{fontSize:"10px",opacity:.8},children:e.toLocaleDateString("es-ES",{weekday:"short"})})]},t))})})()}),(0,ze.jsxs)("div",{ref:_,style:{overflow:"auto",maxHeight:"calc(100vh - 250px)"},children:[Object.values(R).map((e,t)=>(0,ze.jsxs)("div",{style:{borderBottom:"2px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.75rem 1rem",fontWeight:"600",color:"#0a3265",borderBottom:"1px solid #e9ecef",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#F2A900"}}),(0,ze.jsx)("span",{children:e.carpeta.nombre}),(0,ze.jsxs)("span",{style:{fontSize:"12px",color:"#666",fontWeight:"400"},children:["(",e.tareas.length," ",1===e.tareas.length?"tarea":"tareas",")"]})]}),e.tareas.map((e,t)=>{const r=e.fecha_vencimiento?new Date(new Date(e.fecha_vencimiento).getTime()-6048e5):new Date(e.creado_en),n=e.fecha_vencimiento?new Date(e.fecha_vencimiento):new Date(new Date(e.creado_en).getTime()+6048e5),o=T(r),i=((e,t)=>{if(!e||!t)return 50;const r=new Date(e),n=new Date(t),o=Math.ceil((n-r)/864e5);return Math.max(50,100*o*m)})(r,n),s=(l=e.estado,c=e.estado_validacion,"completada"===l?"validada"===c?"#28a745":"rechazada"===c?"#dc3545":"#ffc107":"en_progreso"===l?"#0a6ebd":"#6c757d");var l,c,d;return(0,ze.jsxs)("div",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #f0f0f0",display:"flex",alignItems:"center",minHeight:"60px",position:"relative"},children:[(0,ze.jsxs)("div",{style:{minWidth:"300px",maxWidth:"300px",paddingRight:"1rem",borderRight:"1px solid #e9ecef",cursor:"pointer"},onClick:t=>{t.stopPropagation(),a&&a(e.carpeta_id,e.id)},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[(0,ze.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:(d=e.prioridad,{urgente:"#dc3545",alta:"#fd7e14",media:"#ffc107",baja:"#6c757d"}[d]||"#6c757d")}}),(0,ze.jsx)("span",{style:{fontWeight:"600",color:"#0a3265",fontSize:"14px"},children:e.titulo}),(0,ze.jsx)("i",{className:"fa fa-external-link-alt",style:{fontSize:"10px",color:"#0a6ebd",marginLeft:"4px"}})]}),(0,ze.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginLeft:"20px"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{marginRight:"4px"}}),e.creador_nombre||"Usuario"]}),e.asignados&&e.asignados.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("i",{className:"fa fa-user-check",style:{marginRight:"4px"}}),e.asignados.map(e=>e.usuario_nombre).join(", ")]}),(0,ze.jsx)("div",{children:(0,ze.jsxs)("span",{style:{background:s,color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},children:["en_progreso"===e.estado?"En Progreso":"completada"===e.estado?"Completada":"cancelada"===e.estado?"Cancelada":"Pendiente","completada"===e.estado&&"pendiente"===e.estado_validacion&&" (Pend. Validaci\xf3n)"]})})]})]}),(0,ze.jsx)("div",{style:{flex:1,position:"relative",height:"40px",background:"#f8f9fa",borderRadius:"4px",overflow:"visible"},children:u&&h&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{style:{position:"absolute",left:"".concat(o,"px"),width:"".concat(i,"px"),height:"32px",background:s,borderRadius:"4px",top:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",display:"flex",alignItems:"center",padding:"0 8px",color:"white",fontSize:"11px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},title:"".concat(e.titulo,"\n").concat(C(r)," - ").concat(C(n),"\n\nClic para abrir la tarea"),onMouseEnter:e=>{e.currentTarget.style.transform="scaleY(1.1)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="scaleY(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)"},onClick:t=>{t.stopPropagation(),a&&a(e.carpeta_id,e.id)},children:i>80&&(0,ze.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.titulo.substring(0,Math.floor(i/8))})}),e.fecha_vencimiento&&(0,ze.jsx)("div",{style:{position:"absolute",left:"".concat(T(new Date(e.fecha_vencimiento)),"px"),top:"0",bottom:"0",width:"2px",background:"#dc3545",zIndex:5},title:"Vence: ".concat(E(e.fecha_vencimiento))}),e.recordatorio_en&&(0,ze.jsx)("div",{style:{position:"absolute",left:"".concat(T(new Date(e.recordatorio_en)),"px"),top:"0",width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"8px solid #ffc107",zIndex:5},title:"Recordatorio: ".concat(E(e.recordatorio_en))})]})})]},e.id)})]},t)),0===i.length&&(0,ze.jsxs)("div",{style:{padding:"4rem",textAlign:"center",color:"#999"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{fontSize:"3rem",marginBottom:"1rem",opacity:.3}}),(0,ze.jsx)("p",{style:{fontSize:"16px",margin:0},children:"No hay tareas en el proyecto."}),(0,ze.jsx)("p",{style:{fontSize:"14px",marginTop:"0.5rem"},children:"Las tareas aparecer\xe1n aqu\xed cuando se creen en las carpetas del proyecto."})]})]})]}),(0,ze.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",marginTop:"1rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",gap:"2rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{style:{color:"#0a3265",marginBottom:"0.5rem",display:"block"},children:"Estados:"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"12px",background:"#6c757d",borderRadius:"2px"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Pendiente"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"12px",background:"#0a6ebd",borderRadius:"2px"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"En Progreso"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"12px",background:"#28a745",borderRadius:"2px"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Completada (Validada)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"12px",background:"#ffc107",borderRadius:"2px"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Completada (Pend. Validaci\xf3n)"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"20px",height:"12px",background:"#dc3545",borderRadius:"2px"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Rechazada / Cancelada"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{style:{color:"#0a3265",marginBottom:"0.5rem",display:"block"},children:"Prioridades:"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#dc3545"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Urgente"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#fd7e14"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Alta"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#ffc107"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Media"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#6c757d"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Baja"})]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{style:{color:"#0a3265",marginBottom:"0.5rem",display:"block"},children:"Marcadores:"}),(0,ze.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"2px",height:"12px",background:"#dc3545"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Fecha Vencimiento"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"8px solid #ffc107"}}),(0,ze.jsx)("span",{style:{fontSize:"12px"},children:"Recordatorio"})]})]})]})]})]})},Rh=e=>{let{proyectoId:t,user:r,sidebarCollapsed:n,onNavigateToCarpeta:a}=e;const[i,s]=(0,o.useState)({carpetas:[],tareas:[],mensajes:[]}),[l,c]=(0,o.useState)(!0),[d,p]=(0,o.useState)("todos"),[u,f]=(0,o.useState)("todas"),[h,g]=(0,o.useState)([]),[m,x]=(0,o.useState)(()=>{const e=new Date;return e.setMonth(e.getMonth()-3),e.toISOString().split("T")[0]}),[b,v]=(0,o.useState)(()=>(new Date).toISOString().split("T")[0]),[y,j]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&_()},[t]);const _=async()=>{try{c(!0);const n=await fetch("".concat(Te,"/archivos/carpetas.php?proyecto_id=").concat(t,"&todas=1&usuario_id=").concat(r.id)),o=await n.json();if(!Array.isArray(o))return s({carpetas:[],tareas:[],mensajes:[]}),void c(!1);const a=[],i=[],l=[],d={};g(o);for(const t of o){d[t.id]=t.nombre;try{const n=await fetch("".concat(Te,"/archivos/carpeta_mensajes.php?carpeta_id=").concat(t.id,"&usuario_id=").concat(r.id)),o=await n.json();if(Array.isArray(o)&&o.length>0){const e=o.length,r=o[o.length-1];a.push({carpeta_id:t.id,carpeta_nombre:t.nombre,cantidad_mensajes:e,ultimo_mensaje:r,carpeta:t}),o.forEach(e=>{l.push(Ue(Ue({},e),{},{carpeta_id:t.id,carpeta_nombre:t.nombre}))})}const s=await fetch("".concat(Te,"/archivos/carpeta_tareas.php?carpeta_id=").concat(t.id,"&usuario_id=").concat(r.id)),c=await s.json();if(Array.isArray(c))for(const r of c)try{const e=await fetch("".concat(Te,"/archivos/carpeta_tarea_comentarios.php?tarea_id=").concat(r.id)),n=await e.json();if(Array.isArray(n)&&n.length>0){const e=n.length,o=n[n.length-1];i.push({tarea_id:r.id,tarea_titulo:r.titulo,carpeta_id:t.id,carpeta_nombre:t.nombre,cantidad_comentarios:e,ultimo_comentario:o,tarea:r})}}catch(e){console.error("Error cargando comentarios de tarea ".concat(r.id,":"),e)}}catch(e){console.error("Error procesando carpeta ".concat(t.id,":"),e)}}a.sort((e,t)=>{var r,n;const o=new Date((null===(r=e.ultimo_mensaje)||void 0===r?void 0:r.creado_en)||0);return new Date((null===(n=t.ultimo_mensaje)||void 0===n?void 0:n.creado_en)||0)-o}),i.sort((e,t)=>{var r,n;const o=new Date((null===(r=e.ultimo_comentario)||void 0===r?void 0:r.creado_en)||0);return new Date((null===(n=t.ultimo_comentario)||void 0===n?void 0:n.creado_en)||0)-o}),l.sort((e,t)=>{const r=new Date(e.creado_en||0);return new Date(t.creado_en||0)-r}),s({carpetas:a,tareas:i,mensajes:l}),c(!1)}catch(e){console.error("Error cargando resumen de comentarios:",e),s({carpetas:[],tareas:[],mensajes:[]}),c(!1)}},S=e=>{if(!e)return"";const t=new Date(e),r=new Date-t,n=Math.floor(r/6e4),o=Math.floor(r/36e5),a=Math.floor(r/864e5);return n<1?"Hace un momento":n<60?"Hace ".concat(n," ").concat(1===n?"minuto":"minutos"):o<24?"Hace ".concat(o," ").concat(1===o?"hora":"horas"):a<7?"Hace ".concat(a," ").concat(1===a?"d\xeda":"d\xedas"):t.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},w=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"";if(l)return(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",color:"#0a6ebd"}}),(0,ze.jsx)("p",{children:"Cargando resumen de comentarios..."})]});const k=i.carpetas.length,C=i.tareas.length,E=i.mensajes.length,T=i.mensajes.filter(e=>{if("todas"!==u&&e.carpeta_id!==parseInt(u))return!1;if(!y&&e.creado_en){const t=new Date(e.creado_en),r=new Date(m);r.setHours(0,0,0,0);const n=new Date(b);if(n.setHours(23,59,59,999),t<r||t>n)return!1}else if(!e.creado_en)return!1;return!0}),R=k+C+T.length;return(0,ze.jsxs)("div",{style:{padding:"1.25rem",background:"#ffffff",minHeight:"100vh"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.25rem",paddingBottom:"0.875rem",borderBottom:"2px solid #e9ecef",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",bottom:"-2px",left:0,width:"50px",height:"2px",background:"linear-gradient(90deg, #0a6ebd 0%, #005288 100%)",borderRadius:"2px 2px 0 0"}}),(0,ze.jsxs)("h1",{style:{margin:0,fontSize:"18px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"10px",letterSpacing:"-0.3px",marginBottom:"0.75rem"},children:[(0,ze.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"6px",background:"linear-gradient(135deg, #0a6ebd15 0%, #0a6ebd08 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #0a6ebd20"},children:(0,ze.jsx)("i",{className:"fa fa-comments",style:{color:"#0a6ebd",fontSize:"14px"}})}),"Resumen de Comentarios"]}),(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,ze.jsxs)("button",{onClick:()=>p("todos"),style:{padding:"0.375rem 0.75rem",borderRadius:"4px",border:"none",background:"todos"===d?"#0a6ebd":"#f8f9fa",color:"todos"===d?"white":"#495057",cursor:"pointer",fontSize:"11px",fontWeight:"todos"===d?"700":"500",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.3px"},children:["Todos (",R,")"]}),(0,ze.jsxs)("button",{onClick:()=>p("carpetas"),style:{padding:"0.375rem 0.75rem",borderRadius:"4px",border:"none",background:"carpetas"===d?"#0a6ebd":"#f8f9fa",color:"carpetas"===d?"white":"#495057",cursor:"pointer",fontSize:"11px",fontWeight:"carpetas"===d?"700":"500",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.3px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{fontSize:"9px"}}),"Carpetas (",k,")"]}),(0,ze.jsxs)("button",{onClick:()=>p("tareas"),style:{padding:"0.375rem 0.75rem",borderRadius:"4px",border:"none",background:"tareas"===d?"#0a6ebd":"#f8f9fa",color:"tareas"===d?"white":"#495057",cursor:"pointer",fontSize:"11px",fontWeight:"tareas"===d?"700":"500",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.3px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{fontSize:"9px"}}),"Tareas (",C,")"]}),(0,ze.jsxs)("button",{onClick:()=>p("mensajes"),style:{padding:"0.375rem 0.75rem",borderRadius:"4px",border:"none",background:"mensajes"===d?"#0a6ebd":"#f8f9fa",color:"mensajes"===d?"white":"#495057",cursor:"pointer",fontSize:"11px",fontWeight:"mensajes"===d?"700":"500",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.3px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-envelope",style:{fontSize:"9px"}}),"Mensajes (",T.length,T.length!==E?"/".concat(E):"",")"]})]}),("mensajes"===d||"todos"===d)&&(0,ze.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.length>0&&(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[(0,ze.jsx)("label",{style:{fontSize:"10px",color:"#6c757d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Carpeta:"}),(0,ze.jsxs)("select",{value:u,onChange:e=>f(e.target.value),style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #e9ecef",fontSize:"11px",cursor:"pointer",minWidth:"160px",background:"white"},children:[(0,ze.jsx)("option",{value:"todas",children:"Todas"}),h.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[(0,ze.jsx)("label",{style:{fontSize:"10px",color:"#6c757d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Per\xedodo:"}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",flexWrap:"wrap"},children:[(0,ze.jsx)("input",{type:"date",value:m,onChange:e=>x(e.target.value),max:b,style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #e9ecef",fontSize:"10px",cursor:"pointer",background:"white"}}),(0,ze.jsx)("span",{style:{fontSize:"10px",color:"#6c757d"},children:"a"}),(0,ze.jsx)("input",{type:"date",value:b,onChange:e=>v(e.target.value),min:m,max:(new Date).toISOString().split("T")[0],style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #e9ecef",fontSize:"10px",cursor:"pointer",background:"white"}}),(0,ze.jsx)("button",{onClick:()=>{const e=new Date;e.setMonth(e.getMonth()-3),x(e.toISOString().split("T")[0]),v((new Date).toISOString().split("T")[0]),j(!1)},style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #0a6ebd",background:y?"#0a6ebd":"white",color:y?"white":"#0a6ebd",cursor:"pointer",fontSize:"10px",fontWeight:"500",transition:"all 0.2s ease"},title:"\xdaltimos 3 meses",children:"3 meses"}),(0,ze.jsx)("button",{onClick:()=>j(!y),style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #6c757d",background:y?"#6c757d":"white",color:y?"white":"#6c757d",cursor:"pointer",fontSize:"10px",fontWeight:"500",transition:"all 0.2s ease"},children:"Todos"})]}),T.length<i.mensajes.length&&!y&&(0,ze.jsxs)("div",{style:{fontSize:"9px",color:"#ff9800",fontWeight:"500"},children:["(",i.mensajes.length-T.length," ocultos)"]})]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gap:"0.75rem"},children:[("todos"===d||"carpetas"===d)&&i.carpetas.length>0&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",border:"1px solid #e9ecef",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #0a6ebd 0%, #005288 100%)",padding:"0.625rem 1rem",color:"white",fontWeight:"700",fontSize:"12px",display:"flex",alignItems:"center",gap:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{fontSize:"11px"}}),"Carpetas con Mensajes (",i.carpetas.length,")"]}),(0,ze.jsx)("div",{style:{padding:"0.75rem"},children:i.carpetas.map((e,t)=>(0,ze.jsx)("div",{style:{padding:"0.625rem",borderBottom:t<i.carpetas.length-1?"1px solid #e9ecef":"none",cursor:"pointer",transition:"all 0.2s ease",borderRadius:"4px",marginBottom:t<i.carpetas.length-1?"0.375rem":"0",background:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.transform="translateX(2px)"},onMouseLeave:e=>{e.currentTarget.style.background="#ffffff",e.currentTarget.style.transform="translateX(0)"},onClick:()=>{a?(sessionStorage.setItem("abrirForoCarpeta",e.carpeta_id),a(e.carpeta_id,null)):window.location.hash="#carpeta_".concat(e.carpeta_id)},children:(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.5rem"},children:(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.375rem",flexWrap:"wrap"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#F2A900",fontSize:"12px"}}),(0,ze.jsx)("h3",{style:{margin:0,color:"#0a3265",fontSize:"12px",fontWeight:"600",flex:1,minWidth:0},children:e.carpeta_nombre}),(0,ze.jsx)("span",{style:{background:"#0a6ebd",color:"white",padding:"0.125rem 0.5rem",borderRadius:"10px",fontSize:"9px",fontWeight:"700",whiteSpace:"nowrap"},children:e.cantidad_mensajes})]}),e.ultimo_mensaje&&(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.5rem",borderRadius:"4px",marginLeft:"18px",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#495057",fontWeight:"600"},children:e.ultimo_mensaje.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"9px",color:"#6c757d"},children:S(e.ultimo_mensaje.creado_en)})]}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#495057",lineHeight:"1.4",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:w(e.ultimo_mensaje.mensaje,120)})]})]})})},t))})]}),("todos"===d||"tareas"===d)&&i.tareas.length>0&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",border:"1px solid #e9ecef",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",padding:"0.625rem 1rem",color:"white",fontWeight:"700",fontSize:"12px",display:"flex",alignItems:"center",gap:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{fontSize:"11px"}}),"Tareas con Comentarios (",i.tareas.length,")"]}),(0,ze.jsx)("div",{style:{padding:"0.75rem"},children:i.tareas.map((e,t)=>{const r="completada"===e.tarea.estado?"validada"===e.tarea.estado_validacion?"#28a745":"rechazada"===e.tarea.estado_validacion?"#dc3545":"#ffc107":"en_progreso"===e.tarea.estado?"#0a6ebd":(e.tarea.estado,"#6c757d");return(0,ze.jsx)("div",{style:{padding:"0.625rem",borderBottom:t<i.tareas.length-1?"1px solid #e9ecef":"none",cursor:"pointer",transition:"all 0.2s ease",borderRadius:"4px",marginBottom:t<i.tareas.length-1?"0.375rem":"0",background:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.transform="translateX(2px)"},onMouseLeave:e=>{e.currentTarget.style.background="#ffffff",e.currentTarget.style.transform="translateX(0)"},onClick:()=>{window.location.hash="#carpeta_".concat(e.carpeta_id)},children:(0,ze.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.5rem"},children:(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.375rem",flexWrap:"wrap"},children:[(0,ze.jsx)("i",{className:"fa fa-tasks",style:{color:"#28a745",fontSize:"12px"}}),(0,ze.jsx)("h3",{style:{margin:0,color:"#0a3265",fontSize:"12px",fontWeight:"600",flex:1,minWidth:0},children:e.tarea_titulo}),(0,ze.jsx)("span",{style:{background:r,color:"white",padding:"0.125rem 0.375rem",borderRadius:"8px",fontSize:"8px",fontWeight:"700",textTransform:"uppercase",whiteSpace:"nowrap"},children:"en_progreso"===e.tarea.estado?"En Progreso":"completada"===e.tarea.estado?"Completada":"cancelada"===e.tarea.estado?"Cancelada":"Pendiente"}),(0,ze.jsx)("span",{style:{background:"#0a6ebd",color:"white",padding:"0.125rem 0.5rem",borderRadius:"10px",fontSize:"9px",fontWeight:"700",whiteSpace:"nowrap"},children:e.cantidad_comentarios})]}),(0,ze.jsxs)("div",{style:{fontSize:"10px",color:"#6c757d",marginLeft:"18px",marginBottom:"0.375rem"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"3px",fontSize:"9px"}}),e.carpeta_nombre]}),e.ultimo_comentario&&(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.5rem",borderRadius:"4px",marginLeft:"18px",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#495057",fontWeight:"600"},children:e.ultimo_comentario.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"9px",color:"#6c757d"},children:S(e.ultimo_comentario.creado_en)})]}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#495057",lineHeight:"1.4",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:w(e.ultimo_comentario.comentario,120)})]})]})})},t)})})]}),("todos"===d||"mensajes"===d)&&T.length>0&&(0,ze.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",border:"1px solid #e9ecef",overflow:"hidden"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",padding:"0.625rem 1rem",color:"white",fontWeight:"700",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"0.5rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-envelope",style:{fontSize:"11px"}}),(0,ze.jsxs)("span",{children:["Mensajes por Revisar (",T.length,")"]})]}),T.length<i.mensajes.length&&(0,ze.jsxs)("div",{style:{fontSize:"9px",opacity:.9},children:[i.mensajes.length," totales"]})]}),(0,ze.jsx)("div",{style:{padding:"0.75rem"},children:T.map((e,t)=>(0,ze.jsx)("div",{style:{padding:"0.625rem",borderBottom:t<T.length-1?"1px solid #e9ecef":"none",cursor:"pointer",transition:"all 0.2s ease",borderRadius:"4px",marginBottom:t<T.length-1?"0.375rem":"0",background:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.transform="translateX(2px)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background="#ffffff",e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow="none"},onClick:()=>{a?(sessionStorage.setItem("mensajeIdToOpen",e.id),a(e.carpeta_id,e.id)):window.location.hash="#carpeta_".concat(e.carpeta_id)},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.5rem"},children:[(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.375rem",flexWrap:"wrap"},children:[(0,ze.jsx)("i",{className:"fa fa-comment",style:{color:"#17a2b8",fontSize:"11px"}}),(0,ze.jsxs)("div",{style:{fontSize:"10px",color:"#495057",fontWeight:"600",display:"flex",alignItems:"center",gap:"3px",flex:1,minWidth:0},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#F2A900",fontSize:"9px"}}),(0,ze.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.carpeta_nombre})]}),e.mensaje_padre_id&&(0,ze.jsx)("span",{style:{background:"#6c757d",color:"white",padding:"0.125rem 0.375rem",borderRadius:"8px",fontSize:"8px",fontWeight:"700",textTransform:"uppercase",whiteSpace:"nowrap"},children:"Respuesta"})]}),(0,ze.jsxs)("div",{style:{background:"#f8f9fa",padding:"0.5rem",borderRadius:"4px",marginLeft:"16px",border:"1px solid #e9ecef"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[(0,ze.jsx)("div",{style:{fontSize:"10px",color:"#495057",fontWeight:"600"},children:e.usuario_nombre||"Usuario"}),(0,ze.jsx)("div",{style:{fontSize:"9px",color:"#6c757d"},children:S(e.creado_en)})]}),(0,ze.jsx)("div",{style:{fontSize:"11px",color:"#495057",lineHeight:"1.4",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:w(e.mensaje,150)})]})]}),(0,ze.jsx)("div",{style:{marginLeft:"0.5rem",fontSize:"14px",color:"#17a2b8",flexShrink:0,display:"flex",alignItems:"center"},children:(0,ze.jsx)("i",{className:"fa fa-external-link-alt"})})]})},e.id))})]}),0===R&&(0,ze.jsxs)("div",{style:{background:"white",padding:"2rem",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",border:"1px solid #e9ecef",textAlign:"center",color:"#6c757d"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{fontSize:"2rem",marginBottom:"0.75rem",opacity:.3}}),(0,ze.jsx)("p",{style:{fontSize:"13px",margin:0,fontWeight:"500"},children:"No hay comentarios o mensajes en el proyecto."}),(0,ze.jsx)("p",{style:{fontSize:"11px",marginTop:"0.5rem",color:"#adb5bd"},children:"Los comentarios y mensajes del foro aparecer\xe1n aqu\xed cuando se creen."})]})]})]})},Nh=e=>{let{proyectoId:t,proyecto:r,user:n,sidebarCollapsed:a,onNavigateToCarpeta:i}=e;const[s,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),[p,u]=(0,o.useState)(null),[f,h]=(0,o.useState)([]),[g,m]=(0,o.useState)(!0),[x,b]=(0,o.useState)(null),[v,y]=(0,o.useState)(new Set);(0,o.useEffect)(()=>{t&&(_(),j())},[t,n]);const j=async()=>{try{m(!0);const e=new URLSearchParams({proyecto_id:t});n&&n.id&&e.append("usuario_id",n.id);const r=await fetch("".concat(Te,"/dashboard/carpetas_con_promedios.php?").concat(e));if(!r.ok)throw new Error("Error HTTP ".concat(r.status));const o=await r.json();o.carpetas&&Array.isArray(o.carpetas)?(h(o.carpetas),b(o.promedio_general)):Array.isArray(o)?(h(o),b(null)):(h([]),b(null))}catch(e){console.error("Error cargando carpetas con promedios:",e),h([])}finally{m(!1)}},_=async()=>{try{d(!0),u(null);const e=new URLSearchParams({proyecto_id:t});n&&n.id&&e.append("usuario_id",n.id);const r=await fetch("".concat(Te,"/dashboard/kpis.php?").concat(e));if(!r.ok)throw new Error("Error HTTP ".concat(r.status));const o=await r.json();l(o)}catch(e){console.error("Error cargando KPIs:",e),u(e.message)}finally{d(!1)}};if(c)return(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"2rem",marginBottom:"1rem"}}),(0,ze.jsx)("p",{children:"Cargando indicadores del proyecto..."})]});if(p)return(0,ze.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#dc3545"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle",style:{fontSize:"2rem",marginBottom:"1rem"}}),(0,ze.jsxs)("p",{children:["Error al cargar los indicadores: ",p]}),(0,ze.jsx)("button",{onClick:_,style:{marginTop:"1rem",padding:"10px 20px",background:"#0a6ebd",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Reintentar"})]});if(!s)return(0,ze.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#666"},children:(0,ze.jsx)("p",{children:"No se pudieron cargar los indicadores."})});const S=function(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #ffffff 0%, #fafbfc 100%)",borderRadius:"10px",padding:"1rem",boxShadow:"0 2px 8px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04)",border:"1px solid #e9ecef",borderLeft:"4px solid ".concat(n),position:"relative",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1), 0 0 0 1px ".concat(n,"20"),e.currentTarget.style.borderLeftWidth="5px"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04)",e.currentTarget.style.borderLeftWidth="4px"},children:[(0,ze.jsx)("div",{style:{position:"absolute",top:"-20px",right:"-20px",width:"80px",height:"80px",background:"radial-gradient(circle, ".concat(n,"08 0%, transparent 70%)"),borderRadius:"50%",zIndex:0}}),(0,ze.jsx)("div",{style:{position:"relative",zIndex:1},children:(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"0.75rem"},children:[(0,ze.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,ze.jsxs)("h3",{style:{margin:0,fontSize:"10px",color:"#6c757d",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.8px",marginBottom:"0.6rem",display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:n,flexShrink:0}}),e]}),(0,ze.jsx)("div",{style:{fontSize:"2rem",fontWeight:"800",background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(n,"dd 100%)"),WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",lineHeight:"1.1",marginBottom:"0.35rem",letterSpacing:"-0.5px"},children:t}),o&&(0,ze.jsxs)("div",{style:{fontSize:"11px",color:"#6c757d",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ze.jsx)("i",{className:"fa fa-circle",style:{fontSize:"3px",color:n}}),o]})]}),(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"linear-gradient(135deg, ".concat(n,"15 0%, ").concat(n,"08 100%)"),display:"flex",alignItems:"center",justifyContent:"center",color:n,fontSize:"18px",flexShrink:0,border:"1px solid ".concat(n,"20"),boxShadow:"inset 0 1px 2px ".concat(n,"10")},children:(0,ze.jsx)("i",{className:"fa ".concat(r)})})]})})]})};return(0,ze.jsxs)("div",{style:{padding:"1.25rem",background:"#ffffff",minHeight:"100vh"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid #e9ecef",position:"relative"},children:[(0,ze.jsx)("div",{style:{position:"absolute",bottom:"-2px",left:0,width:"60px",height:"2px",background:"linear-gradient(90deg, #0a6ebd 0%, #005288 100%)",borderRadius:"2px 2px 0 0"}}),(0,ze.jsxs)("h1",{style:{margin:0,fontSize:"20px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"12px",letterSpacing:"-0.3px",flexWrap:"wrap"},children:[(0,ze.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"linear-gradient(135deg, #0a6ebd15 0%, #0a6ebd08 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #0a6ebd20",flexShrink:0},children:(0,ze.jsx)("i",{className:"fa fa-chart-line",style:{color:"#0a6ebd",fontSize:"16px"}})}),"Dashboard del Proyecto",r&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("span",{style:{color:"#999",fontWeight:"400",fontSize:"16px"},children:"\u2022"}),(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#F2A900",fontSize:"16px"}}),(0,ze.jsx)("span",{style:{fontWeight:"600",fontSize:"18px"},children:r.nombre}),(0,ze.jsxs)("span",{style:{color:"#999",fontWeight:"400",fontSize:"14px"},children:["ID: ",r.proyecto_id]}),(0,ze.jsxs)("span",{style:{color:"#999",fontWeight:"400",fontSize:"14px"},children:["Regi\xf3n: ",r.region_id]}),r.descripcion&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("span",{style:{color:"#999",fontWeight:"400",fontSize:"16px"},children:"\u2022"}),(0,ze.jsx)("span",{style:{color:"#666",fontWeight:"400",fontSize:"14px"},children:r.descripcion})]})]})]})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:a?"repeat(auto-fit, minmax(160px, 1fr))":"repeat(auto-fit, minmax(180px, 1fr))",gap:"0.75rem",marginBottom:"1.5rem"},children:[S("Total de Carpetas",s.total_carpetas||0,"fa-folder","#0a6ebd","".concat(s.carpetas_activas||0," activas")),S("Total de Archivos",s.total_archivos||0,"fa-file","#28a745","".concat(s.archivos_recientes||0," subidos este mes")),S("Tareas Activas",s.tareas_activas||0,"fa-tasks","#ffc107","".concat(s.tareas_completadas||0," completadas")),S("Tareas Vencidas",s.tareas_vencidas||0,"fa-exclamation-triangle","#dc3545","Requieren atenci\xf3n"),S("Mensajes del Foro",s.total_mensajes||0,"fa-comments","#17a2b8","".concat(s.mensajes_recientes||0," este mes")),S("Usuarios Activos",s.usuarios_activos||0,"fa-users","#6f42c1","".concat(s.total_usuarios||0," totales"))]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #ffffff 0%, #fafbfc 100%)",borderRadius:"10px",padding:"1.25rem",boxShadow:"0 2px 8px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04)",border:"1px solid #e9ecef",marginTop:"1.5rem",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.06)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04)"},children:[(0,ze.jsxs)("h3",{style:{margin:"0 0 1.25rem 0",fontSize:"12px",fontWeight:"700",color:"#0a3265",textTransform:"uppercase",letterSpacing:"0.8px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,ze.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"linear-gradient(135deg, #28a74515 0%, #28a74508 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #28a74520"},children:(0,ze.jsx)("i",{className:"fa fa-percent",style:{color:"#28a745",fontSize:"11px"}})}),"Promedios de Ponderaci\xf3n por Carpeta",null!==x&&void 0!==x&&(0,ze.jsxs)("span",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",borderRadius:"20px",background:x>=80?"#e8f5e9":x>=50?"#fff9c4":"#ffebee",color:x>=80?"#2e7d32":x>=50?"#f57f17":"#c62828",fontWeight:"700",fontSize:"13px",minWidth:"80px",justifyContent:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-chart-line",style:{fontSize:"10px"}}),"Avance General: ","number"===typeof x?x.toFixed(2):"0.00","%"]})]}),g?(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"1.5rem",marginBottom:"0.5rem"}}),(0,ze.jsx)("p",{style:{fontSize:"12px"},children:"Cargando promedios..."})]}):0===f.length?(0,ze.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#999",fontSize:"12px"},children:"No hay carpetas con promedios de ponderaci\xf3n disponibles."}):(0,ze.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:f.map(e=>{const t=v.has(e.id),r=e.subcarpetas&&e.subcarpetas.length>0;return(0,ze.jsxs)("div",{style:{background:"#f8f9fa",borderRadius:"8px",padding:"1rem",border:"1px solid #e9ecef",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#ffffff",e.currentTarget.style.borderColor="#0a6ebd30",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.08)"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.borderColor="#e9ecef",e.currentTarget.style.boxShadow="none"},children:[(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:r&&t?"0.75rem":"0"},children:[(0,ze.jsxs)("div",{style:{flex:1,cursor:"pointer"},onClick:t=>{const n=t.target,o=n.classList.contains("fa-chevron-right")||n.classList.contains("fa-chevron-down")||n.parentElement&&(n.parentElement.classList.contains("fa-chevron-right")||n.parentElement.classList.contains("fa-chevron-down"));r&&o?(t.stopPropagation(),y(t=>{const r=new Set(t);return r.has(e.id)?r.delete(e.id):r.add(e.id),r})):i&&i(e.id)},children:[(0,ze.jsxs)("h4",{style:{margin:0,fontSize:"14px",fontWeight:"700",color:"#0a3265",display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r&&(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(t?"down":"right"),onClick:t=>{t.stopPropagation(),y(t=>{const r=new Set(t);return r.has(e.id)?r.delete(e.id):r.add(e.id),r})},style:{color:"#0a6ebd",fontSize:"10px",transition:"transform 0.2s ease",cursor:"pointer",padding:"2px"}}),(0,ze.jsx)("i",{className:"fa fa-folder",style:{color:"#0a6ebd",fontSize:"12px"}}),e.nombre]}),e.descripcion&&(0,ze.jsx)("p",{style:{margin:0,fontSize:"11px",color:"#6c757d",marginTop:"2px"},children:e.descripcion})]}),null!==e.promedio_ponderacion&&void 0!==e.promedio_ponderacion?(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",borderRadius:"20px",background:e.promedio_ponderacion>=80?"#e8f5e9":e.promedio_ponderacion>=50?"#fff9c4":"#ffebee",color:e.promedio_ponderacion>=80?"#2e7d32":e.promedio_ponderacion>=50?"#f57f17":"#c62828",fontWeight:"700",fontSize:"14px",minWidth:"70px",justifyContent:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{fontSize:"10px"}}),"number"===typeof e.promedio_ponderacion?e.promedio_ponderacion.toFixed(1):"0.0","%"]}):e.subcarpetas&&e.subcarpetas.length>0?(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",borderRadius:"20px",background:"#ffebee",color:"#c62828",fontWeight:"700",fontSize:"14px",minWidth:"70px",justifyContent:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{fontSize:"10px"}}),"0.0%"]}):null]}),r&&t&&(0,ze.jsx)("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid #e9ecef",display:"flex",flexDirection:"column",gap:"0.5rem",animation:"fadeIn 0.2s ease"},children:e.subcarpetas.map(e=>(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"#ffffff",borderRadius:"6px",border:"1px solid #e9ecef",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>{i&&i(e.id)},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.borderColor="#0a6ebd30"},onMouseLeave:e=>{e.currentTarget.style.background="#ffffff",e.currentTarget.style.borderColor="#e9ecef"},children:[(0,ze.jsx)("div",{style:{flex:1},children:(0,ze.jsxs)("span",{style:{fontSize:"12px",fontWeight:"600",color:"#495057",display:"flex",alignItems:"center",gap:"6px"},children:[(0,ze.jsx)("i",{className:"fa fa-folder-open",style:{color:"#6c757d",fontSize:"10px"}}),e.nombre]})}),null!==e.promedio_ponderacion&&void 0!==e.promedio_ponderacion?(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px 12px",borderRadius:"16px",background:e.promedio_ponderacion>=80?"#e8f5e9":e.promedio_ponderacion>=50?"#fff9c4":"#ffebee",color:e.promedio_ponderacion>=80?"#2e7d32":e.promedio_ponderacion>=50?"#f57f17":"#c62828",fontWeight:"700",fontSize:"12px",minWidth:"60px",justifyContent:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{fontSize:"8px"}}),"number"===typeof e.promedio_ponderacion?e.promedio_ponderacion.toFixed(1):"0.0","%"]}):(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px 12px",borderRadius:"16px",background:"#ffebee",color:"#c62828",fontWeight:"700",fontSize:"12px",minWidth:"60px",justifyContent:"center"},children:[(0,ze.jsx)("i",{className:"fa fa-percent",style:{fontSize:"8px"}}),"0.0%"]})]},e.id))})]},e.id)})})]}),(0,ze.jsx)("style",{children:"\n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "})]})},Ah=()=>{const{proyectoId:e}=function(){let{matches:e}=o.useContext(J),t=e[e.length-1];return t?t.params:{}}(),[t]=ke(),[r,n]=(0,o.useState)(null),[a,i]=(0,o.useState)(!0),s=re(),[l,c]=(0,o.useState)("dashboard"),[d,p]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=t.get("carpeta");e&&c("carpeta_".concat(e))},[t]);const u=(0,o.useMemo)(()=>JSON.parse(localStorage.getItem("user"))||{nombre:"Usuario",rol:"usuario"},[]),f=(0,o.useMemo)(()=>JSON.parse(localStorage.getItem("centros"))||[],[]);(0,o.useEffect)(()=>{(async()=>{i(!0);try{const t=await fetch("".concat(Te,"/proyectos/proyecto.php?id=").concat(e));if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));const r=await t.json();if(r.error)throw new Error(r.error);n(r)}catch(Fh){console.error("Error cargando proyecto:",Fh),n(null)}i(!1)})()},[e]);const h=()=>{localStorage.removeItem("user"),localStorage.removeItem("centros"),window.location.href="/"};if(a)return(0,ze.jsx)("div",{style:{padding:"2rem"},children:"Cargando proyecto..."});if(!r)return(0,ze.jsx)("div",{style:{padding:"2rem"},children:"Proyecto no encontrado."});if(!((e,t)=>{if(!e)return!1;if(xa(e,"super_admin"))return!0;if(ba(e,["admin","trabajador"]))return(JSON.parse(localStorage.getItem("centros"))||[]).some(e=>String(e.proyecto_id)===String(t));return xa(e,"visita"),!1})(u,e))return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:u,onLogout:h}),(0,ze.jsxs)("div",{className:"content-card",style:{textAlign:"center",marginTop:"4rem"},children:[(0,ze.jsx)("h2",{children:"Acceso Restringido"}),(0,ze.jsx)("p",{children:"No tienes permisos para acceder a este proyecto."}),(0,ze.jsx)("p",{children:"Contacta a un administrador si necesitas acceso."}),(0,ze.jsx)("button",{className:"selector-ir-btn",onClick:()=>s("/centros-por-region"),children:"Volver a Proyectos"})]})]});return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:u,onLogout:h}),(0,ze.jsxs)("div",{className:"proyecto-layout",children:[(0,ze.jsx)(pa,{seleccionado:l,onSelect:c,proyecto:r,onCollapsedChange:p,user:u}),(0,ze.jsx)("div",{className:"proyecto-analisis-content ".concat(d?"sidebar-minimizado":""),children:(()=>{if("gestor_archivos"===l)return(0,ze.jsx)(Eh,{proyectoId:e,centroCostoId:f.length>0?f[0].id:null,user:u,sidebarCollapsed:d});if(l&&l.startsWith("carpeta_")){const t=l.replace("carpeta_","");return(0,ze.jsx)(Eh,{proyectoId:e,centroCostoId:f.length>0?f[0].id:null,carpetaId:t,user:u,sidebarCollapsed:d})}switch(l){case"dashboard":return(0,ze.jsx)(Nh,{proyectoId:e,proyecto:r,user:u,sidebarCollapsed:d,onNavigateToCarpeta:e=>{c("carpeta_".concat(e))}});case"control_tareas":return(0,ze.jsx)(Th,{proyectoId:e,user:u,sidebarCollapsed:d,onNavigateToCarpeta:(e,t)=>{c("carpeta_".concat(e)),t&&sessionStorage.setItem("tareaIdToOpen",t)}});case"resumen_comentarios":return(0,ze.jsx)(Rh,{proyectoId:e,user:u,sidebarCollapsed:d,onNavigateToCarpeta:(e,t)=>{c("carpeta_".concat(e)),t&&sessionStorage.setItem("mensajeIdToOpen",t)}});case"arbol_carpetas":return(0,ze.jsx)(ua,{proyectoId:e,user:u,sidebarCollapsed:d});case"presentaciones_staff":return(0,ze.jsx)(fa,{proyectoId:e,sidebarCollapsed:d});case"informes_stockholders":return(0,ze.jsx)(ha,{proyectoId:e,sidebarCollapsed:d});case"planos":return(0,ze.jsx)(ga,{proyectoId:e,sidebarCollapsed:d});case"rca":return(0,ze.jsx)(ma,{proyectoId:e,sidebarCollapsed:d});default:return(0,ze.jsx)(Eh,{proyectoId:e,centroCostoId:f.length>0?f[0].id:null,user:u,sidebarCollapsed:d})}})()})]})]})},zh=e=>{let{user:t}=e;const[r,n]=(0,o.useState)([]),[a,i]=(0,o.useState)([]),[s,l]=(0,o.useState)([]),[c,d]=(0,o.useState)(""),[p,u]=(0,o.useState)(""),[f,h]=(0,o.useState)(""),[g,m]=(0,o.useState)([]),[x,b]=(0,o.useState)([]),[v,y]=(0,o.useState)([]),[j,_]=(0,o.useState)([]),[S,w]=(0,o.useState)([]),[k,C]=(0,o.useState)(!0),[E,T]=(0,o.useState)(null),[R,N]=(0,o.useState)(null),[A,z]=(0,o.useState)({}),[I,O]=(0,o.useState)(!1),[P,D]=(0,o.useState)({nombre:"",email:"",password:"",rol:"trabajador",region_id:"",proyecto_id:"",centro_costo_id:"",aprobado:1}),[L,B]=(0,o.useState)(null),[F,M]=(0,o.useState)(""),[W,U]=(0,o.useState)(""),[H,V]=(re(),(0,o.useState)("")),[G,Y]=(0,o.useState)(""),[$,q]=(0,o.useState)([]),[X,K]=(0,o.useState)([]);if(!t||"trabajador"===t.rol||"visita"===t.rol||"visita_sin_permiso"===t.rol||!t.aprobado)return(0,ze.jsx)("div",{className:"main-bg",children:(0,ze.jsxs)("div",{className:"usuarios-acceso-denegado",children:[(0,ze.jsx)("h2",{children:"Acceso denegado"}),(0,ze.jsx)("p",{children:"No tienes permisos para acceder a la administraci\xf3n de usuarios."})]})});(0,o.useEffect)(()=>{(async()=>{try{const e=await fetch("".concat(Te,"/regiones.php")),t=await e.json();console.log("Regiones cargadas:",t),i(t)}catch(Fh){console.error("Error cargando regiones:",Fh),i([])}})(),(async()=>{try{const e=(new Date).getTime(),t=await fetch("".concat(Te,"/proyectos.php?t=").concat(e)),r=await t.json();console.log("Proyectos cargados:",r),m(r)}catch(Fh){console.error("Error cargando proyectos:",Fh),m([])}})(),(async()=>{try{const e=(new Date).getTime(),t=await fetch("".concat(Te,"/centros_costo.php?t=").concat(e)),r=await t.json();console.log("Centros cargados:",r),l(r)}catch(Fh){console.error("Error cargando centros:",Fh),l([])}})()},[]),(0,o.useEffect)(()=>{c?(b(g.filter(e=>String(e.region_id)===String(c))),u(""),y([]),h(""),D(e=>Ue(Ue({},e),{},{centro_costo_id:""}))):(b([]),y([]),u(""),h(""),D(e=>Ue(Ue({},e),{},{centro_costo_id:""})))},[c,g]),(0,o.useEffect)(()=>{p?(y(s.filter(e=>String(e.proyecto_id)===String(p))),h(""),D(e=>Ue(Ue({},e),{},{centro_costo_id:""}))):(y([]),h(""),D(e=>Ue(Ue({},e),{},{centro_costo_id:""})))},[p,s]),(0,o.useEffect)(()=>{if(P.region_id){const e=g.filter(e=>String(e.region_id)===String(P.region_id));_(e),P.proyecto_id&&!e.find(e=>String(e.proyecto_id)===String(P.proyecto_id))&&D(e=>Ue(Ue({},e),{},{proyecto_id:"",centro_costo_id:""}))}else _([]),D(e=>Ue(Ue({},e),{},{proyecto_id:"",centro_costo_id:""}))},[P.region_id,g]),(0,o.useEffect)(()=>{if(P.proyecto_id){const e=s.filter(e=>String(e.proyecto_id)===String(P.proyecto_id));w(e),P.centro_costo_id&&!e.find(e=>String(e.id)===String(P.centro_costo_id))&&D(e=>Ue(Ue({},e),{},{centro_costo_id:""}))}else w([]),D(e=>Ue(Ue({},e),{},{centro_costo_id:""}))},[P.proyecto_id,s]);const J=async()=>{C(!0);try{let e="".concat(Te,"/usuarios.php");const t=[];c&&t.push("region_id=".concat(c)),p&&t.push("proyecto_id=".concat(p)),f&&t.push("centro_costo_id=".concat(f)),t.length>0&&(e+="?"+t.join("&"));const r=await fetch(e),o=await r.json();n(o)}catch(Fh){n([])}C(!1)};(0,o.useEffect)(()=>{J()},[c,p,f]);const Q=async()=>{if(L)if(F)try{const e=await fetch("".concat(Te,"/usuarios/eliminar_usuario.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:L.id,password_confirmacion:F,usuario_que_elimina_id:t.id})}),o=await e.json();o.success?(n(r.filter(e=>e.id!==L.id)),B(null),M(""),U(""),T({type:"success",msg:"Usuario eliminado correctamente."})):U(o.error||"Error al eliminar usuario")}catch(e){U("Error de red al eliminar usuario.")}else U("Por favor, ingrese la contrase\xf1a de confirmaci\xf3n")},Z=()=>{B(null),M(""),U("")};(0,o.useEffect)(()=>{if(R){const e=s.find(e=>String(e.id)===String(R.centro_costo_id)),t=e?g.find(t=>String(t.proyecto_id)===String(e.proyecto_id)):null,r=t?a.find(e=>String(e.region_id)===String(t.region_id)):null;V(r?r.region_id:""),Y(t?t.proyecto_id:""),q(r?g.filter(e=>String(e.region_id)===String(r.region_id)):[]),K(t?s.filter(e=>String(e.proyecto_id)===String(t.proyecto_id)):[]),z(t=>Ue(Ue({},t),{},{centro_costo_id:e?e.id:""}))}},[R,s,g,a]),(0,o.useEffect)(()=>{if(A.region_id){const e=g.filter(e=>String(e.region_id)===String(A.region_id));q(e),A.proyecto_id&&!e.find(e=>String(e.proyecto_id)===String(A.proyecto_id))&&z(e=>Ue(Ue({},e),{},{proyecto_id:"",centro_costo_id:""}))}else q([]),z(e=>Ue(Ue({},e),{},{proyecto_id:"",centro_costo_id:""}))},[A.region_id,g]),(0,o.useEffect)(()=>{if(A.proyecto_id){const e=s.filter(e=>String(e.proyecto_id)===String(A.proyecto_id));K(e),A.centro_costo_id&&!e.find(e=>String(e.id)===String(A.centro_costo_id))&&z(e=>Ue(Ue({},e),{},{centro_costo_id:""}))}else K([]),z(e=>Ue(Ue({},e),{},{centro_costo_id:""}))},[A.proyecto_id,s]);let ee=r;"admin"===t.rol&&(console.log("user.centro_costo_id:",t.centro_costo_id),console.log("usuarios:",r.map(e=>({email:e.email,ucc_centro_costo_id:e.ucc_centro_costo_id}))),ee=r.filter(e=>String(e.centro_costo_id)===String(t.centro_costo_id)));return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:t,onLogout:()=>{localStorage.removeItem("user"),localStorage.removeItem("centros"),window.location.href="/"}}),(0,ze.jsxs)("div",{className:"usuarios-container",children:[(0,ze.jsx)("h2",{className:"usuarios-titulo",children:"Administraci\xf3n de Usuarios"}),("super_admin"===t.rol||"admin"===t.rol)&&(0,ze.jsx)("div",{style:{textAlign:"right",marginBottom:"1.5rem"},children:(0,ze.jsxs)("button",{className:"usuarios-nuevo-btn",onClick:()=>{let e="";"admin"===t.rol?e=t.region_id:"super_admin"===t.rol&&a.length>0&&(e=a[0].region_id);const r={nombre:"",email:"",password:"",rol:"trabajador",region_id:e,proyecto_id:"admin"===t.rol?t.proyecto_id:"",centro_costo_id:"admin"===t.rol?t.centro_costo_id:"",aprobado:1};D(r),"super_admin"===t.rol&&(_([]),w([])),O(!0)},children:[(0,ze.jsx)("i",{className:"fa fa-plus",style:{marginRight:"0.5rem"}}),"Nuevo Usuario"]})}),(0,ze.jsxs)("div",{className:"usuarios-filtros",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{htmlFor:"region-select",children:[(0,ze.jsx)("i",{className:"fa fa-map-marker",style:{marginRight:"0.5rem"}}),"Filtrar por regi\xf3n:"]}),(0,ze.jsxs)("select",{id:"region-select",value:c,onChange:e=>{d(e.target.value)},children:[(0,ze.jsx)("option",{value:"",children:"Todas las regiones"}),a.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{htmlFor:"proyecto-select",children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{marginRight:"0.5rem"}}),"Filtrar por proyecto:"]}),(0,ze.jsxs)("select",{id:"proyecto-select",value:p,onChange:e=>{u(e.target.value)},disabled:!c,children:[(0,ze.jsx)("option",{value:"",children:"Todos los proyectos"}),x.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{htmlFor:"centro-select",children:[(0,ze.jsx)("i",{className:"fa fa-sitemap",style:{marginRight:"0.5rem"}}),"Filtrar por centro de costo:"]}),(0,ze.jsxs)("select",{id:"centro-select",value:f,onChange:e=>h(e.target.value),disabled:!p,children:[(0,ze.jsx)("option",{value:"",children:"Todos los centros"}),v.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]})]}),E&&(0,ze.jsxs)("div",{className:"usuarios-feedback ".concat(E.type),children:[(0,ze.jsx)("i",{className:"fa ".concat("success"===E.type?"fa-check-circle":"fa-exclamation-circle"),style:{marginRight:"0.5rem"}}),E.msg]}),(0,ze.jsx)("div",{className:"usuarios-table-wrapper",children:k?(0,ze.jsx)("div",{className:"usuarios-loading",children:"Cargando usuarios..."}):(0,ze.jsxs)("table",{className:"usuarios-table",children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("th",{children:"Nombre"}),(0,ze.jsx)("th",{children:"Email"}),(0,ze.jsx)("th",{children:"Rol"}),(0,ze.jsx)("th",{children:"Centro de Costo"}),(0,ze.jsx)("th",{children:"Proyecto"}),(0,ze.jsx)("th",{children:"Regi\xf3n"}),(0,ze.jsx)("th",{children:"Aprobado"}),("admin"===t.rol||"super_admin"===t.rol)&&(0,ze.jsx)("th",{children:"Acciones"})]})}),(0,ze.jsx)("tbody",{children:ee.map(e=>(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{children:e.nombre}),(0,ze.jsx)("td",{children:e.email}),(0,ze.jsx)("td",{children:e.rol}),(0,ze.jsx)("td",{children:e.centro_costo_nombre||"-"}),(0,ze.jsx)("td",{children:e.proyecto_nombre||"-"}),(0,ze.jsx)("td",{children:e.region_nombre||"-"}),(0,ze.jsx)("td",{children:e.aprobado?"S\xed":"No"}),("admin"===t.rol||"super_admin"===t.rol)&&(0,ze.jsx)("td",{children:"super_admin"===t.rol||"admin"===t.rol&&["trabajador","visita_sin_permiso"].includes(e.rol)?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{className:"usuarios-accion-btn",onClick:()=>{return N(t=e),void z({id:t.id,nombre:t.nombre,email:t.email,rol:t.rol,region_id:t.region_id,proyecto_id:t.proyecto_id,centro_costo_id:t.centro_costo_id,aprobado:t.aprobado});var t},title:"Editar usuario",children:(0,ze.jsx)("i",{className:"fa fa-edit"})}),"super_admin"===t.rol&&(0,ze.jsx)("button",{className:"usuarios-accion-btn usuarios-eliminar-btn",onClick:()=>{return B({id:(t=e).id,nombre:t.nombre}),M(""),void U("");var t},title:"Eliminar usuario",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]}):null})]},e.id+"-"+e.centro_costo_id))})]})}),R&&s.length>0&&g.length>0&&a.length>0&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",children:(0,ze.jsxs)("div",{className:"usuarios-modal",children:[(0,ze.jsx)("h3",{children:"Editar usuario"}),(0,ze.jsxs)("div",{className:"usuarios-modal-form",children:[(0,ze.jsxs)("label",{children:["Nombre:",(0,ze.jsx)("input",{type:"text",value:A.nombre,onChange:e=>z(t=>Ue(Ue({},t),{},{nombre:e.target.value}))})]}),(0,ze.jsxs)("label",{children:["Email:",(0,ze.jsx)("input",{type:"email",value:A.email,onChange:e=>z(t=>Ue(Ue({},t),{},{email:e.target.value}))})]}),(0,ze.jsxs)("label",{children:["Rol:",(0,ze.jsx)("select",{value:A.rol,onChange:e=>z(t=>Ue(Ue({},t),{},{rol:e.target.value})),disabled:"admin"===t.rol,children:"admin"===t.rol?(0,ze.jsx)("option",{value:"trabajador",children:"Trabajador"}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"trabajador",children:"Trabajador"}),(0,ze.jsx)("option",{value:"visita",children:"Visita"}),(0,ze.jsx)("option",{value:"admin",children:"Admin"})]})})]}),(0,ze.jsxs)("label",{children:["Regi\xf3n:",(0,ze.jsx)("select",{value:"admin"===t.rol?t.region_id:A.region_id,onChange:e=>z(t=>Ue(Ue({},t),{},{region_id:e.target.value})),disabled:"admin"===t.rol,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.region_id,children:t.region_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar regi\xf3n"}),a.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))]})})]}),(0,ze.jsxs)("label",{children:["Proyecto:",(0,ze.jsx)("select",{value:"admin"===t.rol?t.proyecto_id:A.proyecto_id,onChange:e=>z(t=>Ue(Ue({},t),{},{proyecto_id:e.target.value})),disabled:"admin"===t.rol||!A.region_id,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.proyecto_id,children:t.proyecto_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar proyecto"}),$.map(e=>(0,ze.jsx)("option",{value:e.proyecto_id,children:e.nombre},e.proyecto_id))]})})]}),(0,ze.jsxs)("label",{children:["Centro de Costo:",(0,ze.jsx)("select",{value:"admin"===t.rol?t.centro_costo_id:A.centro_costo_id,onChange:e=>z(t=>Ue(Ue({},t),{},{centro_costo_id:e.target.value})),disabled:"admin"===t.rol||!A.proyecto_id,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.centro_costo_id,children:t.centro_costo_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar centro de costo"}),X.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id))]})})]}),(0,ze.jsxs)("label",{children:["Aprobado:",(0,ze.jsxs)("select",{value:A.aprobado,onChange:e=>z(t=>Ue(Ue({},t),{},{aprobado:e.target.value})),children:[(0,ze.jsx)("option",{value:1,children:"S\xed"}),(0,ze.jsx)("option",{value:0,children:"No"})]})]})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{className:"usuarios-accion-btn",onClick:async()=>{C(!0),T(null);try{const e=await fetch("".concat(Te,"/editar_usuario.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),t=await e.json();t.success?(T({type:"success",msg:"Usuario editado correctamente."}),N(null),J()):T({type:"error",msg:t.error||"No se pudo editar el usuario."})}catch(Fh){T({type:"error",msg:"Error de red al editar usuario."})}C(!1)},children:[(0,ze.jsx)("i",{className:"fa fa-save",style:{marginRight:"0.3rem"}}),"Guardar"]}),(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)"},onClick:()=>{N(null)},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})}),I&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",children:(0,ze.jsxs)("div",{className:"usuarios-modal",children:[(0,ze.jsx)("h3",{children:"Crear nuevo usuario"}),(0,ze.jsxs)("div",{className:"usuarios-modal-form",children:[(0,ze.jsxs)("label",{children:["Nombre:",(0,ze.jsx)("input",{type:"text",value:P.nombre,onChange:e=>D(t=>Ue(Ue({},t),{},{nombre:e.target.value})),autoComplete:"name"})]}),(0,ze.jsxs)("label",{children:["Email:",(0,ze.jsx)("input",{type:"email",value:P.email,onChange:e=>D(t=>Ue(Ue({},t),{},{email:e.target.value})),autoComplete:"username"})]}),(0,ze.jsxs)("label",{children:["Password:",(0,ze.jsx)("input",{type:"password",value:P.password,onChange:e=>D(t=>Ue(Ue({},t),{},{password:e.target.value})),autoComplete:"new-password"})]}),(0,ze.jsxs)("label",{children:["Rol:",(0,ze.jsx)("select",{value:P.rol,onChange:e=>D(t=>Ue(Ue({},t),{},{rol:e.target.value})),disabled:"admin"===t.rol,children:"admin"===t.rol?(0,ze.jsx)("option",{value:"trabajador",children:"Trabajador"}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"trabajador",children:"Trabajador"}),(0,ze.jsx)("option",{value:"visita",children:"Visita"}),(0,ze.jsx)("option",{value:"admin",children:"Admin"}),(0,ze.jsx)("option",{value:"super_admin",children:"Super Admin"}),(0,ze.jsx)("option",{value:"visita_sin_permiso",children:"Visita Sin Permiso"})]})})]}),(0,ze.jsxs)("label",{children:["Regi\xf3n:",(0,ze.jsx)("select",{value:P.region_id||t.region_id||"",onChange:e=>D(t=>Ue(Ue({},t),{},{region_id:e.target.value})),disabled:"admin"===t.rol,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.region_id,children:t.region_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar regi\xf3n"}),a.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))]})})]}),(0,ze.jsxs)("label",{children:["Proyecto:",(0,ze.jsx)("select",{value:P.proyecto_id||"",onChange:e=>{const t=e.target.value;D(e=>Ue(Ue({},e),{},{proyecto_id:t,centro_costo_id:""}))},disabled:"admin"===t.rol||!P.region_id,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.proyecto_id,children:t.proyecto_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar proyecto"}),j.map(e=>(0,ze.jsx)("option",{value:e.proyecto_id,children:e.nombre},e.proyecto_id)),0===j.length&&P.region_id&&(0,ze.jsx)("option",{disabled:!0,children:"No hay proyectos para esta regi\xf3n"})]})})]}),(0,ze.jsxs)("label",{children:["Centro de Costo:",(0,ze.jsx)("select",{value:P.centro_costo_id||"",onChange:e=>D(t=>Ue(Ue({},t),{},{centro_costo_id:e.target.value})),disabled:"admin"===t.rol||!P.proyecto_id,children:"admin"===t.rol?(0,ze.jsx)("option",{value:t.centro_costo_id,children:t.centro_costo_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar centro de costo"}),S.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id)),0===S.length&&P.proyecto_id&&(0,ze.jsx)("option",{disabled:!0,children:"No hay centros para este proyecto"})]})})]}),(0,ze.jsxs)("label",{children:["Aprobado:",(0,ze.jsxs)("select",{value:P.aprobado,onChange:e=>D(t=>Ue(Ue({},t),{},{aprobado:parseInt(e.target.value)})),children:[(0,ze.jsx)("option",{value:1,children:"S\xed"}),(0,ze.jsx)("option",{value:0,children:"No"})]})]})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #43a047 0%, #2e7d32 100%)"},onClick:async()=>{if(P.nombre&&P.email&&P.password&&P.centro_costo_id)if(isNaN(P.centro_costo_id)||""===P.centro_costo_id)T({type:"error",msg:"Centro de costo inv\xe1lido."});else{C(!0),T(null);try{const e=Ue(Ue({},P),{},{centro_costo_id:parseInt(P.centro_costo_id),region_id:P.region_id?parseInt(P.region_id):null,proyecto_id:P.proyecto_id?parseInt(P.proyecto_id):null}),t=await fetch("".concat(Te,"/crear_usuario.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();r.success?(T({type:"success",msg:"Usuario creado correctamente."}),O(!1),J()):T({type:"error",msg:r.error||"No se pudo crear el usuario."})}catch(Fh){T({type:"error",msg:"Error de red al crear usuario."})}C(!1)}else T({type:"error",msg:"Todos los campos son obligatorios."})},disabled:k,children:[(0,ze.jsx)("i",{className:"fa ".concat(k?"fa-spinner fa-spin":"fa-plus"),style:{marginRight:"0.3rem"}}),k?"Creando...":"Crear"]}),(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)"},onClick:()=>O(!1),disabled:k,children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})}),L&&(0,ze.jsx)("div",{className:"usuarios-modal-overlay",onClick:Z,children:(0,ze.jsxs)("div",{className:"usuarios-modal",style:{maxWidth:"450px"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("h3",{style:{margin:"0 0 1rem 0",color:"#c62828",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"}),"Confirmar eliminaci\xf3n"]}),(0,ze.jsxs)("p",{style:{margin:"0 0 1rem 0",color:"#495057"},children:["\xbfEst\xe1s seguro de que deseas eliminar al usuario ",(0,ze.jsx)("strong",{children:L.nombre}),"?"]}),(0,ze.jsx)("p",{style:{margin:"0 0 1rem 0",color:"#6c757d",fontSize:"13px"},children:"Esta acci\xf3n es irreversible. Para confirmar, ingrese la contrase\xf1a especial:"}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057"},children:"Contrase\xf1a de confirmaci\xf3n:"}),(0,ze.jsx)("input",{type:"password",value:F,onChange:e=>{M(e.target.value),U("")},onKeyPress:e=>{"Enter"===e.key&&Q()},placeholder:"Ingrese la contrase\xf1a especial",style:{width:"100%",padding:"0.75rem",border:"2px solid ".concat(W?"#c62828":"#ced4da"),borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"},autoFocus:!0}),W&&(0,ze.jsxs)("p",{style:{margin:"0.5rem 0 0 0",color:"#c62828",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-circle"}),W]})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #c62828 0%, #b71c1c 100%)"},onClick:Q,children:[(0,ze.jsx)("i",{className:"fa fa-trash",style:{marginRight:"0.3rem"}}),"Confirmar eliminaci\xf3n"]}),(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)"},onClick:Z,children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})})]})]})},Ih=e=>{let{seleccionado:t,onNavigate:r,onCollapsedChange:n,collapsed:a,user:i}=e;const[s,l]=(0,o.useState)(a||!1),[c,d]=(0,o.useState)({gestion:!0,administracion:!1,sistema:!1});return o.useEffect(()=>{n&&n(s)},[s,n]),o.useEffect(()=>{l(a)},[a]),(0,ze.jsxs)(kn,{breakPoint:"md",backgroundColor:"rgba(0, 43, 127, 0.92)",collapsed:s,rootStyles:{height:"calc(100vh - 51px)",top:"51px",left:"0",right:"unset",position:"fixed",zIndex:100,width:s?"52px":"260px",minWidth:s?"52px":"260px",maxWidth:s?"52px":"260px",borderRight:"6px solid #F2A900"},children:[(0,ze.jsx)("button",{onClick:()=>l(!s),className:"sidebar-toggle-btn",style:{position:"absolute",top:10,right:8,background:"none",border:"none",color:"#FFD000",fontSize:20,cursor:"pointer",zIndex:1100,padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",fontWeight:"bold"},title:s?"Expandir men\xfa":"Minimizar men\xfa",children:s?"\u25b6":"\u25c0"}),(0,ze.jsxs)(Nn,{menuItemStyles:{button:e=>{let{active:t,disabled:r}=e;return{backgroundColor:t?"#F2A900":r?"#d1d5db":"transparent",color:t?"#1a2235":r?"#222":"#fff",fontWeight:t?"600":"500",borderRadius:"5px",margin:"2px 8px",padding:"11px 12px",transition:"all 0.18s ease",fontSize:"14px",marginTop:"32px",whiteSpace:"nowrap",overflow:"visible",textOverflow:"clip"}},hover:e=>{let{disabled:t}=e;return{backgroundColor:t?"#b0b0b0":"rgba(255, 255, 255, 0.1)",color:t?"#222":"#F2A900",fontWeight:"600"}},icon:e=>{let{active:t,disabled:r,hovered:n}=e;return{color:t?"#1a2235":r?n?"#222":"#b0b0b0":"#F2A900",fontSize:"16px",marginRight:"10px",flexShrink:0}}},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-cog"}),active:"dashboard"===t,onClick:()=>r("dashboard"),style:{marginTop:"32px"},children:"Panel Principal"}),(0,ze.jsxs)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:[!s&&(0,ze.jsx)("div",{style:{padding:"8px 16px",color:"#95a5a6",fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:"GESTI\xd3N"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-pie-chart"}),onClick:()=>{return e="gestion",void d(t=>Ue(Ue({},t),{},{[e]:!t[e]}));var e},style:{margin:"2px 6px",padding:"11px 16px",cursor:"pointer"},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,ze.jsx)("span",{children:"Proyectos"}),!s&&(0,ze.jsx)("i",{className:"fa fa-chevron-".concat(c.gestion?"up":"down"),style:{fontSize:"12px",marginLeft:"8px"}})]})}),c.gestion&&!s&&(0,ze.jsxs)("div",{style:{paddingLeft:"20px"},children:[(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-pie-chart"}),active:"proyectos"===t,onClick:()=>r("proyectos"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Gestionar Proyectos"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-sitemap"}),active:"centros-costo"===t,onClick:()=>r("centros-costo"),style:{margin:"2px 6px",padding:"8px 16px",fontSize:"12px"},children:"Centros de Costo"})]}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-building"}),active:"empresas"===t,onClick:()=>r("empresas"),style:{margin:"2px 6px",padding:"11px 16px"},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,ze.jsx)("span",{children:"Empresas Contratistas"}),!s&&(0,ze.jsx)("i",{className:"fa fa-angle-down",style:{fontSize:"12px"}})]})}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-file-text"}),active:"contratos"===t,onClick:()=>r("contratos"),style:{margin:"2px 6px",padding:"11px 16px"},children:(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,ze.jsx)("span",{children:"Contratos"}),!s&&(0,ze.jsx)("i",{className:"fa fa-angle-down",style:{fontSize:"12px"}})]})})]}),(0,ze.jsxs)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:[!s&&(0,ze.jsx)("div",{style:{padding:"8px 16px",color:"#95a5a6",fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:"ADMINISTRACI\xd3N"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-users"}),active:"usuarios"===t,onClick:()=>r("usuarios"),style:{margin:"2px 6px",padding:"11px 16px"},children:"Usuarios"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-key"}),active:"privilegios"===t,onClick:()=>r("privilegios"),style:{margin:"2px 6px",padding:"11px 16px"},children:"Privilegios (ACL)"})]}),(0,ze.jsxs)("div",{style:{marginTop:"24px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"16px"},children:[!s&&(0,ze.jsx)("div",{style:{padding:"8px 16px",color:"#95a5a6",fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:"SISTEMA"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-cog"}),active:"configuracion"===t,onClick:()=>r("configuracion"),style:{margin:"2px 6px",padding:"11px 16px"},children:"Configuraci\xf3n General"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-database"}),active:"backup"===t,onClick:()=>r("backup"),style:{margin:"2px 6px",padding:"11px 16px"},children:"Backup & Restore"}),(0,ze.jsx)(da,{icon:(0,ze.jsx)("i",{className:"fa fa-shield"}),active:"seguridad"===t,onClick:()=>r("seguridad"),style:{margin:"2px 6px",padding:"11px 16px"},children:"Seguridad"})]})]})]})},Oh=[{value:"super_admin",label:"Super Admin"},{value:"admin",label:"Administrador"},{value:"trabajador",label:"Trabajador"},{value:"visita",label:"Visita"},{value:"visita_sin_permiso",label:"Visita Sin Permiso"}],Ph=e=>{var t;let{user:r}=e;re();const[n,a]=(0,o.useState)(!1),[i,s]=(0,o.useState)(!1),[l,c]=(0,o.useState)("dashboard"),[d,p]=(0,o.useState)(!0),[u,f]=(0,o.useState)(null),[h,g]=(0,o.useState)([]),[m,x]=(0,o.useState)([]),[b,v]=(0,o.useState)([]),[y,j]=(0,o.useState)([]),[_,S]=(0,o.useState)([]),[w,k]=(0,o.useState)([]),[C,E]=(0,o.useState)(!1),[T,R]=(0,o.useState)(!1),[N,A]=(0,o.useState)(!1),[z,I]=(0,o.useState)(!1),[O,P]=(0,o.useState)(null),[D,L]=(0,o.useState)({key:"id",direction:"asc"}),[B,F]=(0,o.useState)(null),[M,W]=(0,o.useState)(""),[U,H]=(0,o.useState)(""),[V,G]=(0,o.useState)({nombre:"",descripcion:"",region_id:""}),[Y,$]=(0,o.useState)({nombre:"",descripcion:"",proyecto_id:""}),[q,X]=(0,o.useState)({nombre:"",email:"",password:"",rol:"trabajador",region_id:"",proyecto_id:"",centro_costo_id:"",empresa_id:"",aprobado:1}),[K,J]=(0,o.useState)({nombre:"",rut:"",direccion:"",telefono:"",email:"",contacto_nombre:"",contacto_telefono:"",contacto_email:"",regiones:[],proyectos:[]}),[Q,Z]=(0,o.useState)([]),[ee,te]=(0,o.useState)([]),[ne,oe]=(0,o.useState)([]),[ae,ie]=(0,o.useState)([]),[se,le]=(0,o.useState)([]),[ce,de]=(0,o.useState)([]);if(!r||"super_admin"!==r.rol&&"admin"!==r.rol)return(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:r,onLogout:ue}),(0,ze.jsxs)("div",{className:"usuarios-acceso-denegado",children:[(0,ze.jsx)("h2",{children:"Acceso denegado"}),(0,ze.jsx)("p",{children:"No tienes permisos para acceder a los ajustes del sistema."})]})]});(0,o.useEffect)(()=>{pe()},[]),(0,o.useEffect)(()=>{if(q.region_id){const e=m.filter(e=>String(e.region_id)===String(q.region_id));Z(e),q.proyecto_id&&!e.find(e=>String(e.proyecto_id)===String(q.proyecto_id))&&X(e=>Ue(Ue({},e),{},{proyecto_id:"",centro_costo_id:""}))}else Z([])},[q.region_id,m]),(0,o.useEffect)(()=>{if(q.proyecto_id){const e=h.filter(e=>String(e.proyecto_id)===String(q.proyecto_id));oe(e),q.centro_costo_id&&e.length>0&&!e.find(e=>String(e.id)===String(q.centro_costo_id))&&X(e=>Ue(Ue({},e),{},{centro_costo_id:""}));const t=_.filter(e=>e.proyectos&&e.proyectos.some(e=>String(e.proyecto_id)===String(q.proyecto_id)));ie(t),q.empresa_id&&t.length>0&&!t.find(e=>e.empresa_id===q.empresa_id)&&X(e=>Ue(Ue({},e),{},{empresa_id:""}))}else oe([]),ie([]),O||X(e=>Ue(Ue({},e),{},{centro_costo_id:"",empresa_id:""}))},[q.proyecto_id,h,_,O]),(0,o.useEffect)(()=>{if(m&&0!==m.length)if(K.regiones&&K.regiones.length>0){const e=m.filter(e=>K.regiones.includes(e.region_id));te(e);const t=K.proyectos.filter(e=>{const t=m.find(t=>t.proyecto_id===e);return t&&K.regiones.includes(t.region_id)});t.length!==K.proyectos.length&&J(e=>Ue(Ue({},e),{},{proyectos:t}))}else te([]),K.proyectos&&K.proyectos.length>0&&J(e=>Ue(Ue({},e),{},{proyectos:[]}));else te([])},[K.regiones,m,K.proyectos.length]);const pe=async()=>{p(!0);try{const[e,t,r,n,o]=await Promise.all([fetch("".concat(Te,"/centros_costo.php")),fetch("".concat(Te,"/proyectos.php")),fetch("".concat(Te,"/regiones.php")),fetch("".concat(Te,"/usuarios.php")),fetch("".concat(Te,"/empresas/empresas.php")).catch(()=>({json:async()=>[]}))]),a=await e.json(),i=await t.json(),s=await r.json(),l=await n.json(),c=await o.json();g(Array.isArray(a)?a:[]),x(Array.isArray(i)?i:[]),v(Array.isArray(s)?s:[]),j(Array.isArray(l)?l:[]),S(Array.isArray(c)?c:[])}catch(Fh){console.error("Error cargando datos:",Fh)}p(!1)};function ue(){localStorage.removeItem("user"),localStorage.removeItem("centros"),window.location.href="/"}const fe=function(e){f({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>f(null),5e3)},he=e=>{c(e)},ge=async()=>{if(B)if(M)try{const e=await fetch("".concat(Te,"/usuarios/eliminar_usuario.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:B.id,password_confirmacion:M,usuario_que_elimina_id:r.id})});if(e.ok){const t=await e.json();t.success?(fe("Usuario eliminado correctamente"),pe(),F(null),W(""),H("")):H(t.error||"Error al eliminar usuario")}else{const t=await e.json();H(t.error||"Error al eliminar usuario")}}catch(e){H("Error de red al eliminar usuario.")}else H("Por favor, ingrese la contrase\xf1a de confirmaci\xf3n")},me=()=>{F(null),W(""),H("")},xe=e=>{const t=m.find(t=>String(t.proyecto_id)===String(e));return t?t.nombre:"N/A"},be=e=>{const t=b.find(t=>String(t.region_id)===String(e));return t?t.nombre:"N/A"},ve=e=>{let t="asc";D.key===e&&"asc"===D.direction&&(t="desc"),L({key:e,direction:t})},ye=[...h].sort((e,t)=>{let r=e[D.key],n=t[D.key];return"proyecto_id"===D.key?(r=xe(e.proyecto_id),n=xe(t.proyecto_id)):"region_id"===D.key&&(r=be(e.region_id),n=be(t.region_id)),r<n?"asc"===D.direction?-1:1:r>n?"asc"===D.direction?1:-1:0}),je=[...m].sort((e,t)=>{let r=e[D.key],n=t[D.key];return"region_id"===D.key&&(r=be(e.region_id),n=be(t.region_id)),r<n?"asc"===D.direction?-1:1:r>n?"asc"===D.direction?1:-1:0}),_e=[..._].sort((e,t)=>{let r=e[D.key],n=t[D.key];return"empresa_id"===D.key&&(r=String(e.empresa_id||e.rut||""),n=String(t.empresa_id||t.rut||"")),r<n?"asc"===D.direction?-1:1:r>n?"asc"===D.direction?1:-1:0}),Se="admin"===r.rol?y.filter(e=>String(e.centro_costo_id)===String(r.centro_costo_id)):y;return d?(0,ze.jsx)("div",{className:"main-bg",children:(0,ze.jsxs)("div",{className:"content-card",style:{textAlign:"center",padding:"3rem"},children:[(0,ze.jsx)("div",{className:"loading-spinner"}),(0,ze.jsx)("span",{children:"Cargando datos..."})]})}):(0,ze.jsxs)("div",{className:"main-bg",children:[(0,ze.jsx)(De,{user:r,onLogout:ue}),(0,ze.jsxs)("div",{className:"ajuste-layout",children:[!i&&(0,ze.jsx)(Ih,{seleccionado:l,onNavigate:he,onCollapsedChange:a,collapsed:n,user:r}),(0,ze.jsxs)("main",{className:"ajuste-content ".concat(n?"sidebar-collapsed":""," ").concat(i?"sidebar-hidden":""),children:["dashboard"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"PANEL PRINCIPAL DE AJUSTES"}),(0,ze.jsxs)("div",{className:"dashboard-kpis",children:[(0,ze.jsxs)("div",{className:"kpi-card",children:[(0,ze.jsx)("div",{className:"kpi-icon proyectos",children:(0,ze.jsx)("i",{className:"fa fa-pie-chart"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-number",children:m.length}),(0,ze.jsx)("div",{className:"kpi-label",children:"Proyectos Activos"})]})]}),(0,ze.jsxs)("div",{className:"kpi-card",children:[(0,ze.jsx)("div",{className:"kpi-icon centros",children:(0,ze.jsx)("i",{className:"fa fa-file-text"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-number",children:h.length}),(0,ze.jsx)("div",{className:"kpi-label",children:"Centros de Costo"})]})]}),(0,ze.jsxs)("div",{className:"kpi-card",children:[(0,ze.jsx)("div",{className:"kpi-icon empresas",children:(0,ze.jsx)("i",{className:"fa fa-building"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-number",children:_.length}),(0,ze.jsx)("div",{className:"kpi-label",children:"Empresas Contratistas"})]})]}),(0,ze.jsxs)("div",{className:"kpi-card",children:[(0,ze.jsx)("div",{className:"kpi-icon regiones",children:(0,ze.jsx)("i",{className:"fa fa-map-marker"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-number",children:b.length}),(0,ze.jsx)("div",{className:"kpi-label",children:"Regiones"})]})]}),(0,ze.jsxs)("div",{className:"kpi-card",children:[(0,ze.jsx)("div",{className:"kpi-icon usuarios",children:(0,ze.jsx)("i",{className:"fa fa-users"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-number",children:y.length}),(0,ze.jsx)("div",{className:"kpi-label",children:"Usuarios"})]})]}),(0,ze.jsxs)("div",{className:"kpi-card status-card",children:[(0,ze.jsx)("div",{className:"kpi-icon status",children:(0,ze.jsx)("i",{className:"fa fa-check-circle"})}),(0,ze.jsxs)("div",{className:"kpi-content",children:[(0,ze.jsx)("div",{className:"kpi-status",children:"SISTEMA OPERATIVO"}),(0,ze.jsx)("div",{className:"kpi-label",children:"Estado: Activo"})]})]})]}),(0,ze.jsxs)("div",{className:"dashboard-quick-access",children:[(0,ze.jsx)("h3",{className:"quick-access-title",children:"ACCESOS R\xc1PIDOS"}),(0,ze.jsxs)("div",{className:"quick-access-grid",children:[(0,ze.jsxs)("div",{className:"quick-access-card",onClick:()=>he("proyectos"),style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(245, 158, 11, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("div",{className:"quick-access-icon",style:{fontSize:"2.5rem",marginBottom:"1rem"},children:(0,ze.jsx)("i",{className:"fa fa-pie-chart"})}),(0,ze.jsx)("div",{className:"quick-access-title-card",children:"Gestionar Proyectos"}),(0,ze.jsxs)("div",{className:"quick-access-count",children:[m.length," proyectos"]})]}),(0,ze.jsxs)("div",{className:"quick-access-card",onClick:()=>he("centros-costo"),style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(16, 185, 129, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("div",{className:"quick-access-icon",style:{fontSize:"2.5rem",marginBottom:"1rem"},children:(0,ze.jsx)("i",{className:"fa fa-file-text"})}),(0,ze.jsx)("div",{className:"quick-access-title-card",children:"Gestionar Centros de Costo"}),(0,ze.jsxs)("div",{className:"quick-access-count",children:[h.length," centros"]})]}),(0,ze.jsxs)("div",{className:"quick-access-card",onClick:()=>he("empresas"),style:{background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(139, 92, 246, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("div",{className:"quick-access-icon",style:{fontSize:"2.5rem",marginBottom:"1rem"},children:(0,ze.jsx)("i",{className:"fa fa-building"})}),(0,ze.jsx)("div",{className:"quick-access-title-card",children:"Gestionar Empresas"}),(0,ze.jsxs)("div",{className:"quick-access-count",children:[_.length," empresas"]})]}),(0,ze.jsxs)("div",{className:"quick-access-card",onClick:()=>he("usuarios"),style:{background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(239, 68, 68, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},children:[(0,ze.jsx)("div",{className:"quick-access-icon",style:{fontSize:"2.5rem",marginBottom:"1rem"},children:(0,ze.jsx)("i",{className:"fa fa-users"})}),(0,ze.jsx)("div",{className:"quick-access-title-card",children:"Administrar Usuarios"}),(0,ze.jsxs)("div",{className:"quick-access-count",children:[y.length," usuarios"]})]})]})]}),u&&(0,ze.jsxs)("div",{className:"ajuste-feedback ".concat(u.type),children:[(0,ze.jsx)("i",{className:"fa fa-".concat("success"===u.type?"check-circle":"exclamation-circle")}),u.message]})]}),"centros-costo"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"GESTI\xd3N DE CENTROS DE COSTO"}),(0,ze.jsx)("div",{className:"ajuste-botones",children:(0,ze.jsx)("button",{className:"ajuste-btn centro",onClick:()=>{P(null),$({nombre:"",descripcion:"",proyecto_id:""}),R(!0)},children:"+ AGREGAR CENTRO DE COSTO"})}),(0,ze.jsx)("div",{className:"usuarios-table-wrapper",children:(0,ze.jsxs)("table",{className:"usuarios-table",children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{children:[(0,ze.jsxs)("th",{onClick:()=>ve("id"),style:{cursor:"pointer"},children:["ID ","id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("nombre"),style:{cursor:"pointer"},children:["NOMBRE ","nombre"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("descripcion"),style:{cursor:"pointer"},children:["DESCRIPCI\xd3N ","descripcion"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("proyecto_id"),style:{cursor:"pointer"},children:["PROYECTO ","proyecto_id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("region_id"),style:{cursor:"pointer"},children:["REGI\xd3N ","region_id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsx)("th",{children:"ACCIONES"})]})}),(0,ze.jsx)("tbody",{children:0===ye.length?(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:"6",style:{textAlign:"center",padding:"2rem",color:"#64748b",fontSize:"0.9rem"},children:"No hay centros de costo disponibles"})}):ye.map(e=>(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{children:e.id}),(0,ze.jsx)("td",{children:e.nombre}),(0,ze.jsx)("td",{children:e.descripcion}),(0,ze.jsx)("td",{children:e.proyecto_nombre||xe(e.proyecto_id)}),(0,ze.jsx)("td",{children:e.region_nombre||"N/A"}),(0,ze.jsxs)("td",{children:[(0,ze.jsx)("button",{className:"usuarios-accion-btn",onClick:()=>(e=>{P(e),$({nombre:e.nombre,descripcion:e.descripcion,proyecto_id:e.proyecto_id}),R(!0)})(e),title:"Editar centro de costo",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}),(0,ze.jsx)("button",{className:"usuarios-accion-btn usuarios-eliminar-btn",onClick:()=>(async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este centro de costo?"))try{const t=await fetch("".concat(Te,"/eliminar_centro_costo.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});t.ok&&(await t.json()).success&&(fe("Centro de costo eliminado"),pe())}catch(t){fe("Error al eliminar","error")}})(e.id),title:"Eliminar centro de costo",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.id))})]})})]}),"proyectos"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"GESTI\xd3N DE PROYECTOS"}),(0,ze.jsx)("div",{className:"ajuste-botones",children:(0,ze.jsx)("button",{className:"ajuste-btn proyecto",onClick:()=>{P(null),G({nombre:"",descripcion:"",region_id:""}),E(!0)},children:"+ AGREGAR PROYECTO"})}),(0,ze.jsx)("div",{className:"usuarios-table-wrapper",children:(0,ze.jsxs)("table",{className:"usuarios-table",children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{children:[(0,ze.jsxs)("th",{onClick:()=>ve("proyecto_id"),style:{cursor:"pointer"},children:["ID ","proyecto_id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("nombre"),style:{cursor:"pointer"},children:["NOMBRE ","nombre"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("descripcion"),style:{cursor:"pointer"},children:["DESCRIPCI\xd3N ","descripcion"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("region_id"),style:{cursor:"pointer"},children:["REGI\xd3N ","region_id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsx)("th",{children:"ACCIONES"})]})}),(0,ze.jsx)("tbody",{children:0===je.length?(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:"5",style:{textAlign:"center",padding:"2rem",color:"#64748b",fontSize:"0.9rem"},children:"No hay proyectos disponibles"})}):je.map(e=>(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{children:e.proyecto_id}),(0,ze.jsx)("td",{children:e.nombre}),(0,ze.jsx)("td",{children:e.descripcion}),(0,ze.jsx)("td",{children:be(e.region_id)}),(0,ze.jsx)("td",{children:(0,ze.jsx)("button",{className:"usuarios-accion-btn",onClick:()=>(e=>{P(e),G({nombre:e.nombre,descripcion:e.descripcion,region_id:e.region_id}),E(!0)})(e),title:"Editar proyecto",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})})})]},e.proyecto_id))})]})})]}),"empresas"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"GESTI\xd3N DE EMPRESAS CONTRATISTAS"}),(0,ze.jsx)("div",{className:"ajuste-botones",children:(0,ze.jsx)("button",{className:"ajuste-btn empresa",onClick:()=>{P(null),J({nombre:"",rut:"",direccion:"",telefono:"",email:"",contacto_nombre:"",contacto_telefono:"",contacto_email:"",regiones:[],proyectos:[]}),I(!0)},children:"+ AGREGAR EMPRESA"})}),(0,ze.jsx)("div",{className:"usuarios-table-wrapper",children:(0,ze.jsxs)("table",{className:"usuarios-table",children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{children:[(0,ze.jsxs)("th",{onClick:()=>ve("empresa_id"),style:{cursor:"pointer"},children:["RUT ","empresa_id"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsxs)("th",{onClick:()=>ve("nombre"),style:{cursor:"pointer"},children:["NOMBRE ","nombre"===D.key&&("asc"===D.direction?"\u2191":"\u2193")]}),(0,ze.jsx)("th",{children:"CONTACTO"}),(0,ze.jsx)("th",{children:"REGI\xd3N(ES)"}),(0,ze.jsx)("th",{children:"PROYECTO(S)"}),(0,ze.jsx)("th",{children:"ACCIONES"})]})}),(0,ze.jsx)("tbody",{children:0===_e.length?(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:"6",style:{textAlign:"center",padding:"2rem",color:"#64748b",fontSize:"0.9rem"},children:"No hay empresas registradas"})}):_e.map(e=>(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{fontWeight:"600",color:"#0a6ebd"},children:e.empresa_id||e.rut||"-"}),(0,ze.jsx)("td",{style:{fontWeight:"600"},children:e.nombre}),(0,ze.jsx)("td",{children:e.contacto_nombre?(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{style:{fontWeight:"500"},children:e.contacto_nombre}),e.contacto_email&&(0,ze.jsxs)("div",{style:{fontSize:"0.85rem",color:"#64748b",marginTop:"0.25rem"},children:[(0,ze.jsx)("i",{className:"fa fa-envelope",style:{marginRight:"0.25rem"}}),e.contacto_email]}),e.contacto_telefono&&(0,ze.jsxs)("div",{style:{fontSize:"0.85rem",color:"#64748b",marginTop:"0.25rem"},children:[(0,ze.jsx)("i",{className:"fa fa-phone",style:{marginRight:"0.25rem"}}),e.contacto_telefono]})]}):"-"}),(0,ze.jsx)("td",{children:e.regiones&&e.regiones.length>0?(0,ze.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:e.regiones.map(e=>(0,ze.jsx)("span",{style:{display:"inline-block",padding:"0.35rem 0.75rem",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"500",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.2)"},children:e.nombre},e.region_id))}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"Sin regiones"})}),(0,ze.jsx)("td",{children:e.proyectos&&e.proyectos.length>0?(0,ze.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:e.proyectos.map(e=>(0,ze.jsx)("span",{style:{display:"inline-block",padding:"0.35rem 0.75rem",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",color:"white",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"500",boxShadow:"0 2px 4px rgba(139, 92, 246, 0.2)"},children:e.nombre},e.proyecto_id))}):(0,ze.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"Sin proyectos"})}),(0,ze.jsxs)("td",{children:[(0,ze.jsx)("button",{className:"usuarios-accion-btn",onClick:()=>(e=>{P(e),J({nombre:e.nombre||"",rut:e.empresa_id||e.rut||"",direccion:e.direccion||"",telefono:e.telefono||"",email:e.email||"",contacto_nombre:e.contacto_nombre||"",contacto_telefono:e.contacto_telefono||"",contacto_email:e.contacto_email||"",regiones:e.regiones?e.regiones.map(e=>e.region_id):[],proyectos:e.proyectos?e.proyectos.map(e=>e.proyecto_id):[]}),I(!0)})(e),title:"Editar empresa",style:{marginRight:"0.5rem"},children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}),(0,ze.jsx)("button",{className:"usuarios-accion-btn usuarios-eliminar-btn",onClick:()=>(async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar esta empresa? Se eliminar\xe1n todas sus relaciones con regiones y proyectos."))try{const t=await fetch("".concat(Te,"/empresas/empresas.php"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({empresa_id:e})});if(t.ok){const e=await t.json();e.success?(fe("Empresa eliminada correctamente"),pe()):fe(e.error||"Error al eliminar empresa","error")}}catch(t){fe("Error al eliminar empresa","error")}})(e.empresa_id),title:"Eliminar empresa",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})]},e.empresa_id))})]})})]}),"contratos"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"GESTI\xd3N DE CONTRATOS"}),(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-file-text",style:{fontSize:"4rem",marginBottom:"1rem",color:"#10b981"}}),(0,ze.jsx)("p",{style:{fontSize:"1.2rem"},children:"Funcionalidad en desarrollo"})]})]}),"usuarios"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"ADMINISTRACI\xd3N DE USUARIOS"}),(0,ze.jsx)("div",{className:"ajuste-botones",children:(0,ze.jsx)("button",{className:"ajuste-btn usuario",onClick:()=>{P(null);let e="";"admin"===r.rol?e=r.region_id:"super_admin"===r.rol&&b.length>0&&(e=b[0].region_id),X({nombre:"",email:"",password:"",rol:"trabajador",region_id:e,proyecto_id:"admin"===r.rol?r.proyecto_id:"",centro_costo_id:"admin"===r.rol?r.centro_costo_id:"",empresa_id:"",aprobado:1}),A(!0)},children:"+ AGREGAR USUARIO"})}),(0,ze.jsx)("div",{className:"usuarios-table-wrapper",children:(0,ze.jsxs)("table",{className:"usuarios-table",children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("th",{children:"NOMBRE"}),(0,ze.jsx)("th",{children:"EMAIL"}),(0,ze.jsx)("th",{children:"ROL"}),(0,ze.jsx)("th",{children:"CENTRO DE COSTO"}),(0,ze.jsx)("th",{children:"PROYECTO"}),(0,ze.jsx)("th",{children:"REGI\xd3N"}),(0,ze.jsx)("th",{children:"APROBADO"}),(0,ze.jsx)("th",{children:"ACCIONES"})]})}),(0,ze.jsx)("tbody",{children:0===Se.length?(0,ze.jsx)("tr",{children:(0,ze.jsx)("td",{colSpan:"8",style:{textAlign:"center",padding:"2rem",color:"#64748b",fontSize:"0.9rem"},children:"No hay usuarios disponibles"})}):Se.map(e=>(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{children:e.nombre}),(0,ze.jsx)("td",{children:e.email}),(0,ze.jsx)("td",{children:(0,ze.jsx)("span",{className:"rol-badge rol-".concat(e.rol),children:e.rol})}),(0,ze.jsx)("td",{children:e.centro_costo_nombre||"-"}),(0,ze.jsx)("td",{children:e.proyecto_nombre||"-"}),(0,ze.jsx)("td",{children:e.region_nombre||"-"}),(0,ze.jsx)("td",{children:(0,ze.jsx)("span",{className:"estado-badge ".concat(e.aprobado?"aprobado":"pendiente"),children:e.aprobado?"Aprobado":"Pendiente"})}),(0,ze.jsx)("td",{children:("super_admin"===r.rol||"admin"===r.rol&&["trabajador","visita_sin_permiso"].includes(e.rol))&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{className:"usuarios-accion-btn",onClick:()=>(e=>{P(e),console.log("Editando usuario completo:",e);const t=e.centro_costo_id_real||e.centro_costo_id;X({nombre:e.nombre||"",email:e.email||"",password:"",rol:e.rol||"trabajador",region_id:null!==e.region_id&&void 0!==e.region_id?String(e.region_id):"",proyecto_id:null!==e.proyecto_id&&void 0!==e.proyecto_id?String(e.proyecto_id):"",centro_costo_id:null!==t&&void 0!==t?String(t):"",empresa_id:e.empresa_id||"",aprobado:void 0!==e.aprobado&&null!==e.aprobado?e.aprobado:1}),console.log("Formulario configurado:",{nombre:e.nombre||"",email:e.email||"",rol:e.rol||"trabajador",region_id:null!==e.region_id&&void 0!==e.region_id?String(e.region_id):"",proyecto_id:null!==e.proyecto_id&&void 0!==e.proyecto_id?String(e.proyecto_id):"",centro_costo_id:null!==t&&void 0!==t?String(t):"",empresa_id:e.empresa_id||"",aprobado:void 0!==e.aprobado&&null!==e.aprobado?e.aprobado:1}),A(!0)})(e),title:"Editar usuario",children:(0,ze.jsx)("i",{className:"fa fa-pencil"})}),"super_admin"===r.rol&&(0,ze.jsx)("button",{className:"usuarios-accion-btn usuarios-eliminar-btn",onClick:()=>{return F({id:(t=e).id,nombre:t.nombre}),W(""),void H("");var t},title:"Eliminar usuario",children:(0,ze.jsx)("i",{className:"fa fa-trash"})})]})})]},e.id))})]})})]}),"configuracion"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"CONFIGURACI\xd3N GENERAL DEL SISTEMA"}),(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-cog",style:{fontSize:"4rem",marginBottom:"1rem",color:"#607d8b"}}),(0,ze.jsx)("p",{style:{fontSize:"1.2rem"},children:"Funcionalidad en desarrollo"})]})]}),"backup"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"BACKUP & RESTORE"}),(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-database",style:{fontSize:"4rem",marginBottom:"1rem",color:"#607d8b"}}),(0,ze.jsx)("p",{style:{fontSize:"1.2rem"},children:"Funcionalidad en desarrollo"})]})]}),"seguridad"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsx)("h1",{className:"ajuste-titulo",children:"CONFIGURACI\xd3N DE SEGURIDAD"}),(0,ze.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:[(0,ze.jsx)("i",{className:"fa fa-shield",style:{fontSize:"4rem",marginBottom:"1rem",color:"#607d8b"}}),(0,ze.jsx)("p",{style:{fontSize:"1.2rem"},children:"Funcionalidad en desarrollo"})]})]}),"privilegios"===l&&(0,ze.jsxs)("div",{className:"ajuste-container",children:[(0,ze.jsxs)("h1",{className:"ajuste-titulo",children:[(0,ze.jsx)("i",{className:"fa fa-key",style:{marginRight:"0.75rem",color:"#F2A900"}}),"MATRIZ DE PRIVILEGIOS (ACL)"]}),(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem 1.5rem",borderRadius:"12px",marginBottom:"2rem",color:"#fff"},children:(0,ze.jsxs)("p",{style:{margin:0,fontSize:"0.95rem"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"0.5rem"}}),"Esta tabla muestra los permisos y acciones permitidas para cada tipo de usuario en el sistema."]})}),(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",overflow:"hidden",marginBottom:"2rem"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #002B7F 0%, #001a4d 100%)",padding:"1rem 1.5rem",color:"#fff"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-users",style:{marginRight:"0.5rem",color:"#F2A900"}}),"Roles del Sistema"]})}),(0,ze.jsx)("div",{style:{padding:"1.5rem"},children:(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1rem"},children:[(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%)",borderRadius:"10px",padding:"1.25rem",color:"#fff"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem"},children:"\u2b50"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{style:{margin:0,fontSize:"1rem"},children:"Super Admin"}),(0,ze.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Acceso total al sistema"})]})]}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",margin:0,opacity:.9},children:"Control completo sobre todas las funcionalidades, usuarios y configuraciones del sistema."})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",borderRadius:"10px",padding:"1.25rem",color:"#fff"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem"},children:"\ud83d\udc54"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{style:{margin:0,fontSize:"1rem"},children:"Administrador"}),(0,ze.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Gesti\xf3n de proyectos asignados"})]})]}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",margin:0,opacity:.9},children:"Puede gestionar usuarios, validar l\xednea base y administrar carpetas dentro de su alcance."})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #28a745 0%, #1e7e34 100%)",borderRadius:"10px",padding:"1.25rem",color:"#fff"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem"},children:"\ud83d\udc77"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{style:{margin:0,fontSize:"1rem"},children:"Trabajador"}),(0,ze.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Usuario operativo"})]})]}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",margin:0,opacity:.9},children:"Puede reportar avances, comentar en el foro y subir respaldos de evidencias."})]}),(0,ze.jsxs)("div",{style:{background:"linear-gradient(135deg, #6c757d 0%, #545b62 100%)",borderRadius:"10px",padding:"1.25rem",color:"#fff"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[(0,ze.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem"},children:"\ud83d\udc41\ufe0f"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{style:{margin:0,fontSize:"1rem"},children:"Visita"}),(0,ze.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Solo lectura"})]})]}),(0,ze.jsx)("p",{style:{fontSize:"0.85rem",margin:0,opacity:.9},children:"Puede visualizar informaci\xf3n sin realizar modificaciones."})]})]})})]}),(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",overflow:"hidden",marginBottom:"2rem"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #002B7F 0%, #001a4d 100%)",padding:"1rem 1.5rem",color:"#fff"},children:(0,ze.jsxs)("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:[(0,ze.jsx)("i",{className:"fa fa-table",style:{marginRight:"0.5rem",color:"#F2A900"}}),"Matriz de Permisos - M\xf3dulos del Sistema"]})}),(0,ze.jsx)("div",{style:{overflowX:"auto"},children:(0,ze.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[(0,ze.jsx)("thead",{children:(0,ze.jsxs)("tr",{style:{background:"#f8f9fa"},children:[(0,ze.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"2px solid #dee2e6",fontWeight:600,minWidth:"200px"},children:"Funcionalidad / M\xf3dulo"}),(0,ze.jsx)("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"2px solid #dee2e6",background:"#6f42c1",color:"#fff",minWidth:"100px"},children:"\u2b50 Super Admin"}),(0,ze.jsx)("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"2px solid #dee2e6",background:"#17a2b8",color:"#fff",minWidth:"100px"},children:"\ud83d\udc54 Admin"}),(0,ze.jsx)("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"2px solid #dee2e6",background:"#28a745",color:"#fff",minWidth:"100px"},children:"\ud83d\udc77 Trabajador"}),(0,ze.jsx)("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"2px solid #dee2e6",background:"#6c757d",color:"#fff",minWidth:"100px"},children:"\ud83d\udc41\ufe0f Visita"})]})}),(0,ze.jsxs)("tbody",{children:[(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-cog",style:{marginRight:"0.5rem"}}),"AJUSTES DEL SISTEMA"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Acceso a Panel de Ajustes"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Gestionar Proyectos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#ffc107",fontSize:"1rem"},children:"\ud83d\udc41\ufe0f"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Gestionar Centros de Costo"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#ffc107",fontSize:"1rem"},children:"\ud83d\udc41\ufe0f"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Gestionar Empresas Contratistas"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#ffc107",fontSize:"1rem"},children:"\ud83d\udc41\ufe0f"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Crear/Editar/Eliminar Usuarios"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-folder",style:{marginRight:"0.5rem"}}),"GESTI\xd3N DE ARCHIVOS Y CARPETAS"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Crear Carpetas"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Subir Archivos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Eliminar Archivos/Carpetas"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Ver/Descargar Archivos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})})]}),(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-list-alt",style:{marginRight:"0.5rem"}}),"L\xcdNEA BASE - NIVEL 1 (Proyecto Principal)"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Editar todos los campos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Validar/Agregar Observaciones"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-list-alt",style:{marginRight:"0.5rem"}}),"L\xcdNEA BASE - NIVEL 2 (Subcarpetas)"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Editar todos los campos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:'Editar solo "% Avance Implementaci\xf3n"'}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Validar/Agregar Observaciones"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-comments",style:{marginRight:"0.5rem"}}),"FORO DE SEGUIMIENTO"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Agregar mensajes y archivos"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Eliminar mensajes propios"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Eliminar mensajes de Trabajadores"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Eliminar mensajes de Admins"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Eliminar mensajes de Super Admins"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsx)("tr",{style:{background:"#e9ecef"},children:(0,ze.jsxs)("td",{colSpan:"5",style:{padding:"0.75rem 1rem",fontWeight:700,color:"#495057"},children:[(0,ze.jsx)("i",{className:"fa fa-share-alt",style:{marginRight:"0.5rem"}}),"AN\xc1LISIS BOWTIE"]})}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Crear/Editar An\xe1lisis Bowtie"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.2rem"},children:"\u2717"})})]}),(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("td",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #dee2e6"},children:"Visualizar An\xe1lisis Bowtie"}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})}),(0,ze.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #dee2e6"},children:(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.2rem"},children:"\u2713"})})]})]})]})})]}),(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",padding:"1.25rem",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexWrap:"wrap",gap:"1.5rem",justifyContent:"center"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("span",{style:{color:"#28a745",fontSize:"1.5rem"},children:"\u2713"}),(0,ze.jsx)("span",{style:{fontSize:"0.9rem",color:"#495057"},children:"Permitido"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("span",{style:{color:"#dc3545",fontSize:"1.5rem"},children:"\u2717"}),(0,ze.jsx)("span",{style:{fontSize:"0.9rem",color:"#495057"},children:"No permitido"})]}),(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("span",{style:{color:"#ffc107",fontSize:"1.2rem"},children:"\ud83d\udc41\ufe0f"}),(0,ze.jsx)("span",{style:{fontSize:"0.9rem",color:"#495057"},children:"Solo lectura"})]})]})]})]})]}),C&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",children:(0,ze.jsxs)("div",{className:"usuarios-modal",children:[(0,ze.jsx)("h3",{children:O?"Editar Proyecto":"Agregar Nuevo Proyecto"}),(0,ze.jsxs)("form",{className:"usuarios-modal-form",onSubmit:async e=>{e.preventDefault();try{const e="".concat(Te,"/proyectos.php"),t="POST",r=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(r.ok){(await r.json()).success&&(fe(O?"Proyecto actualizado correctamente":"Proyecto agregado correctamente"),E(!1),P(null),G({nombre:"",descripcion:"",region_id:""}),pe())}}catch(t){fe("Error al procesar proyecto","error")}},children:[(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{marginRight:"0.5rem"}}),"Nombre del Proyecto:",(0,ze.jsx)("input",{type:"text",value:V.nombre,onChange:e=>G(Ue(Ue({},V),{},{nombre:e.target.value})),required:!0,placeholder:"Ingresa el nombre del proyecto"})]}),(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"0.5rem"}}),"Descripci\xf3n:",(0,ze.jsx)("textarea",{value:V.descripcion,onChange:e=>G(Ue(Ue({},V),{},{descripcion:e.target.value})),required:!0,placeholder:"Describe el proyecto"})]}),(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-map-marker",style:{marginRight:"0.5rem"}}),"Regi\xf3n:",(0,ze.jsxs)("select",{value:V.region_id,onChange:e=>G(Ue(Ue({},V),{},{region_id:e.target.value})),required:!0,children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar regi\xf3n"}),b.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))]})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{type:"submit",className:"usuarios-accion-btn",children:[(0,ze.jsx)("i",{className:"fa fa-save",style:{marginRight:"0.3rem"}}),O?"Actualizar":"Guardar"]}),(0,ze.jsxs)("button",{type:"button",className:"usuarios-accion-btn",onClick:()=>{E(!1),P(null)},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})]})}),T&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",children:(0,ze.jsxs)("div",{className:"usuarios-modal",children:[(0,ze.jsx)("h3",{children:O?"Editar Centro de Costo":"Agregar Nuevo Centro de Costo"}),(0,ze.jsxs)("form",{className:"usuarios-modal-form",onSubmit:async e=>{e.preventDefault();try{const e=parseInt(Y.proyecto_id);if(isNaN(e))return void fe("Proyecto inv\xe1lido","error");const t=await fetch("".concat(Te,"/centros_costo.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:Y.nombre,descripcion:Y.descripcion,proyecto_id:e})});if(t.ok){(await t.json()).success&&(fe(O?"Centro de costo actualizado correctamente":"Centro de costo agregado correctamente"),R(!1),P(null),$({nombre:"",descripcion:"",proyecto_id:""}),pe())}}catch(t){fe("Error al procesar centro de costo","error")}},children:[(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-sitemap",style:{marginRight:"0.5rem"}}),"Nombre:",(0,ze.jsx)("input",{type:"text",value:Y.nombre,onChange:e=>$(Ue(Ue({},Y),{},{nombre:e.target.value})),required:!0,placeholder:"Ingresa el nombre"})]}),(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{marginRight:"0.5rem"}}),"Descripci\xf3n:",(0,ze.jsx)("textarea",{value:Y.descripcion,onChange:e=>$(Ue(Ue({},Y),{},{descripcion:e.target.value})),required:!0,placeholder:"Describe el centro de costo"})]}),(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{marginRight:"0.5rem"}}),"Proyecto:",(0,ze.jsxs)("select",{value:Y.proyecto_id,onChange:e=>$(Ue(Ue({},Y),{},{proyecto_id:e.target.value})),required:!0,children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar proyecto"}),m.map(e=>(0,ze.jsx)("option",{value:e.proyecto_id,children:e.nombre},e.proyecto_id))]})]}),(0,ze.jsxs)("label",{children:[(0,ze.jsx)("i",{className:"fa fa-map-marker",style:{marginRight:"0.5rem"}}),"Regi\xf3n:",(0,ze.jsx)("input",{type:"text",value:Y.proyecto_id&&(null===(t=b.find(e=>{var t;return String(e.region_id)===String(null===(t=m.find(e=>String(e.proyecto_id)===String(Y.proyecto_id)))||void 0===t?void 0:t.region_id)}))||void 0===t?void 0:t.nombre)||"",readOnly:!0,style:{background:"#f5f5f5"}})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{type:"submit",className:"usuarios-accion-btn",children:[(0,ze.jsx)("i",{className:"fa fa-save",style:{marginRight:"0.3rem"}}),O?"Actualizar":"Guardar"]}),(0,ze.jsxs)("button",{type:"button",className:"usuarios-accion-btn",onClick:()=>{R(!1),P(null)},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})]})}),N&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",children:(0,ze.jsxs)("div",{className:"usuarios-modal usuarios-modal-compact",children:[(0,ze.jsxs)("div",{className:"usuarios-modal-header-compact",children:[(0,ze.jsx)("div",{className:"modal-icon-circle",children:(0,ze.jsx)("i",{className:O?"fa fa-user-edit":"fa fa-user-plus"})}),(0,ze.jsx)("h3",{children:O?"Editar Usuario":"Nuevo Usuario"}),(0,ze.jsx)("button",{type:"button",className:"modal-close-btn",onClick:()=>{A(!1),P(null)},children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsxs)("form",{className:"usuarios-modal-form-compact",onSubmit:async e=>{e.preventDefault();const t=Boolean(N&&O),r=!["visita","visita_sin_permiso"].includes(q.rol);if(q.nombre&&q.email)if(t||q.password)if(!r||q.centro_costo_id)try{const e={nombre:q.nombre,email:q.email,rol:q.rol,aprobado:Number(q.aprobado),password:q.password||void 0,region_id:q.region_id?parseInt(q.region_id):null,proyecto_id:q.proyecto_id?parseInt(q.proyecto_id):null,centro_costo_id:r&&q.centro_costo_id?parseInt(q.centro_costo_id):null,empresa_id:q.empresa_id||null};let n="".concat(Te,"/crear_usuario.php");t&&(n="".concat(Te,"/editar_usuario.php"),e.id=O.id,q.password||delete e.password);const o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await o.json();if(o.ok&&a.success)fe(t?"Usuario actualizado correctamente":"Usuario creado correctamente"),A(!1),P(null),X({nombre:"",email:"",password:"",rol:"trabajador",region_id:"",proyecto_id:"",centro_costo_id:"",empresa_id:"",aprobado:1}),pe();else{const e=(null===a||void 0===a?void 0:a.error)||"No se pudo procesar la solicitud";fe(e,"error")}}catch(n){console.error("Error al procesar usuario:",n),fe("Error al procesar usuario","error")}else fe("Selecciona un centro de costo para este rol","error");else fe("Debes definir una contrase\xf1a para el nuevo usuario","error");else fe("Nombre y correo son obligatorios","error")},children:[(0,ze.jsxs)("div",{className:"form-row-2col",children:[(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-user"})," Nombre"]}),(0,ze.jsx)("input",{type:"text",value:q.nombre,onChange:e=>X(t=>Ue(Ue({},t),{},{nombre:e.target.value})),autoComplete:"name",placeholder:"Ej: Juan Soto",required:!0})]}),(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-envelope"})," Email"]}),(0,ze.jsx)("input",{type:"email",value:q.email,onChange:e=>X(t=>Ue(Ue({},t),{},{email:e.target.value})),autoComplete:"username",placeholder:"correo@empresa.cl",required:!0})]})]}),(0,ze.jsxs)("div",{className:"form-row-2col",children:[(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-lock"})," Contrase\xf1a"]}),(0,ze.jsx)("input",{type:"password",value:q.password,placeholder:O?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":"M\xednimo 8 caracteres",onChange:e=>X(t=>Ue(Ue({},t),{},{password:e.target.value})),autoComplete:O?"off":"new-password"}),O&&(0,ze.jsx)("small",{className:"field-hint",children:"Dejar vac\xedo para mantener"})]}),(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-id-badge"})," Rol"]}),(0,ze.jsx)("select",{value:q.rol,onChange:e=>X(t=>Ue(Ue({},t),{},{rol:e.target.value,centro_costo_id:""})),disabled:"admin"===r.rol,children:"admin"===r.rol?(0,ze.jsx)("option",{value:"trabajador",children:"Trabajador"}):Oh.map(e=>(0,ze.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,ze.jsx)("div",{className:"form-section-divider",children:(0,ze.jsx)("span",{children:"Ubicaci\xf3n"})}),(0,ze.jsxs)("div",{className:"form-row-2col",children:[(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-map-marker-alt"})," Regi\xf3n"]}),(0,ze.jsx)("select",{value:q.region_id||"",onChange:e=>X(t=>Ue(Ue({},t),{},{region_id:e.target.value,proyecto_id:"",centro_costo_id:"",empresa_id:""})),disabled:"admin"===r.rol,children:"admin"===r.rol?(0,ze.jsx)("option",{value:r.region_id,children:r.region_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),b.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))]})})]}),(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-project-diagram"})," Proyecto"]}),(0,ze.jsx)("select",{value:q.proyecto_id||"",onChange:e=>X(t=>Ue(Ue({},t),{},{proyecto_id:e.target.value,centro_costo_id:"",empresa_id:""})),disabled:"admin"===r.rol||!q.region_id,children:"admin"===r.rol?(0,ze.jsx)("option",{value:r.proyecto_id,children:r.proyecto_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),Q.map(e=>(0,ze.jsx)("option",{value:e.proyecto_id,children:e.nombre},e.proyecto_id))]})})]})]}),(0,ze.jsxs)("div",{className:"form-row-2col",children:[(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-building"})," Centro de Costo"]}),(0,ze.jsx)("select",{value:q.centro_costo_id||"",onChange:e=>X(t=>Ue(Ue({},t),{},{centro_costo_id:e.target.value})),disabled:"admin"===r.rol||!q.proyecto_id,children:"admin"===r.rol?(0,ze.jsx)("option",{value:r.centro_costo_id,children:r.centro_costo_nombre}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("option",{value:"",children:"Seleccionar..."}),ne.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.nombre},e.id))]})})]}),(0,ze.jsxs)("label",{className:"form-field-compact",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-industry"})," Empresa Contratista"]}),(0,ze.jsxs)("select",{value:q.empresa_id||"",onChange:e=>X(t=>Ue(Ue({},t),{},{empresa_id:e.target.value})),disabled:!q.proyecto_id,children:[(0,ze.jsx)("option",{value:"",children:"(Opcional)"}),ae.map(e=>(0,ze.jsx)("option",{value:e.empresa_id,children:e.nombre},e.empresa_id))]})]})]}),(0,ze.jsx)("div",{className:"form-row-single-center",children:(0,ze.jsxs)("label",{className:"form-field-compact form-field-toggle",children:[(0,ze.jsxs)("span",{children:[(0,ze.jsx)("i",{className:"fa fa-check-circle"})," Estado"]}),(0,ze.jsxs)("div",{className:"toggle-switch-container",children:[(0,ze.jsxs)("button",{type:"button",className:"toggle-btn ".concat(1===q.aprobado?"active":""),onClick:()=>X(e=>Ue(Ue({},e),{},{aprobado:1})),children:[(0,ze.jsx)("i",{className:"fa fa-check"})," Aprobado"]}),(0,ze.jsxs)("button",{type:"button",className:"toggle-btn ".concat(0===q.aprobado?"active inactive":""),onClick:()=>X(e=>Ue(Ue({},e),{},{aprobado:0})),children:[(0,ze.jsx)("i",{className:"fa fa-clock"})," Pendiente"]})]})]})}),(0,ze.jsxs)("div",{className:"modal-actions-compact",children:[(0,ze.jsx)("button",{type:"button",className:"btn-cancel-compact",onClick:()=>{A(!1),P(null)},children:"Cancelar"}),(0,ze.jsxs)("button",{type:"submit",className:"btn-submit-compact",children:[(0,ze.jsx)("i",{className:O?"fa fa-save":"fa fa-plus"}),O?"Guardar Cambios":"Crear Usuario"]})]})]})]})}),B&&(0,ze.jsx)("div",{className:"usuarios-modal-overlay",onClick:me,children:(0,ze.jsxs)("div",{className:"usuarios-modal",style:{maxWidth:"450px"},onClick:e=>e.stopPropagation(),children:[(0,ze.jsxs)("h3",{style:{margin:"0 0 1rem 0",color:"#c62828",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-triangle"}),"Confirmar eliminaci\xf3n"]}),(0,ze.jsxs)("p",{style:{margin:"0 0 1rem 0",color:"#495057"},children:["\xbfEst\xe1s seguro de que deseas eliminar al usuario ",(0,ze.jsx)("strong",{children:B.nombre}),"?"]}),(0,ze.jsx)("p",{style:{margin:"0 0 1rem 0",color:"#6c757d",fontSize:"13px"},children:"Esta acci\xf3n es irreversible. Para confirmar, ingrese la contrase\xf1a especial:"}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#495057"},children:"Contrase\xf1a de confirmaci\xf3n:"}),(0,ze.jsx)("input",{type:"password",value:M,onChange:e=>{W(e.target.value),H("")},onKeyPress:e=>{"Enter"===e.key&&ge()},placeholder:"Ingrese la contrase\xf1a especial",style:{width:"100%",padding:"0.75rem",border:"2px solid ".concat(U?"#c62828":"#ced4da"),borderRadius:"6px",fontSize:"14px",boxSizing:"border-box"},autoFocus:!0}),U&&(0,ze.jsxs)("p",{style:{margin:"0.5rem 0 0 0",color:"#c62828",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},children:[(0,ze.jsx)("i",{className:"fa fa-exclamation-circle"}),U]})]}),(0,ze.jsxs)("div",{className:"usuarios-modal-actions",children:[(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #c62828 0%, #b71c1c 100%)"},onClick:ge,children:[(0,ze.jsx)("i",{className:"fa fa-trash",style:{marginRight:"0.3rem"}}),"Confirmar eliminaci\xf3n"]}),(0,ze.jsxs)("button",{className:"usuarios-accion-btn",style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)"},onClick:me,children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.3rem"}}),"Cancelar"]})]})]})}),z&&(0,ze.jsx)("div",{className:"usuarios-modal-bg",onClick:e=>{e.target===e.currentTarget&&(I(!1),P(null))},children:(0,ze.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",boxShadow:"0 10px 40px rgba(10, 50, 101, 0.2)",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",border:"1px solid #e5e7eb",animation:"slideUp 0.3s ease-out"},children:[(0,ze.jsx)("div",{style:{background:"linear-gradient(135deg, #0a6ebd 0%, #005288 100%)",padding:"1rem 1.5rem",color:"white",boxShadow:"0 2px 8px rgba(10, 110, 189, 0.3)"},children:(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,ze.jsx)("i",{className:"fa fa-building",style:{fontSize:"1.2rem"}}),(0,ze.jsx)("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:O?"Editar Empresa":"Nueva Empresa"})]})}),(0,ze.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),K.nombre&&K.rut&&""!==K.rut.trim())try{const e="".concat(Te,"/empresas/empresas.php"),t=O?"PUT":"POST",r=Ue(Ue({},K),{},{empresa_id:O?O.empresa_id:void 0}),n=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(n.ok){const e=await n.json();e.success?(fe(O?"Empresa actualizada correctamente":"Empresa agregada correctamente"),I(!1),P(null),J({nombre:"",rut:"",direccion:"",telefono:"",email:"",contacto_nombre:"",contacto_telefono:"",contacto_email:"",regiones:[],proyectos:[]}),pe()):fe(e.error||"Error al procesar empresa","error")}else{const e=await n.json();fe(e.error||"Error al procesar empresa","error")}}catch(t){fe("Error al procesar empresa","error"),console.error("Error:",t)}else fe("El nombre y el RUT son obligatorios","error")},style:{padding:"1.25rem",overflowY:"auto",flex:1,background:"#fff"},children:[(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid #e5e7eb"},children:[(0,ze.jsx)("i",{className:"fa fa-info-circle",style:{color:"#0a6ebd",fontSize:"0.9rem"}}),(0,ze.jsx)("h4",{style:{margin:0,fontSize:"0.85rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Informaci\xf3n Principal"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem"},children:[(0,ze.jsxs)("label",{style:{gridColumn:"span 2",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:["Nombre de la Empresa ",(0,ze.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:K.nombre,onChange:e=>J(Ue(Ue({},K),{},{nombre:e.target.value})),required:!0,placeholder:"Ej: Empresa Constructora S.A.",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsxs)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:["RUT ",(0,ze.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,ze.jsx)("input",{type:"text",value:K.rut,onChange:e=>J(Ue(Ue({},K),{},{rut:e.target.value})),required:!0,placeholder:"12345678-9",disabled:!!O,style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:O?"#f3f4f6":"#fff",cursor:O?"not-allowed":"text"},onFocus:e=>{O||(e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)")},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}}),O&&(0,ze.jsx)("small",{style:{color:"#6b7280",fontSize:"0.75rem",marginTop:"-0.15rem"},children:"El RUT no se puede modificar"})]}),(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Tel\xe9fono"}),(0,ze.jsx)("input",{type:"tel",value:K.telefono,onChange:e=>J(Ue(Ue({},K),{},{telefono:e.target.value})),placeholder:"+56 9 1234 5678",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("label",{style:{gridColumn:"span 2",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Email"}),(0,ze.jsx)("input",{type:"email",value:K.email,onChange:e=>J(Ue(Ue({},K),{},{email:e.target.value})),placeholder:"empresa@ejemplo.com",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("label",{style:{gridColumn:"span 2",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Direcci\xf3n"}),(0,ze.jsx)("textarea",{value:K.direccion,onChange:e=>J(Ue(Ue({},K),{},{direccion:e.target.value})),placeholder:"Direcci\xf3n completa",rows:"2",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff",resize:"vertical",fontFamily:"inherit"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]})]})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid #e5e7eb"},children:[(0,ze.jsx)("i",{className:"fa fa-user",style:{color:"#0a6ebd",fontSize:"0.9rem"}}),(0,ze.jsx)("h4",{style:{margin:0,fontSize:"0.85rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Datos de Contacto"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem"},children:[(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Nombre del Contacto"}),(0,ze.jsx)("input",{type:"text",value:K.contacto_nombre,onChange:e=>J(Ue(Ue({},K),{},{contacto_nombre:e.target.value})),placeholder:"Nombre completo",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Tel\xe9fono del Contacto"}),(0,ze.jsx)("input",{type:"tel",value:K.contacto_telefono,onChange:e=>J(Ue(Ue({},K),{},{contacto_telefono:e.target.value})),placeholder:"+56 9 1234 5678",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]}),(0,ze.jsxs)("label",{style:{gridColumn:"span 2",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Email del Contacto"}),(0,ze.jsx)("input",{type:"email",value:K.contacto_email,onChange:e=>J(Ue(Ue({},K),{},{contacto_email:e.target.value})),placeholder:"contacto@empresa.com",style:{padding:"0.6rem 0.75rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.9rem",transition:"all 0.2s",background:"#fff"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"}})]})]})]}),(0,ze.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,ze.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid #e5e7eb"},children:[(0,ze.jsx)("i",{className:"fa fa-map-marked-alt",style:{color:"#0a6ebd",fontSize:"0.9rem"}}),(0,ze.jsx)("h4",{style:{margin:0,fontSize:"0.85rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Servicios"})]}),(0,ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem"},children:[(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Regiones"}),(0,ze.jsx)("select",{multiple:!0,value:K.regiones.map(e=>String(e)),onChange:e=>{const t=Array.from(e.target.selectedOptions,e=>parseInt(e.value));J(Ue(Ue({},K),{},{regiones:t}))},style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.85rem",background:"#fff",transition:"all 0.2s",cursor:"pointer"},onFocus:e=>{e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)"},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"},children:0===b.length?(0,ze.jsx)("option",{disabled:!0,children:"No hay regiones disponibles"}):b.map(e=>(0,ze.jsx)("option",{value:e.region_id,children:e.nombre},e.region_id))}),(0,ze.jsx)("small",{style:{color:"#6b7280",fontSize:"0.75rem",marginTop:"-0.15rem"},children:"Ctrl/Cmd para m\xfaltiple selecci\xf3n"})]}),(0,ze.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:"0.35rem"},children:[(0,ze.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"600",color:"#0a6ebd",textTransform:"uppercase",letterSpacing:"0.3px"},children:"Proyectos"}),(0,ze.jsx)("select",{multiple:!0,value:K.proyectos.map(e=>String(e)),onChange:e=>{const t=Array.from(e.target.selectedOptions,e=>parseInt(e.value));J(Ue(Ue({},K),{},{proyectos:t}))},disabled:!K.regiones||0===K.regiones.length,style:{width:"100%",minHeight:"100px",padding:"0.5rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",fontSize:"0.85rem",background:K.regiones&&0!==K.regiones.length?"#fff":"#f3f4f6",cursor:K.regiones&&0!==K.regiones.length?"pointer":"not-allowed",transition:"all 0.2s",opacity:K.regiones&&0!==K.regiones.length?1:.6},onFocus:e=>{K.regiones&&K.regiones.length>0&&(e.target.style.borderColor="#0a6ebd",e.target.style.boxShadow="0 0 0 3px rgba(10, 110, 189, 0.1)")},onBlur:e=>{e.target.style.borderColor="#cbd5e1",e.target.style.boxShadow="none"},children:K.regiones&&0!==K.regiones.length?0===ee.length?(0,ze.jsx)("option",{disabled:!0,children:"Sin proyectos disponibles"}):ee.map(e=>(0,ze.jsx)("option",{value:e.proyecto_id,children:e.nombre},e.proyecto_id)):(0,ze.jsx)("option",{disabled:!0,children:"Selecciona regiones primero"})}),(0,ze.jsx)("small",{style:{color:K.regiones&&0!==K.regiones.length?"#6b7280":"#9ca3af",fontSize:"0.75rem",marginTop:"-0.15rem"},children:K.regiones&&0!==K.regiones.length?"Ctrl/Cmd para m\xfaltiple selecci\xf3n":"Selecciona regiones primero"})]})]})]}),(0,ze.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.75rem",paddingTop:"1rem",borderTop:"1px solid #e5e7eb",marginTop:"0.5rem"},children:[(0,ze.jsxs)("button",{type:"button",onClick:()=>{I(!1),P(null),J({nombre:"",rut:"",direccion:"",telefono:"",email:"",contacto_nombre:"",contacto_telefono:"",contacto_email:"",regiones:[],proyectos:[]})},style:{padding:"0.6rem 1.25rem",border:"1.5px solid #cbd5e1",borderRadius:"6px",background:"#fff",color:"#64748b",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",textTransform:"uppercase",letterSpacing:"0.3px"},onMouseEnter:e=>{e.target.style.background="#f3f4f6",e.target.style.borderColor="#9ca3af"},onMouseLeave:e=>{e.target.style.background="#fff",e.target.style.borderColor="#cbd5e1"},children:[(0,ze.jsx)("i",{className:"fa fa-times",style:{marginRight:"0.4rem"}}),"Cancelar"]}),(0,ze.jsxs)("button",{type:"submit",style:{padding:"0.6rem 1.25rem",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #0a6ebd 0%, #005288 100%)",color:"#fff",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 8px rgba(10, 110, 189, 0.3)",textTransform:"uppercase",letterSpacing:"0.3px"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #ff6600 0%, #e55a00 100%)",e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 4px 12px rgba(255, 102, 0, 0.3)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #0a6ebd 0%, #005288 100%)",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 8px rgba(10, 110, 189, 0.3)"},children:[(0,ze.jsx)("i",{className:"fa fa-save",style:{marginRight:"0.4rem"}}),O?"Actualizar":"Guardar"]})]})]})]})})]})},Dh=()=>{const[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)([]),[a,i]=(0,o.useState)(""),[s,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)([]),p=(0,o.useRef)(null),u=[{icon:"\ud83d\udcca",text:"\xbfQu\xe9 riesgos cr\xedticos hay?"},{icon:"\ud83c\udfaf",text:"Expl\xedcame el an\xe1lisis Bowtie"},{icon:"\ud83d\udee1\ufe0f",text:"\xbfQu\xe9 son los controles cr\xedticos?"},{icon:"\ud83d\udcd0",text:"\xbfCu\xe1les son las dimensiones de verificaci\xf3n?"},{icon:"\ud83d\udccb",text:"\xbfC\xf3mo funciona la l\xednea base?"},{icon:"\ud83d\udc65",text:"\xbfQu\xe9 roles hay en el sistema?"}];(0,o.useEffect)(()=>{(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[r]),(0,o.useEffect)(()=>{e&&0===r.length&&d(u)},[e]);const f=async function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||a.trim();if(!e||s)return;const t={role:"user",content:e};n(e=>[...e,t]),i(""),d([]),l(!0);try{const t=await fetch("/api/gemini_chat.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),r=await t.json(),o={role:"assistant",content:r.response||"Lo siento, no pude procesar tu mensaje."};n(e=>[...e,o]),r.sugerencias&&r.sugerencias.length>0&&d(r.sugerencias.map(e=>({icon:"\ud83d\udca1",text:e})))}catch(r){console.error("Error:",r);const e={role:"assistant",content:"Error al conectar con el servicio. Por favor intenta m\xe1s tarde."};n(t=>[...t,e])}finally{l(!1)}};return(0,ze.jsxs)(ze.Fragment,{children:[!e&&(0,ze.jsx)("button",{className:"gemini-chat-toggle",onClick:()=>t(!0),title:"Abrir chat de asistencia",children:(0,ze.jsx)("i",{className:"fa fa-comments"})}),e&&(0,ze.jsxs)("div",{className:"gemini-chat-container",children:[(0,ze.jsxs)("div",{className:"gemini-chat-header",children:[(0,ze.jsxs)("div",{className:"gemini-chat-title",children:[(0,ze.jsx)("i",{className:"fa fa-robot"}),(0,ze.jsx)("span",{children:"Asistente Virtual"})]}),(0,ze.jsx)("button",{className:"gemini-chat-close",onClick:()=>t(!1),title:"Cerrar chat",children:(0,ze.jsx)("i",{className:"fa fa-times"})})]}),(0,ze.jsxs)("div",{className:"gemini-chat-messages",children:[0===r.length&&(0,ze.jsxs)("div",{className:"gemini-chat-welcome",children:[(0,ze.jsx)("div",{className:"gemini-welcome-icon",children:(0,ze.jsx)("i",{className:"fa fa-robot"})}),(0,ze.jsx)("h3",{children:"\xa1Hola! Soy tu asistente de Riesgos Cr\xedticos"}),(0,ze.jsx)("p",{children:"Puedo ayudarte con informaci\xf3n sobre:"}),(0,ze.jsxs)("ul",{className:"gemini-capabilities",children:[(0,ze.jsx)("li",{children:"\ud83d\udcca Riesgos cr\xedticos del sistema"}),(0,ze.jsx)("li",{children:"\ud83c\udfaf An\xe1lisis Bowtie"}),(0,ze.jsx)("li",{children:"\ud83d\udee1\ufe0f Controles preventivos y mitigadores"}),(0,ze.jsx)("li",{children:"\ud83d\udcd0 Dimensiones de verificaci\xf3n"})]}),(0,ze.jsx)("p",{className:"gemini-prompt",children:"Selecciona una opci\xf3n o escribe tu pregunta:"})]}),r.map((e,t)=>(0,ze.jsx)("div",{className:"gemini-chat-message ".concat("user"===e.role?"user":"assistant"),children:(0,ze.jsx)("div",{className:"gemini-chat-message-content",children:e.content})},t)),s&&(0,ze.jsx)("div",{className:"gemini-chat-message assistant",children:(0,ze.jsx)("div",{className:"gemini-chat-message-content",children:(0,ze.jsxs)("div",{className:"gemini-chat-typing",children:[(0,ze.jsx)("span",{}),(0,ze.jsx)("span",{}),(0,ze.jsx)("span",{})]})})}),!s&&c.length>0&&(0,ze.jsxs)("div",{className:"gemini-sugerencias-container",children:[(0,ze.jsxs)("div",{className:"gemini-sugerencias-label",children:[(0,ze.jsx)("i",{className:"fa fa-lightbulb-o"})," Sugerencias:"]}),(0,ze.jsx)("div",{className:"gemini-sugerencias",children:c.map((e,t)=>(0,ze.jsxs)("button",{className:"gemini-sugerencia-btn",onClick:()=>{return t=e.text,void f(t);var t},children:[(0,ze.jsx)("span",{className:"gemini-sugerencia-icon",children:e.icon}),(0,ze.jsx)("span",{className:"gemini-sugerencia-text",children:e.text})]},t))})]}),(0,ze.jsx)("div",{ref:p})]}),(0,ze.jsxs)("div",{className:"gemini-chat-input-container",children:[(0,ze.jsx)("input",{type:"text",className:"gemini-chat-input",placeholder:"Escribe tu mensaje...",value:a,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},disabled:s}),(0,ze.jsx)("button",{className:"gemini-chat-send",onClick:()=>f(),disabled:s||!a.trim(),children:(0,ze.jsx)("i",{className:"fa fa-paper-plane"})})]})]})]})};function Lh(){const[e,t]=(0,o.useState)(null),[r,n]=(0,o.useState)([]),a=re(),i=ee();(0,o.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")),r=JSON.parse(localStorage.getItem("centros"))||[];t(e),n(r)},[]),(0,o.useEffect)(()=>{if(!i.pathname.startsWith("/proyecto/")&&e){if(console.log("App: Redirecci\xf3n autom\xe1tica - Usuario:",e.rol,"Path:",i.pathname),"/centros-por-region"===i.pathname)return void console.log("App: Permitiendo acceso a centros-por-region");if("super_admin"===e.rol)return;if("admin"===e.rol)return void("/ajuste"===i.pathname&&(console.log("App: Admin no puede acceder a ajuste, redirigiendo a /"),a("/")));if("trabajador"===e.rol)return void("/ajuste"!==i.pathname&&"/usuarios"!==i.pathname||(console.log("App: Trabajador no puede acceder a ajuste/usuarios, redirigiendo a /"),a("/")));if("visita"===e.rol)return void((i.pathname.startsWith("/proyecto/")||"/ajuste"===i.pathname||"/usuarios"===i.pathname)&&(console.log("App: Visita no puede acceder a proyectos/ajuste/usuarios, redirigiendo a /"),a("/")))}},[e,r,a,i.pathname]);if(!e)return(0,ze.jsx)(Oe,{setUser:t,setCentros:n});const s=()=>{localStorage.removeItem("user"),localStorage.removeItem("centros"),t(null),n([]),window.location.href="/"};return(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)(be,{children:[(0,ze.jsx)(me,{path:"/",element:(0,ze.jsx)(Le,{user:e,centros:r,onLogout:s})}),(0,ze.jsx)(me,{path:"/centros-por-region",element:(0,ze.jsx)(Ye,{user:e,centros:r,onLogout:s})}),(0,ze.jsx)(me,{path:"/ajuste",element:(0,ze.jsx)(Ph,{user:e})}),(0,ze.jsx)(me,{path:"/proyecto/:proyectoId",element:(0,ze.jsx)(Ah,{})}),(0,ze.jsx)(me,{path:"/usuarios",element:(0,ze.jsx)(zh,{user:e})})]}),e&&(0,ze.jsx)(Dh,{})]})}const Bh=function(){return(0,ze.jsx)(_e,{children:(0,ze.jsx)(Lh,{})})};i.render((0,ze.jsx)(Ge,{children:(0,ze.jsx)(Bh,{})}),document.getElementById("root"))})();
//# sourceMappingURL=main.82ecdcd0.js.map